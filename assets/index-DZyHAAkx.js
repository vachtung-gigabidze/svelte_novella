(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const ri=!1;var bo=Array.isArray,Zu=Array.prototype.indexOf,el=Array.from,ws=Object.defineProperty,Nt=Object.getOwnPropertyDescriptor,tl=Object.getOwnPropertyDescriptors,rl=Object.prototype,sl=Array.prototype,mo=Object.getPrototypeOf,si=Object.isExtensible;const es=()=>{};function nl(t){return t()}function ni(t){for(var e=0;e<t.length;e++)t[e]()}function il(){var t,e,r=new Promise((s,n)=>{t=s,e=n});return{promise:r,resolve:t,reject:e}}const te=2,ko=4,Eo=8,Or=16,Pe=32,bt=64,So=128,ee=256,yr=512,K=1024,ae=2048,ze=4096,dt=8192,mt=16384,Js=32768,ol=65536,ii=1<<17,al=1<<18,Qs=1<<19,Ys=1<<20,bs=1<<21,Xs=1<<22,Ne=1<<23,Bt=Symbol("$state"),Zs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ul(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function ll(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function cl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function hl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function dl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function fl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function pl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function _l(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function gl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const vl=1,yl=2,V=Symbol();function $o(t){return t===this.v}function To(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function jo(t){return!To(t,this.v)}let xr=!1,wl=!1;function bl(){xr=!0}let N=null;function wr(t){N=t}function en(t,e=!1,r){N={p:N,c:null,e:null,s:t,x:null,l:xr&&!e?{s:null,u:null,$:[]}:null}}function tn(t){var e=N,r=e.e;if(r!==null){e.e=null;for(var s of r)qo(s)}return N=e.p,{}}function rr(){return!xr||N!==null&&N.l===null}const ml=new WeakMap;function kl(t){var e=T;if(e===null)return S.f|=Ne,t;if((e.f&Js)===0){if((e.f&So)===0)throw!e.parent&&t instanceof Error&&Ao(t),t;e.b.error(t)}else rn(t,e)}function rn(t,e){for(;e!==null;){if((e.f&So)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t instanceof Error&&Ao(t),t}function Ao(t){const e=ml.get(t);e&&(ws(t,"message",{value:e.message}),ws(t,"stack",{value:e.stack}))}function El(){for(var t=T.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&ul(),t}function sn(t){var e=te|ae,r=S!==null&&(S.f&te)!==0?S:null;return T===null||r!==null&&(r.f&ee)!==0?e|=ee:T.f|=Qs,{ctx:N,deps:null,effects:null,equals:$o,f:e,fn:t,reactions:null,rv:0,v:V,wv:0,parent:r??T,ac:null}}function Sl(t,e){let r=T;r===null&&ll();var s=r.b,n=void 0,i=on(V),o=null,a=!S;return Dl(()=>{try{var u=t()}catch(f){u=Promise.reject(f)}var l=()=>u;n=o?.then(l,l)??Promise.resolve(u),o=n;var c=he,h=s.pending;a&&(s.update_pending_count(1),h||c.increment());const d=(f,p=void 0)=>{o=null,h||c.activate(),p?p!==Zs&&(i.f|=Ne,ks(i,p)):((i.f&Ne)!==0&&(i.f^=Ne),ks(i,f)),a&&(s.update_pending_count(-1),h||c.decrement()),xo()};if(n.then(d,f=>d(null,f||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(u=>{function l(c){function h(){c===n?u(i):l(n)}c.then(h,h)}l(n)})}function $l(t){const e=sn(t);return e.equals=jo,e}function Po(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Ve(e[r])}}function Tl(t){for(var e=t.parent;e!==null;){if((e.f&te)===0)return e;e=e.parent}return null}function nn(t){var e,r=T;pt(Tl(t));try{Po(t),e=Ko(t)}finally{pt(r)}return e}function Oo(t){var e=nn(t);if(t.equals(e)||(t.v=e,t.wv=Wo()),!Et)if(ft!==null)ft.set(t,t.v);else{var r=(Se||(t.f&ee)!==0)&&t.deps!==null?ze:K;G(t,r)}}function jl(t,e,r){const s=rr()?sn:$l;if(e.length===0){r(t.map(s));return}var n=he,i=T,o=Al(),a=El();Promise.all(e.map(u=>Sl(u))).then(u=>{n?.activate(),o();try{r([...t.map(s),...u])}catch(l){(i.f&mt)===0&&rn(l,i)}n?.deactivate(),xo()}).catch(u=>{a.error(u)})}function Al(){var t=T,e=S,r=N;return function(){pt(t),Te(e),wr(r)}}function xo(){pt(null),Te(null),wr(null)}const hr=new Set;let he=null,ft=null;let Rt=[],br=null,ms=!1;class Cr{#u=new Map;#i=new Map;#o=new Set;#t=0;#l=null;#c=!1;#s=[];#a=[];#r=[];#e=[];#n=[];skipped_effects=new Set;#d(e){Rt=[];var r=null;if(hr.size>1){r=new Map,ft=new Map;for(const[i,o]of this.#u)r.set(i,{v:i.v,wv:i.wv}),i.v=o;for(const i of hr)if(i!==this)for(const[o,a]of i.#i)r.has(o)||(r.set(o,{v:o.v,wv:o.wv}),o.v=a)}for(const i of e)this.#f(i);if(this.#s.length===0&&this.#t===0){var s=this.#r,n=this.#e;this.#r=[],this.#e=[],this.#n=[],this.#h(),oi(s),oi(n),this.#l?.resolve()}else{for(const i of this.#r)G(i,K);for(const i of this.#e)G(i,K);for(const i of this.#n)G(i,K)}if(r){for(const[i,{v:o,wv:a}]of r)i.wv<=a&&(i.v=o);ft=null}for(const i of this.#s)Mt(i);for(const i of this.#a)Mt(i);this.#s=[],this.#a=[]}#f(e){e.f^=K;for(var r=e.first;r!==null;){var s=r.f,n=(s&(Pe|bt))!==0,i=n&&(s&K)!==0,o=i||(s&dt)!==0||this.skipped_effects.has(r);if(!o&&r.fn!==null){if(n)r.f^=K;else if((s&ko)!==0)this.#e.push(r);else if(Ir(r))if((s&Xs)!==0){var a=r.b?.pending?this.#a:this.#s;a.push(r)}else(r.f&Or)!==0&&this.#n.push(r),Mt(r);var u=r.first;if(u!==null){r=u;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}}capture(e,r){this.#i.has(e)||this.#i.set(e,r),this.#u.set(e,e.v)}activate(){he=this}deactivate(){he=null}neuter(){this.#c=!0}flush(){Rt.length>0?this.flush_effects():this.#h(),he===this&&(this.#t===0&&hr.delete(this),he=null)}flush_effects(){var e=ht;ms=!0;try{var r=0;for(li(!0);Rt.length>0;)r++>1e3&&Pl(),this.#d(Rt),Me.clear()}finally{ms=!1,li(e),br=null}}#h(){if(!this.#c)for(const e of this.#o)e();this.#o.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const e of this.#r)G(e,ae),Be(e);for(const e of this.#e)G(e,ae),Be(e);for(const e of this.#n)G(e,ae),Be(e);this.#r=[],this.#e=[],this.flush()}}add_callback(e){this.#o.add(e)}settled(){return(this.#l??=il()).promise}static ensure(){if(he===null){const e=he=new Cr;hr.add(he),queueMicrotask(()=>{he===e&&e.flush()})}return he}}function Pl(){try{fl()}catch(t){if(br!==null)rn(t,br);else throw t}}function oi(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var s=t[r];if((s.f&(mt|dt))===0&&Ir(s)){var n=kr;if(Mt(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null?Mo(s):s.fn=null),kr>n&&(s.f&Ys)!==0)break}}for(;r<e;r+=1)Be(t[r])}}function Be(t){for(var e=br=t;e.parent!==null;){e=e.parent;var r=e.f;if(ms&&e===T&&(r&Or)!==0)return;if((r&(bt|Pe))!==0){if((r&K)===0)return;e.f^=K}}Rt.push(e)}const Me=new Map;function on(t,e){var r={f:0,v:t,reactions:null,equals:$o,rv:0,wv:0};return r}function we(t,e){const r=on(t);return Vl(r),r}function Ol(t,e=!1,r=!0){const s=on(t);return e||(s.equals=jo),xr&&r&&N!==null&&N.l!==null&&(N.l.s??=[]).push(s),s}function _e(t,e,r=!1){S!==null&&(!fe||(S.f&ii)!==0)&&rr()&&(S.f&(te|Or|Xs|ii))!==0&&!ye?.includes(t)&&gl();let s=r?Lt(e):e;return ks(t,s)}function ks(t,e){if(!t.equals(e)){var r=t.v;Et?Me.set(t,e):Me.set(t,r),t.v=e,Cr.ensure().capture(t,r),(t.f&te)!==0&&((t.f&ae)!==0&&nn(t),G(t,(t.f&ee)===0?K:ze)),t.wv=Wo(),Co(t,ae),rr()&&T!==null&&(T.f&K)!==0&&(T.f&(Pe|bt))===0&&(oe===null?Kl([t]):oe.push(t))}return e}function ts(t){_e(t,t.v+1)}function Co(t,e){var r=t.reactions;if(r!==null)for(var s=rr(),n=r.length,i=0;i<n;i++){var o=r[i],a=o.f;(a&ae)===0&&(!s&&o===T||(G(o,e),(a&(K|ee))!==0&&((a&te)!==0?Co(o,ze):Be(o))))}}function Lt(t){if(typeof t!="object"||t===null||Bt in t)return t;const e=mo(t);if(e!==rl&&e!==sl)return t;var r=new Map,s=bo(t),n=we(0),i=Fe,o=a=>{if(Fe===i)return a();var u=S,l=Fe;Te(null),hi(i);var c=a();return Te(u),hi(l),c};return s&&r.set("length",we(t.length)),new Proxy(t,{defineProperty(a,u,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&pl();var c=r.get(u);return c===void 0?c=o(()=>{var h=we(l.value);return r.set(u,h),h}):_e(c,l.value,!0),!0},deleteProperty(a,u){var l=r.get(u);if(l===void 0){if(u in a){const d=o(()=>we(V));r.set(u,d),ts(n)}}else{if(s&&typeof u=="string"){var c=r.get("length"),h=Number(u);Number.isInteger(h)&&h<c.v&&_e(c,h)}_e(l,V),ts(n)}return!0},get(a,u,l){if(u===Bt)return t;var c=r.get(u),h=u in a;if(c===void 0&&(!h||Nt(a,u)?.writable)&&(c=o(()=>{var f=Lt(h?a[u]:V),p=we(f);return p}),r.set(u,c)),c!==void 0){var d=$e(c);return d===V?void 0:d}return Reflect.get(a,u,l)},getOwnPropertyDescriptor(a,u){var l=Reflect.getOwnPropertyDescriptor(a,u);if(l&&"value"in l){var c=r.get(u);c&&(l.value=$e(c))}else if(l===void 0){var h=r.get(u),d=h?.v;if(h!==void 0&&d!==V)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return l},has(a,u){if(u===Bt)return!0;var l=r.get(u),c=l!==void 0&&l.v!==V||Reflect.has(a,u);if(l!==void 0||T!==null&&(!c||Nt(a,u)?.writable)){l===void 0&&(l=o(()=>{var d=c?Lt(a[u]):V,f=we(d);return f}),r.set(u,l));var h=$e(l);if(h===V)return!1}return c},set(a,u,l,c){var h=r.get(u),d=u in a;if(s&&u==="length")for(var f=l;f<h.v;f+=1){var p=r.get(f+"");p!==void 0?_e(p,V):f in a&&(p=o(()=>we(V)),r.set(f+"",p))}if(h===void 0)(!d||Nt(a,u)?.writable)&&(h=o(()=>we(void 0)),_e(h,Lt(l)),r.set(u,h));else{d=h.v!==V;var v=o(()=>Lt(l));_e(h,v)}var _=Reflect.getOwnPropertyDescriptor(a,u);if(_?.set&&_.set.call(c,l),!d){if(s&&typeof u=="string"){var E=r.get("length"),b=Number(u);Number.isInteger(b)&&b>=E.v&&_e(E,b+1)}ts(n)}return!0},ownKeys(a){$e(n);var u=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==V});for(var[l,c]of r)c.v!==V&&!(l in a)&&u.push(l);return u},setPrototypeOf(){_l()}})}var ai,Io,Ro,Lo;function xl(){if(ai===void 0){ai=window,Io=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Ro=Nt(e,"firstChild").get,Lo=Nt(e,"nextSibling").get,si(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),si(r)&&(r.__t=void 0)}}function Cl(t=""){return document.createTextNode(t)}function mr(t){return Ro.call(t)}function an(t){return Lo.call(t)}function Es(t,e){return mr(t)}function Il(t,e){{var r=mr(t);return r instanceof Comment&&r.data===""?an(r):r}}function Uo(t,e=1,r=!1){let s=t;for(;e--;)s=an(s);return s}function Do(t){T===null&&S===null&&dl(),S!==null&&(S.f&ee)!==0&&T===null&&hl(),Et&&cl()}function Rl(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function kt(t,e,r,s=!0){var n=T;n!==null&&(n.f&dt)!==0&&(t|=dt);var i={ctx:N,deps:null,nodes_start:null,nodes_end:null,f:t|ae,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Mt(i),i.f|=Js}catch(u){throw Ve(i),u}else e!==null&&Be(i);var o=r&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&Qs)===0;if(!o&&s&&(n!==null&&Rl(i,n),S!==null&&(S.f&te)!==0)){var a=S;(a.effects??=[]).push(i)}return i}function ui(t){Do();var e=T.f,r=!S&&(e&Pe)!==0&&(e&Js)===0;if(r){var s=N;(s.e??=[]).push(t)}else return qo(t)}function qo(t){return kt(ko|Ys,t,!1)}function Ll(t){return Do(),kt(Eo|Ys,t,!0)}function Ul(t){Cr.ensure();const e=kt(bt,t,!0);return(r={})=>new Promise(s=>{r.outro?Fl(e,()=>{Ve(e),s(void 0)}):(Ve(e),s(void 0))})}function Dl(t){return kt(Xs|Qs,t,!0)}function ql(t,e=[],r=[]){jl(e,r,s=>{kt(Eo,()=>t(...s.map($e)),!0)})}function Nl(t,e=!0){return kt(Pe,t,!0,e)}function No(t){var e=t.teardown;if(e!==null){const r=Et,s=S;ci(!0),Te(null);try{e.call(null)}finally{ci(r),Te(s)}}}function Bo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){r.ac?.abort(Zs);var s=r.next;(r.f&bt)!==0?r.parent=null:Ve(r,e),r=s}}function Bl(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Pe)===0&&Ve(e),e=r}}function Ve(t,e=!0){var r=!1;(e||(t.f&al)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Ml(t.nodes_start,t.nodes_end),r=!0),Bo(t,e&&!r),Er(t,0),G(t,mt);var s=t.transitions;if(s!==null)for(const i of s)i.stop();No(t);var n=t.parent;n!==null&&n.first!==null&&Mo(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function Ml(t,e){for(;t!==null;){var r=t===e?null:an(t);t.remove(),t=r}}function Mo(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function Fl(t,e){var r=[];Fo(t,r,!0),Wl(r,()=>{Ve(t),e&&e()})}function Wl(t,e){var r=t.length;if(r>0){var s=()=>--r||e();for(var n of t)n.out(s)}else e()}function Fo(t,e,r){if((t.f&dt)===0){if(t.f^=dt,t.transitions!==null)for(const o of t.transitions)(o.is_global||r)&&e.push(o);for(var s=t.first;s!==null;){var n=s.next,i=(s.f&ol)!==0||(s.f&Pe)!==0;Fo(s,e,i?r:!1),s=n}}}let ht=!1;function li(t){ht=t}let Et=!1;function ci(t){Et=t}let S=null,fe=!1;function Te(t){S=t}let T=null;function pt(t){T=t}let ye=null;function Vl(t){S!==null&&(ye===null?ye=[t]:ye.push(t))}let z=null,X=0,oe=null;function Kl(t){oe=t}let kr=1,Ht=0,Fe=Ht;function hi(t){Fe=t}let Se=!1;function Wo(){return++kr}function Ir(t){var e=t.f;if((e&ae)!==0)return!0;if((e&ze)!==0){var r=t.deps,s=(e&ee)!==0;if(r!==null){var n,i,o=(e&yr)!==0,a=s&&T!==null&&!Se,u=r.length;if((o||a)&&(T===null||(T.f&mt)===0)){var l=t,c=l.parent;for(n=0;n<u;n++)i=r[n],(o||!i?.reactions?.includes(l))&&(i.reactions??=[]).push(l);o&&(l.f^=yr),a&&c!==null&&(c.f&ee)===0&&(l.f^=ee)}for(n=0;n<u;n++)if(i=r[n],Ir(i)&&Oo(i),i.wv>t.wv)return!0}(!s||T!==null&&!Se)&&G(t,K)}return!1}function Vo(t,e,r=!0){var s=t.reactions;if(s!==null&&!ye?.includes(t))for(var n=0;n<s.length;n++){var i=s[n];(i.f&te)!==0?Vo(i,e,!1):e===i&&(r?G(i,ae):(i.f&K)!==0&&G(i,ze),Be(i))}}function Ko(t){var e=z,r=X,s=oe,n=S,i=Se,o=ye,a=N,u=fe,l=Fe,c=t.f;z=null,X=0,oe=null,Se=(c&ee)!==0&&(fe||!ht||S===null),S=(c&(Pe|bt))===0?t:null,ye=null,wr(t.ctx),fe=!1,Fe=++Ht,t.ac!==null&&(t.ac.abort(Zs),t.ac=null);try{t.f|=bs;var h=(0,t.fn)(),d=t.deps;if(z!==null){var f;if(Er(t,X),d!==null&&X>0)for(d.length=X+z.length,f=0;f<z.length;f++)d[X+f]=z[f];else t.deps=d=z;if(!Se||(c&te)!==0&&t.reactions!==null)for(f=X;f<d.length;f++)(d[f].reactions??=[]).push(t)}else d!==null&&X<d.length&&(Er(t,X),d.length=X);if(rr()&&oe!==null&&!fe&&d!==null&&(t.f&(te|ze|ae))===0)for(f=0;f<oe.length;f++)Vo(oe[f],t);return n!==null&&n!==t&&(Ht++,oe!==null&&(s===null?s=oe:s.push(...oe))),(t.f&Ne)!==0&&(t.f^=Ne),h}catch(p){return kl(p)}finally{t.f^=bs,z=e,X=r,oe=s,S=n,Se=i,ye=o,wr(a),fe=u,Fe=l}}function zl(t,e){let r=e.reactions;if(r!==null){var s=Zu.call(r,t);if(s!==-1){var n=r.length-1;n===0?r=e.reactions=null:(r[s]=r[n],r.pop())}}r===null&&(e.f&te)!==0&&(z===null||!z.includes(e))&&(G(e,ze),(e.f&(ee|yr))===0&&(e.f^=yr),Po(e),Er(e,0))}function Er(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)zl(t,r[s])}function Mt(t){var e=t.f;if((e&mt)===0){G(t,K);var r=T,s=ht;T=t,ht=!0;try{(e&Or)!==0?Bl(t):Bo(t),No(t);var n=Ko(t);t.teardown=typeof n=="function"?n:null,t.wv=kr;var i;ri&&wl&&(t.f&ae)!==0&&t.deps}finally{ht=s,T=r}}}function $e(t){var e=t.f,r=(e&te)!==0;if(S!==null&&!fe){var s=T!==null&&(T.f&mt)!==0;if(!s&&!ye?.includes(t)){var n=S.deps;if((S.f&bs)!==0)t.rv<Ht&&(t.rv=Ht,z===null&&n!==null&&n[X]===t?X++:z===null?z=[t]:(!Se||!z.includes(t))&&z.push(t));else{(S.deps??=[]).push(t);var i=t.reactions;i===null?t.reactions=[S]:i.includes(S)||i.push(S)}}}else if(r&&t.deps===null&&t.effects===null){var o=t,a=o.parent;a!==null&&(a.f&ee)===0&&(o.f^=ee)}if(Et){if(Me.has(t))return Me.get(t);if(r){o=t;var u=o.v;return((o.f&K)!==0||zo(o))&&(u=nn(o)),Me.set(o,u),u}}else if(r){if(o=t,ft?.has(o))return ft.get(o);Ir(o)&&Oo(o)}if((t.f&Ne)!==0)throw t.v;return t.v}function zo(t){if(t.v===V)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Me.has(e)||(e.f&te)!==0&&zo(e))return!0;return!1}function Gl(t){var e=fe;try{return fe=!0,t()}finally{fe=e}}const Hl=-7169;function G(t,e){t.f=t.f&Hl|e}function Jl(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Bt in t)Ss(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&Bt in r&&Ss(r)}}}function Ss(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let s in t)try{Ss(t[s],e)}catch{}const r=mo(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const s=tl(r);for(let n in s){const i=s[n].get;if(i)try{i.call(t)}catch{}}}}}const Ql=["touchstart","touchmove"];function Yl(t){return Ql.includes(t)}const Go=new Set,$s=new Set;function Xl(t){for(var e=0;e<t.length;e++)Go.add(t[e]);for(var r of $s)r(t)}function dr(t){var e=this,r=e.ownerDocument,s=t.type,n=t.composedPath?.()||[],i=n[0]||t.target,o=0,a=t.__root;if(a){var u=n.indexOf(a);if(u!==-1&&(e===document||e===window)){t.__root=e;return}var l=n.indexOf(e);if(l===-1)return;u<=l&&(o=u)}if(i=n[o]||t.target,i!==e){ws(t,"currentTarget",{configurable:!0,get(){return i||r}});var c=S,h=T;Te(null),pt(null);try{for(var d,f=[];i!==null;){var p=i.assignedSlot||i.parentNode||i.host||null;try{var v=i["__"+s];if(v!=null&&(!i.disabled||t.target===i))if(bo(v)){var[_,...E]=v;_.apply(i,[t,...E])}else v.call(i,t)}catch(b){d?f.push(b):d=b}if(t.cancelBubble||p===e||p===null)break;i=p}if(d){for(let b of f)queueMicrotask(()=>{throw b});throw d}}finally{t.__root=e,delete t.currentTarget,Te(c),pt(h)}}}function Zl(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function di(t,e){var r=T;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function Ho(t,e){var r=(e&vl)!==0,s=(e&yl)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=Zl(i?t:"<!>"+t),r||(n=mr(n)));var o=s||Io?document.importNode(n,!0):n.cloneNode(!0);if(r){var a=mr(o),u=o.lastChild;di(a,u)}else di(o,o);return o}}function Jo(t,e){t!==null&&t.before(e)}function ec(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function tc(t,e){return rc(t,e)}const Qe=new Map;function rc(t,{target:e,anchor:r,props:s={},events:n,context:i,intro:o=!0}){xl();var a=new Set,u=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!a.has(f)){a.add(f);var p=Yl(f);e.addEventListener(f,dr,{passive:p});var v=Qe.get(f);v===void 0?(document.addEventListener(f,dr,{passive:p}),Qe.set(f,1)):Qe.set(f,v+1)}}};u(el(Go)),$s.add(u);var l=void 0,c=Ul(()=>{var h=r??e.appendChild(Cl());return Nl(()=>{if(i){en({});var d=N;d.c=i}n&&(s.$$events=n),l=t(h,s)||{},i&&tn()}),()=>{for(var d of a){e.removeEventListener(d,dr);var f=Qe.get(d);--f===0?(document.removeEventListener(d,dr),Qe.delete(d)):Qe.set(d,f)}$s.delete(u),h!==r&&h.parentNode?.removeChild(h)}});return sc.set(l,c),l}let sc=new WeakMap;function Qo(t=!1){const e=N,r=e.l.u;if(!r)return;let s=()=>Jl(e.s);if(t){let n=0,i={};const o=sn(()=>{let a=!1;const u=e.s;for(const l in u)u[l]!==i[l]&&(i[l]=u[l],a=!0);return a&&n++,n});s=()=>$e(o)}r.b.length&&Ll(()=>{fi(e,s),ni(r.b)}),ui(()=>{const n=Gl(()=>r.m.map(nl));return()=>{for(const i of n)typeof i=="function"&&i()}}),r.a.length&&ui(()=>{fi(e,s),ni(r.a)})}function fi(t,e){if(t.l.s)for(const r of t.l.s)$e(r);e()}const Ye=[];function nc(t,e=es){let r=null;const s=new Set;function n(a){if(To(t,a)&&(t=a,r)){const u=!Ye.length;for(const l of s)l[1](),Ye.push(l,t);if(u){for(let l=0;l<Ye.length;l+=2)Ye[l][0](Ye[l+1]);Ye.length=0}}}function i(a){n(a(t))}function o(a,u=es){const l=[a,u];return s.add(l),s.size===1&&(r=e(n,i)||es),a(t),()=>{s.delete(l),s.size===0&&r&&(r(),r=null)}}return{set:n,update:i,subscribe:o}}const ic="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(ic);bl();const oc="modulepreload",ac=function(t,e){return new URL(t,e).href},pi={},sr=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=a?.nonce||a?.getAttribute("nonce");n=l(r.map(c=>{if(c=ac(c,s),c in pi)return;pi[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(!!s)for(let v=o.length-1;v>=0;v--){const _=o[v];if(_.href===c&&(!h||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":oc,h||(p.as="script"),p.crossOrigin="",p.href=c,u&&p.setAttribute("nonce",u),document.head.appendChild(p),h)return new Promise((v,_)=>{p.addEventListener("load",v),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},uc=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>St);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class un extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class lc extends un{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _i extends un{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class gi extends un{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ts;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ts||(Ts={}));var cc=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class hc{constructor(e,{headers:r={},customFetch:s,region:n=Ts.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=uc(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return cc(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:u}=r;u||(u=this.region);const l=new URL(`${this.url}/${e}`);u&&u!=="any"&&(a["x-region"]=u,l.searchParams.set("forceFunctionRegion",u));let c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const h=yield this.fetch(l.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(v=>{throw new lc(v)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new _i(h);if(!h.ok)throw new gi(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof gi||n instanceof _i?n.context:void 0}}})}}function dc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function fc(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function s(){var n=!1;try{n=this instanceof s}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}var R={},Xe={},Ze={},et={},tt={},rt={},pc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_t=pc();const _c=_t.fetch,Yo=_t.fetch.bind(_t),Xo=_t.Headers,gc=_t.Request,vc=_t.Response,St=Object.freeze(Object.defineProperty({__proto__:null,Headers:Xo,Request:gc,Response:vc,default:Yo,fetch:_c},Symbol.toStringTag,{value:"Module"})),yc=fc(St);var fr={},vi;function Zo(){if(vi)return fr;vi=1,Object.defineProperty(fr,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return fr.default=t,fr}var yi;function ea(){if(yi)return rt;yi=1;var t=rt&&rt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rt,"__esModule",{value:!0});const e=t(yc),r=t(Zo());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let u=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,h,d;let f=null,p=null,v=null,_=l.status,E=l.statusText;if(l.ok){if(this.method!=="HEAD"){const $=await l.text();$===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=$:p=JSON.parse($))}const g=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(h=l.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");g&&w&&w.length>1&&(v=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,_=406,E="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const g=await l.text();try{f=JSON.parse(g),Array.isArray(f)&&l.status===404&&(p=[],f=null,_=200,E="OK")}catch{l.status===404&&g===""?(_=204,E="No Content"):f={message:g}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,_=200,E="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:p,count:v,status:_,statusText:E}});return this.shouldThrowOnError||(u=u.catch(l=>{var c,h,d;return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:`${(h=l?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=l?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),u.then(i,o)}returns(){return this}overrideTypes(){return this}}return rt.default=s,rt}var wi;function ta(){if(wi)return tt;wi=1;var t=tt&&tt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(tt,"__esModule",{value:!0});const e=t(ea());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:u=a}={}){const l=u?`${u}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const u=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(u,`${n}`),this.url.searchParams.set(l,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:u=!1,format:l="text"}={}){var c;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,u?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${d}"; options=${h};`,l==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return tt.default=r,tt}var bi;function ln(){if(bi)return et;bi=1;var t=et&&et.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(et,"__esModule",{value:!0});const e=t(ta());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let u="";a==="plain"?u="pl":a==="phrase"?u="ph":a==="websearch"&&(u="w");const l=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${u}fts${l}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return et.default=r,et}var mi;function ra(){if(mi)return Ze;mi=1;var t=Ze&&Ze.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ze,"__esModule",{value:!0});const e=t(ln());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let u=!1;const l=(n??"*").split("").map(c=>/\s/.test(c)&&!u?"":(c==='"'&&(u=!u),c)).join("");return this.url.searchParams.set("select",l),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",u=[];if(this.headers.Prefer&&u.push(this.headers.Prefer),i&&u.push(`count=${i}`),o||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const l=n.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:u=!0}={}){const l="POST",c=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),u||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Ze.default=r,Ze}var xt={},Ct={},ki;function wc(){return ki||(ki=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.version=void 0,Ct.version="0.0.0-automated"),Ct}var Ei;function bc(){if(Ei)return xt;Ei=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.DEFAULT_HEADERS=void 0;const t=wc();return xt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},xt}var Si;function mc(){if(Si)return Xe;Si=1;var t=Xe&&Xe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Xe,"__esModule",{value:!0});const e=t(ra()),r=t(ln()),s=bc();class n{constructor(o,{headers:a={},schema:u,fetch:l}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=u,this.fetch=l}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:u=!1,get:l=!1,count:c}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;u||l?(h=u?"HEAD":"GET",Object.entries(a).filter(([v,_])=>_!==void 0).map(([v,_])=>[v,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([v,_])=>{d.searchParams.append(v,_)})):(h="POST",f=a);const p=Object.assign({},this.headers);return c&&(p.Prefer=`count=${c}`),new r.default({method:h,url:d,headers:p,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Xe.default=n,Xe}var $i;function kc(){if($i)return R;$i=1;var t=R&&R.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(R,"__esModule",{value:!0}),R.PostgrestError=R.PostgrestBuilder=R.PostgrestTransformBuilder=R.PostgrestFilterBuilder=R.PostgrestQueryBuilder=R.PostgrestClient=void 0;const e=t(mc());R.PostgrestClient=e.default;const r=t(ra());R.PostgrestQueryBuilder=r.default;const s=t(ln());R.PostgrestFilterBuilder=s.default;const n=t(ta());R.PostgrestTransformBuilder=n.default;const i=t(ea());R.PostgrestBuilder=i.default;const o=t(Zo());return R.PostgrestError=o.default,R.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},R}var Ec=kc();const Sc=dc(Ec),{PostgrestClient:$c,PostgrestQueryBuilder:Z_,PostgrestFilterBuilder:eg,PostgrestTransformBuilder:tg,PostgrestBuilder:rg,PostgrestError:sg}=Sc;function Tc(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const jc=Tc(),Ac="2.11.15",Pc=`realtime-js/${Ac}`,Oc="1.0.0",sa=1e4,xc=1e3;var Ft;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ft||(Ft={}));var W;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(W||(W={}));var de;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(de||(de={}));var js;(function(t){t.websocket="websocket"})(js||(js={}));var Ue;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ue||(Ue={}));class Cc{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const u=s.decode(e.slice(o,o+i));o=o+i;const l=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:u,payload:l}}}class na{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var P;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(P||(P={}));const Ti=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Ic(o,t,e,n),i),{})},Ic=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?ia(i,o):As(o)},ia=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Dc(e,r)}switch(t){case P.bool:return Rc(e);case P.float4:case P.float8:case P.int2:case P.int4:case P.int8:case P.numeric:case P.oid:return Lc(e);case P.json:case P.jsonb:return Uc(e);case P.timestamp:return qc(e);case P.abstime:case P.date:case P.daterange:case P.int4range:case P.int8range:case P.money:case P.reltime:case P.text:case P.time:case P.timestamptz:case P.timetz:case P.tsrange:case P.tstzrange:return As(e);default:return As(e)}},As=t=>t,Rc=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Lc=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Uc=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Dc=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ia(e,a))}return t},qc=t=>typeof t=="string"?t.replace(" ","T"):t,oa=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class rs{constructor(e,r,s={},n=sa){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ji;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ji||(ji={}));class Wt{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wt.syncState(this.state,n,i,o),this.pendingDiffs.forEach(u=>{this.state=Wt.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Wt.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},u={};return this.map(i,(l,c)=>{o[l]||(u[l]=c)}),this.map(o,(l,c)=>{const h=i[l];if(h){const d=c.map(_=>_.presence_ref),f=h.map(_=>_.presence_ref),p=c.filter(_=>f.indexOf(_.presence_ref)<0),v=h.filter(_=>d.indexOf(_.presence_ref)<0);p.length>0&&(a[l]=p),v.length>0&&(u[l]=v)}else a[l]=c}),this.syncDiff(i,{joins:a,leaves:u},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,u)=>{var l;const c=(l=e[a])!==null&&l!==void 0?l:[];if(e[a]=this.cloneDeep(u),c.length>0){const h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,c,u)}),this.map(o,(a,u)=>{let l=e[a];if(!l)return;const c=u.map(h=>h.presence_ref);l=l.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=l,n(a,l,u),l.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ai;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ai||(Ai={}));var Pi;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Pi||(Pi={}));var ge;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ge||(ge={}));class cn{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new rs(this,de.join,this.params,this.timeout),this.rejoinTimer=new na(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Wt(this),this.broadcastEndpointURL=oa(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==W.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(c=>e?.(ge.CHANNEL_ERROR,c)),this._onClose(()=>e?.(ge.CLOSED));const u={},l={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(c=>c.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e?.(ge.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,p=[];for(let v=0;v<f;v++){const _=d[v],{filter:{event:E,schema:b,table:g,filter:w}}=_,$=c&&c[v];if($&&$.event===E&&$.schema===b&&$.table===g&&$.filter===w)p.push(Object.assign(Object.assign({},_),{id:$.id}));else{this.unsubscribe(),this.state=W.errored,e?.(ge.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(ge.SUBSCRIBED);return}}).receive("error",c=>{this.state=W.errored,e?.(ge.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e?.(ge.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,u;const l=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=W.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new rs(this,de.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new rs(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:u,leave:l,join:c}=de;if(s&&[a,u,l,c].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,v,_;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((_=(v=f.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,v,_,E,b,g;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,$=(p=f.filter)===null||p===void 0?void 0:p.event;return w&&((v=r.ids)===null||v===void 0?void 0:v.includes(w))&&($==="*"||$?.toLocaleLowerCase()===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(b=(E=f?.filter)===null||E===void 0?void 0:E.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return w==="*"||w===((g=r?.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:v,table:_,commit_timestamp:E,type:b,errors:g}=p;d=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:E,eventType:b,new:{},old:{},errors:g}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&cn.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Ti(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Ti(e.columns,e.old_record)),r}}const Oi=()=>{},Nc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Bc{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=sa,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Oi,this.ref=0,this.logger=Oi,this.conn=null,this.sendBuffer=[],this.serializer=new Cc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>sr(async()=>{const{default:u}=await Promise.resolve().then(()=>St);return{default:u}},void 0,import.meta.url).then(({default:u})=>u(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${js.websocket}`,this.httpEndpoint=oa(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new na(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=jc),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oc}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ft.connecting:return Ue.Connecting;case Ft.open:return Ue.Open;case Ft.closing:return Ue.Closing;default:return Ue.Closed}}isConnected(){return this.connectionState()===Ue.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new cn(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var u;(u=this.conn)===null||u===void 0||u.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:Pc};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(de.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(xc,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([Nc],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class hn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function L(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Mc extends hn{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ps extends hn{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Fc=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const aa=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>St);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Wc=()=>Fc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield sr(()=>Promise.resolve().then(()=>St),void 0,import.meta.url)).Response:Response}),Os=t=>{if(Array.isArray(t))return t.map(r=>Os(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Os(s)}),e};var Ge=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const ss=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Vc=(t,e,r)=>Ge(void 0,void 0,void 0,function*(){const s=yield Wc();t instanceof s&&!r?.noResolveJson?t.json().then(n=>{e(new Mc(ss(n),t.status||500))}).catch(n=>{e(new Ps(ss(n),n))}):e(new Ps(ss(t),t))}),Kc=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),r))};function nr(t,e,r,s,n,i){return Ge(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,Kc(e,s,n,i)).then(u=>{if(!u.ok)throw u;return s?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>Vc(u,a,s))})})}function Sr(t,e,r,s){return Ge(this,void 0,void 0,function*(){return nr(t,"GET",e,r,s)})}function ke(t,e,r,s,n){return Ge(this,void 0,void 0,function*(){return nr(t,"POST",e,s,n,r)})}function zc(t,e,r,s,n){return Ge(this,void 0,void 0,function*(){return nr(t,"PUT",e,s,n,r)})}function Gc(t,e,r,s){return Ge(this,void 0,void 0,function*(){return nr(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function ua(t,e,r,s,n){return Ge(this,void 0,void 0,function*(){return nr(t,"DELETE",e,s,n,r)})}var J=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const Hc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xi={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Jc{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=aa(n)}uploadOrUpdate(e,r,s,n){return J(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},xi),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,u&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:l,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(L(i))return{data:null,error:i};throw i}})}upload(e,r,s){return J(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return J(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let u;const l=Object.assign({upsert:xi.upsert},n),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&s instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",s)):typeof FormData<"u"&&s instanceof FormData?(u=s,u.append("cacheControl",l.cacheControl)):(u=s,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:u,headers:c}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(u){if(L(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,r){return J(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield ke(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new hn("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}update(e,r,s){return J(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return J(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}copy(e,r,s){return J(this,void 0,void 0,function*(){try{return{data:{path:(yield ke(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return J(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield ke(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return J(this,void 0,void 0,function*(){try{const n=yield ke(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}download(e,r){return J(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Sr(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(L(a))return{data:null,error:a};throw a}})}info(e){return J(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield Sr(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Os(s),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}exists(e){return J(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Gc(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(L(s)&&s instanceof Ps){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof r?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(r?.transform||{});u!==""&&n.push(u);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${l}`)}}}remove(e){return J(this,void 0,void 0,function*(){try{return{data:yield ua(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}list(e,r,s){return J(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Hc),r),{prefix:e||""});return{data:yield ke(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Qc="2.7.1",Yc={"X-Client-Info":`storage-js/${Qc}`};var st=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class Xc{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},Yc),r),this.fetch=aa(s)}listBuckets(){return st(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(L(e))return{data:null,error:e};throw e}})}getBucket(e){return st(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return st(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return st(this,void 0,void 0,function*(){try{return{data:yield zc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}emptyBucket(e){return st(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}deleteBucket(e){return st(this,void 0,void 0,function*(){try{return{data:yield ua(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}}class Zc extends Xc{constructor(e,r={},s){super(e,r,s)}from(e){return new Jc(this.url,this.headers,e,this.fetch)}}const eh="2.51.0";let Ut="";typeof Deno<"u"?Ut="deno":typeof document<"u"?Ut="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ut="react-native":Ut="node";const th={"X-Client-Info":`supabase-js-${Ut}/${eh}`},rh={headers:th},sh={schema:"public"},nh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ih={};var oh=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const ah=t=>{let e;return t?e=t:typeof fetch>"u"?e=Yo:e=fetch,(...r)=>e(...r)},uh=()=>typeof Headers>"u"?Xo:Headers,lh=(t,e,r)=>{const s=ah(r),n=uh();return(i,o)=>oh(void 0,void 0,void 0,function*(){var a;const u=(a=yield e())!==null&&a!==void 0?a:t;let l=new n(o?.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),s(i,Object.assign(Object.assign({},o),{headers:l}))})};var ch=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};function hh(t){return t.endsWith("/")?t:t+"/"}function dh(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:u,auth:l,realtime:c,global:h}=e,d={db:Object.assign(Object.assign({},u),n),auth:Object.assign(Object.assign({},l),i),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(s=a?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>ch(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const la="2.71.0",ut=30*1e3,xs=3,ns=xs*ut,fh="http://localhost:9999",ph="supabase.auth.token",_h={"X-Client-Info":`gotrue-js/${la}`},Cs="X-Supabase-Api-Version",ca={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,vh=10*60*1e3;class dn extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function m(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class yh extends dn{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function wh(t){return m(t)&&t.name==="AuthApiError"}class ha extends dn{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Oe extends dn{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class me extends Oe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bh(t){return m(t)&&t.name==="AuthSessionMissingError"}class pr extends Oe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _r extends Oe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class gr extends Oe{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function mh(t){return m(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ci extends Oe{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Is extends Oe{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function is(t){return m(t)&&t.name==="AuthRetryableFetchError"}class Ii extends Oe{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Rs extends Oe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ri=` 	
\r=`.split(""),kh=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ri.length;e+=1)t[Ri[e].charCodeAt(0)]=-2;for(let e=0;e<$r.length;e+=1)t[$r[e].charCodeAt(0)]=e;return t})();function Li(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r($r[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r($r[s]),e.queuedBits-=6}}function da(t,e,r){const s=kh[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Ui(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{$h(o,s,r)};for(let o=0;o<t.length;o+=1)da(t.charCodeAt(o),n,i);return e.join("")}function Eh(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Sh(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Eh(s,e)}}function $h(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Th(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)da(t.charCodeAt(n),r,s);return new Uint8Array(e)}function jh(t){const e=[];return Sh(t,r=>e.push(r)),new Uint8Array(e)}function Ah(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>Li(n,r,s)),Li(null,r,s),e.join("")}function Ph(t){return Math.round(Date.now()/1e3)+t}function Oh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ce=()=>typeof window<"u"&&typeof document<"u",Ie={tested:!1,writable:!1},fa=()=>{if(!ce())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ie.tested)return Ie.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ie.tested=!0,Ie.writable=!0}catch{Ie.tested=!0,Ie.writable=!1}return Ie.writable};function xh(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const pa=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sr(async()=>{const{default:s}=await Promise.resolve().then(()=>St);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Ch=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",lt=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Re=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},be=async(t,e)=>{await t.removeItem(e)};class Rr{constructor(){this.promise=new Rr.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Rr.promiseConstructor=Promise;function os(t){const e=t.split(".");if(e.length!==3)throw new Rs("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!gh.test(e[s]))throw new Rs("JWT not in base64url format");return{header:JSON.parse(Ui(e[0])),payload:JSON.parse(Ui(e[1])),signature:Th(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ih(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Rh(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function Lh(t){return("0"+t.toString(16)).substr(-2)}function Uh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Lh).join("")}async function Dh(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function qh(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Dh(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function nt(t,e,r=!1){const s=Uh();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await lt(t,`${e}-code-verifier`,n);const i=await qh(s);return[i,s===i?"plain":"s256"]}const Nh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Bh(t){const e=t.headers.get(Cs);if(!e||!e.match(Nh))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Mh(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Fh(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Wh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function it(t){if(!Wh.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function as(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var Vh=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Le=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Kh=[502,503,504];async function Di(t){var e;if(!Ch(t))throw new Is(Le(t),0);if(Kh.includes(t.status))throw new Is(Le(t),t.status);let r;try{r=await t.json()}catch(i){throw new ha(Le(i),i)}let s;const n=Bh(t);if(n&&n.getTime()>=ca["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Ii(Le(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new me}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ii(Le(r),t.status,r.weak_password.reasons);throw new yh(Le(r),t.status||500,s)}const zh=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function k(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[Cs]||(i[Cs]=ca["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await Gh(t,e,r+a,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(u):{data:Object.assign({},u),error:null}}async function Gh(t,e,r,s,n,i){const o=zh(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(u){throw console.error(u),new Is(Le(u),0)}if(a.ok||await Di(a),s?.noResolveJson)return a;try{return await a.json()}catch(u){await Di(u)}}function pe(t){var e;let r=null;Yh(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Ph(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function qi(t){const e=pe(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ee(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Hh(t){return{data:t,error:null}}function Jh(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Vh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},u=Object.assign({},o);return{data:{properties:a,user:u},error:null}}function Qh(t){return t}function Yh(t){return t.access_token&&t.refresh_token&&t.expires_in}const us=["global","local","others"];var Xh=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class Zh{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=pa(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=us[0]){if(us.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${us.join(", ")}`);try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(m(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ee})}catch(s){if(m(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Xh(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Jh,redirectTo:r?.redirectTo})}catch(r){if(m(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ee})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,u;try{const l={nextPage:null,lastPage:0,total:0},c=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Qh});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(u=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(p=>{const v=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(p.split(";")[1].split("=")[1]);l[`${_}Page`]=v}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(m(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){it(e);try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ee})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){it(e);try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ee})}catch(s){if(m(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){it(e);try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ee})}catch(s){if(m(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){it(e.userId);try{const{data:r,error:s}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(m(r))return{data:null,error:r};throw r}}async _deleteFactor(e){it(e.userId),it(e.id);try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(m(r))return{data:null,error:r};throw r}}}function Ni(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function ed(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ot={debug:!!(globalThis&&fa()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _a extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class td extends _a{}async function rd(t,e,r){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ot.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new td(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ot.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}ed();const sd={url:fh,storageKey:ph,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_h,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bi(t,e,r){return await r()}const at={};class Jt{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jt.nextInstanceID,Jt.nextInstanceID+=1,this.instanceID>0&&ce()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},sd),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Zh({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=pa(n.fetch),this.lock=n.lock||Bi,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ce()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=rd:this.lock=Bi,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:fa()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ni(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ni(this.memoryStorage)),ce()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=at[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){at[this.storageKey]=Object.assign(Object.assign({},at[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=at[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){at[this.storageKey]=Object.assign(Object.assign({},at[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${la}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=xh(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),ce()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),mh(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return m(r)?{error:r}:{error:new ha("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:pe}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(m(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await nt(this.storage,this.storageKey)),i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:c,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:p},xform:pe})}else if("phone"in e){const{phone:c,password:h,options:d}=e;i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:pe})}else throw new _r("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(m(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:qi})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:qi})}else throw new _r("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new pr}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,u,l,c,h,d,f;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:_,wallet:E,statement:b,options:g}=e;let w;if(ce())if(typeof E=="object")w=E;else{const y=window;if("solana"in y&&typeof y.solana=="object"&&("signIn"in y.solana&&typeof y.solana.signIn=="function"||"signMessage"in y.solana&&typeof y.solana.signMessage=="function"))w=y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!g?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=E}const $=new URL((r=g?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const y=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g?.signInWithSolana),{version:"1",domain:$.host,uri:$.href}),b?{statement:b}:null));let I;if(Array.isArray(y)&&y[0]&&typeof y[0]=="object")I=y[0];else if(y&&typeof y=="object"&&"signedMessage"in y&&"signature"in y)I=y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)p=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),v=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${$.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${$.href}`,`Issued At: ${(n=(s=g?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=g?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((o=g?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((a=g?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((u=g?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((l=g?.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(c=g?.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const y=await w.signMessage(new TextEncoder().encode(p),"utf8");if(!y||!(y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=y}}try{const{data:_,error:E}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Ah(v)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:pe});if(E)throw E;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new pr}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:E})}catch(_){if(m(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const r=await Re(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:pe});if(await be(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new pr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(m(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:pe}),{data:u,error:l}=a;return l?{data:{user:null,session:null},error:l}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new pr}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:l})}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:u}=e;let l=null,c=null;this.flowType==="pkce"&&([l,c]=await nt(this.storage,this.storageKey));const{error:h}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(s=u?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:l,code_challenge_method:c},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:u}=e,{data:l,error:c}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=u?.data)!==null&&n!==void 0?n:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new _r("You must provide either an email or phone number.")}catch(a){if(m(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:pe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,l=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(n){if(m(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await nt(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Hh})}catch(i){if(m(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new me;const{error:n}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(m(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await k(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await k(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new _r("You must provide either an email or phone number and a type")}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Re(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ns:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Re(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=as()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,l,c)=>(!o&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,l,c))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ee}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new me}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ee})})}catch(r){if(m(r))return bh(r)&&(await this._removeSession(),await be(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new me;const o=n.session;let a=null,u=null;this.flowType==="pkce"&&e.email!=null&&([a,u]=await nt(this.storage,this.storageKey));const{data:l,error:c}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:u}),jwt:o.access_token,xform:Ee});if(c)throw c;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(m(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new me;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=os(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(m(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new me;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!ce())throw new gr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new gr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ci("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gr("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ci("No code detected.");const{data:b,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:u,token_type:l}=e;if(!i||!a||!o||!l)throw new gr("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;u&&(d=parseInt(u));const f=d-c;f*1e3<=ut&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,c);const{data:v,error:_}=await this._getUser(i);if(_)throw _;const E={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:l,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:e.type},error:null}}catch(s){if(m(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Re(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(wh(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await be(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Oh(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await nt(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(m(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(m(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,u,l,c;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(l=h.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0})});if(n)throw n;return ce()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(m(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(m(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Rh(async n=>(n>0&&await Ih(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pe})),(n,i)=>{const o=200*Math.pow(2,n);return i&&is(i)&&Date.now()+o-s<ut})}catch(s){if(this._debug(r,"error",s),m(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),ce()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Re(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Re(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await lt(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:as()}else if(n&&!n.user&&!n.user){const o=await Re(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await be(this.storage,this.storageKey+"-user"),await lt(this.storage,this.storageKey,n)):n.user=as()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ns;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${ns}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),is(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new me;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Rr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new me;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),m(i)){const o={session:null,error:i};return is(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await lt(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=structuredClone(n);await lt(this.storage,this.storageKey,i)}else{const n=structuredClone(r);await lt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await be(this.storage,this.storageKey),await be(this.storage,this.storageKey+"-code-verifier"),await be(this.storage,this.storageKey+"-user"),this.userStorage&&await be(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ce()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ut);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/ut);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ut}ms, refresh threshold is ${xs} ticks`),n<=xs&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof _a)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ce()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await nt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(m(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:l}=await k(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(e.factorType==="totp"&&(!((n=u?.totp)===null||n===void 0)&&n.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(m(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(m(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(m(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=e?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=os(n.access_token);let a=null;o.aal&&(a=o.aal);let u=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(u="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+vh>n)return s;const{data:i,error:o}=await k(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};s=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:u}}=os(s);r?.allowExpired||Mh(i.exp);const l=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!l){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const c=Fh(n.alg),h=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,jh(`${a}.${u}`)))throw new Rs("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(m(s))return{data:null,error:s};throw s}}}Jt.nextInstanceID=0;const nd=Jt;class id extends nd{constructor(e){super(e)}}var od=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class ad{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=hh(e),u=new URL(a);this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const l=`sb-${u.hostname.split(".")[0]}-auth-token`,c={db:sh,realtime:ih,auth:Object.assign(Object.assign({},nh),{storageKey:l}),global:rh},h=dh(s??{},c);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=lh(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new $c(new URL("rest/v1",u).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new hc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Zc(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return od(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:u},l,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new id({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),l),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:u,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Bc(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ud=(t,e,r)=>new ad(t,e,r),ld="https://vycjpmuyscfygstjjied.supabase.co",cd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",gt=ud(ld,cd,{auth:{persistSession:!0,autoRefreshToken:!0}}),Ls=nc({user:null,bucketName:null,isLoading:!0,error:null});gt.auth.getSession().then(({data:{session:t}})=>{Ls.update(e=>({...e,user:t?.user??null,isLoading:!1}))});gt.auth.onAuthStateChange((t,e)=>{t==="SIGNED_IN"||t==="TOKEN_REFRESHED"?Ls.update(r=>({...r,user:e.user,isLoading:!1})):t==="SIGNED_OUT"&&Ls.set({user:null,bucketName:null,isLoading:!1,error:null})});async function hd(t,e,r){try{const s=e.initData,{data:n,error:i}=await gt.functions.invoke("tma-auth",{body:{initData:s}});if(i)throw i;const{error:o}=await gt.auth.setSession({access_token:n.access_token,refresh_token:n.refresh_token});if(o)throw o;r(n.user)}catch(s){console.error("Auth error:",s),e.showPopup({title:"Ошибка",message:"Не удалось войти"})}}var dd=Ho('<div class="container"><h1>Мое TMA Приложение</h1> <div id="user-data"></div> <div id="auth-section" style="display:none;"><button class="button">Войти через Telegram</button></div> <div id="content" style="display:none;"><h2>Добро пожаловать!</h2> <p>Вы успешно аутентифицированы</p></div></div>');function fd(t,e){en(e,!1);const r=window.Telegram.WebApp;r.expand(),r.enableClosingConfirmation();async function s(){const{data:{session:l},error:c}=await gt.auth.getSession();if(l&&l.user)n(l.user);else{document.getElementById("auth-section").style.display="block";const h=r.initDataUnsafe?.user;h&&(document.getElementById("user-data").innerHTML=`
                        <p>Привет, ${h.first_name}!</p>
                        <p>@${h.username}</p>
                    `)}}function n(l){document.getElementById("auth-section").style.display="none",document.getElementById("content").style.display="block",i()}async function i(){const{data:l,error:c}=await gt.from("protected_data").select("*");c||console.log("Protected data:",l)}r.ready(),s(),Qo();var o=dd(),a=Uo(Es(o),4),u=Es(a);u.__click=[hd,r,n],Jo(t,o),tn()}Xl(["click"]);var pd=Ho("<p> </p> <!>",1);function _d(t,e){en(e,!1);let r=Ol(null);const s=new URLSearchParams(window.location.search);_e(r,s.get("id")),Qo();var n=pd(),i=Il(n),o=Es(i),a=Uo(i,2);fd(a,{}),ql(()=>ec(o,`User ID: ${$e(r)??""}`)),Jo(t,n),tn()}var ls;function ga(t){return{lang:t?.lang??ls?.lang,message:t?.message,abortEarly:t?.abortEarly??ls?.abortEarly,abortPipeEarly:t?.abortPipeEarly??ls?.abortPipeEarly}}var gd;function vd(t){return gd?.get(t)}var yd;function wd(t){return yd?.get(t)}var bd;function md(t,e){return bd?.get(t)?.get(e)}function kd(t){const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&Object.getPrototypeOf(t)?.constructor?.name)??"null":e}function re(t,e,r,s,n){const i=n&&"input"in n?n.input:r.value,o=n?.expected??t.expects??null,a=n?.received??kd(i),u={kind:t.kind,type:t.type,input:i,expected:o,received:a,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${a}`,requirement:t.requirement,path:n?.path,issues:n?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},l=t.kind==="schema",c=n?.message??t.message??md(t.reference,u.lang)??(l?wd(u.lang):null)??s.message??vd(u.lang);c!==void 0&&(u.message=typeof c=="function"?c(u):c),l&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function H(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},ga())}}}function va(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Ed(t,e){const r=[...new Set(t)];return r.length>1?`(${r.join(` ${e} `)})`:r[0]??"never"}var Us=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function ya(t){return{kind:"transformation",type:"transform",reference:ya,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function Sd(t,e,r){return typeof t.fallback=="function"?t.fallback(e,r):t.fallback}function fn(t,e,r){return typeof t.default=="function"?t.default(e,r):t.default}function pn(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function wa(){return{kind:"schema",type:"any",reference:wa,expects:"any",async:!1,get"~standard"(){return H(this)},"~run"(t){return t.typed=!0,t}}}function ba(t,e){return{kind:"schema",type:"array",reference:ba,expects:"Array",async:!1,item:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){const n=r.value;if(Array.isArray(n)){r.typed=!0,r.value=[];for(let i=0;i<n.length;i++){const o=n[i],a=this.item["~run"]({value:o},s);if(a.issues){const u={type:"array",origin:"value",input:n,key:i,value:o};for(const l of a.issues)l.path?l.path.unshift(u):l.path=[u],r.issues?.push(l);if(r.issues||(r.issues=a.issues),s.abortEarly){r.typed=!1;break}}a.typed||(r.typed=!1),r.value.push(a.value)}}else re(this,"type",r,s);return r}}}function Ds(t){return{kind:"schema",type:"boolean",reference:Ds,expects:"boolean",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="boolean"?e.typed=!0:re(this,"type",e,r),e}}}function ma(t){return{kind:"schema",type:"date",reference:ma,expects:"Date",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return e.value instanceof Date?isNaN(e.value)?re(this,"type",e,r,{received:'"Invalid Date"'}):e.typed=!0:re(this,"type",e,r),e}}}function _n(t){return{kind:"schema",type:"function",reference:_n,expects:"Function",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="function"?e.typed=!0:re(this,"type",e,r),e}}}function ka(t,e){return{kind:"schema",type:"instance",reference:ka,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){return r.value instanceof this.class?r.typed=!0:re(this,"type",r,s),r}}}function Z(t,e){return{kind:"schema",type:"loose_object",reference:Z,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){const n=r.value;if(n&&typeof n=="object"){r.typed=!0,r.value={};for(const i in this.entries){const o=this.entries[i];if(i in n||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const a=i in n?n[i]:fn(o),u=o["~run"]({value:a},s);if(u.issues){const l={type:"object",origin:"value",input:n,key:i,value:a};for(const c of u.issues)c.path?c.path.unshift(l):c.path=[l],r.issues?.push(c);if(r.issues||(r.issues=u.issues),s.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value[i]=u.value}else if(o.fallback!==void 0)r.value[i]=Sd(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(re(this,"key",r,s,{input:void 0,expected:`"${i}"`,path:[{type:"object",origin:"key",input:n,key:i,value:n[i]}]}),s.abortEarly))break}if(!r.issues||!s.abortEarly)for(const i in n)va(n,i)&&!(i in this.entries)&&(r.value[i]=n[i])}else re(this,"type",r,s);return r}}}function Dt(t,e){return{kind:"schema",type:"nullish",reference:Dt,expects:`(${t.expects} | null | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return H(this)},"~run"(r,s){return(r.value===null||r.value===void 0)&&(this.default!==void 0&&(r.value=fn(this,r,s)),r.value===null||r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function Tr(t){return{kind:"schema",type:"number",reference:Tr,expects:"number",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:re(this,"type",e,r),e}}}function jr(t,e){return{kind:"schema",type:"optional",reference:jr,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return H(this)},"~run"(r,s){return r.value===void 0&&(this.default!==void 0&&(r.value=fn(this,r,s)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function Ea(t,e,r){return{kind:"schema",type:"record",reference:Ea,expects:"Object",async:!1,key:t,value:e,message:r,get"~standard"(){return H(this)},"~run"(s,n){const i=s.value;if(i&&typeof i=="object"){s.typed=!0,s.value={};for(const o in i)if(va(i,o)){const a=i[o],u=this.key["~run"]({value:o},n);if(u.issues){const c={type:"object",origin:"key",input:i,key:o,value:a};for(const h of u.issues)h.path=[c],s.issues?.push(h);if(s.issues||(s.issues=u.issues),n.abortEarly){s.typed=!1;break}}const l=this.value["~run"]({value:a},n);if(l.issues){const c={type:"object",origin:"value",input:i,key:o,value:a};for(const h of l.issues)h.path?h.path.unshift(c):h.path=[c],s.issues?.push(h);if(s.issues||(s.issues=l.issues),n.abortEarly){s.typed=!1;break}}(!u.typed||!l.typed)&&(s.typed=!1),u.typed&&(s.value[u.value]=l.value)}}else re(this,"type",s,n);return s}}}function U(t){return{kind:"schema",type:"string",reference:U,expects:"string",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="string"?e.typed=!0:re(this,"type",e,r),e}}}function Mi(t){let e;if(t)for(const r of t)e?e.push(...r.issues):e=r.issues;return e}function Sa(t,e){return{kind:"schema",type:"union",reference:Sa,expects:Ed(t.map(r=>r.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){let n,i,o;for(const a of this.options){const u=a["~run"]({value:r.value},s);if(u.typed)if(u.issues)i?i.push(u):i=[u];else{n=u;break}else o?o.push(u):o=[u]}if(n)return n;if(i){if(i.length===1)return i[0];re(this,"type",r,s,{issues:Mi(i)}),r.typed=!0}else{if(o?.length===1)return o[0];re(this,"type",r,s,{issues:Mi(o)})}return r}}}function $a(){return{kind:"schema",type:"unknown",reference:$a,expects:"unknown",async:!1,get"~standard"(){return H(this)},"~run"(t){return t.typed=!0,t}}}function vt(t,e,r){const s=t["~run"]({value:e},ga(r));if(s.issues)throw new Us(s.issues);return s.value}function vr(...t){return{...t[0],pipe:t,get"~standard"(){return H(this)},"~run"(e,r){for(const s of t)if(s.kind!=="metadata"){if(e.issues&&(s.kind==="schema"||s.kind==="transformation")){e.typed=!1;break}(!e.issues||!r.abortEarly&&!r.abortPipeEarly)&&(e=s["~run"](e,r))}return e}}}var $d=Object.defineProperty,Td=(t,e,r)=>e in t?$d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qs=(t,e,r)=>Td(t,typeof e!="symbol"?e+"":e,r),jd=Object.defineProperty,Ad=(t,e,r)=>e in t?jd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pd=(t,e,r)=>Ad(t,e+"",r);function Od(t,e){return r=>r instanceof t&&r.type===e}function Ta(t,e){e||(e=[]);const r=Symbol(t);class s extends Error{constructor(...i){const o=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...o),Pd(this,"type",r),this.name=t}}return Object.defineProperty(s,"name",{value:t}),[s,Od(s,r)]}const[xd,Cd]=Ta("CancelledError","Promise was canceled"),[Id,ng]=Ta("TimeoutError",(t,e)=>[`Timeout reached: ${t}ms`,{cause:e}]),ja=Symbol("Resolved");function Fi(t){return Array.isArray(t)&&t[0]===ja}function Rd(t){return[ja,t]}function Wi(t,e){return t.reject=e.reject,t.abort=e.abort,t}let q=class Ns extends Promise{constructor(e,r){let s,n;super((i,o)=>{let a,u;typeof e=="function"?(a=e,u=r):u=e;const l=[],c=y=>(...I)=>{const cr=y(...I);return l.forEach(Xu=>Xu()),cr},h=new AbortController,{signal:d}=h;n=y=>{!d.aborted&&h.abort(y)};const f=()=>d.reason,p=y=>{const I=()=>{y(f())};d.addEventListener("abort",I,!0);const cr=()=>{d.removeEventListener("abort",I,!0)};return l.push(cr),cr},v=c(y=>{i(y),n(Rd(y))});s=c(y=>{o(y),n(y)}),u||(u={});const{abortSignal:_,rejectOnAbort:E=!0}=u;if(_)if(_.aborted){const{reason:y}=_;if(E)return s(y);n(y)}else{const y=()=>{n(_.reason)};_.addEventListener("abort",y),l.push(()=>{_.removeEventListener("abort",y)})}E&&p(o);const{timeout:b}=u;if(b){const y=setTimeout(()=>{n(new Id(b))},b);l.push(()=>{clearTimeout(y)})}const g=()=>d.aborted,w=()=>Fi(f()),$=()=>{const y=f();return Fi(y)?y[1]:void 0};try{const y=a&&a(v,s,{abortReason:f,abortSignal:d,isAborted:g,isResolved:w,onAborted:p,onResolved:I=>p(()=>{w()&&I($())}),resolved:$,throwIfAborted(){if(g())throw f()}});y instanceof Promise&&y.catch(s)}catch(y){s(y)}}),qs(this,"abort"),qs(this,"reject"),this.abort=n,this.reject=s}static fn(e,r){return new Ns(async(s,n,i)=>{try{s(await e(i))}catch(o){n(o)}},r)}static resolve(e){return this.fn(()=>e)}static reject(e){return new Ns((r,s)=>{s(e)})}cancel(){this.abort(new xd)}catch(e){return this.then(void 0,e)}finally(e){return Wi(super.finally(e),this)}then(e,r){return Wi(super.then(e,r),this)}};function Vi(t,e){return t.resolve=e.resolve,t}let Ld=class Bs extends q{constructor(e,r){let s,n;typeof e=="function"?(s=e,n=r):n=e;let i;super((o,a,u)=>{i=o,s&&s(o,a,u)},n),qs(this,"resolve"),this.resolve=i}static fn(e,r){return new Bs((s,n,i)=>{try{Promise.resolve(e(i)).then(s,n)}catch(o){n(o)}},r)}static resolve(e){return this.fn(()=>e)}static reject(e){return new Bs((r,s)=>{s(e)})}catch(e){return this.then(void 0,e)}finally(e){return Vi(super.finally(e),this)}then(e,r){return Vi(super.then(e,r),this)}};function Aa(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function Ud(t){return t.replace(/_([a-z])/g,(e,r)=>`-${r.toLowerCase()}`)}function Pa(t){return`tapps/${t}`}function ue(t,e){sessionStorage.setItem(Pa(t),JSON.stringify(e))}function Q(t){const e=sessionStorage.getItem(Pa(t));try{return e?JSON.parse(e):void 0}catch{}}function Lr(...t){const e=t.flat(1);return[e.push.bind(e),()=>{e.forEach(r=>{r()})}]}function Oa(t,e){e||(e={});const{textColor:r,bgColor:s,shouldLog:n}=e,i=n===void 0?!0:n,o=typeof i=="boolean"?()=>i:i,a=(u,l,...c)=>{if(l||o()){const h="font-weight:bold;padding:0 5px;border-radius:100px",[d,f,p]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[u];console[u](`%c${p} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${t}`,`${h};background-color:${d};color:${f}`,"",`${h};${r?`color:${r};`:""}${s?`background-color:${s}`:""}`,...c)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((u,[l,c])=>(u[l]=a.bind(void 0,l,!1),u[c]=a.bind(void 0,l,!0),u),{})}function xa(t){return{lang:t?.lang??void 0,message:t?.message,abortEarly:t?.abortEarly??void 0,abortPipeEarly:t?.abortPipeEarly??void 0}}function Dd(t,e){var r;return(r=void 0)==null?void 0:r.get(e)}function qd(t){var e,r;const s=typeof t;return s==="string"?`"${t}"`:s==="number"||s==="bigint"||s==="boolean"?`${t}`:s==="object"||s==="function"?(t&&((r=(e=Object.getPrototypeOf(t))==null?void 0:e.constructor)==null?void 0:r.name))??"null":s}function se(t,e,r,s,n){const i=n&&"input"in n?n.input:r.value,o=n?.expected??t.expects??null,a=n?.received??qd(i),u={kind:t.kind,type:t.type,input:i,expected:o,received:a,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${a}`,requirement:t.requirement,path:n?.path,issues:n?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},l=t.kind==="schema",c=n?.message??t.message??Dd(t.reference,u.lang)??(l?(u.lang,void 0):null)??s.message??(u.lang,void 0);c&&(u.message=typeof c=="function"?c(u):c),l&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function le(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},xa())}}}function Ca(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Nd(t,e){const r=[...new Set(t)];return r.length>1?`(${r.join(` ${e} `)})`:r[0]??"never"}var Bd=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function Ia(t,e){return{kind:"validation",type:"check",reference:Ia,async:!1,expects:null,requirement:t,message:e,"~run"(r,s){return r.typed&&!this.requirement(r.value)&&se(this,"input",r,s),r}}}function Ra(t){return{kind:"validation",type:"integer",reference:Ra,async:!1,expects:null,requirement:Number.isInteger,message:t,"~run"(e,r){return e.typed&&!this.requirement(e.value)&&se(this,"integer",e,r),e}}}function je(t){return{kind:"transformation",type:"transform",reference:je,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function La(t,e,r){return typeof t.default=="function"?t.default(e,r):t.default}function Md(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function qt(t){return{kind:"schema",type:"boolean",reference:qt,expects:"boolean",async:!1,message:t,get"~standard"(){return le(this)},"~run"(e,r){return typeof e.value=="boolean"?e.typed=!0:se(this,"type",e,r),e}}}function Ua(t){return{kind:"schema",type:"date",reference:Ua,expects:"Date",async:!1,message:t,get"~standard"(){return le(this)},"~run"(e,r){return e.value instanceof Date?isNaN(e.value)?se(this,"type",e,r,{received:'"Invalid Date"'}):e.typed=!0:se(this,"type",e,r),e}}}function Da(t,e){return{kind:"schema",type:"instance",reference:Da,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return le(this)},"~run"(r,s){return r.value instanceof this.class?r.typed=!0:se(this,"type",r,s),r}}}function gn(t){return{kind:"schema",type:"lazy",reference:gn,expects:"unknown",async:!1,getter:t,get"~standard"(){return le(this)},"~run"(e,r){return this.getter(e.value)["~run"](e,r)}}}function $t(t,e){return{kind:"schema",type:"loose_object",reference:$t,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return le(this)},"~run"(r,s){var n;const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const o in this.entries){const a=this.entries[o];if(o in i||(a.type==="exact_optional"||a.type==="optional"||a.type==="nullish")&&a.default!==void 0){const u=o in i?i[o]:La(a),l=a["~run"]({value:u},s);if(l.issues){const c={type:"object",origin:"value",input:i,key:o,value:u};for(const h of l.issues)h.path?h.path.unshift(c):h.path=[c],(n=r.issues)==null||n.push(h);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}l.typed||(r.typed=!1),r.value[o]=l.value}else if(a.type!=="exact_optional"&&a.type!=="optional"&&a.type!=="nullish"&&(se(this,"key",r,s,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:i,key:o,value:i[o]}]}),s.abortEarly))break}if(!r.issues||!s.abortEarly)for(const o in i)Ca(i,o)&&!(o in this.entries)&&(r.value[o]=i[o])}else se(this,"type",r,s);return r}}}function Ur(t){return{kind:"schema",type:"number",reference:Ur,expects:"number",async:!1,message:t,get"~standard"(){return le(this)},"~run"(e,r){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:se(this,"type",e,r),e}}}function x(t,e){return{kind:"schema",type:"optional",reference:x,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return le(this)},"~run"(r,s){return r.value===void 0&&(this.default!==void 0&&(r.value=La(this,r,s)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function qa(t,e,r){return{kind:"schema",type:"record",reference:qa,expects:"Object",async:!1,key:t,value:e,message:r,get"~standard"(){return le(this)},"~run"(s,n){var i,o;const a=s.value;if(a&&typeof a=="object"){s.typed=!0,s.value={};for(const u in a)if(Ca(a,u)){const l=a[u],c=this.key["~run"]({value:u},n);if(c.issues){const d={type:"object",origin:"key",input:a,key:u,value:l};for(const f of c.issues)f.path=[d],(i=s.issues)==null||i.push(f);if(s.issues||(s.issues=c.issues),n.abortEarly){s.typed=!1;break}}const h=this.value["~run"]({value:l},n);if(h.issues){const d={type:"object",origin:"value",input:a,key:u,value:l};for(const f of h.issues)f.path?f.path.unshift(d):f.path=[d],(o=s.issues)==null||o.push(f);if(s.issues||(s.issues=h.issues),n.abortEarly){s.typed=!1;break}}(!c.typed||!h.typed)&&(s.typed=!1),c.typed&&(s.value[c.value]=h.value)}}else se(this,"type",s,n);return s}}}function A(t){return{kind:"schema",type:"string",reference:A,expects:"string",async:!1,message:t,get"~standard"(){return le(this)},"~run"(e,r){return typeof e.value=="string"?e.typed=!0:se(this,"type",e,r),e}}}function Ki(t){let e;if(t)for(const r of t)e?e.push(...r.issues):e=r.issues;return e}function vn(t,e){return{kind:"schema",type:"union",reference:vn,expects:Nd(t.map(r=>r.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return le(this)},"~run"(r,s){let n,i,o;for(const a of this.options){const u=a["~run"]({value:r.value},s);if(u.typed)if(u.issues)i?i.push(u):i=[u];else{n=u;break}else o?o.push(u):o=[u]}if(n)return n;if(i){if(i.length===1)return i[0];se(this,"type",r,s,{issues:Ki(i)}),r.typed=!0}else{if(o?.length===1)return o[0];se(this,"type",r,s,{issues:Ki(o)})}return r}}}function Na(){return{kind:"schema",type:"unknown",reference:Na,expects:"unknown",async:!1,get"~standard"(){return le(this)},"~run"(t){return t.typed=!0,t}}}function Ba(t,e,r){const s=t["~run"]({value:e},xa(r));if(s.issues)throw new Bd(s.issues);return s.value}function Ae(...t){return{...t[0],pipe:t,get"~standard"(){return le(this)},"~run"(e,r){for(const s of t)if(s.kind!=="metadata"){if(e.issues&&(s.kind==="schema"||s.kind==="transformation")){e.typed=!1;break}(!e.issues||!r.abortEarly&&!r.abortPipeEarly)&&(e=s["~run"](e,r))}return e}}}function Fd(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function Wd(t){return Object.entries(t).reduce((e,[r,s])=>(e[Fd(r)]=s,e),{})}function Ms(t){const e=Wd(t);for(const r in e){const s=e[r];s&&typeof s=="object"&&!(s instanceof Date)&&(e[r]=Array.isArray(s)?s.map(Ms):Ms(s))}return e}function yn(t){return je(e=>t?Ms(e):e)}function Ma(t){return e=>Ae(t,yn(e))}function Vd(t){return(e,r)=>Ba(Ae(t,yn(r)),e)}function wn(){return je(JSON.parse)}function bn(t){const e=Ma(t);return r=>Ae(A(),wn(),e(r))}function Fa(t){return je(e=>{const r={};return new URLSearchParams(e).forEach((s,n)=>{const i=r[n];Array.isArray(i)?i.push(s):i===void 0?r[n]=s:r[n]=[i,s]}),Ba(t,r)})}function Wa(t){return e=>Ae(vn([A(),Da(URLSearchParams)]),Fa(t),yn(e))}const zi=x(gn(()=>Jd())),Kd=$t({id:Ur(),photo_url:x(A()),type:A(),title:A(),username:x(A())}),zd=$t({added_to_attachment_menu:x(qt()),allows_write_to_pm:x(qt()),first_name:A(),id:Ur(),is_bot:x(qt()),is_premium:x(qt()),last_name:x(A()),language_code:x(A()),photo_url:x(A()),username:x(A())}),Gd=$t({auth_date:Ae(A(),je(t=>new Date(Number(t)*1e3)),Ua()),can_send_after:x(Ae(A(),je(Number),Ra())),chat:x(gn(()=>Hd())),chat_type:x(A()),chat_instance:x(A()),hash:A(),query_id:x(A()),receiver:zi,start_param:x(A()),signature:A(),user:zi}),Hd=bn(Kd),Jd=bn(zd),Qd=Wa(Gd);function Tt(t){return/^#[\da-f]{6}$/i.test(t)}function Yd(t){return/^#[\da-f]{3}$/i.test(t)}function Xd(t){const e=t.replace(/\s/g,"").toLowerCase();if(Tt(e))return e;if(Yd(e)){let s="#";for(let n=0;n<3;n+=1)s+=e[1+n].repeat(2);return s}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((s,n)=>s+parseInt(n,10).toString(16).padStart(2,"0"),"#")}const Va=Ma(qa(A(),Ae(vn([A(),Ur()]),je(t=>typeof t=="number"?`#${(t&16777215).toString(16).padStart(6,"0")}`:t),Ia(Tt)))),cs=x(Ae(A(),je(t=>t==="1"))),Gi=bn(Va()),Zd=$t({tgWebAppBotInline:cs,tgWebAppData:x(Qd()),tgWebAppDefaultColors:x(Gi()),tgWebAppFullscreen:cs,tgWebAppPlatform:A(),tgWebAppShowSettings:cs,tgWebAppStartParam:x(A()),tgWebAppThemeParams:Gi(),tgWebAppVersion:A()}),Ka=Wa(Zd),za=Vd(Ka()),ef=$t({eventType:A(),eventData:x(Na())});function tf(t){try{return Md(Ka(),t)}catch{return!1}}function rf(t){return{all:t=t||new Map,on:function(e,r){var s=t.get(e);s?s.push(r):t.set(e,[r])},off:function(e,r){var s=t.get(e);s&&(r?s.splice(s.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var s=t.get(e);s&&s.slice().map(function(n){n(r)}),(s=t.get("*"))&&s.slice().map(function(n){n(e,r)})}}}let ct;function sf(t,e){ct&&ct.set(t,e)||e()}function Qt(t){if(ct)return t();ct=new Map;try{t()}finally{ct.forEach(e=>e()),ct=void 0}}function jt(t,e){e||(e={});const r=e.equals||Object.is;let s=[],n=t;const i=l=>{if(!r(n,l)){const c=n;n=l,sf(u,()=>{[...s].forEach(([h,d])=>{h(l,c),d&&a(h,!0)})})}};function o(l){const c=typeof l!="object"?{once:l}:l;return{once:c.once||!1,signal:c.signal||!1}}const a=(l,c)=>{const h=o(c),d=s.findIndex(([f,p])=>f===l&&p.once===h.once&&p.signal===h.signal);d>=0&&s.splice(d,1)},u=Object.assign(function(){return nf(u),n},{destroy(){s=[]},set:i,reset(){i(t)},sub(l,c){return s.push([l,o(c)]),()=>a(l,c)},unsub:a,unsubAll(){s=s.filter(l=>l[1].signal)}});return u}const Vt=[];function nf(t){Vt.length&&Vt[Vt.length-1].add(t)}function of(t,e){let r=new Set,s;function n(){return s||(s=jt(o(),e))}function i(){n().set(o())}function o(){r.forEach(l=>{l.unsub(i,{signal:!0})});const a=new Set;let u;Vt.push(a);try{u=t()}finally{Vt.pop()}return a.forEach(l=>{l.sub(i,{signal:!0})}),r=a,u}return Object.assign(function(){return n()()},{destroy(){n().destroy()},sub(...a){return n().sub(...a)},unsub(...a){n().unsub(...a)},unsubAll(...a){n().unsubAll(...a)}})}var af=Object.defineProperty,uf=(t,e,r)=>e in t?af(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fs=(t,e,r)=>uf(t,typeof e!="symbol"?e+"":e,r);function Ga(t,e){return r=>r instanceof t&&r.type===e}function B(t,e){e||(e=[]);const r=Symbol(t);class s extends Error{constructor(...i){const o=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...o),Fs(this,"type",r),this.name=t}}return Object.defineProperty(s,"name",{value:t}),[s,Ga(s,r)]}function lf(t,e,r){const s=Symbol(t);class n extends B(t,r)[0]{constructor(...o){super(...o),Fs(this,"data"),Fs(this,"type",s),this.data=e(...o)}}return Object.defineProperty(n,"name",{value:t}),[n,Ga(n,s)]}function Ha(t){return pn(Z({TelegramWebviewProxy:Z({postEvent:_n()})}),t)}function cf(){try{return window.self!==window.top}catch{return!0}}function hf(t,e){const r=new Map,s=rf(),n=(i,o,a)=>{a||(a=!1);const u=r.get(i)||new Map;r.set(i,u);const l=u.get(o)||[];u.set(o,l);const c=l.findIndex(h=>h[1]===a);if(c>=0&&(s.off(i,l[c][0]),l.splice(c,1),!l.length&&(u.delete(o),!u.size))){const h=r.size;r.delete(i),h&&!r.size&&e()}};return[function(i,o,a){!r.size&&t();const u=()=>{n(i,o,a)},l=(...d)=>{a&&u(),i==="*"?o(d):o(...d)};s.on(i,l);const c=r.get(i)||new Map;r.set(i,c);const h=c.get(o)||[];return c.set(o,h),h.push([l,a||!1]),u},n,s.emit,function(){const i=r.size;s.all.clear(),r.clear(),i&&e()}]}function hs(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}let df=!1;const Yt=jt(Oa("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return df}}));function Ja(t,e,r,s){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:r,set:s})}function Hi(t,e){const r=t[e];Ja(t,e,()=>r,s=>{Object.entries(s).forEach(([n,i])=>{r[n]=i})})}function Ji(t,e,r){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}function ds(t,e,r){const s=t[e],n=[r];typeof s=="function"&&n.push(s);const i=(...a)=>{n.forEach(u=>{u(...a)})},o=Object.assign((...a)=>{i(...a)},{unwrap(){const{length:a}=n;if(a===1){delete t[e];return}if(a===2){Ji(t,e,n[1]);return}n.unshift(1),Ji(t,e,i)}});Ja(t,e,()=>o,a=>{n.push(a)})}const ff={clipboard_text_received:Z({req_id:U(),data:Dt(U())}),custom_method_invoked:Z({req_id:U(),result:jr($a()),error:jr(U())}),popup_closed:Dt(Z({button_id:Dt(U(),()=>{})}),{}),viewport_changed:Z({height:Tr(),width:Dt(Tr(),()=>window.innerWidth),is_state_stable:Ds(),is_expanded:Ds()}),theme_changed:Z({theme_params:Va()})};function Qi(t){if(t.source!==window.parent)return;let e;try{e=vt(vr(U(),wn(),ef),t.data)}catch{return}const{eventType:r,eventData:s}=e,n=ff[r];let i;try{i=n?vt(n,s):s}catch(o){return Yt().forceError([`An error occurred processing the "${r}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),e,o)}pf(r,i)}const[D,ir,pf,ig]=hf(()=>{const t=window;!t.TelegramGameProxy&&(t.TelegramGameProxy={}),ds(t.TelegramGameProxy,"receiveEvent",hs),Hi(t,"TelegramGameProxy"),!t.Telegram&&(t.Telegram={}),!t.Telegram.WebView&&(t.Telegram.WebView={}),ds(t.Telegram.WebView,"receiveEvent",hs),Hi(t.Telegram,"WebView"),ds(t,"TelegramGameProxy_receiveEvent",hs),window.addEventListener("message",Qi)},()=>{[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(t=>{const e=window;let r=[void 0,e];for(const i of t)if(r=[r[1],r[1][i]],!r[1])return;const[s,n]=r;"unwrap"in n&&(n.unwrap(),s&&s!==e&&!Object.keys(s).length&&delete e[t[0]])}),window.removeEventListener("message",Qi)}),[_f,og]=B("MethodUnsupportedError",(t,e)=>[`Method "${t}" is unsupported in Mini Apps version ${e}`]),[gf,ag]=B("MethodParameterUnsupportedError",(t,e,r)=>[`Parameter "${e}" of "${t}" method is unsupported in Mini Apps version ${r}`]),[vf,ug]=lf("LaunchParamsRetrieveError",t=>({errors:t}),t=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","📖 Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","","Collected errors:",...t.map(([e,r])=>`Source: ${e} / ${r instanceof Error?r.message:String(r)}`)].join(`
`)]);B("InvalidLaunchParamsError",(t,e)=>[`Invalid value for launch params: ${t}`,{cause:e}]);const[yf,lg]=B("UnknownEnvError"),[wf,cg]=B("InvokeCustomMethodError",t=>[`Server returned error: ${t}`]),bf=jt((...t)=>{try{window.parent.postMessage(...t)}catch(e){e instanceof SyntaxError?Yt().forceError("Unable to call window.parent.postMessage due to incorrectly configured target origin. Use the setTargetOrigin method to allow this origin to receive events",e):Yt().forceError(e)}}),mf=(...t)=>bf()(...t),kf=jt("https://web.telegram.org");function mn(t,e){Yt().log("Posting event:",e?{eventType:t,eventData:e}:{eventType:t});const r=window,s=JSON.stringify({eventType:t,eventData:e});if(cf())return mf(s,kf());if(Ha(r)){r.TelegramWebviewProxy.postEvent(t,JSON.stringify(e));return}if(pn(Z({external:Z({notify:_n()})}),r)){r.external.notify(s);return}throw new yf}function kn(t,e,r){r||(r={});const{capture:s}=r,[n,i]=Lr();return new q(o=>{(Array.isArray(e)?e:[e]).forEach(a=>{n(D(a,u=>{(!s||(Array.isArray(e)?s({event:a,payload:u}):s(u)))&&o(u)}))}),(r.postEvent||mn)(t,r.params)},r).finally(i)}const Yi="launchParams";function Xi(t){return t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function Ef(){const t=[];for(const[e,r]of[[()=>Xi(window.location.href),"window.location.href"],[()=>{const s=performance.getEntriesByType("navigation")[0];return s&&Xi(s.name)},"performance navigation entries"],[()=>Q(Yi),"local storage"]]){const s=e();if(!s){t.push([r,new Error("Source is empty")]);continue}if(tf(s))return ue(Yi,s),s;try{za(s)}catch(n){t.push([r,n])}}throw new vf(t)}function Qa(t){return za(Ef())}function Zi(t,e){try{return Qa(),!0}catch{return!1}return q.fn(async r=>{if(Ha(window))return!0;try{return await kn("web_app_request_theme","theme_changed",r),!0}catch{return!1}},{timeout:100})}function Sf(t){return({req_id:e})=>e===t}function eo(t){return t.split(".").map(Number)}function $f(t,e){const r=eo(t),s=eo(e),n=Math.max(r.length,s.length);for(let i=0;i<n;i+=1){const o=r[i]||0,a=s[i]||0;if(o!==a)return o>a?1:-1}return 0}function F(t,e){return $f(t,e)<=0}function yt(t,e,r){if(typeof r=="string"){if(t==="web_app_open_link"){if(e==="try_instant_view")return F("6.4",r);if(e==="try_browser")return F("7.6",r)}if(t==="web_app_set_header_color"&&e==="color")return F("6.9",r);if(t==="web_app_close"&&e==="return_back")return F("7.6",r);if(t==="web_app_setup_main_button"&&e==="has_shine_effect")return F("7.10",r)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return F("6.1",e);case"web_app_open_popup":return F("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return F("6.4",e);case"web_app_switch_inline_query":return F("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return F("6.9",e);case"web_app_setup_settings_button":return F("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return F("7.2",e);case"web_app_setup_swipe_behavior":return F("7.7",e);case"web_app_share_to_story":return F("7.8",e);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return F("7.10",e);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return F("8.0",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function Tf(t,e){e||(e="strict");const r=typeof e=="function"?e:s=>{const{method:n,version:i}=s,o="param"in s?new gf(n,s.param,i):new _f(n,i);if(e==="strict")throw o;return Yt().forceWarn(o.message)};return(s,n)=>yt(s,t)?s==="web_app_set_header_color"&&pn(Z({color:wa()}),n)&&!yt(s,"color",t)?r({version:t,method:s,param:"color"}):mn(s,n):r({version:t,method:s})}function jf(t,e,r,s){return kn("web_app_invoke_custom_method","custom_method_invoked",{...s||{},params:{method:t,params:e,req_id:r},capture:Sf(r)}).then(({result:n,error:i})=>{if(i)throw new wf(i);return n})}function Af(){return performance.getEntriesByType("navigation")[0]}function ne(){const t=Af();return!!t&&t.type==="reload"}function At(t,e){return jt(t,e)}function C(t,e){return of(t,e)}function O(t,e){const r=At(t,e);return[r,C(r)]}let Pf=!1;const Ws=jt(Oa("Bridge",{bgColor:"forestgreen",textColor:"white",shouldLog(){return Pf}})),fs=At(0),Ya=At(mn),[to,Dr]=O({tgWebAppPlatform:"unknown",tgWebAppVersion:"0.0"}),De=C(()=>Dr().tgWebAppVersion);function Of(t){t||(t={});const{postEvent:e}=t,r=t.launchParams||Qa();to.set(r),Ya.set(typeof e=="function"?e:Tf(r.tgWebAppVersion)),Ws().log("The package was configured. Launch params:",to())}function xf(){return fs.set(fs()+1),fs().toString()}function or(t,e,r){return jf(t,e,xf(),{...r||{},postEvent:j})}const M=(t,e,r)=>(r||(r={}),r.postEvent||(r.postEvent=j),kn(t,e,r)),j=(t,e)=>Ya()(t,e);function He(t){return[t]}const[En,hg]=B("CSSVarsBoundError","CSS variables are already bound"),[Xa,dg]=B("NotAvailableError",He);B("InvalidEnvError",He);const[It,fg]=B("FunctionNotAvailableError",He),[ve,pg]=B("InvalidArgumentsError",(t,e)=>[t,{cause:e}]),[Cf,_g]=B("ConcurrentCallError",He),[If,gg]=B("SetEmojiStatusError",t=>[`Failed to set emoji status: ${t}`]),[Rf,vg]=B("AccessDeniedError",He),[Lf,yg]=B("FullscreenFailedError",He);B("ShareMessageError",He);const[Sn,wg]=B("UnknownThemeParamsKeyError",t=>[`Unknown theme params key passed: ${t}`]);function ro(){return typeof window>"u"}function $n(t,e,r){r||(r={});const{isSupported:s,isMounted:n,isMounting:i,component:o,supports:a}=r||{},u=`${o?`${o}.`:""}${t}()`,l=s?Array.isArray(s)||typeof s=="object"&&"any"in s?s:[s]:void 0;function c(b){if(a){const g=a[b];return yt(g[0],g[1],De())}return!0}function h(){if(!l)return;function b($){return typeof $=="function"?$():yt($,De())?void 0:`it is unsupported in Mini Apps version ${De()}`}const g=Array.isArray(l)?l:l.any,w=g.map(b).filter(Boolean);return Array.isArray(l)?w[0]:w.length===g.length?w[w.length-1]:void 0}function d(...b){for(const g in a)if(a[g][2](...b)&&!c(g))return`option ${g} is not supported in Mini Apps version ${De()}`}let f;if(a){f={};for(const b in a)f[b]=C(()=>c(b))}const p=C(()=>!h()),v=C(()=>De()!=="0.0"),_=C(()=>!n||n()),E=C(()=>Zi()&&!ro()&&v()&&p()&&_());return Object.assign((...b)=>{const g=`Unable to call the ${u} ${o?"method":"function"}:`;if(ro()||!Zi())throw new It(`${g} it can't be called outside Mini Apps`);if(!v())throw new It(`${g} the SDK was not initialized. Use the SDK init() function`);const w=h();if(w)throw new It(`${g} ${w}`);const $=d(...b);if($)throw new It(`${g} ${$}`);if(!_()){const y=i&&i()?"mounting. Wait for the mount completion":`unmounted. Use the ${o}.mount() method`;throw new It(`${g} the component is ${y}`)}return e(...b)},e,{isAvailable:E,ifAvailable(...b){return E()?[!0,e(...b)]:[!1]}},l?{isSupported:p}:{},f?{supports:f}:{})}function qr(t,e){return e||(e={}),(r,s,n,i)=>$n(r,s,{...e,isSupported:n||e.isSupported,supports:i,component:t})}function xe(t,e,r){return qr(t,{isSupported:r,isMounted:e})}function ie(t,e){return qr(t,{isSupported:e})}const Tn="web_app_setup_back_button",Za="back_button_pressed",Nr="backButton",[so,bg]=O(!1),[Vs,mg]=O(!1),eu=xe(Nr,Vs,Tn),jn=ie(Nr,Tn);eu("hide",()=>{An(!1)});jn("mount",()=>{Vs()||(An(ne()&&Q(Nr)||!1),Vs.set(!0))});function An(t){t!==so()&&(j(Tn,{is_visible:t}),ue(Nr,t),so.set(t))}jn("onClick",t=>D(Za,t));jn("offClick",t=>{ir(Za,t)});eu("show",()=>{An(!0)});function Y(t,e,r){r||(r={});const{promise:s,error:n}=r,[i,o]=s?[s,C(s)]:O(),[a,u]=n?[n,C(n)]:O();return[Object.assign((...l)=>{if(i()){const h=new Cf(e);return a.set(h),q.reject(h)}Qt(()=>{i.set(t(...l)),a.set(void 0)});let c;return i().catch(h=>{throw c=h,h}).finally(()=>{Qt(()=>{i.set(void 0),a.set(c)})})},t),[i,o,C(()=>!!i())],[a,u]]}function ar(t,e,r){const[s,...n]=Y(e,`The ${t} component is already mounting`),[i,o]=O(!1);return[(...a)=>i()?q.resolve():s(...a).then(u=>{Qt(()=>{i.set(!0),r(u)})}),...n,[i,o]]}const[tu,kg]=O({available:!1,type:"",accessGranted:!1,accessRequested:!1,deviceId:"",tokenSaved:!1}),no="web_app_biometry_get_info",Uf=$n("requestBiometry",t=>M(no,"biometry_info_received",t),{isSupported:no});function ru(t){if(!Cd(t))throw t}function su(t){const e=t();e&&e.catch(ru).cancel()}const Xt="biometry",Pn="web_app_biometry_request_auth",nu="biometry_info_received",Df=t=>{Br(On(t))};function iu(){throw new Xa("Biometry is not available")}function On(t){let e=!1,r=!1,s="",n=!1,i="",o=!1;return t.available&&(e=!0,r=t.token_saved,s=t.device_id,n=t.access_requested,i=t.type,o=t.access_granted),{available:e,tokenSaved:r,deviceId:s,type:i,accessGranted:o,accessRequested:n}}const[qf,Nf,Bf,ou]=ar(Xt,t=>{const e=ne()&&Q(Xt);return e?q.resolve(e):Uf({abortSignal:t}).then(On)},t=>{D(nu,Df),Br(t)}),au=ie(Xt,Pn),xn=xe(Xt,ou[0],Pn);au("mount",qf);const[,Eg,Sg]=Nf,[,$g]=Bf,[Tg,jg]=ou,[Mf,Ff,Wf]=Y(t=>q.fn(async e=>{const r=tu();r.available||iu();const s=await M(Pn,"biometry_auth_requested",{...t,...e,params:{reason:((t||{}).reason||"").trim()}}),{token:n}=s;return typeof n=="string"&&Br({...r,token:n}),s},t),"Biometry authentication is already in progress");xn("authenticate",Mf);const[,Ag,Pg]=Ff,[,Og]=Wf;au("openSettings",()=>{j("web_app_biometry_open_settings")});const[Vf,Kf,zf]=Y(t=>q.fn(async e=>{const r=await M("web_app_biometry_request_access",nu,{...t,...e,params:{reason:(t||{}).reason||""}}).then(On);return r.available||iu(),Br(r),r.accessGranted},t),"Biometry access request is already in progress");xn("requestAccess",Vf);const[,xg,Cg]=Kf,[,Ig]=zf;function Br(t){tu.set(t),ue(Xt,t)}xn("updateToken",t=>(t||(t={}),M("web_app_biometry_update_token","biometry_token_updated",{...t,params:{token:t.token||"",reason:t.reason}}).then(e=>e.status)));function Mr(t,e){return qr(t,{isMounted:e})}const Ce=qr,Fr="closingBehavior",[io,Rg]=O(!1),[oo,Gf]=O(!1),uu=Mr(Fr,Gf),Hf=Ce(Fr);uu("disableConfirmation",()=>{Cn(!1)});uu("enableConfirmation",()=>{Cn(!0)});Hf("mount",()=>{oo()||(Cn(ne()&&Q(Fr)||!1),oo.set(!0))});function Cn(t){t!==io()&&(j("web_app_setup_closing_behavior",{need_confirmation:t}),ue(Fr,t),io.set(t))}const Jf="web_app_invoke_custom_method",ur=ie("cloudStorage",Jf),Qf=ur("deleteItem",(t,e)=>{const r=Array.isArray(t)?t:[t];return r.length?or("deleteStorageValues",{keys:r},e).then():q.resolve()});function Yf(t,e){const r=Array.isArray(t)?t:[t];return r.length?or("getStorageValues",{keys:r},e).then(s=>{const n={...r.reduce((i,o)=>(i[o]="",i),{}),...vt(Ea(U(),U()),s)};return typeof t=="string"?n[t]:n}):q.resolve(Array.isArray(t)?{}:"")}ur("getItem",Yf);const Xf=ur("getKeys",t=>or("getStorageKeys",{},t).then(e=>vt(ba(U()),e)));ur("setItem",(t,e,r)=>or("saveStorageValue",{key:t,value:e},r).then());ur("clear",t=>Xf(t).then(Qf));const Wr="web_app_trigger_haptic_feedback",In=ie("hapticFeedback",Wr);In("impactOccurred",t=>{j(Wr,{type:"impact",impact_style:t})});In("notificationOccurred",t=>{j(Wr,{type:"notification",notification_type:t})});In("selectionChanged",()=>{j(Wr,{type:"selection_change"})});const lu="web_app_open_invoice",Zf=ie("invoice",lu);function ep(t,e,r){let s;if(e==="url"){const{hostname:n,pathname:i}=new URL(t,window.location.href);if(n!=="t.me")throw new ve(`Link has unexpected hostname: ${n}`);const o=i.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!o)throw new ve('Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,s]=o}else s=t,r=e;return M(lu,"invoice_closed",{...r,params:{slug:s},capture:n=>s===n.slug}).then(n=>n.status)}const[tp,rp,sp]=Y(ep,"Invoice is already opened");Zf("open",tp);const[,Lg,Ug]=rp,[,Dg]=sp,Kt="locationManager",cu="web_app_check_location",ao="web_app_open_location_settings",Ks=At({available:!1,accessGranted:!1,accessRequested:!1});function np(t){let e=!1,r,s;return t.available&&(e=!0,r=t.access_requested,s=t.access_granted),{available:e,accessGranted:s||!1,accessRequested:r||!1}}const[ip,op,ap,hu]=ar(Kt,t=>{const e=ne()&&Q(Kt);return e?q.resolve(e):M("web_app_check_location","location_checked",t).then(np)},t=>{Ks.set(t),ue(Kt,t)}),du=ie(Kt,cu),up=xe(Kt,hu[0],cu);du("mount",ip);const[,qg,Ng]=op,[,Bg]=ap,[Mg,Fg]=hu,[lp,cp,hp]=Y(t=>M("web_app_request_location","location_requested",t).then(e=>{if(!e.available)throw Ks.set({...Ks(),available:!1}),new Xa("Location data tracking is not available");const{available:r,...s}=e;return s}),"Location request is currently in progress");up("requestLocation",lp);const[,Wg,Vg]=cp,[,Kg]=hp;du("openSettings",()=>{j(ao)},ao);function Rn(t){const e={};for(const r in t){const s=t[r];s!==void 0&&(e[r]=s)}return e}function dp(t){const e=Xd(t);return Math.sqrt([.299,.587,.114].reduce((r,s,n)=>{const i=parseInt(e.slice(1+n*2,1+(n+1)*2),16);return r+i*i*s},0))<120}const[ps,zg]=O(!1),[We,lr]=O({});function Ln(t){return C(()=>We()[t])}const fu=Ln("button_color"),fp=Ln("button_text_color"),pp=Ln("secondary_bg_color"),zt=At({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),_p=C(()=>{const t=zt();return{...t,backgroundColor:t.backgroundColor||fu()||"#2481cc",textColor:t.textColor||fp()||"#ffffff"}}),[uo,gp]=O(!1),vp="web_app_setup_main_button",pu="main_button_pressed",Vr="mainButton",Un=Ce(Vr),yp=Mr(Vr,gp);Un("mount",()=>{if(!uo()){const t=ne()&&Q(Vr);t&&zt.set(t),uo.set(!0)}});Un("onClick",t=>D(pu,t));Un("offClick",t=>{ir(pu,t)});yp("setParams",t=>{zt.set({...zt(),...Rn(t)}),ue(Vr,zt());const e=_p();e.text&&j(vp,{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,text:e.text,text_color:e.textColor})});function Dn(t,e){document.documentElement.style.setProperty(t,e)}function qn(t){document.documentElement.style.removeProperty(t)}const wt="themeParams",_u="theme_changed",gu=Ce(wt),vu=({theme_params:t})=>{We.set(t),ue(wt,t)},[wp,yu,bp,wu]=ar(wt,t=>q.resolve(ne()&&Q(wt)||Dr().tgWebAppThemeParams||{}),t=>{D(_u,vu),We.set(t)}),mp=Mr(wt,wu[0]);mp("bindCssVars",t=>{if(ps())throw new En;t||(t=s=>`--tg-theme-${Ud(s)}`);function e(s){Object.entries(We()).forEach(([n,i])=>{i&&s(n,i)})}function r(){e((s,n)=>{Dn(t(s),n)})}return r(),We.sub(r),ps.set(!0),()=>{e(qn),We.unsub(r),ps.set(!1)}});const kp=gu("mount",wp);yu[2];yu[1];bp[1];const[lo,Gg]=wu,Ep=gu("mountSync",()=>{if(!lo()){const t=ne()&&Q(wt)||Dr().tgWebAppThemeParams||{};D(_u,vu),Qt(()=>{We.set(t),lo.set(!0)})}});function bu(t){return C(()=>Kr(t()))}function Kr(t){return Tt(t)?t:lr()[t]}const[Zt,Sp]=O("bg_color"),Nn=bu(Zt),[er,$p]=O("bottom_bar_bg_color"),Bn=C(()=>{const t=er();return Tt(t)?t:lr()[t]||pp()}),[tr,Tp]=O("bg_color"),mu=bu(tr),[_s,jp]=O(!1),Ap=C(()=>{const t=Nn();return t?dp(t):!1}),[zr,Pp]=O(!0),ku=C(()=>({backgroundColor:Zt(),bottomBarColor:er(),headerColor:tr(),isActive:zr()})),Ar="web_app_set_background_color",Pr="web_app_set_bottom_bar_color",qe="web_app_set_header_color",Mn="visibility_changed",Ke="miniApp",Fn={any:[Ar,Pr,qe]},Op=C(()=>Fn.any.some(t=>yt(t,De()))),Wn=t=>{zr.set(t.is_visible),Hr()},Vn=t=>{[[tr,qe],[Zt,Ar],[er,Pr]].forEach(([e,r])=>{const s=e();if(!Tt(s)&&(r!==qe||s!=="bg_color"&&s!=="secondary_bg_color")){const n=t[s];n&&j(r,{color:n})}})},[xp,Eu,Cp,Su]=ar(Ke,t=>kp(t).then(()=>ne()&&Q(Ke)||void 0),t=>{Kn.ifAvailable(t?t.backgroundColor:"bg_color"),zn.ifAvailable(t?t.bottomBarColor:"bottom_bar_bg_color"),Gn.ifAvailable(t?t.headerColor:"bg_color"),zr.set(t?t.isActive:!0),D(Mn,Wn),lr.sub(Vn)}),$u=Ce(Ke),Tu=ie(Ke,Fn),Gr=xe(Ke,Su[0],Fn),Ip=Gr("bindCssVars",t=>{if(_s())throw new En;const[e,r]=Lr();function s(n,i){function o(){Dn(n,i()||null)}o(),e(i.sub(o),qn.bind(null,n))}return t||(t=n=>`--tg-${Aa(n)}`),s(t("bgColor"),Nn),s(t("bottomBarColor"),Bn),s(t("headerColor"),mu),e(()=>{_s.set(!1)}),_s.set(!0),r}),Rp=$u("close",t=>{j("web_app_close",{return_back:t})}),Lp=Tu("mount",xp),Up=Eu[2],ju=Eu[1],Dp=Cp[1],[zs,qp]=Su,Np=Tu("mountSync",()=>{if(!zs()){Ep();const t=ne()&&Q(Ke)||void 0;Kn.ifAvailable(t?t.backgroundColor:"bg_color"),zn.ifAvailable(t?t.bottomBarColor:"bottom_bar_bg_color"),Gn.ifAvailable(t?t.headerColor:"bg_color"),D(Mn,Wn),lr.sub(Vn),Qt(()=>{zr.set(t?t.isActive:!0),zs.set(!0)})}}),Bp=$u("ready",()=>{j("web_app_ready")});function Hr(){ue(Ke,ku())}const Kn=Gr("setBackgroundColor",t=>{if(t===Zt())return;const e=Kr(t);if(!e)throw new Sn(t);j(Ar,{color:e}),Zt.set(t),Hr()},Ar),zn=Gr("setBottomBarColor",t=>{if(t===er())return;const e=Kr(t);if(!e)throw new Sn(t);j(Pr,{color:e}),er.set(t),Hr()},Pr),Gn=Gr("setHeaderColor",t=>{if(t!==tr()){if(t==="bg_color"||t==="secondary_bg_color")j(qe,{color_key:t});else{const e=Kr(t);if(!e)throw new Sn(t);j(qe,{color:e})}tr.set(t),Hr()}},qe,{rgb:[qe,"color",Tt]});function Mp(){su(ju),ir(Mn,Wn),lr.unsub(Vn),zs.set(!1)}const co=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:Sp,backgroundColorRGB:Nn,bindCssVars:Ip,bottomBarColor:$p,bottomBarColorRGB:Bn,close:Rp,headerColor:Tp,headerColorRGB:mu,isActive:Pp,isCssVarsBound:jp,isDark:Ap,isMounted:qp,isMounting:Up,isSupported:Op,mount:Lp,mountError:Dp,mountPromise:ju,mountSync:Np,ready:Bp,setBackgroundColor:Kn,setBottomBarColor:zn,setHeaderColor:Gn,state:ku,unmount:Mp},Symbol.toStringTag,{value:"Module"}));function Fp(t){const e=t.message.trim(),r=(t.title||"").trim(),s=t.buttons||[];if(r.length>64)throw new ve(`Invalid title: ${r}`);if(!e||e.length>256)throw new ve(`Invalid message: ${e}`);if(s.length>3)throw new ve(`Invalid buttons count: ${s.length}`);return{title:r,message:e,buttons:s.length?s.map((n,i)=>{const o=n.id||"";if(o.length>64)throw new ve(`Button with index ${i} has invalid id: ${o}`);if(!n.type||n.type==="default"||n.type==="destructive"){const a=n.text.trim();if(!a||a.length>64)throw new ve(`Button with index ${i} has invalid text: ${a}`);return{type:n.type,text:a,id:o}}return{type:n.type,id:o}}):[{type:"close",id:""}]}}const Au="web_app_open_popup",Pu=ie("popup",Au),[Ou,Hn,xu]=Y(t=>M(Au,"popup_closed",{...t,params:Fp(t)}).then(({button_id:e})=>e===void 0?null:e),"A popup is already opened");Pu("open",Ou);Hn[1];Hn[2];xu[1];Pu("show",Ou);const[,Hg,Jg]=Hn,[,Qg]=xu,Cu="web_app_close_scan_qr_popup",Iu="web_app_open_scan_qr_popup",Wp="scan_qr_popup_closed",Vp="qr_text_received",Ru=ie("qrScanner",Iu);Ru("close",()=>{j(Cu),su(Jp)});function Kp(t){t||(t={});const{onCaptured:e,text:r,capture:s}=t,[,n]=Lr(D(Wp,()=>{i.resolve()}),D(Vp,o=>{e?e(o.data):(!s||s(o.data))&&(i.resolve(o.data),j(Cu))})),i=new Ld(t);return(t.postEvent||j)(Iu,{text:r}),q.resolve(i).catch(ru).finally(n)}const[zp,Gp,Hp]=Y(Kp,"The QR Scanner is already opened");Ru("open",zp);const[,Jp,Yg]=Gp,[,Xg]=Hp,Gt=At({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),Qp=C(()=>{const t=Gt();return{...t,backgroundColor:t.backgroundColor||Bn()||"#000000",textColor:t.textColor||fu()||"#2481cc"}}),[ho,Yp]=O(!1),Jn="web_app_setup_secondary_button",Lu="secondary_button_pressed",Jr="secondaryButton",Qn=ie(Jr,Jn),Xp=xe(Jr,Yp,Jn);Qn("mount",()=>{if(!ho()){const t=ne()&&Q(Jr);t&&Gt.set(t),ho.set(!0)}});Qn("onClick",t=>D(Lu,t));Qn("offClick",t=>{ir(Lu,t)});Xp("setParams",t=>{Gt.set({...Gt(),...Rn(t)}),ue(Jr,Gt());const e=Qp();e.text&&j(Jn,{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,position:e.position,text:e.text,text_color:e.textColor})});const Yn="web_app_setup_settings_button",Uu="settings_button_pressed",Qr="settingsButton",[fo,Zg]=O(!1),[Gs,ev]=O(!1),Xn=ie(Qr,Yn),Du=xe(Qr,Gs,Yn);Du("hide",()=>{Zn(!1)});Xn("mount",()=>{Gs()||(Zn(ne()&&Q(Qr)||!1),Gs.set(!0))});function Zn(t){t!==fo()&&(j(Yn,{is_visible:t}),ue(Qr,t),fo.set(t))}Xn("onClick",t=>D(Uu,t));Xn("offClick",t=>{ir(Uu,t)});Du("show",()=>{Zn(!0)});const ei="web_app_setup_swipe_behavior",Yr="swipeBehavior",[Hs,tv]=O(!1),[po,rv]=O(!0),Zp=ie(Yr,ei),qu=xe(Yr,Hs,ei);qu("disableVertical",()=>{ti(!1)});qu("enableVertical",()=>{ti(!0)});Zp("mount",()=>{Hs()||(ti(ne()&&Q(Yr)||!1,!0),Hs.set(!0))});function ti(t,e){(t!==po()||e)&&(j(ei,{allow_vertical_swipe:t}),ue(Yr,t),po.set(t))}const Je="viewport",Nu="fullscreen_changed",Bu="safe_area_changed",Mu="content_safe_area_changed",Fu="viewport_changed",Wu=Ce(Je),_o={left:0,top:0,bottom:0,right:0};function gs(t){return Math.max(t,0)}const[vs,e_]=O({contentSafeAreaInsets:_o,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:_o,stableHeight:0,width:0});function Pt(t){return C(()=>e_()[t])}const t_=Pt("height"),r_=Pt("stableHeight"),s_=Pt("width");function Ot(t){const{height:e,stableHeight:r,width:s}=t;vs.set({...vs(),...Rn({...t,height:e?gs(e):void 0,width:s?gs(s):void 0,stableHeight:r?gs(r):void 0})}),ue(Je,vs())}function n_(){return Q(Je)}function Xr(t){return C(()=>Vu()[t])}const Vu=Pt("contentSafeAreaInsets"),i_=Xr("bottom"),o_=Xr("left"),a_=Xr("right"),u_=Xr("top");function Zr(t){return C(()=>Ku()[t])}const Ku=Pt("safeAreaInsets"),l_=Zr("bottom"),c_=Zr("left"),h_=Zr("right"),d_=Zr("top"),zu="web_app_request_safe_area",Gu=ie(Je,zu),go=Gu("requestContentSafeAreaInsets",t=>M("web_app_request_content_safe_area",Mu,t));function f_(t){return M("web_app_request_viewport",Fu,t)}const vo=Gu("requestSafeAreaInsets",t=>M(zu,Bu,t)),p_=t=>{const{height:e}=t;Ot({isExpanded:t.is_expanded,height:e,width:t.width,stableHeight:t.is_state_stable?e:void 0})},__=t=>{Ot({isFullscreen:t.is_fullscreen})},g_=t=>{Ot({safeAreaInsets:t})},v_=t=>{Ot({contentSafeAreaInsets:t})},[y_,w_,b_,m_]=ar(Je,t=>{const e=ne()&&n_();return e?q.resolve(e):q.fn(async r=>{const s=await q.all([vo.isAvailable()?vo(r):Ku(),go.isAvailable()?go(r):Vu()]),n=Dr(),i={contentSafeAreaInsets:s[1],isFullscreen:!!n.tgWebAppFullscreen,safeAreaInsets:s[0]};if(["macos","tdesktop","unigram","webk","weba","web"].includes(n.tgWebAppPlatform)){const o=window;return{...i,height:o.innerHeight,isExpanded:!0,stableHeight:o.innerHeight,width:o.innerWidth}}return f_(r).then(o=>({...i,height:o.height,isExpanded:o.is_expanded,stableHeight:o.is_state_stable?o.height:0,width:o.width}))},t)},t=>{D(Fu,p_),D(Nu,__),D(Bu,g_),D(Mu,v_),Ot(t)});Wu("mount",y_);const[,sv,nv]=w_,[,iv]=b_,[Hu,ov]=m_,k_=Mr(Je,Hu),[ys,av]=O(!1);k_("bindCssVars",t=>{if(ys())throw new En;t||(t=r=>`--tg-viewport-${Aa(r)}`);const e=[["height",t_],["stableHeight",r_],["width",s_],["safeAreaInsetTop",d_],["safeAreaInsetBottom",l_],["safeAreaInsetLeft",c_],["safeAreaInsetRight",h_],["contentSafeAreaInsetTop",u_],["contentSafeAreaInsetBottom",i_],["contentSafeAreaInsetLeft",o_],["contentSafeAreaInsetRight",a_]].reduce((r,[s,n])=>{const i=t(s);if(i){const o=()=>{Dn(i,`${n()}px`)};r.push([o,n.sub(o),i])}return r},[]);return e.forEach(r=>{r[0]()}),ys.set(!0),()=>{e.forEach(r=>{r[1](),qn(r[2])}),ys.set(!1)}});Wu("expand",()=>{j("web_app_expand")});const Ju="web_app_request_fullscreen",E_=xe(Je,Hu,Ju),S_=Pt("isFullscreen"),[$_,uv]=O(),[T_,lv]=O();function Qu(t,e){return E_(t,Y(r=>M(e?Ju:"web_app_exit_fullscreen",[Nu,"fullscreen_failed"],r).then(s=>{if("error"in s&&s.error!=="ALREADY_FULLSCREEN")throw new Lf(s.error);const n="is_fullscreen"in s?s.is_fullscreen:!0;n!==S_()&&Ot({isFullscreen:n})}),"Fullscreen mode change is already being requested",{promise:$_,error:T_})[0])}Qu("requestFullscreen",!0);Qu("exitFullscreen");const j_="web_app_request_emoji_status_access",[cv,A_,P_]=Y(t=>M(j_,"emoji_status_access_requested",t).then(e=>e.status),"Emoji status access request is already in progress"),[,hv,dv]=A_,[,fv]=P_,O_="web_app_set_emoji_status",[pv,x_,C_]=Y((t,e)=>M(O_,["emoji_status_set","emoji_status_failed"],{params:{custom_emoji_id:t,duration:(e||{}).duration},...e}).then(r=>{if(r&&"error"in r)throw new If(r.error)}),"Emoji status set request is currently in progress"),[,_v,gv]=x_,[,vv]=C_,I_="web_app_check_home_screen",[yv,R_,L_]=Y(t=>M(I_,"home_screen_checked",t).then(e=>e.status||"unknown"),"Check home screen status request is currently in progress"),[,wv,bv]=R_,[,mv]=L_,U_=Ce();U_("openLink",(t,e)=>{if(typeof t=="string")try{t=new URL(t)}catch(r){throw new ve(`"${t.toString()}" is invalid URL`,r)}e||(e={}),j("web_app_open_link",{url:t.toString(),try_browser:e.tryBrowser,try_instant_view:e.tryInstantView})});const yo="web_app_open_tg_link",D_=Ce(),q_=D_("openTelegramLink",t=>{const e=t.toString();if(!e.match(/^https:\/\/t.me\/.+/))throw new ve(`"${e}" is invalid URL`);if(!yt(yo,De())){window.location.href=e;return}t=new URL(t),j(yo,{path_full:t.pathname+t.search})}),N_=Ce();N_("shareURL",(t,e)=>{q_("https://t.me/share/url?"+new URLSearchParams({url:t,text:e||""}).toString().replace(/\+/g,"%20"))});function B_(t,e){return new q({abortSignal:e,timeout:t}).catch(()=>{})}const Yu="web_app_request_phone",[M_,F_,W_]=Y(t=>M(Yu,"phone_requested",t).then(e=>e.status),"Phone access request is currently in progress"),V_=$n("requestPhoneAccess",M_,{isSupported:Yu}),[,kv,Ev]=F_,[,Sv]=W_;async function wo(t){const e=vt(U(),await or("getRequestedContact",{},{...t,timeout:(t||{}).timeout||5e3}));return{raw:e,parsed:vt(vr(Sa([U(),ka(URLSearchParams)]),Fa(Z({contact:vr(U(),wn(),Z({user_id:Tr(),phone_number:U(),first_name:U(),last_name:jr(U())})),auth_date:vr(U(),ya(r=>new Date(Number(r)*1e3)),ma()),hash:U()}))),e)}}const[$v,K_,z_]=Y(t=>new q(async(e,r,s)=>{try{return e(await wo(s))}catch(i){if(i instanceof Us)throw i}if(await V_(s)!=="sent")throw new Rf("User denied access");let n=50;for(;!s.isAborted();){try{return e(await wo(s))}catch(i){if(i instanceof Us)throw i}await B_(n),n+=50}},t),"Contact is already being requested"),[,Tv,jv]=K_,[,Av]=z_,G_="web_app_request_write_access",[Pv,H_,J_]=Y(t=>M(G_,"write_access_requested",t).then(e=>e.status),"Write access request is currently in progress"),[,Ov,xv]=H_,[,Cv]=J_;function Q_(t){Of(t);const[e,r]=Lr(D("reload_iframe",()=>{Ws().log("Received a request to reload the page"),j("iframe_will_reload"),window.location.reload()})),{acceptCustomStyles:s=!0}={};if(s){const n=document.createElement("style");n.id="telegram-custom-styles",document.head.appendChild(n),e(D("set_custom_style",i=>{n.innerHTML=i}),()=>{document.head.removeChild(n)})}return j("iframe_ready",{reload_supported:!0}),Ws().log("The package was initialized"),r}const Y_=async()=>{try{await Q_(),co?.ready&&(await co.ready(),console.log("Mini App готово"))}catch(t){console.error("Ошибка инициализации:",t)}};Y_();tc(_d,{target:document.getElementById("app")});
