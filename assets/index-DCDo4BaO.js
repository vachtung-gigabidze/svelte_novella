(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();const Ba=!1;var xs=Array.isArray,cl=Array.prototype.indexOf,Ls=Array.from,fs=Object.defineProperty,Lr=Object.getOwnPropertyDescriptor,Wa=Object.getOwnPropertyDescriptors,hl=Object.prototype,dl=Array.prototype,Fs=Object.getPrototypeOf,Jo=Object.isExtensible;function fl(n){return n()}function vs(n){for(var e=0;e<n.length;e++)n[e]()}function vl(){var n,e,t=new Promise((r,o)=>{n=r,e=o});return{promise:t,resolve:n,reject:e}}const vt=2,Ds=4,xi=8,vr=16,an=32,Nn=64,Va=128,wt=256,ki=512,rt=1024,bt=2048,An=4096,Lt=8192,pr=16384,Us=32768,$s=65536,Xo=1<<17,pl=1<<18,qr=1<<19,qa=1<<20,ps=1<<21,Ns=1<<22,Dn=1<<23,or=Symbol("$state"),Bs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function gl(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function ml(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function _l(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function yl(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function wl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function bl(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Al(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function El(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function kl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Sl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Cl=1,Tl=2,Pl=16,Il=1,Rl=2,Je=Symbol(),Ol="http://www.w3.org/1999/xhtml";let jl=!1;function Ha(n){return n===this.v}function za(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Ml(n,e){return n!==e}function Ga(n){return!za(n,this.v)}let Hr=!1,xl=!1;function Ll(){Hr=!0}let $e=null;function Si(n){$e=n}function gr(n,e=!1,t){$e={p:$e,c:null,e:null,s:n,x:null,l:Hr&&!e?{s:null,u:null,$:[]}:null}}function mr(n){var e=$e,t=e.e;if(t!==null){e.e=null;for(var r of t)ou(r)}return $e=e.p,{}}function _r(){return!Hr||$e!==null&&$e.l===null}const Fl=new WeakMap;function Dl(n){var e=ke;if(e===null)return Ee.f|=Dn,n;if((e.f&Us)===0){if((e.f&Va)===0)throw!e.parent&&n instanceof Error&&Ka(n),n;e.b.error(n)}else Ws(n,e)}function Ws(n,e){for(;e!==null;){if((e.f&Va)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&Ka(n),n}function Ka(n){const e=Fl.get(n);e&&(fs(n,"message",{value:e.message}),fs(n,"stack",{value:e.stack}))}let Ci=[];function Ul(){var n=Ci;Ci=[],vs(n)}function Ya(n){Ci.length===0&&queueMicrotask(Ul),Ci.push(n)}function $l(){for(var n=ke.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&gl(),n}function Vs(n){var e=vt|bt,t=Ee!==null&&(Ee.f&vt)!==0?Ee:null;return ke===null||t!==null&&(t.f&wt)!==0?e|=wt:ke.f|=qr,{ctx:$e,deps:null,effects:null,equals:Ha,f:e,fn:n,reactions:null,rv:0,v:Je,wv:0,parent:t??ke,ac:null}}function Nl(n,e){let t=ke;t===null&&_l();var r=t.b,o=void 0,u=Nr(Je),c=null,f=!Ee;return tc(()=>{try{var v=n();c&&Promise.resolve(v).catch(()=>{})}catch(g){v=Promise.reject(g)}var m=()=>v;o=c?.then(m,m)??Promise.resolve(v),c=o;var y=Xe,A=r.pending;f&&(r.update_pending_count(1),A||y.increment());const E=(g,C=void 0)=>{c=null,A||y.activate(),C?C!==Bs&&(u.f|=Dn,Pi(u,C)):((u.f&Dn)!==0&&(u.f^=Dn),Pi(u,g)),f&&(r.update_pending_count(-1),A||y.decrement()),Za()};if(o.then(E,g=>E(null,g||"unknown")),y)return()=>{queueMicrotask(()=>y.neuter())}}),new Promise(v=>{function m(y){function A(){y===o?v(u):m(o)}y.then(A,A)}m(o)})}function Ja(n){const e=Vs(n);return e.equals=Ga,e}function Xa(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)on(e[t])}}function Bl(n){for(var e=n.parent;e!==null;){if((e.f&vt)===0)return e;e=e.parent}return null}function qs(n){var e,t=ke;bn(Bl(n));try{Xa(n),e=pu(n)}finally{bn(t)}return e}function Qa(n){var e=qs(n);if(n.equals(e)||(n.v=e,n.wv=fu()),!yr){var t=(yn||(n.f&wt)!==0)&&n.deps!==null?An:rt;lt(n,t)}}function Wl(n,e,t){const r=_r()?Vs:Ja;if(e.length===0){t(n.map(r));return}var o=Xe,u=ke,c=Vl(),f=$l();Promise.all(e.map(v=>Nl(v))).then(v=>{o?.activate(),c();try{t([...n.map(r),...v])}catch(m){(u.f&pr)===0&&Ws(m,u)}o?.deactivate(),Za()}).catch(v=>{f.error(v)})}function Vl(){var n=ke,e=Ee,t=$e,r=Xe;return function(){bn(n),qt(e),Si(t),r?.activate()}}function Za(){bn(null),qt(null),Si(null)}const rs=new Set;let Xe=null,Qo=new Set,Ti=[];function eu(){const n=Ti.shift();Ti.length>0&&queueMicrotask(eu),n()}let $r=[],Hs=null,gs=!1;class cr{current=new Map;#u=new Map;#i=new Set;#e=0;#l=null;#c=!1;#n=[];#s=[];#r=[];#t=[];#o=[];#h=[];#d=[];skipped_effects=new Set;process(e){$r=[];for(const o of e)this.#v(o);if(this.#n.length===0&&this.#e===0){this.#f();var t=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#o=[],Xe=null,Zo(t),Zo(r),Xe===null?Xe=this:rs.delete(this),this.#l?.resolve()}else this.#a(this.#r),this.#a(this.#t),this.#a(this.#o);for(const o of this.#n)ur(o);for(const o of this.#s)ur(o);this.#n=[],this.#s=[]}#v(e){e.f^=rt;for(var t=e.first;t!==null;){var r=t.f,o=(r&(an|Nn))!==0,u=o&&(r&rt)!==0,c=u||(r&Lt)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(o)t.f^=rt;else if((r&Ds)!==0)this.#t.push(t);else if((r&rt)===0)if((r&Ns)!==0){var f=t.b?.pending?this.#s:this.#n;f.push(t)}else Di(t)&&((t.f&vr)!==0&&this.#o.push(t),ur(t));var v=t.first;if(v!==null){t=v;continue}}var m=t.parent;for(t=t.next;t===null&&m!==null;)t=m.next,m=m.parent}}#a(e){for(const t of e)((t.f&bt)!==0?this.#h:this.#d).push(t),lt(t,rt);e.length=0}capture(e,t){this.#u.has(e)||this.#u.set(e,t),this.current.set(e,e.v)}activate(){Xe=this}deactivate(){Xe=null;for(const e of Qo)if(Qo.delete(e),e(),Xe!==null)break}neuter(){this.#c=!0}flush(){$r.length>0?ql():this.#f(),Xe===this&&(this.#e===0&&rs.delete(this),this.deactivate())}#f(){if(!this.#c)for(const e of this.#i)e();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)lt(e,bt),hr(e);for(const e of this.#d)lt(e,An),hr(e);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#i.add(e)}settled(){return(this.#l??=vl()).promise}static ensure(){if(Xe===null){const e=Xe=new cr;rs.add(Xe),cr.enqueue(()=>{Xe===e&&e.flush()})}return Xe}static enqueue(e){Ti.length===0&&queueMicrotask(eu),Ti.unshift(e)}}function ql(){var n=ar;gs=!0;try{var e=0;for(ta(!0);$r.length>0;){var t=cr.ensure();if(e++>1e3){var r,o;Hl()}t.process($r),wn.clear()}}finally{gs=!1,ta(n),Hs=null}}function Hl(){try{Al()}catch(n){Ws(n,Hs)}}let xn=null;function Zo(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(pr|Lt))===0&&Di(r)&&(xn=[],ur(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?lu(r):r.fn=null),xn?.length>0)){wn.clear();for(const o of xn)ur(o);xn=[]}}xn=null}}function hr(n){for(var e=Hs=n;e.parent!==null;){e=e.parent;var t=e.f;if(gs&&e===ke&&(t&vr)!==0)return;if((t&(Nn|an))!==0){if((t&rt)===0)return;e.f^=rt}}$r.push(e)}const wn=new Map;function Nr(n,e){var t={f:0,v:n,reactions:null,equals:Ha,rv:0,wv:0};return t}function Fe(n,e){const t=Nr(n);return sc(t),t}function zl(n,e=!1,t=!0){const r=Nr(n);return e||(r.equals=Ga),Hr&&t&&$e!==null&&$e.l!==null&&($e.l.s??=[]).push(r),r}function ie(n,e,t=!1){Ee!==null&&(!Vt||(Ee.f&Xo)!==0)&&_r()&&(Ee.f&(vt|vr|Ns|Xo))!==0&&!sn?.includes(n)&&Sl();let r=t?Fn(e):e;return Pi(n,r)}function Pi(n,e){if(!n.equals(e)){var t=n.v;yr?wn.set(n,e):wn.set(n,t),n.v=e;var r=cr.ensure();r.capture(n,t),(n.f&vt)!==0&&((n.f&bt)!==0&&qs(n),lt(n,(n.f&wt)===0?rt:An)),n.wv=fu(),tu(n,bt),_r()&&ke!==null&&(ke.f&rt)!==0&&(ke.f&(an|Nn))===0&&(yt===null?oc([n]):yt.push(n))}return e}function Gl(n,e=1){var t=te(n),r=e===1?t++:t--;return ie(n,t),r}function is(n){ie(n,n.v+1)}function tu(n,e){var t=n.reactions;if(t!==null)for(var r=_r(),o=t.length,u=0;u<o;u++){var c=t[u],f=c.f;if(!(!r&&c===ke)){var v=(f&bt)===0;v&&lt(c,e),(f&vt)!==0?tu(c,An):v&&((f&vr)!==0&&xn!==null&&xn.push(c),hr(c))}}}function Fn(n){if(typeof n!="object"||n===null||or in n)return n;const e=Fs(n);if(e!==hl&&e!==dl)return n;var t=new Map,r=xs(n),o=Fe(0),u=Un,c=f=>{if(Un===u)return f();var v=Ee,m=Un;qt(null),ra(u);var y=f();return qt(v),ra(m),y};return r&&t.set("length",Fe(n.length)),new Proxy(n,{defineProperty(f,v,m){(!("value"in m)||m.configurable===!1||m.enumerable===!1||m.writable===!1)&&El();var y=t.get(v);return y===void 0?y=c(()=>{var A=Fe(m.value);return t.set(v,A),A}):ie(y,m.value,!0),!0},deleteProperty(f,v){var m=t.get(v);if(m===void 0){if(v in f){const y=c(()=>Fe(Je));t.set(v,y),is(o)}}else ie(m,Je),is(o);return!0},get(f,v,m){if(v===or)return n;var y=t.get(v),A=v in f;if(y===void 0&&(!A||Lr(f,v)?.writable)&&(y=c(()=>{var g=Fn(A?f[v]:Je),C=Fe(g);return C}),t.set(v,y)),y!==void 0){var E=te(y);return E===Je?void 0:E}return Reflect.get(f,v,m)},getOwnPropertyDescriptor(f,v){var m=Reflect.getOwnPropertyDescriptor(f,v);if(m&&"value"in m){var y=t.get(v);y&&(m.value=te(y))}else if(m===void 0){var A=t.get(v),E=A?.v;if(A!==void 0&&E!==Je)return{enumerable:!0,configurable:!0,value:E,writable:!0}}return m},has(f,v){if(v===or)return!0;var m=t.get(v),y=m!==void 0&&m.v!==Je||Reflect.has(f,v);if(m!==void 0||ke!==null&&(!y||Lr(f,v)?.writable)){m===void 0&&(m=c(()=>{var E=y?Fn(f[v]):Je,g=Fe(E);return g}),t.set(v,m));var A=te(m);if(A===Je)return!1}return y},set(f,v,m,y){var A=t.get(v),E=v in f;if(r&&v==="length")for(var g=m;g<A.v;g+=1){var C=t.get(g+"");C!==void 0?ie(C,Je):g in f&&(C=c(()=>Fe(Je)),t.set(g+"",C))}if(A===void 0)(!E||Lr(f,v)?.writable)&&(A=c(()=>Fe(void 0)),ie(A,Fn(m)),t.set(v,A));else{E=A.v!==Je;var j=c(()=>Fn(m));ie(A,j)}var F=Reflect.getOwnPropertyDescriptor(f,v);if(F?.set&&F.set.call(y,m),!E){if(r&&typeof v=="string"){var q=t.get("length"),B=Number(v);Number.isInteger(B)&&B>=q.v&&ie(q,B+1)}is(o)}return!0},ownKeys(f){te(o);var v=Reflect.ownKeys(f).filter(A=>{var E=t.get(A);return E===void 0||E.v!==Je});for(var[m,y]of t)y.v!==Je&&!(m in f)&&v.push(m);return v},setPrototypeOf(){kl()}})}var ea,nu,ru,iu;function Kl(){if(ea===void 0){ea=window,nu=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;ru=Lr(e,"firstChild").get,iu=Lr(e,"nextSibling").get,Jo(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Jo(t)&&(t.__t=void 0)}}function Bn(n=""){return document.createTextNode(n)}function Ii(n){return ru.call(n)}function Li(n){return iu.call(n)}function xe(n,e){return Ii(n)}function rn(n,e){{var t=Ii(n);return t instanceof Comment&&t.data===""?Li(t):t}}function Mt(n,e=1,t=!1){let r=n;for(;e--;)r=Li(r);return r}function Yl(n){n.textContent=""}function zs(){return!1}function Gs(n){var e=Ee,t=ke;qt(null),bn(null);try{return n()}finally{qt(e),bn(t)}}function su(n){ke===null&&Ee===null&&bl(),Ee!==null&&(Ee.f&wt)!==0&&ke===null&&wl(),yr&&yl()}function Jl(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Ht(n,e,t,r=!0){var o=ke;o!==null&&(o.f&Lt)!==0&&(n|=Lt);var u={ctx:$e,deps:null,nodes_start:null,nodes_end:null,f:n|bt,first:null,fn:e,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{ur(u),u.f|=Us}catch(v){throw on(u),v}else e!==null&&hr(u);if(r){var c=u;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&qr)===0&&(c=c.first),c!==null&&(c.parent=o,o!==null&&Jl(c,o),Ee!==null&&(Ee.f&vt)!==0&&(n&Nn)===0)){var f=Ee;(f.effects??=[]).push(c)}}return u}function Xl(n){const e=Ht(xi,null,!1);return lt(e,rt),e.teardown=n,e}function ms(n){su();var e=ke.f,t=!Ee&&(e&an)!==0&&(e&Us)===0;if(t){var r=$e;(r.e??=[]).push(n)}else return ou(n)}function ou(n){return Ht(Ds|qa,n,!1)}function Ql(n){return su(),Ht(xi|qa,n,!0)}function Zl(n){cr.ensure();const e=Ht(Nn|qr,n,!0);return(t={})=>new Promise(r=>{t.outro?Fi(e,()=>{on(e),r(void 0)}):(on(e),r(void 0))})}function ec(n){return Ht(Ds,n,!1)}function tc(n){return Ht(Ns|qr,n,!0)}function nc(n,e=0){return Ht(xi|e,n,!0)}function xt(n,e=[],t=[]){Wl(e,t,r=>{Ht(xi,()=>n(...r.map(te)),!0)})}function Ks(n,e=0){var t=Ht(vr|e,n,!0);return t}function dr(n,e=!0){return Ht(an|qr,n,!0,e)}function au(n){var e=n.teardown;if(e!==null){const t=yr,r=Ee;na(!0),qt(null);try{e.call(null)}finally{na(t),qt(r)}}}function uu(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const o=t.ac;o!==null&&Gs(()=>{o.abort(Bs)});var r=t.next;(t.f&Nn)!==0?t.parent=null:on(t,e),t=r}}function rc(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&an)===0&&on(e),e=t}}function on(n,e=!0){var t=!1;(e||(n.f&pl)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(ic(n.nodes_start,n.nodes_end),t=!0),uu(n,e&&!t),Ri(n,0),lt(n,pr);var r=n.transitions;if(r!==null)for(const u of r)u.stop();au(n);var o=n.parent;o!==null&&o.first!==null&&lu(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function ic(n,e){for(;n!==null;){var t=n===e?null:Li(n);n.remove(),n=t}}function lu(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Fi(n,e){var t=[];Ys(n,t,!0),cu(t,()=>{on(n),e&&e()})}function cu(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function Ys(n,e,t){if((n.f&Lt)===0){if(n.f^=Lt,n.transitions!==null)for(const c of n.transitions)(c.is_global||t)&&e.push(c);for(var r=n.first;r!==null;){var o=r.next,u=(r.f&$s)!==0||(r.f&an)!==0;Ys(r,e,u?t:!1),r=o}}}function Js(n){hu(n,!0)}function hu(n,e){if((n.f&Lt)!==0){n.f^=Lt,(n.f&rt)===0&&(lt(n,bt),hr(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&$s)!==0||(t.f&an)!==0;hu(t,o?e:!1),t=r}if(n.transitions!==null)for(const u of n.transitions)(u.is_global||e)&&u.in()}}let ar=!1;function ta(n){ar=n}let yr=!1;function na(n){yr=n}let Ee=null,Vt=!1;function qt(n){Ee=n}let ke=null;function bn(n){ke=n}let sn=null;function sc(n){Ee!==null&&(sn===null?sn=[n]:sn.push(n))}let st=null,ft=0,yt=null;function oc(n){yt=n}let du=1,Br=0,Un=Br;function ra(n){Un=n}let yn=!1;function fu(){return++du}function Di(n){var e=n.f;if((e&bt)!==0)return!0;if((e&An)!==0){var t=n.deps,r=(e&wt)!==0;if(t!==null){var o,u,c=(e&ki)!==0,f=r&&ke!==null&&!yn,v=t.length;if((c||f)&&(ke===null||(ke.f&pr)===0)){var m=n,y=m.parent;for(o=0;o<v;o++)u=t[o],(c||!u?.reactions?.includes(m))&&(u.reactions??=[]).push(m);c&&(m.f^=ki),f&&y!==null&&(y.f&wt)===0&&(m.f^=wt)}for(o=0;o<v;o++)if(u=t[o],Di(u)&&Qa(u),u.wv>n.wv)return!0}(!r||ke!==null&&!yn)&&lt(n,rt)}return!1}function vu(n,e,t=!0){var r=n.reactions;if(r!==null&&!sn?.includes(n))for(var o=0;o<r.length;o++){var u=r[o];(u.f&vt)!==0?vu(u,e,!1):e===u&&(t?lt(u,bt):(u.f&rt)!==0&&lt(u,An),hr(u))}}function pu(n){var e=st,t=ft,r=yt,o=Ee,u=yn,c=sn,f=$e,v=Vt,m=Un,y=n.f;st=null,ft=0,yt=null,yn=(y&wt)!==0&&(Vt||!ar||Ee===null),Ee=(y&(an|Nn))===0?n:null,sn=null,Si(n.ctx),Vt=!1,Un=++Br,n.ac!==null&&(Gs(()=>{n.ac.abort(Bs)}),n.ac=null);try{n.f|=ps;var A=n.fn,E=A(),g=n.deps;if(st!==null){var C;if(Ri(n,ft),g!==null&&ft>0)for(g.length=ft+st.length,C=0;C<st.length;C++)g[ft+C]=st[C];else n.deps=g=st;if(!yn||(y&vt)!==0&&n.reactions!==null)for(C=ft;C<g.length;C++)(g[C].reactions??=[]).push(n)}else g!==null&&ft<g.length&&(Ri(n,ft),g.length=ft);if(_r()&&yt!==null&&!Vt&&g!==null&&(n.f&(vt|An|bt))===0)for(C=0;C<yt.length;C++)vu(yt[C],n);return o!==null&&o!==n&&(Br++,yt!==null&&(r===null?r=yt:r.push(...yt))),(n.f&Dn)!==0&&(n.f^=Dn),E}catch(j){return Dl(j)}finally{n.f^=ps,st=e,ft=t,yt=r,Ee=o,yn=u,sn=c,Si(f),Vt=v,Un=m}}function ac(n,e){let t=e.reactions;if(t!==null){var r=cl.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&(e.f&vt)!==0&&(st===null||!st.includes(e))&&(lt(e,An),(e.f&(wt|ki))===0&&(e.f^=ki),Xa(e),Ri(e,0))}function Ri(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)ac(n,t[r])}function ur(n){var e=n.f;if((e&pr)===0){lt(n,rt);var t=ke,r=ar;ke=n,ar=!0;try{(e&vr)!==0?rc(n):uu(n),au(n);var o=pu(n);n.teardown=typeof o=="function"?o:null,n.wv=du;var u;Ba&&xl&&(n.f&bt)!==0&&n.deps}finally{ar=r,ke=t}}}function te(n){var e=n.f,t=(e&vt)!==0;if(Ee!==null&&!Vt){var r=ke!==null&&(ke.f&pr)!==0;if(!r&&!sn?.includes(n)){var o=Ee.deps;if((Ee.f&ps)!==0)n.rv<Br&&(n.rv=Br,st===null&&o!==null&&o[ft]===n?ft++:st===null?st=[n]:(!yn||!st.includes(n))&&st.push(n));else{(Ee.deps??=[]).push(n);var u=n.reactions;u===null?n.reactions=[Ee]:u.includes(Ee)||u.push(Ee)}}}else if(t&&n.deps===null&&n.effects===null){var c=n,f=c.parent;f!==null&&(f.f&wt)===0&&(c.f^=wt)}if(yr){if(wn.has(n))return wn.get(n);if(t){c=n;var v=c.v;return((c.f&rt)===0&&c.reactions!==null||gu(c))&&(v=qs(c)),wn.set(c,v),v}}else t&&(c=n,Di(c)&&Qa(c));if((n.f&Dn)!==0)throw n.v;return n.v}function gu(n){if(n.v===Je)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(wn.has(e)||(e.f&vt)!==0&&gu(e))return!0;return!1}function Xs(n){var e=Vt;try{return Vt=!0,n()}finally{Vt=e}}const uc=-7169;function lt(n,e){n.f=n.f&uc|e}function lc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(or in n)_s(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&or in t&&_s(t)}}}function _s(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{_s(n[r],e)}catch{}const t=Fs(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Wa(t);for(let o in r){const u=r[o].get;if(u)try{u.call(n)}catch{}}}}}const cc=["touchstart","touchmove"];function hc(n){return cc.includes(n)}const mu=new Set,ys=new Set;function dc(n,e,t,r={}){function o(u){if(r.capture||Mr.call(e,u),!u.cancelBubble)return Gs(()=>t?.call(this,u))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Ya(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function ia(n,e,t,r,o){var u={capture:r,passive:o},c=dc(n,e,t,u);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Xl(()=>{e.removeEventListener(n,c,u)})}function Qs(n){for(var e=0;e<n.length;e++)mu.add(n[e]);for(var t of ys)t(n)}let sa=null;function Mr(n){var e=this,t=e.ownerDocument,r=n.type,o=n.composedPath?.()||[],u=o[0]||n.target;sa=n;var c=0,f=sa===n&&n.__root;if(f){var v=o.indexOf(f);if(v!==-1&&(e===document||e===window)){n.__root=e;return}var m=o.indexOf(e);if(m===-1)return;v<=m&&(c=v)}if(u=o[c]||n.target,u!==e){fs(n,"currentTarget",{configurable:!0,get(){return u||t}});var y=Ee,A=ke;qt(null),bn(null);try{for(var E,g=[];u!==null;){var C=u.assignedSlot||u.parentNode||u.host||null;try{var j=u["__"+r];if(j!=null&&(!u.disabled||n.target===u))if(xs(j)){var[F,...q]=j;F.apply(u,[n,...q])}else j.call(u,n)}catch(B){E?g.push(B):E=B}if(n.cancelBubble||C===e||C===null)break;u=C}if(E){for(let B of g)queueMicrotask(()=>{throw B});throw E}}finally{n.__root=e,delete n.currentTarget,qt(y),bn(A)}}}function fc(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Oi(n,e){var t=ke;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function qe(n,e){var t=(e&Il)!==0,r=(e&Rl)!==0,o,u=!n.startsWith("<!>");return()=>{o===void 0&&(o=fc(u?n:"<!>"+n),t||(o=Ii(o)));var c=r||nu?document.importNode(o,!0):o.cloneNode(!0);if(t){var f=Ii(c),v=c.lastChild;Oi(f,v)}else Oi(c,c);return c}}function pn(n=""){{var e=Bn(n+"");return Oi(e,e),e}}function $n(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Bn();return n.append(e,t),Oi(e,t),n}function be(n,e){n!==null&&n.before(e)}function nn(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function vc(n,e){return pc(n,e)}const Gn=new Map;function pc(n,{target:e,anchor:t,props:r={},events:o,context:u,intro:c=!0}){Kl();var f=new Set,v=A=>{for(var E=0;E<A.length;E++){var g=A[E];if(!f.has(g)){f.add(g);var C=hc(g);e.addEventListener(g,Mr,{passive:C});var j=Gn.get(g);j===void 0?(document.addEventListener(g,Mr,{passive:C}),Gn.set(g,1)):Gn.set(g,j+1)}}};v(Ls(mu)),ys.add(v);var m=void 0,y=Zl(()=>{var A=t??e.appendChild(Bn());return dr(()=>{if(u){gr({});var E=$e;E.c=u}o&&(r.$$events=o),m=n(A,r)||{},u&&mr()}),()=>{for(var E of f){e.removeEventListener(E,Mr);var g=Gn.get(E);--g===0?(document.removeEventListener(E,Mr),Gn.delete(E)):Gn.set(E,g)}ys.delete(v),A!==t&&A.parentNode?.removeChild(A)}});return gc.set(m,y),m}let gc=new WeakMap;function et(n,e,t=!1){var r=n,o=null,u=null,c=Je,f=t?$s:0,v=!1;const m=(g,C=!0)=>{v=!0,E(C,g)};var y=null;function A(){y!==null&&(y.lastChild.remove(),r.before(y),y=null);var g=c?o:u,C=c?u:o;g&&Js(g),C&&Fi(C,()=>{c?u=null:o=null})}const E=(g,C)=>{if(c!==(c=g)){var j=zs(),F=r;if(j&&(y=document.createDocumentFragment(),y.append(F=Bn())),c?o??=C&&dr(()=>C(F)):u??=C&&dr(()=>C(F)),j){var q=Xe,B=c?o:u,D=c?u:o;B&&q.skipped_effects.delete(B),D&&q.skipped_effects.add(D),q.add_callback(A)}else A()}};Ks(()=>{v=!1,e(m),v||E(null,null)},f)}function oa(n,e,t){var r=n,o=Je,u,c,f=null,v=_r()?Ml:za;function m(){u&&Fi(u),f!==null&&(f.lastChild.remove(),r.before(f),f=null),u=c}Ks(()=>{if(v(o,o=e())){var y=r,A=zs();A&&(f=document.createDocumentFragment(),f.append(y=Bn())),c=dr(()=>t(y)),A?Xe.add_callback(m):m()}})}function mc(n,e,t){for(var r=n.items,o=[],u=e.length,c=0;c<u;c++)Ys(e[c].e,o,!0);var f=u>0&&o.length===0&&t!==null;if(f){var v=t.parentNode;Yl(v),v.append(t),r.clear(),Bt(n,e[0].prev,e[u-1].next)}cu(o,()=>{for(var m=0;m<u;m++){var y=e[m];f||(r.delete(y.k),Bt(n,y.prev,y.next)),on(y.e,!f)}})}function _c(n,e,t,r,o,u=null){var c=n,f={flags:e,items:new Map,first:null};{var v=n;c=v.appendChild(Bn())}var m=null,y=!1,A=new Map,E=Ja(()=>{var F=t();return xs(F)?F:F==null?[]:Ls(F)}),g,C;function j(){yc(C,g,f,A,c,o,e,r,t),u!==null&&(g.length===0?m?Js(m):m=dr(()=>u(c)):m!==null&&Fi(m,()=>{m=null}))}Ks(()=>{C??=ke,g=te(E);var F=g.length;if(!(y&&F===0)){y=F===0;var q,B,D,x;if(zs()){var K=new Set,M=Xe;for(B=0;B<F;B+=1){D=g[B],x=r(D,B);var L=f.items.get(x)??A.get(x);L?_u(L,D,B):(q=yu(null,f,null,null,D,x,B,o,e,t,!0),A.set(x,q)),K.add(x)}for(const[ee,X]of f.items)K.has(ee)||M.skipped_effects.add(X.e);M.add_callback(j)}else j();te(E)}})}function yc(n,e,t,r,o,u,c,f,v){var m=e.length,y=t.items,A=t.first,E=A,g,C=null,j=[],F=[],q,B,D,x;for(x=0;x<m;x+=1){if(q=e[x],B=f(q,x),D=y.get(B),D===void 0){var K=r.get(B);if(K!==void 0){r.delete(B),y.set(B,K);var M=C?C.next:E;Bt(t,C,K),Bt(t,K,M),ss(K,M,o),C=K}else{var L=E?E.e.nodes_start:o;C=yu(L,t,C,C===null?t.first:C.next,q,B,x,u,c,v)}y.set(B,C),j=[],F=[],E=C.next;continue}if(_u(D,q,x),(D.e.f&Lt)!==0&&Js(D.e),D!==E){if(g!==void 0&&g.has(D)){if(j.length<F.length){var ee=F[0],X;C=ee.prev;var ae=j[0],z=j[j.length-1];for(X=0;X<j.length;X+=1)ss(j[X],ee,o);for(X=0;X<F.length;X+=1)g.delete(F[X]);Bt(t,ae.prev,z.next),Bt(t,C,ae),Bt(t,z,ee),E=ee,C=z,x-=1,j=[],F=[]}else g.delete(D),ss(D,E,o),Bt(t,D.prev,D.next),Bt(t,D,C===null?t.first:C.next),Bt(t,C,D),C=D;continue}for(j=[],F=[];E!==null&&E.k!==B;)(E.e.f&Lt)===0&&(g??=new Set).add(E),F.push(E),E=E.next;if(E===null)continue;D=E}j.push(D),C=D,E=D.next}if(E!==null||g!==void 0){for(var re=g===void 0?[]:Ls(g);E!==null;)(E.e.f&Lt)===0&&re.push(E),E=E.next;var Ne=re.length;if(Ne>0){var Be=m===0?o:null;mc(t,re,Be)}}n.first=t.first&&t.first.e,n.last=C&&C.e;for(var De of r.values())on(De.e);r.clear()}function _u(n,e,t,r){Pi(n.v,e),n.i=t}function yu(n,e,t,r,o,u,c,f,v,m,y){var A=(v&Cl)!==0,E=(v&Pl)===0,g=A?E?zl(o,!1,!1):Nr(o):o,C=(v&Tl)===0?c:Nr(c),j={i:C,v:g,k:u,a:null,e:null,prev:t,next:r};try{if(n===null){var F=document.createDocumentFragment();F.append(n=Bn())}return j.e=dr(()=>f(n,g,C,m),jl),j.e.prev=t&&t.e,j.e.next=r&&r.e,t===null?y||(e.first=j):(t.next=j,t.e.next=j.e),r!==null&&(r.prev=j,r.e.prev=j.e),j}finally{}}function ss(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,u=n.e.nodes_start;u!==null&&u!==r;){var c=Li(u);o.before(u),u=c}}function Bt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const aa=[...` 	
\r\f \v\uFEFF`];function wc(n,e,t){var r=n==null?"":""+n;if(t){for(var o in t)if(t[o])r=r?r+" "+o:o;else if(r.length)for(var u=o.length,c=0;(c=r.indexOf(o,c))>=0;){var f=c+u;(c===0||aa.includes(r[c-1]))&&(f===r.length||aa.includes(r[f]))?r=(c===0?"":r.substring(0,c))+r.substring(f+1):c=f}}return r===""?null:r}function ua(n,e,t,r,o,u){var c=n.__className;if(c!==t||c===void 0){var f=wc(t,r,u);f==null?n.removeAttribute("class"):n.className=f,n.__className=t}else if(u&&o!==u)for(var v in u){var m=!!u[v];(o==null||m!==!!o[v])&&n.classList.toggle(v,m)}return u}const bc=Symbol("is custom element"),Ac=Symbol("is html");function la(n,e,t,r){var o=Ec(n);o[e]!==(o[e]=t)&&(t==null?n.removeAttribute(e):typeof t!="string"&&kc(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Ec(n){return n.__attributes??={[bc]:n.nodeName.includes("-"),[Ac]:n.namespaceURI===Ol}}var ca=new Map;function kc(n){var e=n.getAttribute("is")||n.nodeName,t=ca.get(e);if(t)return t;ca.set(e,t=[]);for(var r,o=n,u=Element.prototype;u!==o;){r=Wa(o);for(var c in r)r[c].set&&t.push(c);o=Fs(o)}return t}function ha(n,e){return n===e||n?.[or]===e}function Sc(n={},e,t,r){return ec(()=>{var o,u;return nc(()=>{o=u,u=[],Xs(()=>{n!==t(...u)&&(e(n,...u),o&&ha(t(...o),n)&&e(null,...o))})}),()=>{Ya(()=>{u&&ha(t(...u),n)&&e(null,...u)})}}),n}function Cc(n=!1){const e=$e,t=e.l.u;if(!t)return;let r=()=>lc(e.s);if(n){let o=0,u={};const c=Vs(()=>{let f=!1;const v=e.s;for(const m in v)v[m]!==u[m]&&(u[m]=v[m],f=!0);return f&&o++,o});r=()=>te(c)}t.b.length&&Ql(()=>{da(e,r),vs(t.b)}),ms(()=>{const o=Xs(()=>t.m.map(fl));return()=>{for(const u of o)typeof u=="function"&&u()}}),t.a.length&&ms(()=>{da(e,r),vs(t.a)})}function da(n,e){if(n.l.s)for(const t of n.l.s)te(t);e()}function Wr(n){$e===null&&ml(),Hr&&$e.l!==null?Tc($e).m.push(n):ms(()=>{const e=Xs(n);if(typeof e=="function")return e})}function Tc(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const Pc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Pc);Ll();function Ic(){return!!(navigator.platform.substr(0,2)==="iP"&&window.webkit&&window.webkit.messageHandlers)}function Rc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Oc(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var o=!1;try{o=this instanceof r}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var Ei={exports:{}},jc=Ei.exports,fa;function Mc(){return fa||(fa=1,(function(n,e){(function(r,o){n.exports=o()})(jc,()=>(()=>{var t=[,((c,f,v)=>{v.r(f),v.d(f,{default:()=>y});var m=(()=>{var A=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(E={}){var g=E,C,j;g.ready=new Promise((i,s)=>{C=i,j=s});function F(){function i(k){const I=d;l=s=0,d=new Map,I.forEach(R=>{try{R(k)}catch(P){console.error(P)}}),this.pb(),_&&_.Tb()}let s=0,l=0,d=new Map,_=null,b=null;this.requestAnimationFrame=function(k){s||(s=requestAnimationFrame(i.bind(this)));const I=++l;return d.set(I,k),I},this.cancelAnimationFrame=function(k){d.delete(k),s&&d.size==0&&(cancelAnimationFrame(s),s=0)},this.Rb=function(k){b&&(document.body.remove(b),b=null),k||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",k=function(I){b.innerHTML="RIVE FPS "+I.toFixed(1)},document.body.appendChild(b)),_=new function(){let I=0,R=0;this.Tb=function(){var P=performance.now();R?(++I,P-=R,1e3<P&&(k(1e3*I/P),I=R=0)):(R=P,I=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),_=null},this.pb=function(){}}function q(i){console.assert(!0);const s=new Map;let l=-1/0;this.push=function(d){return d=d+((1<<i)-1)>>i,s.has(d)&&clearTimeout(s.get(d)),s.set(d,setTimeout(function(){s.delete(d),s.length==0?l=-1/0:d==l&&(l=Math.max(...s.keys()),console.assert(l<d))},1e3)),l=Math.max(d,l),l<<i}}const B=g.onRuntimeInitialized;g.onRuntimeInitialized=function(){B&&B();let i=g.decodeAudio;g.decodeAudio=function(_,b){_=i(_),b(_)};let s=g.decodeFont;g.decodeFont=function(_,b){_=s(_),b(_)};const l=g.FileAssetLoader;g.ptrToAsset=_=>{let b=g.ptrToFileAsset(_);return b.isImage?g.ptrToImageAsset(_):b.isFont?g.ptrToFontAsset(_):b.isAudio?g.ptrToAudioAsset(_):b},g.CustomFileAssetLoader=l.extend("CustomFileAssetLoader",{__construct:function({loadContents:_}){this.__parent.__construct.call(this),this.Gb=_},loadContents:function(_,b){return _=g.ptrToAsset(_),this.Gb(_,b)}}),g.CDNFileAssetLoader=l.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(_){let b=g.ptrToAsset(_);return _=b.cdnUuid,_===""?!1:((function(k,I){var R=new XMLHttpRequest;R.responseType="arraybuffer",R.onreadystatechange=function(){R.readyState==4&&R.status==200&&I(R)},R.open("GET",k,!0),R.send(null)})(b.cdnBaseUrl+"/"+_,k=>{b.decode(new Uint8Array(k.response))}),!0)}}),g.FallbackFileAssetLoader=l.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(_){this.lb.push(_)},loadContents:function(_,b){for(let k of this.lb)if(k.loadContents(_,b))return!0;return!1}});let d=g.computeAlignment;g.computeAlignment=function(_,b,k,I,R=1){return d.call(this,_,b,k,I,R)}};const D="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),x=new function(){function i(){if(!s){let he=function(fe,G,Oe){if(G=N.createShader(G),N.shaderSource(G,Oe),N.compileShader(G),Oe=N.getShaderInfoLog(G),0<(Oe||"").length)throw Oe;N.attachShader(fe,G)};var S=document.createElement("canvas"),W={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let N;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(N=S.getContext("webgl",W),l=1,!N)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(N=S.getContext("webgl2",W))l=2;else if(N=S.getContext("webgl",W))l=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(N=new Proxy(N,{get(fe,G){if(fe.isContextLost()){if(R||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",G),R=!0),typeof fe[G]=="function")return function(){}}else return typeof fe[G]=="function"?function(...Oe){return fe[G].apply(fe,Oe)}:fe[G]},set(fe,G,Oe){if(fe.isContextLost())R||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+G),R=!0);else return fe[G]=Oe,!0}}),d=Math.min(N.getParameter(N.MAX_RENDERBUFFER_SIZE),N.getParameter(N.MAX_TEXTURE_SIZE)),S=N.createProgram(),he(S,N.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),he(S,N.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),N.bindAttribLocation(S,0,"vertex"),N.bindAttribLocation(S,1,"uv"),N.linkProgram(S),W=N.getProgramInfoLog(S),0<(W||"").trim().length)throw W;_=N.getUniformLocation(S,"mat"),b=N.getUniformLocation(S,"translate"),N.useProgram(S),N.bindBuffer(N.ARRAY_BUFFER,N.createBuffer()),N.enableVertexAttribArray(0),N.enableVertexAttribArray(1),N.bindBuffer(N.ELEMENT_ARRAY_BUFFER,N.createBuffer()),N.uniform1i(N.getUniformLocation(S,"image"),0),N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s=N}return!0}let s=null,l=0,d=0,_=null,b=null,k=0,I=0,R=!1;i(),this.hc=function(){return i(),d},this.Mb=function(S){s.deleteTexture&&s.deleteTexture(S)},this.Lb=function(S){if(!i())return null;const W=s.createTexture();return W?(s.bindTexture(s.TEXTURE_2D,W),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,S),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),l==2?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.generateMipmap(s.TEXTURE_2D)):s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),W):null};const P=new q(8),V=new q(8),H=new q(10),J=new q(10);this.Qb=function(S,W,N,he,fe){if(i()){var G=P.push(S),Oe=V.push(W);if(s.canvas){(s.canvas.width!=G||s.canvas.height!=Oe)&&(s.canvas.width=G,s.canvas.height=Oe),s.viewport(0,Oe-W,S,W),s.disable(s.SCISSOR_TEST),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.SCISSOR_TEST),N.sort((ye,Nt)=>Nt.xb-ye.xb),G=H.push(he),k!=G&&(s.bufferData(s.ARRAY_BUFFER,8*G,s.DYNAMIC_DRAW),k=G),G=0;for(var Ze of N)s.bufferSubData(s.ARRAY_BUFFER,G,Ze.Ua),G+=4*Ze.Ua.length;console.assert(G==4*he);for(var $t of N)s.bufferSubData(s.ARRAY_BUFFER,G,$t.Db),G+=4*$t.Db.length;console.assert(G==8*he),G=J.push(fe),I!=G&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,2*G,s.DYNAMIC_DRAW),I=G),Ze=0;for(var Pn of N)s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,Ze,Pn.indices),Ze+=2*Pn.indices.length;console.assert(Ze==2*fe),Pn=0,$t=!0,G=Ze=0;for(const ye of N){ye.image.Ka!=Pn&&(s.bindTexture(s.TEXTURE_2D,ye.image.Ja||null),Pn=ye.image.Ka),ye.mc?(s.scissor(ye.Za,Oe-ye.$a-ye.kb,ye.Ac,ye.kb),$t=!0):$t&&(s.scissor(0,Oe-W,S,W),$t=!1),N=2/S;const Nt=-2/W;s.uniform4f(_,ye.ha[0]*N*ye.Ba,ye.ha[1]*Nt*ye.Ca,ye.ha[2]*N*ye.Ba,ye.ha[3]*Nt*ye.Ca),s.uniform2f(b,ye.ha[4]*N*ye.Ba+N*(ye.Za-ye.ic*ye.Ba)-1,ye.ha[5]*Nt*ye.Ca+Nt*(ye.$a-ye.jc*ye.Ca)+1),s.vertexAttribPointer(0,2,s.FLOAT,!1,0,G),s.vertexAttribPointer(1,2,s.FLOAT,!1,0,G+4*he),s.drawElements(s.TRIANGLES,ye.indices.length,s.UNSIGNED_SHORT,Ze),G+=4*ye.Ua.length,Ze+=2*ye.indices.length}console.assert(G==4*he),console.assert(Ze==2*fe)}}},this.canvas=function(){return i()&&s.canvas}},K=g.onRuntimeInitialized;g.onRuntimeInitialized=function(){function i(U){switch(U){case P.srcOver:return"source-over";case P.screen:return"screen";case P.overlay:return"overlay";case P.darken:return"darken";case P.lighten:return"lighten";case P.colorDodge:return"color-dodge";case P.colorBurn:return"color-burn";case P.hardLight:return"hard-light";case P.softLight:return"soft-light";case P.difference:return"difference";case P.exclusion:return"exclusion";case P.multiply:return"multiply";case P.hue:return"hue";case P.saturation:return"saturation";case P.color:return"color";case P.luminosity:return"luminosity"}}function s(U){return"rgba("+((16711680&U)>>>16)+","+((65280&U)>>>8)+","+((255&U)>>>0)+","+((4278190080&U)>>>24)/255+")"}function l(){0<Oe.length&&(x.Qb(G.drawWidth(),G.drawHeight(),Oe,Ze,$t),Oe=[],$t=Ze=0,G.reset(512,512));for(const U of fe){for(const Y of U.H)Y();U.H=[]}fe.clear()}K&&K();var d=g.RenderPaintStyle;const _=g.RenderPath,b=g.RenderPaint,k=g.Renderer,I=g.StrokeCap,R=g.StrokeJoin,P=g.BlendMode,V=d.fill,H=d.stroke,J=g.FillRule.evenOdd;let S=1;var W=g.RenderImage.extend("CanvasRenderImage",{__construct:function({la:U,xa:Y}={}){this.__parent.__construct.call(this),this.Ka=S,S=S+1&2147483647||1,this.la=U,this.xa=Y},__destruct:function(){this.Ja&&(x.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(U){var Y=this;Y.xa&&Y.xa(Y);var ge=new Image;Y.Xa=URL.createObjectURL(new Blob([U],{type:"image/png"})),ge.onload=function(){Y.Fb=ge,Y.Ja=x.Lb(ge),Y.size(ge.width,ge.height),Y.la&&Y.la(Y)},ge.src=Y.Xa}}),N=_.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(U,Y,ge,we,de,_e,Te){var Pe=this.T,Rt=Pe.addPath;U=U.T;const Ge=new DOMMatrix;Ge.a=Y,Ge.b=ge,Ge.c=we,Ge.d=de,Ge.e=_e,Ge.f=Te,Rt.call(Pe,U,Ge)},fillRule:function(U){this.Wa=U},moveTo:function(U,Y){this.T.moveTo(U,Y)},lineTo:function(U,Y){this.T.lineTo(U,Y)},cubicTo:function(U,Y,ge,we,de,_e){this.T.bezierCurveTo(U,Y,ge,we,de,_e)},close:function(){this.T.closePath()}}),he=b.extend("CanvasRenderPaint",{color:function(U){this.Ya=s(U)},thickness:function(U){this.Ib=U},join:function(U){switch(U){case R.miter:this.Ia="miter";break;case R.round:this.Ia="round";break;case R.bevel:this.Ia="bevel"}},cap:function(U){switch(U){case I.butt:this.Ha="butt";break;case I.round:this.Ha="round";break;case I.square:this.Ha="square"}},style:function(U){this.Hb=U},blendMode:function(U){this.Eb=i(U)},clearGradient:function(){this.ja=null},linearGradient:function(U,Y,ge,we){this.ja={zb:U,Ab:Y,cb:ge,eb:we,Ra:[]}},radialGradient:function(U,Y,ge,we){this.ja={zb:U,Ab:Y,cb:ge,eb:we,Ra:[],ec:!0}},addStop:function(U,Y){this.ja.Ra.push({color:U,stop:Y})},completeGradient:function(){},draw:function(U,Y,ge){let we=this.Hb;var de=this.Ya,_e=this.ja;if(U.globalCompositeOperation=this.Eb,_e!=null){de=_e.zb;var Te=_e.Ab;const Rt=_e.cb;var Pe=_e.eb;const Ge=_e.Ra;_e.ec?(_e=Rt-de,Pe-=Te,de=U.createRadialGradient(de,Te,0,de,Te,Math.sqrt(_e*_e+Pe*Pe))):de=U.createLinearGradient(de,Te,Rt,Pe);for(let _t=0,Ke=Ge.length;_t<Ke;_t++)Te=Ge[_t],de.addColorStop(Te.stop,s(Te.color));this.Ya=de,this.ja=null}switch(we){case H:U.strokeStyle=de,U.lineWidth=this.Ib,U.lineCap=this.Ha,U.lineJoin=this.Ia,U.stroke(Y);break;case V:U.fillStyle=de,U.fill(Y,ge)}}});const fe=new Set;let G=null,Oe=[],Ze=0,$t=0;var Pn=g.CanvasRenderer=k.extend("Renderer",{__construct:function(U){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=U.getContext("2d"),this.Va=U,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const U=this.S.length-6;if(6>U)throw"restore() called without matching save().";this.S.splice(U),this.H.push(this.C.restore.bind(this.C))},transform:function(U,Y,ge,we,de,_e){const Te=this.S,Pe=Te.length-6;Te.splice(Pe,6,Te[Pe]*U+Te[Pe+2]*Y,Te[Pe+1]*U+Te[Pe+3]*Y,Te[Pe]*ge+Te[Pe+2]*we,Te[Pe+1]*ge+Te[Pe+3]*we,Te[Pe]*de+Te[Pe+2]*_e+Te[Pe+4],Te[Pe+1]*de+Te[Pe+3]*_e+Te[Pe+5]),this.H.push(this.C.transform.bind(this.C,U,Y,ge,we,de,_e))},rotate:function(U){const Y=Math.sin(U);U=Math.cos(U),this.transform(U,Y,-Y,U,0,0)},_drawPath:function(U,Y){this.H.push(Y.draw.bind(Y,this.C,U.T,U.Wa===J?"evenodd":"nonzero"))},_drawRiveImage:function(U,Y,ge,we){var de=U.Fb;if(de){var _e=this.C,Te=i(ge);this.H.push(function(){_e.globalCompositeOperation=Te,_e.globalAlpha=we,_e.drawImage(de,0,0),_e.globalAlpha=1})}},_getMatrix:function(U){const Y=this.S,ge=Y.length-6;for(let we=0;6>we;++we)U[we]=Y[ge+we]},_drawImageMesh:function(U,Y,ge,we,de,_e,Te,Pe,Rt,Ge,_t){Y=this.C.canvas.width;var Ke=this.C.canvas.height;const Ho=Ge-Pe,zo=_t-Rt;Pe=Math.max(Pe,0),Rt=Math.max(Rt,0),Ge=Math.min(Ge,Y),_t=Math.min(_t,Ke);const Or=Ge-Pe,jr=_t-Rt;if(console.assert(Or<=Math.min(Ho,Y)),console.assert(jr<=Math.min(zo,Ke)),!(0>=Or||0>=jr)){Ge=Or<Ho||jr<zo,Y=_t=1;var In=Math.ceil(Or*_t),Rn=Math.ceil(jr*Y);Ke=x.hc(),In>Ke&&(_t*=Ke/In,In=Ke),Rn>Ke&&(Y*=Ke/Rn,Rn=Ke),G||(G=new g.DynamicRectanizer(Ke),G.reset(512,512)),Ke=G.addRect(In,Rn),0>Ke&&(l(),fe.add(this),Ke=G.addRect(In,Rn),console.assert(0<=Ke));var Go=Ke&65535,Ko=Ke>>16;Oe.push({ha:this.S.slice(this.S.length-6),image:U,Za:Go,$a:Ko,ic:Pe,jc:Rt,Ac:In,kb:Rn,Ba:_t,Ca:Y,Ua:new Float32Array(de),Db:new Float32Array(_e),indices:new Uint16Array(Te),mc:Ge,xb:U.Ka<<1|(Ge?1:0)}),Ze+=de.length,$t+=Te.length;var zn=this.C,ll=i(ge);this.H.push(function(){zn.save(),zn.resetTransform(),zn.globalCompositeOperation=ll,zn.globalAlpha=we;const Yo=x.canvas();Yo&&zn.drawImage(Yo,Go,Ko,In,Rn,Pe,Rt,Or,jr),zn.restore()})}},_clipPath:function(U){this.H.push(this.C.clip.bind(this.C,U.T,U.Wa===J?"evenodd":"nonzero"))},clear:function(){fe.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(U,Y){this.transform(1,0,0,1,U,Y)}});g.makeRenderer=function(U){const Y=new Pn(U),ge=Y.C;return new Proxy(Y,{get(we,de){if(typeof we[de]=="function")return function(..._e){return we[de].apply(we,_e)};if(typeof ge[de]=="function"){if(-1<D.indexOf(de))throw Error("RiveException: Method call to '"+de+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(..._e){Y.H.push(ge[de].bind(ge,..._e))}}return we[de]},set(we,de,_e){if(de in ge)return Y.H.push(()=>{ge[de]=_e}),!0}})},g.decodeImage=function(U,Y){new W({la:Y}).decode(U)},g.renderFactory={makeRenderPaint:function(){return new he},makeRenderPath:function(){return new N},makeRenderImage:function(){let U=Nt;return new W({xa:()=>{U.total++},la:()=>{if(U.loaded++,U.loaded===U.total){const Y=U.ready;Y&&(Y(),U.ready=null)}}})}};let ye=g.load,Nt=null;g.load=function(U,Y,ge=!0){const we=new g.FallbackFileAssetLoader;return Y!==void 0&&we.addLoader(Y),ge&&(Y=new g.CDNFileAssetLoader,we.addLoader(Y)),new Promise(function(de){let _e=null;Nt={total:0,loaded:0,ready:function(){de(_e)}},_e=ye(U,we),Nt.total==0&&de(_e)})};let ul=g.RendererWrapper.prototype.align;g.RendererWrapper.prototype.align=function(U,Y,ge,we,de=1){ul.call(this,U,Y,ge,we,de)},d=new F,g.requestAnimationFrame=d.requestAnimationFrame.bind(d),g.cancelAnimationFrame=d.cancelAnimationFrame.bind(d),g.enableFPSCounter=d.Rb.bind(d),g.disableFPSCounter=d.Ob,d.pb=l,g.resolveAnimationFrame=l,g.cleanup=function(){G&&G.delete()}};var M=Object.assign({},g),L="./this.program",ee=typeof window=="object",X=typeof importScripts=="function",ae="",z,re;(ee||X)&&(X?ae=self.location.href:typeof document<"u"&&document.currentScript&&(ae=document.currentScript.src),A&&(ae=A),ae.indexOf("blob:")!==0?ae=ae.substr(0,ae.replace(/[?#].*/,"").lastIndexOf("/")+1):ae="",X&&(re=i=>{var s=new XMLHttpRequest;return s.open("GET",i,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),z=(i,s,l)=>{var d=new XMLHttpRequest;d.open("GET",i,!0),d.responseType="arraybuffer",d.onload=()=>{d.status==200||d.status==0&&d.response?s(d.response):l()},d.onerror=l,d.send(null)});var Ne=g.print||console.log.bind(console),Be=g.printErr||console.error.bind(console);Object.assign(g,M),M=null,g.thisProgram&&(L=g.thisProgram);var De;g.wasmBinary&&(De=g.wasmBinary),g.noExitRuntime,typeof WebAssembly!="object"&&ln("no native wasm support detected");var At,se,tt=!1,He,Me,Qe,Et,me,Se,kt,Ie;function ct(){var i=At.buffer;g.HEAP8=He=new Int8Array(i),g.HEAP16=Qe=new Int16Array(i),g.HEAP32=me=new Int32Array(i),g.HEAPU8=Me=new Uint8Array(i),g.HEAPU16=Et=new Uint16Array(i),g.HEAPU32=Se=new Uint32Array(i),g.HEAPF32=kt=new Float32Array(i),g.HEAPF64=Ie=new Float64Array(i)}var Ue,zt=[],un=[],Gt=[];function kn(){var i=g.preRun.shift();zt.unshift(i)}var ot=0,St=null;function ln(i){throw g.onAbort&&g.onAbort(i),i="Aborted("+i+")",Be(i),tt=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),j(i),i}function br(i){return i.startsWith("data:application/octet-stream;base64,")}var Kt;if(Kt="canvas_advanced.wasm",!br(Kt)){var Kr=Kt;Kt=g.locateFile?g.locateFile(Kr,ae):ae+Kr}function ht(i){if(i==Kt&&De)return new Uint8Array(De);if(re)return re(i);throw"both async and sync fetching of the wasm failed"}function $i(i){if(!De&&(ee||X)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(s=>{if(!s.ok)throw"failed to load wasm binary file at '"+i+"'";return s.arrayBuffer()}).catch(()=>ht(i));if(z)return new Promise((s,l)=>{z(i,d=>s(new Uint8Array(d)),l)})}return Promise.resolve().then(()=>ht(i))}function Yr(i,s,l){return $i(i).then(d=>WebAssembly.instantiate(d,s)).then(d=>d).then(l,d=>{Be("failed to asynchronously prepare wasm: "+d),ln(d)})}function Ni(i,s){var l=Kt;return De||typeof WebAssembly.instantiateStreaming!="function"||br(l)||l.startsWith("file://")||typeof fetch!="function"?Yr(l,i,s):fetch(l,{credentials:"same-origin"}).then(d=>WebAssembly.instantiateStreaming(d,i).then(s,function(_){return Be("wasm streaming compile failed: "+_),Be("falling back to ArrayBuffer instantiation"),Yr(l,i,s)}))}var cn,p,a={460492:(i,s,l,d,_)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=s,window.h.I.La=l,window.h.ga={},window.h.ga.stopped=d,window.h.ga.yb=_;let b=window.h;b.D=[],b.yc=function(k){for(var I=0;I<b.D.length;++I)if(b.D[I]==null)return b.D[I]=k,I;return b.D.push(k),b.D.length-1},b.Cb=function(k){for(b.D[k]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(k){for(var I=0;I<b.D.length;++I)if(b.D[I]==k)return b.Cb(I)},b.ra=function(k){return b.D[k]},b.Ta=["touchend","click"],b.unlock=function(){for(var k=0;k<b.D.length;++k){var I=b.D[k];I!=null&&I.J!=null&&I.state===b.ga.yb&&I.J.resume().then(()=>{No(I.qb)},R=>{console.error("Failed to resume audiocontext",R)})}b.Ta.map(function(R){document.removeEventListener(R,b.unlock,!0)})},b.Ta.map(function(k){document.addEventListener(k,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),s=i.sampleRate;return i.close(),s}catch{return 0}},463249:(i,s,l,d,_,b)=>{if(typeof window.h>"u")return-1;var k={},I={};return i==window.h.I.ya&&l!=0&&(I.sampleRate=l),k.J=new(window.AudioContext||window.webkitAudioContext)(I),k.J.suspend(),k.state=window.h.ga.stopped,l=0,i!=window.h.I.ya&&(l=s),k.Z=k.J.createScriptProcessor(d,l,s),k.Z.onaudioprocess=function(R){if((k.sa==null||k.sa.length==0)&&(k.sa=new Float32Array(kt.buffer,_,d*s)),i==window.h.I.capture||i==window.h.I.La){for(var P=0;P<s;P+=1)for(var V=R.inputBuffer.getChannelData(P),H=k.sa,J=0;J<d;J+=1)H[J*s+P]=V[J];Bo(b,d,_)}if(i==window.h.I.ya||i==window.h.I.La)for(Wo(b,d,_),P=0;P<R.outputBuffer.numberOfChannels;++P)for(V=R.outputBuffer.getChannelData(P),H=k.sa,J=0;J<d;J+=1)V[J]=H[J*s+P];else for(P=0;P<R.outputBuffer.numberOfChannels;++P)R.outputBuffer.getChannelData(P).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(R){k.Da=k.J.createMediaStreamSource(R),k.Da.connect(k.Z),k.Z.connect(k.J.destination)}).catch(function(R){console.log("Failed to get user media: "+R)}),i==window.h.I.ya&&k.Z.connect(k.J.destination),k.qb=b,window.h.yc(k)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},h=i=>{for(;0<i.length;)i.shift()(g)},w=(i,s)=>{for(var l=0,d=i.length-1;0<=d;d--){var _=i[d];_==="."?i.splice(d,1):_===".."?(i.splice(d,1),l++):l&&(i.splice(d,1),l--)}if(s)for(;l;l--)i.unshift("..");return i},T=i=>{var s=i.charAt(0)==="/",l=i.substr(-1)==="/";return(i=w(i.split("/").filter(d=>!!d),!s).join("/"))||s||(i="."),i&&l&&(i+="/"),(s?"/":"")+i},O=i=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=s[0],s=s[1],!i&&!s?".":(s&&(s=s.substr(0,s.length-1)),i+s)},$=i=>{if(i==="/")return"/";i=T(i),i=i.replace(/\/$/,"");var s=i.lastIndexOf("/");return s===-1?i:i.substr(s+1)},ne=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);ln("initRandomDevice")},ue=i=>(ue=ne())(i);function Z(){for(var i="",s=!1,l=arguments.length-1;-1<=l&&!s;l--){if(s=0<=l?arguments[l]:"/",typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";i=s+"/"+i,s=s.charAt(0)==="/"}return i=w(i.split("/").filter(d=>!!d),!s).join("/"),(s?"/":"")+i||"."}var ve=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ce=(i,s,l)=>{var d=s+l;for(l=s;i[l]&&!(l>=d);)++l;if(16<l-s&&i.buffer&&ve)return ve.decode(i.subarray(s,l));for(d="";s<l;){var _=i[s++];if(_&128){var b=i[s++]&63;if((_&224)==192)d+=String.fromCharCode((_&31)<<6|b);else{var k=i[s++]&63;_=(_&240)==224?(_&15)<<12|b<<6|k:(_&7)<<18|b<<12|k<<6|i[s++]&63,65536>_?d+=String.fromCharCode(_):(_-=65536,d+=String.fromCharCode(55296|_>>10,56320|_&1023))}}else d+=String.fromCharCode(_)}return d},ze=[],je=i=>{for(var s=0,l=0;l<i.length;++l){var d=i.charCodeAt(l);127>=d?s++:2047>=d?s+=2:55296<=d&&57343>=d?(s+=4,++l):s+=3}return s},Ct=(i,s,l,d)=>{if(!(0<d))return 0;var _=l;d=l+d-1;for(var b=0;b<i.length;++b){var k=i.charCodeAt(b);if(55296<=k&&57343>=k){var I=i.charCodeAt(++b);k=65536+((k&1023)<<10)|I&1023}if(127>=k){if(l>=d)break;s[l++]=k}else{if(2047>=k){if(l+1>=d)break;s[l++]=192|k>>6}else{if(65535>=k){if(l+2>=d)break;s[l++]=224|k>>12}else{if(l+3>=d)break;s[l++]=240|k>>18,s[l++]=128|k>>12&63}s[l++]=128|k>>6&63}s[l++]=128|k&63}}return s[l]=0,l-_};function pt(i,s){var l=Array(je(i)+1);return i=Ct(i,l,0,l.length),s&&(l.length=i),l}var at=[];function ut(i,s){at[i]={input:[],F:[],V:s},Wi(i,gt)}var gt={open:function(i){var s=at[i.node.za];if(!s)throw new Q(43);i.s=s,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,s,l,d){if(!i.s||!i.s.V.jb)throw new Q(60);for(var _=0,b=0;b<d;b++){try{var k=i.s.V.jb(i.s)}catch{throw new Q(29)}if(k===void 0&&_===0)throw new Q(6);if(k==null)break;_++,s[l+b]=k}return _&&(i.node.timestamp=Date.now()),_},write:function(i,s,l,d){if(!i.s||!i.s.V.Oa)throw new Q(60);try{for(var _=0;_<d;_++)i.s.V.Oa(i.s,s[l+_])}catch{throw new Q(29)}return d&&(i.node.timestamp=Date.now()),_}},hn={jb:function(){e:{if(!ze.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}ze=pt(i,!0)}i=ze.shift()}return i},Oa:function(i,s){s===null||s===10?(Ne(Ce(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Ne(Ce(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},dn={Oa:function(i,s){s===null||s===10?(Be(Ce(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Be(Ce(i.F,0)),i.F=[])}};function Ft(i,s){var l=i.j?i.j.length:0;l>=s||(s=Math.max(s,l*(1048576>l?2:1.125)>>>0),l!=0&&(s=Math.max(s,256)),l=i.j,i.j=new Uint8Array(s),0<i.v&&i.j.set(l.subarray(0,i.v),0))}var oe={O:null,U(){return oe.createNode(null,"/",16895,0)},createNode(i,s,l,d){if((l&61440)===24576||(l&61440)===4096)throw new Q(63);return oe.O||(oe.O={dir:{node:{Y:oe.l.Y,P:oe.l.P,ka:oe.l.ka,va:oe.l.va,vb:oe.l.vb,Bb:oe.l.Bb,wb:oe.l.wb,tb:oe.l.tb,Ea:oe.l.Ea},stream:{ba:oe.m.ba}},file:{node:{Y:oe.l.Y,P:oe.l.P},stream:{ba:oe.m.ba,read:oe.m.read,write:oe.m.write,pa:oe.m.pa,mb:oe.m.mb,ob:oe.m.ob}},link:{node:{Y:oe.l.Y,P:oe.l.P,ma:oe.l.ma},stream:{}},ab:{node:{Y:oe.l.Y,P:oe.l.P},stream:Nu}}),l=uo(i,s,l,d),(l.mode&61440)===16384?(l.l=oe.O.dir.node,l.m=oe.O.dir.stream,l.j={}):(l.mode&61440)===32768?(l.l=oe.O.file.node,l.m=oe.O.file.stream,l.v=0,l.j=null):(l.mode&61440)===40960?(l.l=oe.O.link.node,l.m=oe.O.link.stream):(l.mode&61440)===8192&&(l.l=oe.O.ab.node,l.m=oe.O.ab.stream),l.timestamp=Date.now(),i&&(i.j[s]=l,i.timestamp=l.timestamp),l},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var s={};return s.Jc=(i.mode&61440)===8192?i.id:1,s.Mc=i.id,s.mode=i.mode,s.Oc=1,s.uid=0,s.Lc=0,s.za=i.za,(i.mode&61440)===16384?s.size=4096:(i.mode&61440)===32768?s.size=i.v:(i.mode&61440)===40960?s.size=i.link.length:s.size=0,s.Bc=new Date(i.timestamp),s.Nc=new Date(i.timestamp),s.Ic=new Date(i.timestamp),s.Jb=4096,s.Cc=Math.ceil(s.size/s.Jb),s},P(i,s){if(s.mode!==void 0&&(i.mode=s.mode),s.timestamp!==void 0&&(i.timestamp=s.timestamp),s.size!==void 0&&(s=s.size,i.v!=s))if(s==0)i.j=null,i.v=0;else{var l=i.j;i.j=new Uint8Array(s),l&&i.j.set(l.subarray(0,Math.min(s,i.v))),i.v=s}},ka(){throw Bi[44]},va(i,s,l,d){return oe.createNode(i,s,l,d)},vb(i,s,l){if((i.mode&61440)===16384){try{var d=Xr(s,l)}catch{}if(d)for(var _ in d.j)throw new Q(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=l,s.j[l]=i,s.timestamp=i.parent.timestamp,i.parent=s},Bb(i,s){delete i.j[s],i.timestamp=Date.now()},wb(i,s){var l=Xr(i,s),d;for(d in l.j)throw new Q(55);delete i.j[s],i.timestamp=Date.now()},tb(i){var s=[".",".."],l;for(l in i.j)i.j.hasOwnProperty(l)&&s.push(l);return s},Ea(i,s,l){return i=oe.createNode(i,s,41471,0),i.link=l,i},ma(i){if((i.mode&61440)!==40960)throw new Q(28);return i.link}},m:{read(i,s,l,d,_){var b=i.node.j;if(_>=i.node.v)return 0;if(i=Math.min(i.node.v-_,d),8<i&&b.subarray)s.set(b.subarray(_,_+i),l);else for(d=0;d<i;d++)s[l+d]=b[_+d];return i},write(i,s,l,d,_,b){if(s.buffer===He.buffer&&(b=!1),!d)return 0;if(i=i.node,i.timestamp=Date.now(),s.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=s.subarray(l,l+d),i.v=d;if(i.v===0&&_===0)return i.j=s.slice(l,l+d),i.v=d;if(_+d<=i.v)return i.j.set(s.subarray(l,l+d),_),d}if(Ft(i,_+d),i.j.subarray&&s.subarray)i.j.set(s.subarray(l,l+d),_);else for(b=0;b<d;b++)i.j[_+b]=s[l+b];return i.v=Math.max(i.v,_+d),d},ba(i,s,l){if(l===1?s+=i.position:l===2&&(i.node.mode&61440)===32768&&(s+=i.node.v),0>s)throw new Q(28);return s},pa(i,s,l){Ft(i.node,s+l),i.node.v=Math.max(i.node.v,s+l)},mb(i,s,l,d,_){if((i.node.mode&61440)!==32768)throw new Q(43);if(i=i.node.j,_&2||i.buffer!==He.buffer){if((0<l||l+s<i.length)&&(i.subarray?i=i.subarray(l,l+s):i=Array.prototype.slice.call(i,l,l+s)),l=!0,ln(),s=void 0,!s)throw new Q(48);He.set(i,s)}else l=!1,s=i.byteOffset;return{o:s,M:l}},ob(i,s,l,d){return oe.m.write(i,s,0,d,l,!1),0}}};function Ae(i,s){var l=0;return i&&(l|=365),s&&(l|=146),l}var Dt=null,io={},Jr=[],Uu=1,Ar=null,so=!0,Q=null,Bi={},Sn=(i,s={})=>{if(i=Z(i),!i)return{path:"",node:null};if(s=Object.assign({hb:!0,Qa:0},s),8<s.Qa)throw new Q(32);i=i.split("/").filter(k=>!!k);for(var l=Dt,d="/",_=0;_<i.length;_++){var b=_===i.length-1;if(b&&s.parent)break;if(l=Xr(l,i[_]),d=T(d+"/"+i[_]),l.wa&&(!b||b&&s.hb)&&(l=l.wa.root),!b||s.gb){for(b=0;(l.mode&61440)===40960;)if(l=Bu(d),d=Z(O(d),l),l=Sn(d,{Qa:s.Qa+1}).node,40<b++)throw new Q(32)}}return{path:d,node:l}},oo=i=>{for(var s;;){if(i===i.parent)return i=i.U.nb,s?i[i.length-1]!=="/"?`${i}/${s}`:i+s:i;s=s?`${i.name}/${s}`:i.name,i=i.parent}},ao=(i,s)=>{for(var l=0,d=0;d<s.length;d++)l=(l<<5)-l+s.charCodeAt(d)|0;return(i+l>>>0)%Ar.length},Xr=(i,s)=>{var l;if(l=(l=Qr(i,"x"))?l:i.l.ka?0:2)throw new Q(l,i);for(l=Ar[ao(i.id,s)];l;l=l.lc){var d=l.name;if(l.parent.id===i.id&&d===s)return l}return i.l.ka(i,s)},uo=(i,s,l,d)=>(i=new Fo(i,s,l,d),s=ao(i.parent.id,i.name),i.lc=Ar[s],Ar[s]=i),lo=i=>{var s=["r","w","rw"][i&3];return i&512&&(s+="w"),s},Qr=(i,s)=>{if(so)return 0;if(!s.includes("r")||i.mode&292){if(s.includes("w")&&!(i.mode&146)||s.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},co=(i,s)=>{try{return Xr(i,s),20}catch{}return Qr(i,"wx")},$u=()=>{for(var i=0;4096>=i;i++)if(!Jr[i])return i;throw new Q(33)},fn=i=>{if(i=Jr[i],!i)throw new Q(8);return i},ho=(i,s=-1)=>(kr||(kr=function(){this.h={}},kr.prototype={},Object.defineProperties(kr.prototype,{object:{get(){return this.node},set(l){this.node=l}},flags:{get(){return this.h.flags},set(l){this.h.flags=l}},position:{get(){return this.h.position},set(l){this.h.position=l}}})),i=Object.assign(new kr,i),s==-1&&(s=$u()),i.X=s,Jr[s]=i),Nu={open:i=>{i.m=io[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new Q(70)}},Wi=(i,s)=>{io[i]={m:s}},fo=(i,s)=>{var l=s==="/",d=!s;if(l&&Dt)throw new Q(10);if(!l&&!d){var _=Sn(s,{hb:!1});if(s=_.path,_=_.node,_.wa)throw new Q(10);if((_.mode&61440)!==16384)throw new Q(54)}s={type:i,Qc:{},nb:s,kc:[]},i=i.U(s),i.U=s,s.root=i,l?Dt=i:_&&(_.wa=s,_.U&&_.U.kc.push(s))},Tt=(i,s,l)=>{var d=Sn(i,{parent:!0}).node;if(i=$(i),!i||i==="."||i==="..")throw new Q(28);var _=co(d,i);if(_)throw new Q(_);if(!d.l.va)throw new Q(63);return d.l.va(d,i,s,l)},Zr=(i,s,l)=>{typeof l>"u"&&(l=s,s=438),Tt(i,s|8192,l)},Vi=(i,s)=>{if(!Z(i))throw new Q(44);var l=Sn(s,{parent:!0}).node;if(!l)throw new Q(44);s=$(s);var d=co(l,s);if(d)throw new Q(d);if(!l.l.Ea)throw new Q(63);l.l.Ea(l,s,i)},Bu=i=>{if(i=Sn(i).node,!i)throw new Q(44);if(!i.l.ma)throw new Q(28);return Z(oo(i.parent),i.l.ma(i))},ei=(i,s,l)=>{if(i==="")throw new Q(44);if(typeof s=="string"){var d={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[s];if(typeof d>"u")throw Error(`Unknown file open mode: ${s}`);s=d}if(l=s&64?(typeof l>"u"?438:l)&4095|32768:0,typeof i=="object")var _=i;else{i=T(i);try{_=Sn(i,{gb:!(s&131072)}).node}catch{}}if(d=!1,s&64)if(_){if(s&128)throw new Q(20)}else _=Tt(i,l,0),d=!0;if(!_)throw new Q(44);if((_.mode&61440)===8192&&(s&=-513),s&65536&&(_.mode&61440)!==16384)throw new Q(54);if(!d&&(l=_?(_.mode&61440)===40960?32:(_.mode&61440)===16384&&(lo(s)!=="r"||s&512)?31:Qr(_,lo(s)):44))throw new Q(l);if(s&512&&!d){if(l=_,l=typeof l=="string"?Sn(l,{gb:!0}).node:l,!l.l.P)throw new Q(63);if((l.mode&61440)===16384)throw new Q(31);if((l.mode&61440)!==32768)throw new Q(28);if(d=Qr(l,"w"))throw new Q(d);l.l.P(l,{size:0,timestamp:Date.now()})}return s&=-131713,_=ho({node:_,path:oo(_),flags:s,seekable:!0,position:0,m:_.m,zc:[],error:!1}),_.m.open&&_.m.open(_),!g.logReadFiles||s&1||(ti||(ti={}),i in ti||(ti[i]=1)),_},vo=(i,s,l)=>{if(i.X===null)throw new Q(8);if(!i.seekable||!i.m.ba)throw new Q(70);if(l!=0&&l!=1&&l!=2)throw new Q(28);i.position=i.m.ba(i,s,l),i.zc=[]},po=()=>{Q||(Q=function(i,s){this.name="ErrnoError",this.node=s,this.pc=function(l){this.aa=l},this.pc(i),this.message="FS error"},Q.prototype=Error(),Q.prototype.constructor=Q,[44].forEach(i=>{Bi[i]=new Q(i),Bi[i].stack="<generic error, no stack>"}))},go,Er=(i,s,l)=>{i=T("/dev/"+i);var d=Ae(!!s,!!l);qi||(qi=64);var _=qi++<<8|0;Wi(_,{open:b=>{b.seekable=!1},close:()=>{l&&l.buffer&&l.buffer.length&&l(10)},read:(b,k,I,R)=>{for(var P=0,V=0;V<R;V++){try{var H=s()}catch{throw new Q(29)}if(H===void 0&&P===0)throw new Q(6);if(H==null)break;P++,k[I+V]=H}return P&&(b.node.timestamp=Date.now()),P},write:(b,k,I,R)=>{for(var P=0;P<R;P++)try{l(k[I+P])}catch{throw new Q(29)}return R&&(b.node.timestamp=Date.now()),P}}),Zr(i,d,_)},qi,Cn={},kr,ti,Sr=void 0;function Yt(){return Sr+=4,me[Sr-4>>2]}function mo(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var s=i.charCodeAt(0);return 48<=s&&57>=s?`_${i}`:i}function ni(i,s){return i=mo(i),{[i]:function(){return s.apply(this,arguments)}}[i]}function _o(){this.M=[void 0],this.ib=[]}var mt=new _o,Vn=void 0;function ce(i){throw new Vn(i)}var Pt=i=>(i||ce("Cannot use deleted val. handle = "+i),mt.get(i).value),It=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return mt.pa({ub:1,value:i})}};function yo(i){var s=Error,l=ni(i,function(d){this.name=i,this.message=d,d=Error(d).stack,d!==void 0&&(this.stack=this.toString()+`
`+d.replace(/^Error(:[^\n]*)?\n/,""))});return l.prototype=Object.create(s.prototype),l.prototype.constructor=l,l.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},l}var wo=void 0,bo=void 0;function Le(i){for(var s="";Me[i];)s+=bo[Me[i++]];return s}var Cr=[];function Hi(){for(;Cr.length;){var i=Cr.pop();i.g.fa=!1,i.delete()}}var Tr=void 0,Jt={};function zi(i,s){for(s===void 0&&ce("ptr should not be undefined");i.A;)s=i.na(s),i=i.A;return s}var Tn={};function Ao(i){i=Vo(i);var s=Le(i);return Zt(i),s}function Pr(i,s){var l=Tn[i];return l===void 0&&ce(s+" has unknown type "+Ao(i)),l}function ri(){}var Gi=!1;function Eo(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function ko(i,s,l){return s===l?i:l.A===void 0?null:(i=ko(i,s,l.A),i===null?null:l.Pb(i))}var So={};function Wu(i,s){return s=zi(i,s),Jt[s]}var Co=void 0;function ii(i){throw new Co(i)}function si(i,s){return s.u&&s.o||ii("makeClassHandle requires ptr and ptrType"),!!s.L!=!!s.G&&ii("Both smartPtrType and smartPtr must be specified"),s.count={value:1},qn(Object.create(i,{g:{value:s}}))}function qn(i){return typeof FinalizationRegistry>"u"?(qn=s=>s,i):(Gi=new FinalizationRegistry(s=>{Eo(s.g)}),qn=s=>{var l=s.g;return l.G&&Gi.register(s,{g:l},s),s},ri=s=>{Gi.unregister(s)},qn(i))}var oi={};function Ir(i){for(;i.length;){var s=i.pop();i.pop()(s)}}function Rr(i){return this.fromWireType(me[i>>2])}var Hn={},ai={};function dt(i,s,l){function d(I){I=l(I),I.length!==i.length&&ii("Mismatched type converter count");for(var R=0;R<i.length;++R)Ut(i[R],I[R])}i.forEach(function(I){ai[I]=s});var _=Array(s.length),b=[],k=0;s.forEach((I,R)=>{Tn.hasOwnProperty(I)?_[R]=Tn[I]:(b.push(I),Hn.hasOwnProperty(I)||(Hn[I]=[]),Hn[I].push(()=>{_[R]=Tn[I],++k,k===b.length&&d(_)}))}),b.length===0&&d(_)}function ui(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function Vu(i,s,l={}){var d=s.name;if(i||ce(`type "${d}" must have a positive integer typeid pointer`),Tn.hasOwnProperty(i)){if(l.$b)return;ce(`Cannot register type '${d}' twice`)}Tn[i]=s,delete ai[i],Hn.hasOwnProperty(i)&&(s=Hn[i],delete Hn[i],s.forEach(_=>_()))}function Ut(i,s,l={}){if(!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");Vu(i,s,l)}function Ki(i){ce(i.g.u.i.name+" instance already deleted")}function vn(){}function Yi(i,s,l){if(i[s].B===void 0){var d=i[s];i[s]=function(){return i[s].B.hasOwnProperty(arguments.length)||ce(`Function '${l}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[s].B})!`),i[s].B[arguments.length].apply(this,arguments)},i[s].B=[],i[s].B[d.ea]=d}}function Ji(i,s,l){g.hasOwnProperty(i)?((l===void 0||g[i].B!==void 0&&g[i].B[l]!==void 0)&&ce(`Cannot register public name '${i}' twice`),Yi(g,i,i),g.hasOwnProperty(l)&&ce(`Cannot register multiple overloads of a function with the same number of arguments (${l})!`),g[i].B[l]=s):(g[i]=s,l!==void 0&&(g[i].Pc=l))}function qu(i,s,l,d,_,b,k,I){this.name=i,this.constructor=s,this.N=l,this.W=d,this.A=_,this.Ub=b,this.na=k,this.Pb=I,this.rb=[]}function li(i,s,l){for(;s!==l;)s.na||ce(`Expected null or instance of ${l.name}, got an instance of ${s.name}`),i=s.na(i),s=s.A;return i}function Hu(i,s){return s===null?(this.Na&&ce(`null is not a valid ${this.name}`),0):(s.g||ce(`Cannot pass "${Qi(s)}" as a ${this.name}`),s.g.o||ce(`Cannot pass deleted object as a pointer of type ${this.name}`),li(s.g.o,s.g.u.i,this.i))}function zu(i,s){if(s===null){if(this.Na&&ce(`null is not a valid ${this.name}`),this.ua){var l=this.Pa();return i!==null&&i.push(this.W,l),l}return 0}if(s.g||ce(`Cannot pass "${Qi(s)}" as a ${this.name}`),s.g.o||ce(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&s.g.u.ta&&ce(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`),l=li(s.g.o,s.g.u.i,this.i),this.ua)switch(s.g.G===void 0&&ce("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:s.g.L===this?l=s.g.G:ce(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`);break;case 1:l=s.g.G;break;case 2:if(s.g.L===this)l=s.g.G;else{var d=s.clone();l=this.oc(l,It(function(){d.delete()})),i!==null&&i.push(this.W,l)}break;default:ce("Unsupporting sharing policy")}return l}function Gu(i,s){return s===null?(this.Na&&ce(`null is not a valid ${this.name}`),0):(s.g||ce(`Cannot pass "${Qi(s)}" as a ${this.name}`),s.g.o||ce(`Cannot pass deleted object as a pointer of type ${this.name}`),s.g.u.ta&&ce(`Cannot convert argument of type ${s.g.u.name} to parameter type ${this.name}`),li(s.g.o,s.g.u.i,this.i))}function Xt(i,s,l,d){this.name=i,this.i=s,this.Na=l,this.ta=d,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,s.A!==void 0?this.toWireType=zu:(this.toWireType=d?Hu:Gu,this.K=null)}function To(i,s,l){g.hasOwnProperty(i)||ii("Replacing nonexistant public symbol"),g[i].B!==void 0&&l!==void 0?g[i].B[l]=s:(g[i]=s,g[i].ea=l)}var ci=[],Po=i=>{var s=ci[i];return s||(i>=ci.length&&(ci.length=i+1),ci[i]=s=Ue.get(i)),s},Ku=(i,s)=>{var l=[];return function(){if(l.length=0,Object.assign(l,arguments),i.includes("j")){var d=g["dynCall_"+i];d=l&&l.length?d.apply(null,[s].concat(l)):d.call(null,s)}else d=Po(s).apply(null,l);return d}};function nt(i,s){i=Le(i);var l=i.includes("j")?Ku(i,s):Po(s);return typeof l!="function"&&ce(`unknown function pointer with signature ${i}: ${s}`),l}var Io=void 0;function Qt(i,s){function l(b){_[b]||Tn[b]||(ai[b]?ai[b].forEach(l):(d.push(b),_[b]=!0))}var d=[],_={};throw s.forEach(l),new Io(`${i}: `+d.map(Ao).join([", "]))}function hi(i,s,l,d,_){var b=s.length;2>b&&ce("argTypes array size mismatch! Must at least get return value and 'this' types!");var k=s[1]!==null&&l!==null,I=!1;for(l=1;l<s.length;++l)if(s[l]!==null&&s[l].K===void 0){I=!0;break}var R=s[0].name!=="void",P=b-2,V=Array(P),H=[],J=[];return function(){if(arguments.length!==P&&ce(`function ${i} called with ${arguments.length} arguments, expected ${P} args!`),J.length=0,H.length=k?2:1,H[0]=_,k){var S=s[1].toWireType(J,this);H[1]=S}for(var W=0;W<P;++W)V[W]=s[W+2].toWireType(J,arguments[W]),H.push(V[W]);if(W=d.apply(null,H),I)Ir(J);else for(var N=k?1:2;N<s.length;N++){var he=N===1?S:V[N-2];s[N].K!==null&&s[N].K(he)}return S=R?s[0].fromWireType(W):void 0,S}}function di(i,s){for(var l=[],d=0;d<i;d++)l.push(Se[s+4*d>>2]);return l}function Ro(i,s,l){return i instanceof Object||ce(`${l} with invalid "this": ${i}`),i instanceof s.i.constructor||ce(`${l} incompatible with "this" of type ${i.constructor.name}`),i.g.o||ce(`cannot call emscripten binding method ${l} on deleted object`),li(i.g.o,i.g.u.i,s.i)}function Xi(i){i>=mt.h&&--mt.get(i).ub===0&&mt.Zb(i)}function Yu(i,s,l){switch(s){case 0:return function(d){return this.fromWireType((l?He:Me)[d])};case 1:return function(d){return this.fromWireType((l?Qe:Et)[d>>1])};case 2:return function(d){return this.fromWireType((l?me:Se)[d>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Qi(i){if(i===null)return"null";var s=typeof i;return s==="object"||s==="array"||s==="function"?i.toString():""+i}function Ju(i,s){switch(s){case 2:return function(l){return this.fromWireType(kt[l>>2])};case 3:return function(l){return this.fromWireType(Ie[l>>3])};default:throw new TypeError("Unknown float type: "+i)}}function Xu(i,s,l){switch(s){case 0:return l?function(d){return He[d]}:function(d){return Me[d]};case 1:return l?function(d){return Qe[d>>1]}:function(d){return Et[d>>1]};case 2:return l?function(d){return me[d>>2]}:function(d){return Se[d>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var Oo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Qu=(i,s)=>{for(var l=i>>1,d=l+s/2;!(l>=d)&&Et[l];)++l;if(l<<=1,32<l-i&&Oo)return Oo.decode(Me.subarray(i,l));for(l="",d=0;!(d>=s/2);++d){var _=Qe[i+2*d>>1];if(_==0)break;l+=String.fromCharCode(_)}return l},Zu=(i,s,l)=>{if(l===void 0&&(l=2147483647),2>l)return 0;l-=2;var d=s;l=l<2*i.length?l/2:i.length;for(var _=0;_<l;++_)Qe[s>>1]=i.charCodeAt(_),s+=2;return Qe[s>>1]=0,s-d},el=i=>2*i.length,tl=(i,s)=>{for(var l=0,d="";!(l>=s/4);){var _=me[i+4*l>>2];if(_==0)break;++l,65536<=_?(_-=65536,d+=String.fromCharCode(55296|_>>10,56320|_&1023)):d+=String.fromCharCode(_)}return d},nl=(i,s,l)=>{if(l===void 0&&(l=2147483647),4>l)return 0;var d=s;l=d+l-4;for(var _=0;_<i.length;++_){var b=i.charCodeAt(_);if(55296<=b&&57343>=b){var k=i.charCodeAt(++_);b=65536+((b&1023)<<10)|k&1023}if(me[s>>2]=b,s+=4,s+4>l)break}return me[s>>2]=0,s-d},rl=i=>{for(var s=0,l=0;l<i.length;++l){var d=i.charCodeAt(l);55296<=d&&57343>=d&&++l,s+=4}return s},il={};function fi(i){var s=il[i];return s===void 0?Le(i):s}var vi=[];function sl(i){var s=vi.length;return vi.push(i),s}function ol(i,s){for(var l=Array(i),d=0;d<i;++d)l[d]=Pr(Se[s+4*d>>2],"parameter "+d);return l}var jo=[],Zi=[],es={},Mo=()=>{if(!ts){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:L||"./this.program"},s;for(s in es)es[s]===void 0?delete i[s]:i[s]=es[s];var l=[];for(s in i)l.push(`${s}=${i[s]}`);ts=l}return ts},ts,pi=i=>i%4===0&&(i%100!==0||i%400===0),xo=[31,29,31,30,31,30,31,31,30,31,30,31],Lo=[31,28,31,30,31,30,31,31,30,31,30,31],al=(i,s,l,d)=>{function _(S,W,N){for(S=typeof S=="number"?S.toString():S||"";S.length<W;)S=N[0]+S;return S}function b(S,W){return _(S,W,"0")}function k(S,W){function N(fe){return 0>fe?-1:0<fe?1:0}var he;return(he=N(S.getFullYear()-W.getFullYear()))===0&&(he=N(S.getMonth()-W.getMonth()))===0&&(he=N(S.getDate()-W.getDate())),he}function I(S){switch(S.getDay()){case 0:return new Date(S.getFullYear()-1,11,29);case 1:return S;case 2:return new Date(S.getFullYear(),0,3);case 3:return new Date(S.getFullYear(),0,2);case 4:return new Date(S.getFullYear(),0,1);case 5:return new Date(S.getFullYear()-1,11,31);case 6:return new Date(S.getFullYear()-1,11,30)}}function R(S){var W=S.ca;for(S=new Date(new Date(S.da+1900,0,1).getTime());0<W;){var N=S.getMonth(),he=(pi(S.getFullYear())?xo:Lo)[N];if(W>he-S.getDate())W-=he-S.getDate()+1,S.setDate(1),11>N?S.setMonth(N+1):(S.setMonth(0),S.setFullYear(S.getFullYear()+1));else{S.setDate(S.getDate()+W);break}}return N=new Date(S.getFullYear()+1,0,4),W=I(new Date(S.getFullYear(),0,4)),N=I(N),0>=k(W,S)?0>=k(N,S)?S.getFullYear()+1:S.getFullYear():S.getFullYear()-1}var P=me[d+40>>2];d={wc:me[d>>2],vc:me[d+4>>2],Fa:me[d+8>>2],Sa:me[d+12>>2],Ga:me[d+16>>2],da:me[d+20>>2],R:me[d+24>>2],ca:me[d+28>>2],Rc:me[d+32>>2],uc:me[d+36>>2],xc:P&&P?Ce(Me,P):""},l=l?Ce(Me,l):"",P={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var V in P)l=l.replace(new RegExp(V,"g"),P[V]);var H="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),J="January February March April May June July August September October November December".split(" ");P={"%a":S=>H[S.R].substring(0,3),"%A":S=>H[S.R],"%b":S=>J[S.Ga].substring(0,3),"%B":S=>J[S.Ga],"%C":S=>b((S.da+1900)/100|0,2),"%d":S=>b(S.Sa,2),"%e":S=>_(S.Sa,2," "),"%g":S=>R(S).toString().substring(2),"%G":S=>R(S),"%H":S=>b(S.Fa,2),"%I":S=>(S=S.Fa,S==0?S=12:12<S&&(S-=12),b(S,2)),"%j":S=>{for(var W=0,N=0;N<=S.Ga-1;W+=(pi(S.da+1900)?xo:Lo)[N++]);return b(S.Sa+W,3)},"%m":S=>b(S.Ga+1,2),"%M":S=>b(S.vc,2),"%n":()=>`
`,"%p":S=>0<=S.Fa&&12>S.Fa?"AM":"PM","%S":S=>b(S.wc,2),"%t":()=>"	","%u":S=>S.R||7,"%U":S=>b(Math.floor((S.ca+7-S.R)/7),2),"%V":S=>{var W=Math.floor((S.ca+7-(S.R+6)%7)/7);if(2>=(S.R+371-S.ca-2)%7&&W++,W)W==53&&(N=(S.R+371-S.ca)%7,N==4||N==3&&pi(S.da)||(W=1));else{W=52;var N=(S.R+7-S.ca-1)%7;(N==4||N==5&&pi(S.da%400-1))&&W++}return b(W,2)},"%w":S=>S.R,"%W":S=>b(Math.floor((S.ca+7-(S.R+6)%7)/7),2),"%y":S=>(S.da+1900).toString().substring(2),"%Y":S=>S.da+1900,"%z":S=>{S=S.uc;var W=0<=S;return S=Math.abs(S)/60,(W?"+":"-")+("0000"+(S/60*100+S%60)).slice(-4)},"%Z":S=>S.xc,"%%":()=>"%"},l=l.replace(/%%/g,"\0\0");for(V in P)l.includes(V)&&(l=l.replace(new RegExp(V,"g"),P[V](d)));return l=l.replace(/\0\0/g,"%"),V=pt(l,!1),V.length>s?0:(He.set(V,i),V.length-1)};function Fo(i,s,l,d){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Uu++,this.name=s,this.mode=l,this.l={},this.m={},this.za=d}Object.defineProperties(Fo.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),po(),Ar=Array(4096),fo(oe,"/"),Tt("/tmp",16895,0),Tt("/home",16895,0),Tt("/home/web_user",16895,0),(()=>{Tt("/dev",16895,0),Wi(259,{read:()=>0,write:(d,_,b,k)=>k}),Zr("/dev/null",259),ut(1280,hn),ut(1536,dn),Zr("/dev/tty",1280),Zr("/dev/tty1",1536);var i=new Uint8Array(1024),s=0,l=()=>(s===0&&(s=ue(i).byteLength),i[--s]);Er("random",l),Er("urandom",l),Tt("/dev/shm",16895,0),Tt("/dev/shm/tmp",16895,0)})(),(()=>{Tt("/proc",16895,0);var i=Tt("/proc/self",16895,0);Tt("/proc/self/fd",16895,0),fo({U:()=>{var s=uo(i,"fd",16895,73);return s.l={ka:(l,d)=>{var _=fn(+d);return l={parent:null,U:{nb:"fake"},l:{ma:()=>_.path}},l.parent=l}},s}},"/proc/self/fd")})(),Object.assign(_o.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var s=this.ib.pop()||this.M.length;return this.M[s]=i,s},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),Vn=g.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},mt.M.push({value:void 0},{value:null},{value:!0},{value:!1}),mt.h=mt.M.length,g.count_emval_handles=function(){for(var i=0,s=mt.h;s<mt.M.length;++s)mt.M[s]!==void 0&&++i;return i},wo=g.PureVirtualError=yo("PureVirtualError");for(var Do=Array(256),gi=0;256>gi;++gi)Do[gi]=String.fromCharCode(gi);bo=Do,g.getInheritedInstanceCount=function(){return Object.keys(Jt).length},g.getLiveInheritedInstances=function(){var i=[],s;for(s in Jt)Jt.hasOwnProperty(s)&&i.push(Jt[s]);return i},g.flushPendingDeletes=Hi,g.setDelayFunction=function(i){Tr=i,Cr.length&&Tr&&Tr(Hi)},Co=g.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},vn.prototype.isAliasOf=function(i){if(!(this instanceof vn&&i instanceof vn))return!1;var s=this.g.u.i,l=this.g.o,d=i.g.u.i;for(i=i.g.o;s.A;)l=s.na(l),s=s.A;for(;d.A;)i=d.na(i),d=d.A;return s===d&&l===i},vn.prototype.clone=function(){if(this.g.o||Ki(this),this.g.ia)return this.g.count.value+=1,this;var i=qn,s=Object,l=s.create,d=Object.getPrototypeOf(this),_=this.g;return i=i(l.call(s,d,{g:{value:{count:_.count,fa:_.fa,ia:_.ia,o:_.o,u:_.u,G:_.G,L:_.L}}})),i.g.count.value+=1,i.g.fa=!1,i},vn.prototype.delete=function(){this.g.o||Ki(this),this.g.fa&&!this.g.ia&&ce("Object already scheduled for deletion"),ri(this),Eo(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},vn.prototype.isDeleted=function(){return!this.g.o},vn.prototype.deleteLater=function(){return this.g.o||Ki(this),this.g.fa&&!this.g.ia&&ce("Object already scheduled for deletion"),Cr.push(this),Cr.length===1&&Tr&&Tr(Hi),this.g.fa=!0,this},Xt.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},Xt.prototype.bb=function(i){this.W&&this.W(i)},Xt.prototype.argPackAdvance=8,Xt.prototype.readValueFromPointer=Rr,Xt.prototype.deleteObject=function(i){i!==null&&i.delete()},Xt.prototype.fromWireType=function(i){function s(){return this.ua?si(this.i.N,{u:this.nc,o:l,L:this,G:i}):si(this.i.N,{u:this,o:i})}var l=this.Vb(i);if(!l)return this.bb(i),null;var d=Wu(this.i,l);if(d!==void 0)return d.g.count.value===0?(d.g.o=l,d.g.G=i,d.clone()):(d=d.clone(),this.bb(i),d);if(d=this.i.Ub(l),d=So[d],!d)return s.call(this);d=this.ta?d.Kb:d.pointerType;var _=ko(l,this.i,d.i);return _===null?s.call(this):this.ua?si(d.i.N,{u:d,o:_,L:this,G:i}):si(d.i.N,{u:d,o:_})},Io=g.UnboundTypeError=yo("UnboundTypeError");var Uo={__syscall_fcntl64:function(i,s,l){Sr=l;try{var d=fn(i);switch(s){case 0:var _=Yt();return 0>_?-28:ho(d,_).X;case 1:case 2:return 0;case 3:return d.flags;case 4:return _=Yt(),d.flags|=_,0;case 5:return _=Yt(),Qe[_+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return me[$o()>>2]=28,-1;default:return-28}}catch(b){if(typeof Cn>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,s,l){Sr=l;try{var d=fn(i);switch(s){case 21509:return d.s?0:-59;case 21505:if(!d.s)return-59;if(d.s.V.bc){s=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var _=Yt();me[_>>2]=25856,me[_+4>>2]=5,me[_+8>>2]=191,me[_+12>>2]=35387;for(var b=0;32>b;b++)He[_+b+17>>0]=s[b]||0}return 0;case 21510:case 21511:case 21512:return d.s?0:-59;case 21506:case 21507:case 21508:if(!d.s)return-59;if(d.s.V.cc)for(_=Yt(),s=[],b=0;32>b;b++)s.push(He[_+b+17>>0]);return 0;case 21519:return d.s?(_=Yt(),me[_>>2]=0):-59;case 21520:return d.s?-28:-59;case 21531:if(_=Yt(),!d.m.ac)throw new Q(59);return d.m.ac(d,s,_);case 21523:return d.s?(d.s.V.dc&&(b=[24,80],_=Yt(),Qe[_>>1]=b[0],Qe[_+2>>1]=b[1]),0):-59;case 21524:return d.s?0:-59;case 21515:return d.s?0:-59;default:return-28}}catch(k){if(typeof Cn>"u"||k.name!=="ErrnoError")throw k;return-k.aa}},__syscall_openat:function(i,s,l,d){Sr=d;try{s=s?Ce(Me,s):"";var _=s;if(_.charAt(0)==="/")s=_;else{var b=i===-100?"/":fn(i).path;if(_.length==0)throw new Q(44);s=T(b+"/"+_)}var k=d?Yt():0;return ei(s,l,k).X}catch(I){if(typeof Cn>"u"||I.name!=="ErrnoError")throw I;return-I.aa}},_embind_create_inheriting_constructor:function(i,s,l){i=Le(i),s=Pr(s,"wrapper"),l=Pt(l);var d=[].slice,_=s.i,b=_.N,k=_.A.N,I=_.A.constructor;i=ni(i,function(){_.A.rb.forEach((function(P){if(this[P]===k[P])throw new wo(`Pure virtual function ${P} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,d.call(arguments))}),b.__construct=function(){this===b&&ce("Pass correct 'this' to __construct");var P=I.implement.apply(void 0,[this].concat(d.call(arguments)));ri(P);var V=P.g;P.notifyOnDestruction(),V.ia=!0,Object.defineProperties(this,{g:{value:V}}),qn(this),P=V.o,P=zi(_,P),Jt.hasOwnProperty(P)?ce(`Tried to register registered instance: ${P}`):Jt[P]=this},b.__destruct=function(){this===b&&ce("Pass correct 'this' to __destruct"),ri(this);var P=this.g.o;P=zi(_,P),Jt.hasOwnProperty(P)?delete Jt[P]:ce(`Tried to unregister unregistered instance: ${P}`)},i.prototype=Object.create(b);for(var R in l)i.prototype[R]=l[R];return It(i)},_embind_finalize_value_object:function(i){var s=oi[i];delete oi[i];var l=s.Pa,d=s.W,_=s.fb,b=_.map(k=>k.Yb).concat(_.map(k=>k.rc));dt([i],b,k=>{var I={};return _.forEach((R,P)=>{var V=k[P],H=R.Wb,J=R.Xb,S=k[P+_.length],W=R.qc,N=R.sc;I[R.Sb]={read:he=>V.fromWireType(H(J,he)),write:(he,fe)=>{var G=[];W(N,he,S.toWireType(G,fe)),Ir(G)}}}),[{name:s.name,fromWireType:function(R){var P={},V;for(V in I)P[V]=I[V].read(R);return d(R),P},toWireType:function(R,P){for(var V in I)if(!(V in P))throw new TypeError(`Missing field: "${V}"`);var H=l();for(V in I)I[V].write(H,P[V]);return R!==null&&R.push(d,H),H},argPackAdvance:8,readValueFromPointer:Rr,K:d}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,s,l,d,_){var b=ui(l);s=Le(s),Ut(i,{name:s,fromWireType:function(k){return!!k},toWireType:function(k,I){return I?d:_},argPackAdvance:8,readValueFromPointer:function(k){if(l===1)var I=He;else if(l===2)I=Qe;else if(l===4)I=me;else throw new TypeError("Unknown boolean type size: "+s);return this.fromWireType(I[k>>b])},K:null})},_embind_register_class:function(i,s,l,d,_,b,k,I,R,P,V,H,J){V=Le(V),b=nt(_,b),I&&(I=nt(k,I)),P&&(P=nt(R,P)),J=nt(H,J);var S=mo(V);Ji(S,function(){Qt(`Cannot construct ${V} due to unbound types`,[d])}),dt([i,s,l],d?[d]:[],function(W){if(W=W[0],d)var N=W.i,he=N.N;else he=vn.prototype;W=ni(S,function(){if(Object.getPrototypeOf(this)!==fe)throw new Vn("Use 'new' to construct "+V);if(G.$===void 0)throw new Vn(V+" has no accessible constructor");var Ze=G.$[arguments.length];if(Ze===void 0)throw new Vn(`Tried to invoke ctor of ${V} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(G.$).toString()}) parameters instead!`);return Ze.apply(this,arguments)});var fe=Object.create(he,{constructor:{value:W}});W.prototype=fe;var G=new qu(V,W,fe,J,N,b,I,P);G.A&&(G.A.oa===void 0&&(G.A.oa=[]),G.A.oa.push(G)),N=new Xt(V,G,!0,!1),he=new Xt(V+"*",G,!1,!1);var Oe=new Xt(V+" const*",G,!1,!0);return So[i]={pointerType:he,Kb:Oe},To(S,W),[N,he,Oe]})},_embind_register_class_class_function:function(i,s,l,d,_,b,k){var I=di(l,d);s=Le(s),b=nt(_,b),dt([],[i],function(R){function P(){Qt(`Cannot call ${V} due to unbound types`,I)}R=R[0];var V=`${R.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var H=R.i.constructor;return H[s]===void 0?(P.ea=l-1,H[s]=P):(Yi(H,s,V),H[s].B[l-1]=P),dt([],I,function(J){if(J=hi(V,[J[0],null].concat(J.slice(1)),null,b,k),H[s].B===void 0?(J.ea=l-1,H[s]=J):H[s].B[l-1]=J,R.i.oa)for(const S of R.i.oa)S.constructor.hasOwnProperty(s)||(S.constructor[s]=J);return[]}),[]})},_embind_register_class_class_property:function(i,s,l,d,_,b,k,I){s=Le(s),b=nt(_,b),dt([],[i],function(R){R=R[0];var P=`${R.name}.${s}`,V={get(){Qt(`Cannot access ${P} due to unbound types`,[l])},enumerable:!0,configurable:!0};return V.set=I?()=>{Qt(`Cannot access ${P} due to unbound types`,[l])}:()=>{ce(`${P} is a read-only property`)},Object.defineProperty(R.i.constructor,s,V),dt([],[l],function(H){H=H[0];var J={get(){return H.fromWireType(b(d))},enumerable:!0};return I&&(I=nt(k,I),J.set=S=>{var W=[];I(d,H.toWireType(W,S)),Ir(W)}),Object.defineProperty(R.i.constructor,s,J),[]}),[]})},_embind_register_class_constructor:function(i,s,l,d,_,b){var k=di(s,l);_=nt(d,_),dt([],[i],function(I){I=I[0];var R=`constructor ${I.name}`;if(I.i.$===void 0&&(I.i.$=[]),I.i.$[s-1]!==void 0)throw new Vn(`Cannot register multiple constructors with identical number of parameters (${s-1}) for class '${I.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return I.i.$[s-1]=()=>{Qt(`Cannot construct ${I.name} due to unbound types`,k)},dt([],k,function(P){return P.splice(1,0,null),I.i.$[s-1]=hi(R,P,null,_,b),[]}),[]})},_embind_register_class_function:function(i,s,l,d,_,b,k,I){var R=di(l,d);s=Le(s),b=nt(_,b),dt([],[i],function(P){function V(){Qt(`Cannot call ${H} due to unbound types`,R)}P=P[0];var H=`${P.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),I&&P.i.rb.push(s);var J=P.i.N,S=J[s];return S===void 0||S.B===void 0&&S.className!==P.name&&S.ea===l-2?(V.ea=l-2,V.className=P.name,J[s]=V):(Yi(J,s,H),J[s].B[l-2]=V),dt([],R,function(W){return W=hi(H,W,P,b,k),J[s].B===void 0?(W.ea=l-2,J[s]=W):J[s].B[l-2]=W,[]}),[]})},_embind_register_class_property:function(i,s,l,d,_,b,k,I,R,P){s=Le(s),_=nt(d,_),dt([],[i],function(V){V=V[0];var H=`${V.name}.${s}`,J={get(){Qt(`Cannot access ${H} due to unbound types`,[l,k])},enumerable:!0,configurable:!0};return J.set=R?()=>{Qt(`Cannot access ${H} due to unbound types`,[l,k])}:()=>{ce(H+" is a read-only property")},Object.defineProperty(V.i.N,s,J),dt([],R?[l,k]:[l],function(S){var W=S[0],N={get(){var fe=Ro(this,V,H+" getter");return W.fromWireType(_(b,fe))},enumerable:!0};if(R){R=nt(I,R);var he=S[1];N.set=function(fe){var G=Ro(this,V,H+" setter"),Oe=[];R(P,G,he.toWireType(Oe,fe)),Ir(Oe)}}return Object.defineProperty(V.i.N,s,N),[]}),[]})},_embind_register_emval:function(i,s){s=Le(s),Ut(i,{name:s,fromWireType:function(l){var d=Pt(l);return Xi(l),d},toWireType:function(l,d){return It(d)},argPackAdvance:8,readValueFromPointer:Rr,K:null})},_embind_register_enum:function(i,s,l,d){function _(){}l=ui(l),s=Le(s),_.values={},Ut(i,{name:s,constructor:_,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,k){return k.value},argPackAdvance:8,readValueFromPointer:Yu(s,l,d),K:null}),Ji(s,_)},_embind_register_enum_value:function(i,s,l){var d=Pr(i,"enum");s=Le(s),i=d.constructor,d=Object.create(d.constructor.prototype,{value:{value:l},constructor:{value:ni(`${d.name}_${s}`,function(){})}}),i.values[l]=d,i[s]=d},_embind_register_float:function(i,s,l){l=ui(l),s=Le(s),Ut(i,{name:s,fromWireType:function(d){return d},toWireType:function(d,_){return _},argPackAdvance:8,readValueFromPointer:Ju(s,l),K:null})},_embind_register_function:function(i,s,l,d,_,b){var k=di(s,l);i=Le(i),_=nt(d,_),Ji(i,function(){Qt(`Cannot call ${i} due to unbound types`,k)},s-1),dt([],k,function(I){return To(i,hi(i,[I[0],null].concat(I.slice(1)),null,_,b),s-1),[]})},_embind_register_integer:function(i,s,l,d,_){s=Le(s),_===-1&&(_=4294967295),_=ui(l);var b=I=>I;if(d===0){var k=32-8*l;b=I=>I<<k>>>k}l=s.includes("unsigned")?function(I,R){return R>>>0}:function(I,R){return R},Ut(i,{name:s,fromWireType:b,toWireType:l,argPackAdvance:8,readValueFromPointer:Xu(s,_,d!==0),K:null})},_embind_register_memory_view:function(i,s,l){function d(b){b>>=2;var k=Se;return new _(k.buffer,k[b+1],k[b])}var _=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];l=Le(l),Ut(i,{name:l,fromWireType:d,argPackAdvance:8,readValueFromPointer:d},{$b:!0})},_embind_register_std_string:function(i,s){s=Le(s);var l=s==="std::string";Ut(i,{name:s,fromWireType:function(d){var _=Se[d>>2],b=d+4;if(l)for(var k=b,I=0;I<=_;++I){var R=b+I;if(I==_||Me[R]==0){if(k=k?Ce(Me,k,R-k):"",P===void 0)var P=k;else P+="\0",P+=k;k=R+1}}else{for(P=Array(_),I=0;I<_;++I)P[I]=String.fromCharCode(Me[b+I]);P=P.join("")}return Zt(d),P},toWireType:function(d,_){_ instanceof ArrayBuffer&&(_=new Uint8Array(_));var b=typeof _=="string";b||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int8Array||ce("Cannot pass non-string to std::string");var k=l&&b?je(_):_.length,I=ns(4+k+1),R=I+4;if(Se[I>>2]=k,l&&b)Ct(_,Me,R,k+1);else if(b)for(b=0;b<k;++b){var P=_.charCodeAt(b);255<P&&(Zt(R),ce("String has UTF-16 code units that do not fit in 8 bits")),Me[R+b]=P}else for(b=0;b<k;++b)Me[R+b]=_[b];return d!==null&&d.push(Zt,I),I},argPackAdvance:8,readValueFromPointer:Rr,K:function(d){Zt(d)}})},_embind_register_std_wstring:function(i,s,l){if(l=Le(l),s===2)var d=Qu,_=Zu,b=el,k=()=>Et,I=1;else s===4&&(d=tl,_=nl,b=rl,k=()=>Se,I=2);Ut(i,{name:l,fromWireType:function(R){for(var P=Se[R>>2],V=k(),H,J=R+4,S=0;S<=P;++S){var W=R+4+S*s;(S==P||V[W>>I]==0)&&(J=d(J,W-J),H===void 0?H=J:(H+="\0",H+=J),J=W+s)}return Zt(R),H},toWireType:function(R,P){typeof P!="string"&&ce(`Cannot pass non-string to C++ string type ${l}`);var V=b(P),H=ns(4+V+s);return Se[H>>2]=V>>I,_(P,H+4,V+s),R!==null&&R.push(Zt,H),H},argPackAdvance:8,readValueFromPointer:Rr,K:function(R){Zt(R)}})},_embind_register_value_object:function(i,s,l,d,_,b){oi[i]={name:Le(s),Pa:nt(l,d),W:nt(_,b),fb:[]}},_embind_register_value_object_field:function(i,s,l,d,_,b,k,I,R,P){oi[i].fb.push({Sb:Le(s),Yb:l,Wb:nt(d,_),Xb:b,rc:k,qc:nt(I,R),sc:P})},_embind_register_void:function(i,s){s=Le(s),Ut(i,{fc:!0,name:s,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,s,l){i=Pt(i),s=Pr(s,"emval::as");var d=[],_=It(d);return Se[l>>2]=_,s.toWireType(d,i)},_emval_call_method:function(i,s,l,d,_){i=vi[i],s=Pt(s),l=fi(l);var b=[];return Se[d>>2]=It(b),i(s,l,b,_)},_emval_call_void_method:function(i,s,l,d){i=vi[i],s=Pt(s),l=fi(l),i(s,l,null,d)},_emval_decref:Xi,_emval_get_method_caller:function(i,s){var l=ol(i,s),d=l[0];s=d.name+"_$"+l.slice(1).map(function(k){return k.name}).join("_")+"$";var _=jo[s];if(_!==void 0)return _;var b=Array(i-1);return _=sl((k,I,R,P)=>{for(var V=0,H=0;H<i-1;++H)b[H]=l[H+1].readValueFromPointer(P+V),V+=l[H+1].argPackAdvance;for(k=k[I].apply(k,b),H=0;H<i-1;++H)l[H+1].Nb&&l[H+1].Nb(b[H]);if(!d.fc)return d.toWireType(R,k)}),jo[s]=_},_emval_get_module_property:function(i){return i=fi(i),It(g[i])},_emval_get_property:function(i,s){return i=Pt(i),s=Pt(s),It(i[s])},_emval_incref:function(i){4<i&&(mt.get(i).ub+=1)},_emval_new_array:function(){return It([])},_emval_new_cstring:function(i){return It(fi(i))},_emval_new_object:function(){return It({})},_emval_run_destructors:function(i){var s=Pt(i);Ir(s),Xi(i)},_emval_set_property:function(i,s,l){i=Pt(i),s=Pt(s),l=Pt(l),i[s]=l},_emval_take_value:function(i,s){return i=Pr(i,"_emval_take_value"),i=i.readValueFromPointer(s),It(i)},abort:()=>{ln("")},emscripten_asm_const_int:(i,s,l)=>{Zi.length=0;var d;for(l>>=2;d=Me[s++];)l+=d!=105&l,Zi.push(d==105?me[l]:Ie[l++>>1]),++l;return a[i].apply(null,Zi)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,s,l)=>Me.copyWithin(i,s,s+l),emscripten_resize_heap:i=>{var s=Me.length;if(i>>>=0,2147483648<i)return!1;for(var l=1;4>=l;l*=2){var d=s*(1+.2/l);d=Math.min(d,i+100663296);var _=Math;d=Math.max(i,d);e:{_=_.min.call(_,2147483648,d+(65536-d%65536)%65536)-At.buffer.byteLength+65535>>>16;try{At.grow(_),ct();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,s)=>{var l=0;return Mo().forEach(function(d,_){var b=s+l;for(_=Se[i+4*_>>2]=b,b=0;b<d.length;++b)He[_++>>0]=d.charCodeAt(b);He[_>>0]=0,l+=d.length+1}),0},environ_sizes_get:(i,s)=>{var l=Mo();Se[i>>2]=l.length;var d=0;return l.forEach(function(_){d+=_.length+1}),Se[s>>2]=d,0},fd_close:function(i){try{var s=fn(i);if(s.X===null)throw new Q(8);s.Ma&&(s.Ma=null);try{s.m.close&&s.m.close(s)}catch(l){throw l}finally{Jr[s.X]=null}return s.X=null,0}catch(l){if(typeof Cn>"u"||l.name!=="ErrnoError")throw l;return l.aa}},fd_read:function(i,s,l,d){try{e:{var _=fn(i);i=s;for(var b,k=s=0;k<l;k++){var I=Se[i>>2],R=Se[i+4>>2];i+=8;var P=_,V=I,H=R,J=b,S=He;if(0>H||0>J)throw new Q(28);if(P.X===null)throw new Q(8);if((P.flags&2097155)===1)throw new Q(8);if((P.node.mode&61440)===16384)throw new Q(31);if(!P.m.read)throw new Q(28);var W=typeof J<"u";if(!W)J=P.position;else if(!P.seekable)throw new Q(70);var N=P.m.read(P,S,V,H,J);W||(P.position+=N);var he=N;if(0>he){var fe=-1;break e}if(s+=he,he<R)break;typeof b<"u"&&(b+=he)}fe=s}return Se[d>>2]=fe,0}catch(G){if(typeof Cn>"u"||G.name!=="ErrnoError")throw G;return G.aa}},fd_seek:function(i,s,l,d,_){s=l+2097152>>>0<4194305-!!s?(s>>>0)+4294967296*l:NaN;try{if(isNaN(s))return 61;var b=fn(i);return vo(b,s,d),p=[b.position>>>0,(cn=b.position,1<=+Math.abs(cn)?0<cn?+Math.floor(cn/4294967296)>>>0:~~+Math.ceil((cn-+(~~cn>>>0))/4294967296)>>>0:0)],me[_>>2]=p[0],me[_+4>>2]=p[1],b.Ma&&s===0&&d===0&&(b.Ma=null),0}catch(k){if(typeof Cn>"u"||k.name!=="ErrnoError")throw k;return k.aa}},fd_write:function(i,s,l,d){try{e:{var _=fn(i);i=s;for(var b,k=s=0;k<l;k++){var I=Se[i>>2],R=Se[i+4>>2];i+=8;var P=_,V=I,H=R,J=b,S=He;if(0>H||0>J)throw new Q(28);if(P.X===null)throw new Q(8);if((P.flags&2097155)===0)throw new Q(8);if((P.node.mode&61440)===16384)throw new Q(31);if(!P.m.write)throw new Q(28);P.seekable&&P.flags&1024&&vo(P,0,2);var W=typeof J<"u";if(!W)J=P.position;else if(!P.seekable)throw new Q(70);var N=P.m.write(P,S,V,H,J,void 0);W||(P.position+=N);var he=N;if(0>he){var fe=-1;break e}s+=he,typeof b<"u"&&(b+=he)}fe=s}return Se[d>>2]=fe,0}catch(G){if(typeof Cn>"u"||G.name!=="ErrnoError")throw G;return G.aa}},strftime_l:(i,s,l,d)=>al(i,s,l,d)};(function(){function i(l){if(se=l=l.exports,At=se.memory,ct(),Ue=se.__indirect_function_table,un.unshift(se.__wasm_call_ctors),ot--,g.monitorRunDependencies&&g.monitorRunDependencies(ot),ot==0&&St){var d=St;St=null,d()}return l}var s={env:Uo,wasi_snapshot_preview1:Uo};if(ot++,g.monitorRunDependencies&&g.monitorRunDependencies(ot),g.instantiateWasm)try{return g.instantiateWasm(s,i)}catch(l){Be("Module.instantiateWasm callback failed with error: "+l),j(l)}return Ni(s,function(l){i(l.instance)}).catch(j),{}})();var Zt=i=>(Zt=se.free)(i),ns=i=>(ns=se.malloc)(i),$o=()=>($o=se.__errno_location)(),No=g._ma_device__on_notification_unlocked=i=>(No=g._ma_device__on_notification_unlocked=se.ma_device__on_notification_unlocked)(i);g._ma_malloc_emscripten=(i,s)=>(g._ma_malloc_emscripten=se.ma_malloc_emscripten)(i,s),g._ma_free_emscripten=(i,s)=>(g._ma_free_emscripten=se.ma_free_emscripten)(i,s);var Bo=g._ma_device_process_pcm_frames_capture__webaudio=(i,s,l)=>(Bo=g._ma_device_process_pcm_frames_capture__webaudio=se.ma_device_process_pcm_frames_capture__webaudio)(i,s,l),Wo=g._ma_device_process_pcm_frames_playback__webaudio=(i,s,l)=>(Wo=g._ma_device_process_pcm_frames_playback__webaudio=se.ma_device_process_pcm_frames_playback__webaudio)(i,s,l),Vo=i=>(Vo=se.__getTypeName)(i);g.__embind_initialize_bindings=()=>(g.__embind_initialize_bindings=se._embind_initialize_bindings)(),g.dynCall_iiji=(i,s,l,d,_)=>(g.dynCall_iiji=se.dynCall_iiji)(i,s,l,d,_),g.dynCall_jiji=(i,s,l,d,_)=>(g.dynCall_jiji=se.dynCall_jiji)(i,s,l,d,_),g.dynCall_iiiji=(i,s,l,d,_,b)=>(g.dynCall_iiiji=se.dynCall_iiiji)(i,s,l,d,_,b),g.dynCall_iij=(i,s,l,d)=>(g.dynCall_iij=se.dynCall_iij)(i,s,l,d),g.dynCall_jii=(i,s,l)=>(g.dynCall_jii=se.dynCall_jii)(i,s,l),g.dynCall_viijii=(i,s,l,d,_,b,k)=>(g.dynCall_viijii=se.dynCall_viijii)(i,s,l,d,_,b,k),g.dynCall_iiiiij=(i,s,l,d,_,b,k)=>(g.dynCall_iiiiij=se.dynCall_iiiiij)(i,s,l,d,_,b,k),g.dynCall_iiiiijj=(i,s,l,d,_,b,k,I,R)=>(g.dynCall_iiiiijj=se.dynCall_iiiiijj)(i,s,l,d,_,b,k,I,R),g.dynCall_iiiiiijj=(i,s,l,d,_,b,k,I,R,P)=>(g.dynCall_iiiiiijj=se.dynCall_iiiiiijj)(i,s,l,d,_,b,k,I,R,P);var mi;St=function i(){mi||qo(),mi||(St=i)};function qo(){function i(){if(!mi&&(mi=!0,g.calledRun=!0,!tt)){if(g.noFSInit||go||(go=!0,po(),g.stdin=g.stdin,g.stdout=g.stdout,g.stderr=g.stderr,g.stdin?Er("stdin",g.stdin):Vi("/dev/tty","/dev/stdin"),g.stdout?Er("stdout",null,g.stdout):Vi("/dev/tty","/dev/stdout"),g.stderr?Er("stderr",null,g.stderr):Vi("/dev/tty1","/dev/stderr"),ei("/dev/stdin",0),ei("/dev/stdout",1),ei("/dev/stderr",1)),so=!1,h(un),C(g),g.onRuntimeInitialized&&g.onRuntimeInitialized(),g.postRun)for(typeof g.postRun=="function"&&(g.postRun=[g.postRun]);g.postRun.length;){var s=g.postRun.shift();Gt.unshift(s)}h(Gt)}}if(!(0<ot)){if(g.preRun)for(typeof g.preRun=="function"&&(g.preRun=[g.preRun]);g.preRun.length;)kn();h(zt),0<ot||(g.setStatus?(g.setStatus("Running..."),setTimeout(function(){setTimeout(function(){g.setStatus("")},1),i()},1)):i())}}if(g.preInit)for(typeof g.preInit=="function"&&(g.preInit=[g.preInit]);0<g.preInit.length;)g.preInit.pop()();return qo(),E.ready})})();const y=m}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,f,v)=>{v.r(f),v.d(f,{Animation:()=>m.Animation});var m=v(4)}),((c,f,v)=>{v.r(f),v.d(f,{Animation:()=>m});var m=(function(){function y(A,E,g,C){this.animation=A,this.artboard=E,this.playing=C,this.loopCount=0,this.scrubTo=null,this.instance=new g.LinearAnimationInstance(A,E)}return Object.defineProperty(y.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"time",{get:function(){return this.instance.time},set:function(A){this.instance.time=A},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),y.prototype.advance=function(A){this.scrubTo===null?this.instance.advance(A):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},y.prototype.apply=function(A){this.instance.apply(A)},y.prototype.cleanup=function(){this.instance.delete()},y})()}),((c,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>A.AudioAssetWrapper,AudioWrapper:()=>A.AudioWrapper,BLANK_URL:()=>y.BLANK_URL,CustomFileAssetLoaderWrapper:()=>A.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>A.FileAssetWrapper,Finalizable:()=>A.Finalizable,FontAssetWrapper:()=>A.FontAssetWrapper,FontWrapper:()=>A.FontWrapper,ImageAssetWrapper:()=>A.ImageAssetWrapper,ImageWrapper:()=>A.ImageWrapper,finalizationRegistry:()=>A.finalizationRegistry,registerTouchInteractions:()=>m.registerTouchInteractions,sanitizeUrl:()=>y.sanitizeUrl});var m=v(6),y=v(7),A=v(8)}),((c,f,v)=>{v.r(f),v.d(f,{registerTouchInteractions:()=>A});var m=void 0,y=function(E,g){var C,j;return["touchstart","touchmove"].indexOf(E.type)>-1&&(!((C=E.touches)===null||C===void 0)&&C.length)?(g||E.preventDefault(),{clientX:E.touches[0].clientX,clientY:E.touches[0].clientY}):E.type==="touchend"&&(!((j=E.changedTouches)===null||j===void 0)&&j.length)?{clientX:E.changedTouches[0].clientX,clientY:E.changedTouches[0].clientY}:{clientX:E.clientX,clientY:E.clientY}},A=function(E){var g=E.canvas,C=E.artboard,j=E.stateMachines,F=j===void 0?[]:j,q=E.renderer,B=E.rive,D=E.fit,x=E.alignment,K=E.isTouchScrollEnabled,M=K===void 0?!1:K,L=E.layoutScaleFactor,ee=L===void 0?1:L;if(!g||!F.length||!q||!B||!C||typeof window>"u")return null;var X=null,ae=!1,z=function(Ne){if(ae&&Ne instanceof MouseEvent){Ne.type=="mouseup"&&(ae=!1);return}ae=M&&Ne.type==="touchend"&&X==="touchstart",X=Ne.type;var Be=Ne.currentTarget.getBoundingClientRect(),De=y(Ne,M),At=De.clientX,se=De.clientY;if(!(!At&&!se)){var tt=At-Be.left,He=se-Be.top,Me=B.computeAlignment(D,x,{minX:0,minY:0,maxX:Be.width,maxY:Be.height},C.bounds,ee),Qe=new B.Mat2D;Me.invert(Qe);var Et=new B.Vec2D(tt,He),me=B.mapXY(Qe,Et),Se=me.x(),kt=me.y();switch(me.delete(),Qe.delete(),Et.delete(),Me.delete(),Ne.type){case"mouseout":for(var Ie=0,ct=F;Ie<ct.length;Ie++){var Ue=ct[Ie];Ue.pointerMove(Se,kt)}break;case"touchmove":case"mouseover":case"mousemove":{for(var zt=0,un=F;zt<un.length;zt++){var Ue=un[zt];Ue.pointerMove(Se,kt)}break}case"touchstart":case"mousedown":{for(var Gt=0,kn=F;Gt<kn.length;Gt++){var Ue=kn[Gt];Ue.pointerDown(Se,kt)}break}case"touchend":case"mouseup":{for(var ot=0,St=F;ot<St.length;ot++){var Ue=St[ot];Ue.pointerUp(Se,kt)}break}}}},re=z.bind(m);return g.addEventListener("mouseover",re),g.addEventListener("mouseout",re),g.addEventListener("mousemove",re),g.addEventListener("mousedown",re),g.addEventListener("mouseup",re),g.addEventListener("touchmove",re,{passive:M}),g.addEventListener("touchstart",re,{passive:M}),g.addEventListener("touchend",re),function(){g.removeEventListener("mouseover",re),g.removeEventListener("mouseout",re),g.removeEventListener("mousemove",re),g.removeEventListener("mousedown",re),g.removeEventListener("mouseup",re),g.removeEventListener("touchmove",re),g.removeEventListener("touchstart",re),g.removeEventListener("touchend",re)}}}),((c,f,v)=>{v.r(f),v.d(f,{BLANK_URL:()=>j,sanitizeUrl:()=>B});var m=/^([^\w]*)(javascript|data|vbscript)/im,y=/&#(\w+)(^\w|;)?/g,A=/&(newline|tab);/gi,E=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,g=/^.+(:|&colon;)/gim,C=[".","/"],j="about:blank";function F(D){return C.indexOf(D[0])>-1}function q(D){var x=D.replace(E,"");return x.replace(y,function(K,M){return String.fromCharCode(M)})}function B(D){if(!D)return j;var x=q(D).replace(A,"").replace(E,"").trim();if(!x)return j;if(F(x))return x;var K=x.match(g);if(!K)return x;var M=K[0];return m.test(M)?j:x}}),((c,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>q,AudioWrapper:()=>E,CustomFileAssetLoaderWrapper:()=>C,FileAssetWrapper:()=>j,Finalizable:()=>y,FontAssetWrapper:()=>B,FontWrapper:()=>g,ImageAssetWrapper:()=>F,ImageWrapper:()=>A,finalizationRegistry:()=>K});var m=(function(){var M=function(L,ee){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,ae){X.__proto__=ae}||function(X,ae){for(var z in ae)Object.prototype.hasOwnProperty.call(ae,z)&&(X[z]=ae[z])},M(L,ee)};return function(L,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");M(L,ee);function X(){this.constructor=L}L.prototype=ee===null?Object.create(ee):(X.prototype=ee.prototype,new X)}})(),y=(function(){function M(){this.selfUnref=!1}return M})(),A=(function(M){m(L,M);function L(ee){var X=M.call(this)||this;return X._nativeImage=ee,X}return Object.defineProperty(L.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},L})(y),E=(function(M){m(L,M);function L(ee){var X=M.call(this)||this;return X._nativeAudio=ee,X}return Object.defineProperty(L.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},L})(y),g=(function(M){m(L,M);function L(ee){var X=M.call(this)||this;return X._nativeFont=ee,X}return Object.defineProperty(L.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},L})(y),C=(function(){function M(L,ee){this._assetLoaderCallback=ee,this.assetLoader=new L.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return M.prototype.loadContents=function(L,ee){var X;return L.isImage?X=new F(L):L.isAudio?X=new q(L):L.isFont&&(X=new B(L)),this._assetLoaderCallback(X,ee)},M})(),j=(function(){function M(L){this._nativeFileAsset=L}return M.prototype.decode=function(L){this._nativeFileAsset.decode(L)},Object.defineProperty(M.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),M})(),F=(function(M){m(L,M);function L(){return M!==null&&M.apply(this,arguments)||this}return L.prototype.setRenderImage=function(ee){this._nativeFileAsset.setRenderImage(ee.nativeImage)},L})(j),q=(function(M){m(L,M);function L(){return M!==null&&M.apply(this,arguments)||this}return L.prototype.setAudioSource=function(ee){this._nativeFileAsset.setAudioSource(ee.nativeAudio)},L})(j),B=(function(M){m(L,M);function L(){return M!==null&&M.apply(this,arguments)||this}return L.prototype.setFont=function(ee){this._nativeFileAsset.setFont(ee.nativeFont)},L})(j),D=(function(){function M(L){}return M.prototype.register=function(L){L.selfUnref=!0},M.prototype.unregister=function(L){},M})(),x=typeof FinalizationRegistry<"u"?FinalizationRegistry:D,K=new x(function(M){M.unref()})})],r={};function o(c){var f=r[c];if(f!==void 0)return f.exports;var v=r[c]={exports:{}};return t[c](v,v.exports,o),v.exports}o.d=(c,f)=>{for(var v in f)o.o(f,v)&&!o.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:f[v]})},o.o=(c,f)=>Object.prototype.hasOwnProperty.call(c,f),o.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var u={};return(()=>{o.r(u),o.d(u,{Alignment:()=>B,DataEnum:()=>kt,EventType:()=>z,Fit:()=>q,Layout:()=>D,LoopType:()=>re,Rive:()=>me,RiveEventType:()=>L,RiveFile:()=>Et,RuntimeLoader:()=>x,StateMachineInput:()=>M,StateMachineInputType:()=>K,Testing:()=>$i,ViewModel:()=>Se,ViewModelInstance:()=>ct,ViewModelInstanceArtboard:()=>Kt,ViewModelInstanceAssetImage:()=>br,ViewModelInstanceBoolean:()=>Gt,ViewModelInstanceColor:()=>ln,ViewModelInstanceEnum:()=>ot,ViewModelInstanceList:()=>St,ViewModelInstanceNumber:()=>un,ViewModelInstanceString:()=>zt,ViewModelInstanceTrigger:()=>kn,ViewModelInstanceValue:()=>Ue,decodeAudio:()=>Yr,decodeFont:()=>cn,decodeImage:()=>Ni});var c=o(1),f=o(2),v=o(3),m=o(5),y=(function(){var p=function(a,h){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,T){w.__proto__=T}||function(w,T){for(var O in T)Object.prototype.hasOwnProperty.call(T,O)&&(w[O]=T[O])},p(a,h)};return function(a,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");p(a,h);function w(){this.constructor=a}a.prototype=h===null?Object.create(h):(w.prototype=h.prototype,new w)}})(),A=function(){return A=Object.assign||function(p){for(var a,h=1,w=arguments.length;h<w;h++){a=arguments[h];for(var T in a)Object.prototype.hasOwnProperty.call(a,T)&&(p[T]=a[T])}return p},A.apply(this,arguments)},E=function(p,a,h,w){function T(O){return O instanceof h?O:new h(function($){$(O)})}return new(h||(h=Promise))(function(O,$){function ne(ve){try{Z(w.next(ve))}catch(Ce){$(Ce)}}function ue(ve){try{Z(w.throw(ve))}catch(Ce){$(Ce)}}function Z(ve){ve.done?O(ve.value):T(ve.value).then(ne,ue)}Z((w=w.apply(p,a||[])).next())})},g=function(p,a){var h={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},w,T,O,$=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return $.next=ne(0),$.throw=ne(1),$.return=ne(2),typeof Symbol=="function"&&($[Symbol.iterator]=function(){return this}),$;function ne(Z){return function(ve){return ue([Z,ve])}}function ue(Z){if(w)throw new TypeError("Generator is already executing.");for(;$&&($=0,Z[0]&&(h=0)),h;)try{if(w=1,T&&(O=Z[0]&2?T.return:Z[0]?T.throw||((O=T.return)&&O.call(T),0):T.next)&&!(O=O.call(T,Z[1])).done)return O;switch(T=0,O&&(Z=[Z[0]&2,O.value]),Z[0]){case 0:case 1:O=Z;break;case 4:return h.label++,{value:Z[1],done:!1};case 5:h.label++,T=Z[1],Z=[0];continue;case 7:Z=h.ops.pop(),h.trys.pop();continue;default:if(O=h.trys,!(O=O.length>0&&O[O.length-1])&&(Z[0]===6||Z[0]===2)){h=0;continue}if(Z[0]===3&&(!O||Z[1]>O[0]&&Z[1]<O[3])){h.label=Z[1];break}if(Z[0]===6&&h.label<O[1]){h.label=O[1],O=Z;break}if(O&&h.label<O[2]){h.label=O[2],h.ops.push(Z);break}O[2]&&h.ops.pop(),h.trys.pop();continue}Z=a.call(p,h)}catch(ve){Z=[6,ve],T=0}finally{w=O=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}},C=function(p,a,h){if(h||arguments.length===2)for(var w=0,T=a.length,O;w<T;w++)(O||!(w in a))&&(O||(O=Array.prototype.slice.call(a,0,w)),O[w]=a[w]);return p.concat(O||Array.prototype.slice.call(a))},j=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h.isHandledError=!0,h}return a})(Error),F=function(p){return p&&p.isHandledError?p.message:"Problem loading file; may be corrupt!"},q;(function(p){p.Cover="cover",p.Contain="contain",p.Fill="fill",p.FitWidth="fitWidth",p.FitHeight="fitHeight",p.None="none",p.ScaleDown="scaleDown",p.Layout="layout"})(q||(q={}));var B;(function(p){p.Center="center",p.TopLeft="topLeft",p.TopCenter="topCenter",p.TopRight="topRight",p.CenterLeft="centerLeft",p.CenterRight="centerRight",p.BottomLeft="bottomLeft",p.BottomCenter="bottomCenter",p.BottomRight="bottomRight"})(B||(B={}));var D=(function(){function p(a){var h,w,T,O,$,ne,ue;this.fit=(h=a?.fit)!==null&&h!==void 0?h:q.Contain,this.alignment=(w=a?.alignment)!==null&&w!==void 0?w:B.Center,this.layoutScaleFactor=(T=a?.layoutScaleFactor)!==null&&T!==void 0?T:1,this.minX=(O=a?.minX)!==null&&O!==void 0?O:0,this.minY=($=a?.minY)!==null&&$!==void 0?$:0,this.maxX=(ne=a?.maxX)!==null&&ne!==void 0?ne:0,this.maxY=(ue=a?.maxY)!==null&&ue!==void 0?ue:0}return p.new=function(a){var h=a.fit,w=a.alignment,T=a.minX,O=a.minY,$=a.maxX,ne=a.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new p({fit:h,alignment:w,minX:T,minY:O,maxX:$,maxY:ne})},p.prototype.copyWith=function(a){var h=a.fit,w=a.alignment,T=a.layoutScaleFactor,O=a.minX,$=a.minY,ne=a.maxX,ue=a.maxY;return new p({fit:h??this.fit,alignment:w??this.alignment,layoutScaleFactor:T??this.layoutScaleFactor,minX:O??this.minX,minY:$??this.minY,maxX:ne??this.maxX,maxY:ue??this.maxY})},p.prototype.runtimeFit=function(a){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var h;return this.fit===q.Cover?h=a.Fit.cover:this.fit===q.Contain?h=a.Fit.contain:this.fit===q.Fill?h=a.Fit.fill:this.fit===q.FitWidth?h=a.Fit.fitWidth:this.fit===q.FitHeight?h=a.Fit.fitHeight:this.fit===q.ScaleDown?h=a.Fit.scaleDown:this.fit===q.Layout?h=a.Fit.layout:h=a.Fit.none,this.cachedRuntimeFit=h,h},p.prototype.runtimeAlignment=function(a){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var h;return this.alignment===B.TopLeft?h=a.Alignment.topLeft:this.alignment===B.TopCenter?h=a.Alignment.topCenter:this.alignment===B.TopRight?h=a.Alignment.topRight:this.alignment===B.CenterLeft?h=a.Alignment.centerLeft:this.alignment===B.CenterRight?h=a.Alignment.centerRight:this.alignment===B.BottomLeft?h=a.Alignment.bottomLeft:this.alignment===B.BottomCenter?h=a.Alignment.bottomCenter:this.alignment===B.BottomRight?h=a.Alignment.bottomRight:h=a.Alignment.center,this.cachedRuntimeAlignment=h,h},p})(),x=(function(){function p(){}return p.loadRuntime=function(){c.default({locateFile:function(){return p.wasmURL}}).then(function(a){var h;for(p.runtime=a;p.callBackQueue.length>0;)(h=p.callBackQueue.shift())===null||h===void 0||h(p.runtime)}).catch(function(a){var h={message:a?.message||"Unknown error",type:a?.name||"Error",wasmError:a instanceof WebAssembly.CompileError||a instanceof WebAssembly.RuntimeError,originalError:a};console.debug("Rive WASM load error details:",h);var w="https://cdn.jsdelivr.net/npm/".concat(f.name,"@").concat(f.version,"/rive_fallback.wasm");if(p.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(p.wasmURL," (").concat(h.message,"), trying jsdelivr as a backup")),p.setWasmUrl(w),p.loadRuntime();else{var T=["Could not load Rive WASM file from ".concat(p.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(h.type),"- Message: ".concat(h.message),"- WebAssembly-specific error: ".concat(h.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(T)}})},p.getInstance=function(a){p.isLoading||(p.isLoading=!0,p.loadRuntime()),p.runtime?a(p.runtime):p.callBackQueue.push(a)},p.awaitInstance=function(){return new Promise(function(a){return p.getInstance(function(h){return a(h)})})},p.setWasmUrl=function(a){p.wasmURL=a},p.getWasmUrl=function(){return p.wasmURL},p.isLoading=!1,p.callBackQueue=[],p.wasmURL="https://unpkg.com/".concat(f.name,"@").concat(f.version,"/rive.wasm"),p})(),K;(function(p){p[p.Number=56]="Number",p[p.Trigger=58]="Trigger",p[p.Boolean=59]="Boolean"})(K||(K={}));var M=(function(){function p(a,h){this.type=a,this.runtimeInput=h}return Object.defineProperty(p.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(a){this.runtimeInput.value=a},enumerable:!1,configurable:!0}),p.prototype.fire=function(){this.type===K.Trigger&&this.runtimeInput.fire()},p.prototype.delete=function(){this.runtimeInput=null},p})(),L;(function(p){p[p.General=128]="General",p[p.OpenUrl=131]="OpenUrl"})(L||(L={}));var ee=(function(){function p(a){this.nativeArtboard=a}return p})(),X=(function(){function p(a,h,w,T){this.stateMachine=a,this.playing=w,this.artboard=T,this.inputs=[],this.instance=new h.StateMachineInstance(a,T),this.initInputs(h)}return Object.defineProperty(p.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statesChanged",{get:function(){for(var a=[],h=0;h<this.instance.stateChangedCount();h++)a.push(this.instance.stateChangedNameByIndex(h));return a},enumerable:!1,configurable:!0}),p.prototype.advance=function(a){this.instance.advance(a)},p.prototype.advanceAndApply=function(a){this.instance.advanceAndApply(a)},p.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},p.prototype.reportedEventAt=function(a){return this.instance.reportedEventAt(a)},p.prototype.initInputs=function(a){for(var h=0;h<this.instance.inputCount();h++){var w=this.instance.input(h);this.inputs.push(this.mapRuntimeInput(w,a))}},p.prototype.mapRuntimeInput=function(a,h){if(a.type===h.SMIInput.bool)return new M(K.Boolean,a.asBool());if(a.type===h.SMIInput.number)return new M(K.Number,a.asNumber());if(a.type===h.SMIInput.trigger)return new M(K.Trigger,a.asTrigger())},p.prototype.cleanup=function(){this.inputs.forEach(function(a){a.delete()}),this.inputs.length=0,this.instance.delete()},p.prototype.bindViewModelInstance=function(a){a.runtimeInstance!=null&&this.instance.bindViewModelInstance(a.runtimeInstance)},p})(),ae=(function(){function p(a,h,w,T,O){T===void 0&&(T=[]),O===void 0&&(O=[]),this.runtime=a,this.artboard=h,this.eventManager=w,this.animations=T,this.stateMachines=O}return p.prototype.add=function(a,h,w){if(w===void 0&&(w=!0),a=ht(a),a.length===0)this.animations.forEach(function(je){return je.playing=h}),this.stateMachines.forEach(function(je){return je.playing=h});else for(var T=this.animations.map(function(je){return je.name}),O=this.stateMachines.map(function(je){return je.name}),$=0;$<a.length;$++){var ne=T.indexOf(a[$]),ue=O.indexOf(a[$]);if(ne>=0||ue>=0)ne>=0?this.animations[ne].playing=h:this.stateMachines[ue].playing=h;else{var Z=this.artboard.animationByName(a[$]);if(Z){var ve=new v.Animation(Z,this.artboard,this.runtime,h);ve.advance(0),ve.apply(1),this.animations.push(ve)}else{var Ce=this.artboard.stateMachineByName(a[$]);if(Ce){var ze=new X(Ce,this.runtime,h,this.artboard);this.stateMachines.push(ze)}}}}return w&&(h?this.eventManager.fire({type:z.Play,data:this.playing}):this.eventManager.fire({type:z.Pause,data:this.paused})),h?this.playing:this.paused},p.prototype.initLinearAnimations=function(a,h){for(var w=this.animations.map(function(ue){return ue.name}),T=0;T<a.length;T++){var O=w.indexOf(a[T]);if(O>=0)this.animations[O].playing=h;else{var $=this.artboard.animationByName(a[T]);if($){var ne=new v.Animation($,this.artboard,this.runtime,h);ne.advance(0),ne.apply(1),this.animations.push(ne)}else console.error("Animation with name ".concat(a[T]," not found."))}}},p.prototype.initStateMachines=function(a,h){for(var w=this.stateMachines.map(function(ue){return ue.name}),T=0;T<a.length;T++){var O=w.indexOf(a[T]);if(O>=0)this.stateMachines[O].playing=h;else{var $=this.artboard.stateMachineByName(a[T]);if($){var ne=new X($,this.runtime,h,this.artboard);this.stateMachines.push(ne),h||ne.advanceAndApply(0)}else console.warn("State Machine with name ".concat(a[T]," not found.")),this.initLinearAnimations([a[T]],h)}}},p.prototype.play=function(a){return this.add(a,!0)},p.prototype.pause=function(a){return this.add(a,!1)},p.prototype.scrub=function(a,h){var w=this.animations.filter(function(T){return a.includes(T.name)});return w.forEach(function(T){return T.scrubTo=h}),w.map(function(T){return T.name})},Object.defineProperty(p.prototype,"playing",{get:function(){return this.animations.filter(function(a){return a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"paused",{get:function(){return this.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),p.prototype.stop=function(a){var h=this;a=ht(a);var w=[];if(a.length===0)w=this.animations.map(function($){return $.name}).concat(this.stateMachines.map(function($){return $.name})),this.animations.forEach(function($){return $.cleanup()}),this.stateMachines.forEach(function($){return $.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var T=this.animations.filter(function($){return a.includes($.name)});T.forEach(function($){$.cleanup(),h.animations.splice(h.animations.indexOf($),1)});var O=this.stateMachines.filter(function($){return a.includes($.name)});O.forEach(function($){$.cleanup(),h.stateMachines.splice(h.stateMachines.indexOf($),1)}),w=T.map(function($){return $.name}).concat(O.map(function($){return $.name}))}return this.eventManager.fire({type:z.Stop,data:w}),w},Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(a,h){return a||h.playing},!1)||this.stateMachines.reduce(function(a,h){return a||h.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),p.prototype.atLeastOne=function(a,h){h===void 0&&(h=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],a,h):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],a,h)),w},p.prototype.handleLooping=function(){for(var a=0,h=this.animations.filter(function(T){return T.playing});a<h.length;a++){var w=h[a];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:z.Loop,data:{animation:w.name,type:re.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:z.Loop,data:{animation:w.name,type:re.PingPong}}),w.loopCount=0)}},p.prototype.handleStateChanges=function(){for(var a=[],h=0,w=this.stateMachines.filter(function(O){return O.playing});h<w.length;h++){var T=w[h];a.push.apply(a,T.statesChanged)}a.length>0&&this.eventManager.fire({type:z.StateChange,data:a})},p.prototype.handleAdvancing=function(a){this.eventManager.fire({type:z.Advance,data:a})},p})(),z;(function(p){p.Load="load",p.LoadError="loaderror",p.Play="play",p.Pause="pause",p.Stop="stop",p.Loop="loop",p.Draw="draw",p.Advance="advance",p.StateChange="statechange",p.RiveEvent="riveevent",p.AudioStatusChange="audiostatuschange"})(z||(z={}));var re;(function(p){p.OneShot="oneshot",p.Loop="loop",p.PingPong="pingpong"})(re||(re={}));var Ne=(function(){function p(a){a===void 0&&(a=[]),this.listeners=a}return p.prototype.getListeners=function(a){return this.listeners.filter(function(h){return h.type===a})},p.prototype.add=function(a){this.listeners.includes(a)||this.listeners.push(a)},p.prototype.remove=function(a){for(var h=0;h<this.listeners.length;h++){var w=this.listeners[h];if(w.type===a.type&&w.callback===a.callback){this.listeners.splice(h,1);break}}},p.prototype.removeAll=function(a){var h=this;a?this.listeners.filter(function(w){return w.type===a}).forEach(function(w){return h.remove(w)}):this.listeners.splice(0,this.listeners.length)},p.prototype.fire=function(a){var h=this.getListeners(a.type);h.forEach(function(w){return w.callback(a)})},p})(),Be=(function(){function p(a){this.eventManager=a,this.queue=[]}return p.prototype.add=function(a){this.queue.push(a)},p.prototype.process=function(){for(;this.queue.length>0;){var a=this.queue.shift();a?.action&&a.action(),a?.event&&this.eventManager.fire(a.event)}},p})(),De;(function(p){p[p.AVAILABLE=0]="AVAILABLE",p[p.UNAVAILABLE=1]="UNAVAILABLE"})(De||(De={}));var At=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h._started=!1,h._enabled=!1,h._status=De.UNAVAILABLE,h}return a.prototype.delay=function(h){return E(this,void 0,void 0,function(){return g(this,function(w){return[2,new Promise(function(T){return setTimeout(T,h)})]})})},a.prototype.timeout=function(){return E(this,void 0,void 0,function(){return g(this,function(h){return[2,new Promise(function(w,T){return setTimeout(T,50)})]})})},a.prototype.reportToListeners=function(){this.fire({type:z.AudioStatusChange}),this.removeAll()},a.prototype.enableAudio=function(){return E(this,void 0,void 0,function(){return g(this,function(h){return this._enabled||(this._enabled=!0,this._status=De.AVAILABLE,this.reportToListeners()),[2]})})},a.prototype.testAudio=function(){return E(this,void 0,void 0,function(){return g(this,function(h){switch(h.label){case 0:if(!(this._status===De.UNAVAILABLE&&this._audioContext!==null))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return h.sent(),this.enableAudio(),[3,4];case 3:return h.sent(),[3,4];case 4:return[2]}})})},a.prototype._establishAudio=function(){return E(this,void 0,void 0,function(){return g(this,function(h){switch(h.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),h.label=2;case 2:return this._status!==De.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return h.sent(),[4,this.delay(1e3)];case 4:return h.sent(),[3,2];case 5:return[2]}})})},a.prototype.listenForUserAction=function(){var h=this,w=function(){return E(h,void 0,void 0,function(){return g(this,function(T){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},a.prototype.establishAudio=function(){return E(this,void 0,void 0,function(){return g(this,function(h){return this._establishAudio(),[2]})})},Object.defineProperty(a.prototype,"systemVolume",{get:function(){return this._status===De.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),a})(Ne),se=new At,tt=(function(){function p(){}return p.prototype.observe=function(){},p.prototype.unobserve=function(){},p.prototype.disconnect=function(){},p})(),He=globalThis.ResizeObserver||tt,Me=(function(){function p(){var a=this;this._elementsMap=new Map,this._onObservedEntry=function(h){var w=a._elementsMap.get(h.target);w!==null?w.onResize(h.target.clientWidth==0||h.target.clientHeight==0):a._resizeObserver.unobserve(h.target)},this._onObserved=function(h){h.forEach(a._onObservedEntry)},this._resizeObserver=new He(this._onObserved)}return p.prototype.add=function(a,h){var w={onResize:h,element:a};return this._elementsMap.set(a,w),this._resizeObserver.observe(a),w},p.prototype.remove=function(a){this._resizeObserver.unobserve(a.element),this._elementsMap.delete(a.element)},p})(),Qe=new Me,Et=(function(){function p(a){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=a.src,this.buffer=a.buffer,a.assetLoader&&(this.assetLoader=a.assetLoader),this.enableRiveAssetCDN=typeof a.enableRiveAssetCDN=="boolean"?a.enableRiveAssetCDN:!0,this.eventManager=new Ne,a.onLoad&&this.on(z.Load,a.onLoad),a.onLoadError&&this.on(z.LoadError,a.onLoadError)}return p.prototype.initData=function(){return E(this,void 0,void 0,function(){var a,h,w,T,O;return g(this,function($){switch($.label){case 0:return this.src?(a=this,[4,Kr(this.src)]):[3,2];case 1:a.buffer=$.sent(),$.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new m.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),h=w.assetLoader),T=this,[4,this.runtime.load(new Uint8Array(this.buffer),h,this.enableRiveAssetCDN)]);case 3:return T.file=$.sent(),this.destroyed?((O=this.file)===null||O===void 0||O.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:z.Load,data:this}):this.fireLoadError(p.fileLoadErrorMessage),[2])}})})},p.prototype.init=function(){return E(this,void 0,void 0,function(){var a,h;return g(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(p.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),a=this,[4,x.awaitInstance()];case 2:return a.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return h=w.sent(),this.fireLoadError(h instanceof Error?h.message:p.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},p.prototype.fireLoadError=function(a){throw this.eventManager.fire({type:z.LoadError,data:a}),new Error(a)},p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.cleanup=function(){var a;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(a=this.file)===null||a===void 0||a.delete(),this.file=null,this.destroyed=!0)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},p.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},p.prototype.getArtboard=function(a){var h=this.file.artboardByName(a);return h!=null?new ee(h):null},p.missingErrorMessage="Rive source file or data buffer required",p.fileLoadErrorMessage="The file failed to load",p})(),me=(function(){function p(a){var h=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(T){var O=h._hasZeroSize!==T;h._hasZeroSize=T,T?(!h._layout.maxX||!h._layout.maxY)&&h.resizeToCanvas():O&&h.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=a.canvas,a.canvas.constructor===HTMLCanvasElement&&(this._observed=Qe.add(this.canvas,this.onCanvasResize)),this.src=a.src,this.buffer=a.buffer,this.riveFile=a.riveFile,this.layout=(w=a.layout)!==null&&w!==void 0?w:new D,this.shouldDisableRiveListeners=!!a.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!a.isTouchScrollEnabled,this.automaticallyHandleEvents=!!a.automaticallyHandleEvents,this.enableRiveAssetCDN=a.enableRiveAssetCDN===void 0?!0:a.enableRiveAssetCDN,this.eventManager=new Ne,a.onLoad&&this.on(z.Load,a.onLoad),a.onLoadError&&this.on(z.LoadError,a.onLoadError),a.onPlay&&this.on(z.Play,a.onPlay),a.onPause&&this.on(z.Pause,a.onPause),a.onStop&&this.on(z.Stop,a.onStop),a.onLoop&&this.on(z.Loop,a.onLoop),a.onStateChange&&this.on(z.StateChange,a.onStateChange),a.onAdvance&&this.on(z.Advance,a.onAdvance),a.onload&&!a.onLoad&&this.on(z.Load,a.onload),a.onloaderror&&!a.onLoadError&&this.on(z.LoadError,a.onloaderror),a.onplay&&!a.onPlay&&this.on(z.Play,a.onplay),a.onpause&&!a.onPause&&this.on(z.Pause,a.onpause),a.onstop&&!a.onStop&&this.on(z.Stop,a.onstop),a.onloop&&!a.onLoop&&this.on(z.Loop,a.onloop),a.onstatechange&&!a.onStateChange&&this.on(z.StateChange,a.onstatechange),a.assetLoader&&(this.assetLoader=a.assetLoader),this.taskQueue=new Be(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:a.autoplay,autoBind:a.autoBind,animations:a.animations,stateMachines:a.stateMachines,artboard:a.artboard,useOffscreenRenderer:a.useOffscreenRenderer})}return Object.defineProperty(p.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),p.new=function(a){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new p(a)},p.prototype.onSystemAudioChanged=function(){this.volume=this._volume},p.prototype.init=function(a){var h=this,w=a.src,T=a.buffer,O=a.riveFile,$=a.animations,ne=a.stateMachines,ue=a.artboard,Z=a.autoplay,ve=Z===void 0?!1:Z,Ce=a.useOffscreenRenderer,ze=Ce===void 0?!1:Ce,je=a.autoBind,Ct=je===void 0?!1:je;if(!this.destroyed){if(this.src=w,this.buffer=T,this.riveFile=O,!this.src&&!this.buffer&&!this.riveFile)throw new j(p.missingErrorMessage);var pt=ht($),at=ht(ne);this.loaded=!1,this.readyForPlaying=!1,x.awaitInstance().then(function(ut){h.destroyed||(h.runtime=ut,h.removeRiveListeners(),h.deleteRiveRenderer(),h.renderer=h.runtime.makeRenderer(h.canvas,ze),h.canvas.width||h.canvas.height||h.resizeDrawingSurfaceToCanvas(),h.initData(ue,pt,at,ve,Ct).then(function(gt){if(gt)return h.setupRiveListeners()}).catch(function(gt){console.error(gt)}))}).catch(function(ut){console.error(ut)})}},p.prototype.setupRiveListeners=function(a){var h=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(O){return O.playing&&h.runtime.hasListeners(O.instance)}).map(function(O){return O.instance}),T=this.isTouchScrollEnabled;a&&"isTouchScrollEnabled"in a&&(T=a.isTouchScrollEnabled),this.eventCleanup=(0,m.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:T,layoutScaleFactor:this._layout.layoutScaleFactor})}},p.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},p.prototype.initializeAudio=function(){var a=this,h;se.status==De.UNAVAILABLE&&!((h=this.artboard)===null||h===void 0)&&h.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:z.AudioStatusChange,callback:function(){return a.onSystemAudioChanged()}},se.add(this._audioEventListener),se.establishAudio())},p.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},p.prototype.initData=function(a,h,w,T,O){return E(this,void 0,void 0,function(){var $,ne,ue,Z;return g(this,function(ve){switch(ve.label){case 0:return ve.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:($=new Et({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=$,[4,$.init()]);case 1:if(ve.sent(),this.destroyed)return $.destroyIfUnused(),[2,!1];ve.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(a,h,w,T,O),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:z.Load,data:(Z=this.src)!==null&&Z!==void 0?Z:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return ne=ve.sent(),ue=F(ne),console.warn(ue),this.eventManager.fire({type:z.LoadError,data:ue}),[2,Promise.reject(ue)];case 4:return[2]}})})},p.prototype.initArtboard=function(a,h,w,T,O){if(this.file){var $=a?this.file.artboardByName(a):this.file.defaultArtboard();if(!$){var ne="Invalid artboard name or no default artboard";console.warn(ne),this.eventManager.fire({type:z.LoadError,data:ne});return}if(this.artboard=$,$.volume=this._volume*se.systemVolume,this.artboard.animationCount()<1){var ne="Artboard has no animations";throw this.eventManager.fire({type:z.LoadError,data:ne}),ne}this.animator=new ae(this.runtime,this.artboard,this.eventManager);var ue;if(h.length>0||w.length>0?(ue=h.concat(w),this.animator.initLinearAnimations(h,T),this.animator.initStateMachines(w,T)):ue=[this.animator.atLeastOne(T,!1)],this.taskQueue.add({event:{type:T?z.Play:z.Pause,data:ue}}),O){var Z=this.file.defaultArtboardViewModel($);if(Z!==null){var ve=Z.defaultInstance();if(ve!==null){var Ce=new ct(ve,null);this.bindViewModelInstance(Ce)}}}}},p.prototype.drawFrame=function(){var a,h;!((a=document?.timeline)===null||a===void 0)&&a.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(h=this.runtime)===null||h===void 0||h.resolveAnimationFrame()):this.startRendering()},p.prototype.draw=function(a,h){var w;this.frameRequestId=null;var T=performance.now();this.lastRenderTime||(this.lastRenderTime=a),this.renderSecondTimer+=a-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,h?.());var O=(a-this.lastRenderTime)/1e3;this.lastRenderTime=a;for(var $=this.animator.animations.filter(function(Dt){return Dt.playing||Dt.needsScrub}).sort(function(Dt){return Dt.needsScrub?-1:1}),ne=0,ue=$;ne<ue.length;ne++){var Z=ue[ne];Z.advance(O),Z.instance.didLoop&&(Z.loopCount+=1),Z.apply(1)}for(var ve=this.animator.stateMachines.filter(function(Dt){return Dt.playing}),Ce=0,ze=ve;Ce<ze.length;Ce++){var je=ze[Ce],Ct=je.reportedEventCount();if(Ct)for(var pt=0;pt<Ct;pt++){var at=je.reportedEventAt(pt);if(at)if(at.type===L.OpenUrl){if(this.eventManager.fire({type:z.RiveEvent,data:at}),this.automaticallyHandleEvents){var ut=document.createElement("a"),gt=at,hn=gt.url,dn=gt.target,Ft=(0,m.sanitizeUrl)(hn);hn&&ut.setAttribute("href",Ft),dn&&ut.setAttribute("target",dn),Ft&&Ft!==m.BLANK_URL&&ut.click()}}else this.eventManager.fire({type:z.RiveEvent,data:at})}je.advanceAndApply(O)}this.animator.stateMachines.length==0&&this.artboard.advance(O);var oe=this.renderer;oe.clear(),oe.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(oe),oe.restore(),oe.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(O),this.frameCount++;var Ae=performance.now();for(this.frameTimes.push(Ae),this.durations.push(Ae-T);this.frameTimes[0]<=Ae-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},p.prototype.alignRenderer=function(){var a=this,h=a.renderer,w=a.runtime,T=a._layout,O=a.artboard;h.align(T.runtimeFit(w),T.runtimeAlignment(w),{minX:T.minX,minY:T.minY,maxX:T.maxX,maxY:T.maxY},O.bounds,this._devicePixelRatioUsed*T.layoutScaleFactor)},Object.defineProperty(p.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(a,h){return a+h},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),p.prototype.cleanup=function(){var a,h;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&Qe.remove(this._observed),this.removeRiveListeners(),this.file&&((a=this.riveFile)===null||a===void 0||a.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(se.remove(this._audioEventListener),this._audioEventListener=null),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=null,this._dataEnums=null},p.prototype.deleteRiveRenderer=function(){var a;(a=this.renderer)===null||a===void 0||a.delete(),this.renderer=null},p.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},p.prototype.retrieveTextRun=function(a){var h;if(!a){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(a);if(!w){console.warn("Could not access a text run with name '".concat(a,"' in the '").concat((h=this.artboard)===null||h===void 0?void 0:h.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},p.prototype.getTextRunValue=function(a){var h=this.retrieveTextRun(a);return h?h.text:void 0},p.prototype.setTextRunValue=function(a,h){var w=this.retrieveTextRun(a);w&&(w.text=h)},p.prototype.play=function(a,h){var w=this;if(a=ht(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(a,h)}});return}this.animator.play(a),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},p.prototype.pause=function(a){var h=this;if(a=ht(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.pause(a)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(a)},p.prototype.scrub=function(a,h){var w=this;if(a=ht(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(a,h)}});return}this.animator.scrub(a,h||0),this.drawFrame()},p.prototype.stop=function(a){var h=this;if(a=ht(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.stop(a)}});return}this.animator&&this.animator.stop(a),this.eventCleanup&&this.eventCleanup()},p.prototype.reset=function(a){var h,w,T=a?.artboard,O=ht(a?.animations),$=ht(a?.stateMachines),ne=(h=a?.autoplay)!==null&&h!==void 0?h:!1,ue=(w=a?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(T,O,$,ne,ue),this.taskQueue.process()},p.prototype.load=function(a){this.file=null,this.stop(),this.init(a)},Object.defineProperty(p.prototype,"layout",{get:function(){return this._layout},set:function(a){this._layout=a,(!a.maxX||!a.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),p.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},p.prototype.resizeDrawingSurfaceToCanvas=function(a){if(this.canvas instanceof HTMLCanvasElement&&window){var h=this.canvas.getBoundingClientRect(),w=h.width,T=h.height,O=a||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=O,this.canvas.width=O*w,this.canvas.height=O*T,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===q.Layout){var $=this._layout.layoutScaleFactor;this.artboard.width=w/$,this.artboard.height=T/$}}},Object.defineProperty(p.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.animationCount();h++)a.push(this.artboard.animationByIndex(h).name);return a},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.stateMachineCount();h++)a.push(this.artboard.stateMachineByIndex(h).name);return a},enumerable:!1,configurable:!0}),p.prototype.stateMachineInputs=function(a){if(this.loaded){var h=this.animator.stateMachines.find(function(w){return w.name===a});return h?.inputs}},p.prototype.retrieveInputAtPath=function(a,h){if(!a){console.warn("No input name provided for path '".concat(h,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(a,h);if(!w){console.warn("Could not access an input with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.setBooleanStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===K.Boolean?T.asBool().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a boolean")))},p.prototype.setNumberStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===K.Number?T.asNumber().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a number")))},p.prototype.fireStateAtPath=function(a,h){var w=this.retrieveInputAtPath(a,h);w&&(w.type===K.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(a,"', at path:'").concat(h,"' is not a trigger")))},p.prototype.retrieveTextAtPath=function(a,h){if(!a){console.warn("No text name provided for path '".concat(h,"'"));return}if(!h){console.warn("No path provided for text '".concat(a,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.textByPath(a,h);if(!w){console.warn("Could not access text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.getTextRunValueAtPath=function(a,h){var w=this.retrieveTextAtPath(a,h);if(!w){console.warn("Could not get text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w.text},p.prototype.setTextRunValueAtPath=function(a,h,w){var T=this.retrieveTextAtPath(a,w);if(!T){console.warn("Could not set text with name: '".concat(a,"', at path:'").concat(w,"'"));return}T.text=h},Object.defineProperty(p.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.unsubscribe=function(a,h){console.warn("This function is deprecated: please use `off()` instead."),this.off(a,h)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.unsubscribeAll=function(a){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(a)},p.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},p.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},p.prototype.enableFPSCounter=function(a){this.runtime.enableFPSCounter(a)},p.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(p.prototype,"contents",{get:function(){if(this.loaded){for(var a={artboards:[]},h=0;h<this.file.artboardCount();h++){for(var w=this.file.artboardByIndex(h),T={name:w.name,animations:[],stateMachines:[]},O=0;O<w.animationCount();O++){var $=w.animationByIndex(O);T.animations.push($.name)}for(var ne=0;ne<w.stateMachineCount();ne++){for(var ue=w.stateMachineByIndex(ne),Z=ue.name,ve=new this.runtime.StateMachineInstance(ue,w),Ce=[],ze=0;ze<ve.inputCount();ze++){var je=ve.input(ze);Ce.push({name:je.name,type:je.type})}T.stateMachines.push({name:Z,inputs:Ce})}a.artboards.push(T)}return a}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(a){this._volume=a,this.artboard&&(this.artboard.volume=a*se.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardWidth",{get:function(){var a;return this.artboard?this.artboard.width:(a=this._artboardWidth)!==null&&a!==void 0?a:0},set:function(a){this._artboardWidth=a,this.artboard&&(this.artboard.width=a)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardHeight",{get:function(){var a;return this.artboard?this.artboard.height:(a=this._artboardHeight)!==null&&a!==void 0?a:0},set:function(a){this._artboardHeight=a,this.artboard&&(this.artboard.height=a)},enumerable:!1,configurable:!0}),p.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(p.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(a){this._devicePixelRatioUsed=a},enumerable:!1,configurable:!0}),p.prototype.bindViewModelInstance=function(a){var h;this.artboard&&!this.destroyed&&a&&a.runtimeInstance&&(a.internalIncrementReferenceCount(),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=a,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(a)}):this.artboard.bindViewModelInstance(a.runtimeInstance))},Object.defineProperty(p.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),p.prototype.viewModelByIndex=function(a){var h=this.file.viewModelByIndex(a);return h!==null?new Se(h):null},p.prototype.viewModelByName=function(a){var h=this.file.viewModelByName(a);return h!==null?new Se(h):null},p.prototype.enums=function(){if(this._dataEnums===null){var a=this.file.enums();this._dataEnums=a.map(function(h){return new kt(h)})}return this._dataEnums},p.prototype.defaultViewModel=function(){if(this.artboard){var a=this.file.defaultArtboardViewModel(this.artboard);if(a)return new Se(a)}return null},p.prototype.getArtboard=function(a){var h,w;return(w=(h=this.riveFile)===null||h===void 0?void 0:h.getArtboard(a))!==null&&w!==void 0?w:null},p.missingErrorMessage="Rive source file or data buffer required",p.cleanupErrorMessage="Attempt to use file after calling cleanup.",p})(),Se=(function(){function p(a){this._viewModel=a}return Object.defineProperty(p.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),p.prototype.instanceByIndex=function(a){var h=this._viewModel.instanceByIndex(a);return h!==null?new ct(h,null):null},p.prototype.instanceByName=function(a){var h=this._viewModel.instanceByName(a);return h!==null?new ct(h,null):null},p.prototype.defaultInstance=function(){var a=this._viewModel.defaultInstance();return a!==null?new ct(a,null):null},p.prototype.instance=function(){var a=this._viewModel.instance();return a!==null?new ct(a,null):null},Object.defineProperty(p.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),p})(),kt=(function(){function p(a){this._dataEnum=a}return Object.defineProperty(p.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),p})(),Ie;(function(p){p.Number="number",p.String="string",p.Boolean="boolean",p.Color="color",p.Trigger="trigger",p.Enum="enum",p.List="list",p.Image="image",p.Artboard="artboard"})(Ie||(Ie={}));var ct=(function(){function p(a,h){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=a,h!==null&&this._parents.push(h)}return Object.defineProperty(p.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),p.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(a){a.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(a){a.clearChanges()})),this._children.forEach(function(a){return a.handleCallbacks()})},p.prototype.addParent=function(a){this._parents.includes(a)||(this._parents.push(a),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&a.addToViewModelCallbacks(this))},p.prototype.removeParent=function(a){var h=this._parents.indexOf(a);if(h!==-1){var w=this._parents[h];w.removeFromViewModelCallbacks(this),this._parents.splice(h,1)}},p.prototype.addToPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)||(this._propertiesWithCallbacks.push(a),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.addToViewModelCallbacks=function(a){var h=this;this._children.includes(a)||(this._children.push(a),this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromViewModelCallbacks=function(a){var h=this;this._children.includes(a)&&(this._children=this._children.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(a){a.clearCallbacks()})},p.prototype.propertyFromPath=function(a,h){var w=a.split("/");return this.propertyFromPathSegments(w,0,h)},p.prototype.viewModelFromPathSegments=function(a,h){var w=this.internalViewModelInstance(a[h]);return w!==null?h==a.length-1?w:w.viewModelFromPathSegments(a,h++):null},p.prototype.propertyFromPathSegments=function(a,h,w){var T,O,$,ne,ue,Z,ve,Ce,ze,je,Ct,pt,at,ut,gt,hn,dn,Ft;if(h<a.length-1){var oe=this.internalViewModelInstance(a[h]);return oe!==null?oe.propertyFromPathSegments(a,h+1,w):null}var Ae=null;switch(w){case Ie.Number:if(Ae=(O=(T=this._runtimeInstance)===null||T===void 0?void 0:T.number(a[h]))!==null&&O!==void 0?O:null,Ae!==null)return new un(Ae,this);break;case Ie.String:if(Ae=(ne=($=this._runtimeInstance)===null||$===void 0?void 0:$.string(a[h]))!==null&&ne!==void 0?ne:null,Ae!==null)return new zt(Ae,this);break;case Ie.Boolean:if(Ae=(Z=(ue=this._runtimeInstance)===null||ue===void 0?void 0:ue.boolean(a[h]))!==null&&Z!==void 0?Z:null,Ae!==null)return new Gt(Ae,this);break;case Ie.Color:if(Ae=(Ce=(ve=this._runtimeInstance)===null||ve===void 0?void 0:ve.color(a[h]))!==null&&Ce!==void 0?Ce:null,Ae!==null)return new ln(Ae,this);break;case Ie.Trigger:if(Ae=(je=(ze=this._runtimeInstance)===null||ze===void 0?void 0:ze.trigger(a[h]))!==null&&je!==void 0?je:null,Ae!==null)return new kn(Ae,this);break;case Ie.Enum:if(Ae=(pt=(Ct=this._runtimeInstance)===null||Ct===void 0?void 0:Ct.enum(a[h]))!==null&&pt!==void 0?pt:null,Ae!==null)return new ot(Ae,this);break;case Ie.List:if(Ae=(ut=(at=this._runtimeInstance)===null||at===void 0?void 0:at.list(a[h]))!==null&&ut!==void 0?ut:null,Ae!==null)return new St(Ae,this);break;case Ie.Image:if(Ae=(hn=(gt=this._runtimeInstance)===null||gt===void 0?void 0:gt.image(a[h]))!==null&&hn!==void 0?hn:null,Ae!==null)return new br(Ae,this);break;case Ie.Artboard:if(Ae=(Ft=(dn=this._runtimeInstance)===null||dn===void 0?void 0:dn.artboard(a[h]))!==null&&Ft!==void 0?Ft:null,Ae!==null)return new Kt(Ae,this);break}return null},p.prototype.internalViewModelInstance=function(a){var h;if(this._viewModelInstances.has(a))return this._viewModelInstances.get(a);var w=(h=this._runtimeInstance)===null||h===void 0?void 0:h.viewModel(a);if(w!==null){var T=new p(w,this);return T.internalIncrementReferenceCount(),this._viewModelInstances.set(a,T),T}return null},p.prototype.number=function(a){var h=this.propertyFromPath(a,Ie.Number);return h},p.prototype.string=function(a){var h=this.propertyFromPath(a,Ie.String);return h},p.prototype.boolean=function(a){var h=this.propertyFromPath(a,Ie.Boolean);return h},p.prototype.color=function(a){var h=this.propertyFromPath(a,Ie.Color);return h},p.prototype.trigger=function(a){var h=this.propertyFromPath(a,Ie.Trigger);return h},p.prototype.enum=function(a){var h=this.propertyFromPath(a,Ie.Enum);return h},p.prototype.list=function(a){var h=this.propertyFromPath(a,Ie.List);return h},p.prototype.image=function(a){var h=this.propertyFromPath(a,Ie.Image);return h},p.prototype.artboard=function(a){var h=this.propertyFromPath(a,Ie.Artboard);return h},p.prototype.viewModel=function(a){var h=a.split("/"),w=h.length>1?this.viewModelFromPathSegments(h.slice(0,h.length-1),0):this;return w!=null?w.internalViewModelInstance(h[h.length-1]):null},p.prototype.internalReplaceViewModel=function(a,h){var w;if(h.runtimeInstance!==null){var T=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(a,h.runtimeInstance))||!1;if(T){h.internalIncrementReferenceCount();var O=this.internalViewModelInstance(a);O!==null&&(O.removeParent(this),this._children.includes(O)&&(this._children=this._children.filter(function($){return $!==O})),O.cleanup()),this._viewModelInstances.set(a,h),h.addParent(this)}return T}return!1},p.prototype.replaceViewModel=function(a,h){var w,T=a.split("/"),O=T.length>1?this.viewModelFromPathSegments(T.slice(0,T.length-1),0):this;return(w=O?.internalReplaceViewModel(T[T.length-1],h))!==null&&w!==void 0?w:!1},p.prototype.incrementReferenceCount=function(){var a;this._referenceCount++,(a=this._runtimeInstance)===null||a===void 0||a.incrementReferenceCount()},p.prototype.decrementReferenceCount=function(){var a;this._referenceCount--,(a=this._runtimeInstance)===null||a===void 0||a.decrementReferenceCount()},Object.defineProperty(p.prototype,"properties",{get:function(){var a;return((a=this._runtimeInstance)===null||a===void 0?void 0:a.getProperties().map(function(h){return A({},h)}))||[]},enumerable:!1,configurable:!0}),p.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},p.prototype.cleanup=function(){var a=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(T){T.cleanup()}),this._viewModelInstances.clear();var h=C([],this._children,!0);this._children.length=0;var w=C([],this._parents,!0);this._parents.length=0,h.forEach(function(T){T.removeParent(a)}),w.forEach(function(T){T.removeFromViewModelCallbacks(a)})}},p})(),Ue=(function(){function p(a,h){this.callbacks=[],this._viewModelInstanceValue=a,this._parentViewModel=h}return p.prototype.on=function(a){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(a)||(this.callbacks.push(a),this._parentViewModel.addToPropertyCallbacks(this))},p.prototype.off=function(a){a?this.callbacks=this.callbacks.filter(function(h){return h!==a}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},p.prototype.internalHandleCallback=function(a){},p.prototype.handleCallbacks=function(){var a=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(h){a.internalHandleCallback(h)})},p.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},p.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),p})(),zt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ue),un=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ue),Gt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ue),kn=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return a.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},a.prototype.internalHandleCallback=function(h){h()},a})(Ue),ot=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(h){this._viewModelInstanceValue.valueIndex=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ue),St=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),a.prototype.addInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(h.runtimeInstance),h.addParent(this._parentViewModel))},a.prototype.addInstanceAt=function(h,w){return h.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(h.runtimeInstance,w)?(h.addParent(this._parentViewModel),!0):!1},a.prototype.removeInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(h.runtimeInstance),h.removeParent(this._parentViewModel))},a.prototype.removeInstanceAt=function(h){this._viewModelInstanceValue.removeInstanceAt(h)},a.prototype.instanceAt=function(h){var w=this._viewModelInstanceValue.instanceAt(h);if(w!=null){var T=new ct(w,this._parentViewModel);return T}return null},a.prototype.swap=function(h,w){this._viewModelInstanceValue.swap(h,w)},a.prototype.internalHandleCallback=function(h){h()},a})(Ue),ln=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.rgb=function(h,w,T){this._viewModelInstanceValue.rgb(h,w,T)},a.prototype.rgba=function(h,w,T,O){this._viewModelInstanceValue.argb(O,h,w,T)},a.prototype.argb=function(h,w,T,O){this._viewModelInstanceValue.argb(h,w,T,O)},a.prototype.alpha=function(h){this._viewModelInstanceValue.alpha(h)},a.prototype.opacity=function(h){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,h))*255))},a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ue),br=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Ue),Kt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Ue),Kr=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Request(p),[4,fetch(a)];case 1:return h=T.sent(),[4,h.arrayBuffer()];case 2:return w=T.sent(),[2,w]}})})},ht=function(p){return typeof p=="string"?[p]:p instanceof Array?p:[]},$i={EventManager:Ne,TaskQueueManager:Be},Yr=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return x.getInstance(function($){$.decodeAudio(p,O)})}),[4,a];case 1:return h=T.sent(),w=new m.AudioWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})},Ni=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return x.getInstance(function($){$.decodeImage(p,O)})}),[4,a];case 1:return h=T.sent(),w=new m.ImageWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})},cn=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return x.getInstance(function($){$.decodeFont(p,O)})}),[4,a];case 1:return h=T.sent(),w=new m.FontWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})}})(),u})())})(Ei)),Ei.exports}var xc=Mc();const ws="dracula",bs="https://vycjpmuyscfygstjjied.supabase.co";var Lc=qe('<div class="main-container"><canvas width="400" height="500"></canvas></div>');function va(n,e){gr(e,!0);let t=Fe(void 0);Wr(()=>{if(!te(t))return;const u=new xc.Rive({src:`${bs}/storage/v1/object/public/${ws}/${e.fileName}`,canvas:te(t),autoplay:!0,stateMachines:"SM1"});return()=>{u.cleanup()}});var r=Lc(),o=xe(r);Sc(o,u=>ie(t,u),()=>te(t)),be(n,r),mr()}var Fc=qe('<img alt="Background"/>'),Dc=qe('<div class="background-media svelte-6amr7n"><!></div>'),Uc=qe('<img alt="Character"/>'),$c=qe('<div class="character-media svelte-6amr7n"><!></div>'),Nc=(n,e,t)=>e(te(t).nextDialogueId),Bc=qe('<button class="option-button svelte-6amr7n"> </button>'),Wc=qe('<div class="options-container svelte-6amr7n"></div>'),Vc=qe('<div class="error-overlay svelte-6amr7n"><p class="error-text svelte-6amr7n"> </p></div>'),qc=qe('<div class="dialogue-container svelte-6amr7n"><!> <!> <div class="dialogue-content svelte-6amr7n"><div class="dialogue-text svelte-6amr7n"> </div> <!></div> <!></div>');function Hc(n,e){gr(e,!0);let t=Fe(null),r=Fe(null),o=Fe(null);async function u(){try{if(ie(o,null),e.dialogue.backgroundImage)try{e.dialogue.backgroundImage.endsWith(".riv")||(ie(t,`${bs}/storage/v1/object/public/${ws}/${e.dialogue.backgroundImage}`),await c(te(t)))}catch{console.warn("Background not found:",e.dialogue.backgroundImage),ie(t,null)}if(e.dialogue.characterImage)try{e.dialogue.characterImage.endsWith(".riv")||(ie(r,`${bs}/storage/v1/object/public/${ws}/${e.dialogue.characterImage}`),await c(te(r)))}catch{console.warn("Character not found:",e.dialogue.characterImage),ie(r,null)}}catch(x){ie(o,"Ошибка загрузки медиа: "+x.message),console.error("Media loading error:",x),e.dialogue.backgroundImage?.endsWith(".riv")&&ie(t,null),e.dialogue.characterImage?.endsWith(".riv")&&ie(r,null)}finally{}}function c(x){return new Promise((K,M)=>{const L=new Image;L.onload=()=>K(x),L.onerror=()=>M(new Error(`Image not found: ${x}`)),L.src=x})}u();function f(x){const K=new CustomEvent("dialogueChange",{detail:{nextDialogueId:x}});window.dispatchEvent(K)}var v=qc(),m=xe(v);{var y=x=>{var K=Dc(),M=xe(K);{var L=X=>{var ae=$n(),z=rn(ae);oa(z,()=>e.dialogue.backgroundImage,re=>{va(re,{get fileName(){return e.dialogue.backgroundImage}})}),be(X,ae)},ee=X=>{var ae=Fc();let z;xt(re=>{la(ae,"src",te(t)?te(t):""),z=ua(ae,1,"background-image svelte-6amr7n",null,z,re)},[()=>({hidden:!te(t)||!e.dialogue.backgroundImage.endsWith(".riv")})]),ia("error",ae,()=>{ie(o,"Ошибка загрузки фона: "+e.dialogue.backgroundImage),ie(t,null)}),be(X,ae)};et(M,X=>{e.dialogue.backgroundImage.endsWith(".riv")?X(L):X(ee,!1)})}be(x,K)};et(m,x=>{e.dialogue.backgroundImage&&x(y)})}var A=Mt(m,2);{var E=x=>{var K=$c(),M=xe(K);{var L=X=>{var ae=$n(),z=rn(ae);oa(z,()=>e.dialogue.characterImage,re=>{va(re,{get fileName(){return e.dialogue.characterImage}})}),be(X,ae)},ee=X=>{var ae=Uc();let z;xt(re=>{la(ae,"src",te(r)?te(r):""),z=ua(ae,1,"character-image svelte-6amr7n",null,z,re)},[()=>({hidden:!te(r)||!e.dialogue.characterImageUrl.endsWith(".riv")})]),ia("error",ae,()=>{ie(o,"Ошибка загрузки персонажа: "+e.dialogue.characterImage),ie(r,null)}),be(X,ae)};et(M,X=>{e.dialogue.characterImage.endsWith(".riv")?X(L):X(ee,!1)})}be(x,K)};et(A,x=>{e.dialogue.characterImage&&x(E)})}var g=Mt(A,2),C=xe(g),j=xe(C),F=Mt(C,2);{var q=x=>{var K=Wc();_c(K,21,()=>e.dialogue.options,M=>M.text,(M,L)=>{var ee=Bc();ee.__click=[Nc,f,L];var X=xe(ee);xt(()=>nn(X,te(L).text)),be(M,ee)}),be(x,K)};et(F,x=>{e.dialogue.options&&e.dialogue.options.length>0&&x(q)})}var B=Mt(g,2);{var D=x=>{var K=Vc(),M=xe(K),L=xe(M);xt(()=>nn(L,te(o))),be(x,K)};et(B,x=>{te(o)&&x(D)})}xt(()=>nn(j,`"${e.dialogue.text??""}"`)),be(n,v),mr()}Qs(["click"]);function zc(n,e){ie(e,0)}async function Gc(n,e,t,r,o){ie(e,!0),ie(t,"");try{await r(),ie(o,0)}catch(u){ie(t,"Ошибка перезагрузки: "+u.message)}finally{ie(e,!1)}}var Kc=qe('<div class="loading"><p>🔄 Загрузка истории Дракулы...</p></div>'),Yc=qe('<div class="error"> <div style="margin-top: 15px;"><button class="nav-button">🔄 Попробовать снова</button></div></div>'),Jc=(n,e)=>e(),Xc=qe('<div class="dialogues-container" role="button" tabindex="0" aria-label="Next"><!></div>'),Qc=qe('<div class="welcome-section"><h1 class="welcome-title">🧛‍♂️ Дракула: Интерактивная история</h1> <p class="welcome-text">Погрузитесь в атмосферную готическую историю с интерактивными диалогами.<br/> Принимайте решения, которые влияют на развитие сюжета.</p> <button class="start-button">🎭 Начать историю</button></div>'),Zc=qe('<div class="app"><!></div>');function As(n,e){gr(e,!0),Fn({name:"Игрок"});let t=Fe(!0),r=Fe(""),o=Fe(Fn([])),u=Fe(0);Wr(async()=>{try{await c()}catch(g){ie(r,"Ошибка загрузки истории: "+g.message),console.error("Load error:",g)}finally{ie(t,!1)}});async function c(g){try{const C=await fetch(g);if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const j=await C.json();if(!j.dialogues||!Array.isArray(j.dialogues))throw new Error("Неверный формат файла истории: отсутствует dialogues array");ie(o,j.dialogues,!0),console.log("Диалоги загружены:",te(o).length)}catch(C){throw ie(r,`Ошибка загрузки диалогов: Из ${g} ${C.message}`),console.error("Load dialogues error:",C),C}}function f(g){const C=g.detail.nextDialogueId,j=te(o).findIndex(F=>F.id===C);if(j!==-1)ie(u,j,!0);else{const F=te(o)[te(u)];if(F.nextDialogueId){const q=te(o).findIndex(B=>B.id===F.nextDialogueId);q!==-1&&ie(u,q,!0)}}}function v(){te(o)[te(u)].options.length<1&&te(u)<te(o).length-1&&Gl(u)}Wr(()=>(window.addEventListener("dialogueChange",f),()=>window.removeEventListener("dialogueChange",f)));var m=Zc(),y=xe(m);{var A=g=>{var C=Kc();be(g,C)},E=g=>{var C=$n(),j=rn(C);{var F=B=>{var D=Yc(),x=xe(D),K=Mt(x),M=xe(K);M.__click=[Gc,t,r,c,u],xt(()=>nn(x,`⚠️ ${te(r)??""} `)),be(B,D)},q=B=>{var D=$n(),x=rn(D);{var K=L=>{var ee=Xc();ee.__click=[Jc,v];var X=xe(ee);Hc(X,{get index(){return te(u)},get dialogue(){return te(o)[te(u)]}}),be(L,ee)},M=L=>{var ee=Qc(),X=Mt(xe(ee),4);X.__click=[zc,u],be(L,ee)};et(x,L=>{te(o).length>0?L(K):L(M,!1)},!0)}be(B,D)};et(j,B=>{te(r)?B(F):B(q,!1)},!0)}be(g,C)};et(y,g=>{te(t)?g(A):g(E,!1)})}be(n,m),mr()}Qs(["click"]);const eh="modulepreload",th=function(n,e){return new URL(n,e).href},pa={},zr=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let m=function(y){return Promise.all(y.map(A=>Promise.resolve(A).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};const c=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),v=f?.nonce||f?.getAttribute("nonce");o=m(t.map(y=>{if(y=th(y,r),y in pa)return;pa[y]=!0;const A=y.endsWith(".css"),E=A?'[rel="stylesheet"]':"";if(!!r)for(let j=c.length-1;j>=0;j--){const F=c[j];if(F.href===y&&(!A||F.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${E}`))return;const C=document.createElement("link");if(C.rel=A?"stylesheet":eh,A||(C.as="script"),C.crossOrigin="",C.href=y,v&&C.setAttribute("nonce",v),document.head.appendChild(C),A)return new Promise((j,F)=>{C.addEventListener("load",j),C.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return o.then(c=>{for(const f of c||[])f.status==="rejected"&&u(f.reason);return e().catch(u)})},nh=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>zr(async()=>{const{default:r}=await Promise.resolve().then(()=>wr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Zs extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class rh extends Zs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ga extends Zs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ma extends Zs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Es;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Es||(Es={}));var ih=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class sh{constructor(e,{headers:t={},customFetch:r,region:o=Es.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=nh(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ih(this,void 0,void 0,function*(){try{const{headers:o,method:u,body:c}=t;let f={},{region:v}=t;v||(v=this.region);const m=new URL(`${this.url}/${e}`);v&&v!=="any"&&(f["x-region"]=v,m.searchParams.set("forceFunctionRegion",v));let y;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(f["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(f["Content-Type"]="application/json",y=JSON.stringify(c)));const A=yield this.fetch(m.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:y}).catch(j=>{throw new rh(j)}),E=A.headers.get("x-relay-error");if(E&&E==="true")throw new ga(A);if(!A.ok)throw new ma(A);let g=((r=A.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),C;return g==="application/json"?C=yield A.json():g==="application/octet-stream"?C=yield A.blob():g==="text/event-stream"?C=A:g==="multipart/form-data"?C=yield A.formData():C=yield A.text(),{data:C,error:null,response:A}}catch(o){return{data:null,error:o,response:o instanceof ma||o instanceof ga?o.context:void 0}}})}}var Ye={},Kn={},Yn={},Jn={},Xn={},Qn={},oh=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fr=oh();const ah=fr.fetch,wu=fr.fetch.bind(fr),bu=fr.Headers,uh=fr.Request,lh=fr.Response,wr=Object.freeze(Object.defineProperty({__proto__:null,Headers:bu,Request:uh,Response:lh,default:wu,fetch:ah},Symbol.toStringTag,{value:"Module"})),ch=Oc(wr);var _i={},_a;function Au(){if(_a)return _i;_a=1,Object.defineProperty(_i,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return _i.default=n,_i}var ya;function Eu(){if(ya)return Qn;ya=1;var n=Qn&&Qn.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Qn,"__esModule",{value:!0});const e=n(ch),t=n(Au());class r{constructor(u){var c,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(c=u.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,c){return this.headers=new Headers(this.headers),this.headers.set(u,c),this}then(u,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let v=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var y,A,E,g;let C=null,j=null,F=null,q=m.status,B=m.statusText;if(m.ok){if(this.method!=="HEAD"){const M=await m.text();M===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?j=M:j=JSON.parse(M))}const x=(A=this.headers.get("Prefer"))===null||A===void 0?void 0:A.match(/count=(exact|planned|estimated)/),K=(E=m.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");x&&K&&K.length>1&&(F=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(C={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,F=null,q=406,B="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const x=await m.text();try{C=JSON.parse(x),Array.isArray(C)&&m.status===404&&(j=[],C=null,q=200,B="OK")}catch{m.status===404&&x===""?(q=204,B="No Content"):C={message:x}}if(C&&this.isMaybeSingle&&(!((g=C?.details)===null||g===void 0)&&g.includes("0 rows"))&&(C=null,q=200,B="OK"),C&&this.shouldThrowOnError)throw new t.default(C)}return{error:C,data:j,count:F,status:q,statusText:B}});return this.shouldThrowOnError||(v=v.catch(m=>{var y,A,E;return{error:{message:`${(y=m?.name)!==null&&y!==void 0?y:"FetchError"}: ${m?.message}`,details:`${(A=m?.stack)!==null&&A!==void 0?A:""}`,hint:"",code:`${(E=m?.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),v.then(u,c)}returns(){return this}overrideTypes(){return this}}return Qn.default=r,Qn}var wa;function ku(){if(wa)return Xn;wa=1;var n=Xn&&Xn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Xn,"__esModule",{value:!0});const e=n(Eu());class t extends e.default{select(o){let u=!1;const c=(o??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:u=!0,nullsFirst:c,foreignTable:f,referencedTable:v=f}={}){const m=v?`${v}.order`:"order",y=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${y?`${y},`:""}${o}.${u?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:u,referencedTable:c=u}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${o}`),this}range(o,u,{foreignTable:c,referencedTable:f=c}={}){const v=typeof f>"u"?"offset":`${f}.offset`,m=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(v,`${o}`),this.url.searchParams.set(m,`${u-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:u=!1,settings:c=!1,buffers:f=!1,wal:v=!1,format:m="text"}={}){var y;const A=[o?"analyze":null,u?"verbose":null,c?"settings":null,f?"buffers":null,v?"wal":null].filter(Boolean).join("|"),E=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${E}"; options=${A};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Xn.default=t,Xn}var ba;function eo(){if(ba)return Jn;ba=1;var n=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jn,"__esModule",{value:!0});const e=n(ku());class t extends e.default{eq(o,u){return this.url.searchParams.append(o,`eq.${u}`),this}neq(o,u){return this.url.searchParams.append(o,`neq.${u}`),this}gt(o,u){return this.url.searchParams.append(o,`gt.${u}`),this}gte(o,u){return this.url.searchParams.append(o,`gte.${u}`),this}lt(o,u){return this.url.searchParams.append(o,`lt.${u}`),this}lte(o,u){return this.url.searchParams.append(o,`lte.${u}`),this}like(o,u){return this.url.searchParams.append(o,`like.${u}`),this}likeAllOf(o,u){return this.url.searchParams.append(o,`like(all).{${u.join(",")}}`),this}likeAnyOf(o,u){return this.url.searchParams.append(o,`like(any).{${u.join(",")}}`),this}ilike(o,u){return this.url.searchParams.append(o,`ilike.${u}`),this}ilikeAllOf(o,u){return this.url.searchParams.append(o,`ilike(all).{${u.join(",")}}`),this}ilikeAnyOf(o,u){return this.url.searchParams.append(o,`ilike(any).{${u.join(",")}}`),this}is(o,u){return this.url.searchParams.append(o,`is.${u}`),this}in(o,u){const c=Array.from(new Set(u)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,u){return typeof u=="string"?this.url.searchParams.append(o,`cs.${u}`):Array.isArray(u)?this.url.searchParams.append(o,`cs.{${u.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(u)}`),this}containedBy(o,u){return typeof u=="string"?this.url.searchParams.append(o,`cd.${u}`):Array.isArray(u)?this.url.searchParams.append(o,`cd.{${u.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(u)}`),this}rangeGt(o,u){return this.url.searchParams.append(o,`sr.${u}`),this}rangeGte(o,u){return this.url.searchParams.append(o,`nxl.${u}`),this}rangeLt(o,u){return this.url.searchParams.append(o,`sl.${u}`),this}rangeLte(o,u){return this.url.searchParams.append(o,`nxr.${u}`),this}rangeAdjacent(o,u){return this.url.searchParams.append(o,`adj.${u}`),this}overlaps(o,u){return typeof u=="string"?this.url.searchParams.append(o,`ov.${u}`):this.url.searchParams.append(o,`ov.{${u.join(",")}}`),this}textSearch(o,u,{config:c,type:f}={}){let v="";f==="plain"?v="pl":f==="phrase"?v="ph":f==="websearch"&&(v="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${v}fts${m}.${u}`),this}match(o){return Object.entries(o).forEach(([u,c])=>{this.url.searchParams.append(u,`eq.${c}`)}),this}not(o,u,c){return this.url.searchParams.append(o,`not.${u}.${c}`),this}or(o,{foreignTable:u,referencedTable:c=u}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${o})`),this}filter(o,u,c){return this.url.searchParams.append(o,`${u}.${c}`),this}}return Jn.default=t,Jn}var Aa;function Su(){if(Aa)return Yn;Aa=1;var n=Yn&&Yn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Yn,"__esModule",{value:!0});const e=n(eo());class t{constructor(o,{headers:u={},schema:c,fetch:f}){this.url=o,this.headers=new Headers(u),this.schema=c,this.fetch=f}select(o,{head:u=!1,count:c}={}){const f=u?"HEAD":"GET";let v=!1;const m=(o??"*").split("").map(y=>/\s/.test(y)&&!v?"":(y==='"'&&(v=!v),y)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:u,defaultToNull:c=!0}={}){var f;const v="POST";if(u&&this.headers.append("Prefer",`count=${u}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const m=o.reduce((y,A)=>y.concat(Object.keys(A)),[]);if(m.length>0){const y=[...new Set(m)].map(A=>`"${A}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(o,{onConflict:u,ignoreDuplicates:c=!1,count:f,defaultToNull:v=!0}={}){var m;const y="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),u!==void 0&&this.url.searchParams.set("on_conflict",u),f&&this.headers.append("Prefer",`count=${f}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const A=o.reduce((E,g)=>E.concat(Object.keys(g)),[]);if(A.length>0){const E=[...new Set(A)].map(g=>`"${g}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(o,{count:u}={}){var c;const f="PATCH";return u&&this.headers.append("Prefer",`count=${u}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var u;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Yn.default=t,Yn}var Ea;function hh(){if(Ea)return Kn;Ea=1;var n=Kn&&Kn.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Kn,"__esModule",{value:!0});const e=n(Su()),t=n(eo());class r{constructor(u,{headers:c={},schema:f,fetch:v}={}){this.url=u,this.headers=new Headers(c),this.schemaName=f,this.fetch=v}from(u){const c=new URL(`${this.url}/${u}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(u){return new r(this.url,{headers:this.headers,schema:u,fetch:this.fetch})}rpc(u,c={},{head:f=!1,get:v=!1,count:m}={}){var y;let A;const E=new URL(`${this.url}/rpc/${u}`);let g;f||v?(A=f?"HEAD":"GET",Object.entries(c).filter(([j,F])=>F!==void 0).map(([j,F])=>[j,Array.isArray(F)?`{${F.join(",")}}`:`${F}`]).forEach(([j,F])=>{E.searchParams.append(j,F)})):(A="POST",g=c);const C=new Headers(this.headers);return m&&C.set("Prefer",`count=${m}`),new t.default({method:A,url:E,headers:C,schema:this.schemaName,body:g,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Kn.default=r,Kn}var ka;function dh(){if(ka)return Ye;ka=1;var n=Ye&&Ye.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.PostgrestError=Ye.PostgrestBuilder=Ye.PostgrestTransformBuilder=Ye.PostgrestFilterBuilder=Ye.PostgrestQueryBuilder=Ye.PostgrestClient=void 0;const e=n(hh());Ye.PostgrestClient=e.default;const t=n(Su());Ye.PostgrestQueryBuilder=t.default;const r=n(eo());Ye.PostgrestFilterBuilder=r.default;const o=n(ku());Ye.PostgrestTransformBuilder=o.default;const u=n(Eu());Ye.PostgrestBuilder=u.default;const c=n(Au());return Ye.PostgrestError=c.default,Ye.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:u.default,PostgrestError:c.default},Ye}var fh=dh();const vh=Rc(fh),{PostgrestClient:ph,PostgrestQueryBuilder:mf,PostgrestFilterBuilder:_f,PostgrestTransformBuilder:yf,PostgrestBuilder:wf,PostgrestError:bf}=vh;class gh{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const mh="2.15.1",_h=`realtime-js/${mh}`,yh="1.0.0",ks=1e4,wh=1e3,bh=100;var Fr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Fr||(Fr={}));var We;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(We||(We={}));var jt;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(jt||(jt={}));var Ss;(function(n){n.websocket="websocket"})(Ss||(Ss={}));var Ln;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ln||(Ln={}));class Ah{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),u=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=r.decode(e.slice(c,c+o));c=c+o;const v=r.decode(e.slice(c,c+u));c=c+u;const m=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:f,event:v,payload:m}}}class Cu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Re;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Re||(Re={}));const Sa=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((u,c)=>(u[c]=Eh(c,n,e,o),u),{})},Eh=(n,e,t,r)=>{const o=e.find(f=>f.name===n),u=o?.type,c=t[n];return u&&!r.includes(u)?Tu(u,c):Cs(c)},Tu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Th(e,t)}switch(n){case Re.bool:return kh(e);case Re.float4:case Re.float8:case Re.int2:case Re.int4:case Re.int8:case Re.numeric:case Re.oid:return Sh(e);case Re.json:case Re.jsonb:return Ch(e);case Re.timestamp:return Ph(e);case Re.abstime:case Re.date:case Re.daterange:case Re.int4range:case Re.int8range:case Re.money:case Re.reltime:case Re.text:case Re.time:case Re.timestamptz:case Re.timetz:case Re.tsrange:case Re.tstzrange:return Cs(e);default:return Cs(e)}},Cs=n=>n,kh=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Sh=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Ch=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Th=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let u;const c=n.slice(1,t);try{u=JSON.parse("["+c+"]")}catch{u=c?c.split(","):[]}return u.map(f=>Tu(e,f))}return n},Ph=n=>typeof n=="string"?n.replace(" ","T"):n,Pu=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class os{constructor(e,t,r={},o=ks){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ca;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ca||(Ca={}));class Dr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:u,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dr.syncState(this.state,o,u,c),this.pendingDiffs.forEach(v=>{this.state=Dr.syncDiff(this.state,v,u,c)}),this.pendingDiffs=[],f()}),this.channel._on(r.diff,{},o=>{const{onJoin:u,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Dr.syncDiff(this.state,o,u,c),f())}),this.onJoin((o,u,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:u,newPresences:c})}),this.onLeave((o,u,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:u,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const u=this.cloneDeep(e),c=this.transformState(t),f={},v={};return this.map(u,(m,y)=>{c[m]||(v[m]=y)}),this.map(c,(m,y)=>{const A=u[m];if(A){const E=y.map(F=>F.presence_ref),g=A.map(F=>F.presence_ref),C=y.filter(F=>g.indexOf(F.presence_ref)<0),j=A.filter(F=>E.indexOf(F.presence_ref)<0);C.length>0&&(f[m]=C),j.length>0&&(v[m]=j)}else f[m]=y}),this.syncDiff(u,{joins:f,leaves:v},r,o)}static syncDiff(e,t,r,o){const{joins:u,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(u,(f,v)=>{var m;const y=(m=e[f])!==null&&m!==void 0?m:[];if(e[f]=this.cloneDeep(v),y.length>0){const A=e[f].map(g=>g.presence_ref),E=y.filter(g=>A.indexOf(g.presence_ref)<0);e[f].unshift(...E)}r(f,y,v)}),this.map(c,(f,v)=>{let m=e[f];if(!m)return;const y=v.map(A=>A.presence_ref);m=m.filter(A=>y.indexOf(A.presence_ref)<0),e[f]=m,o(f,m,v),m.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ta;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Ta||(Ta={}));var Ur;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Ur||(Ur={}));var tn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(tn||(tn={}));class to{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=We.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new os(this,jt.join,this.params,this.timeout),this.rejoinTimer=new Cu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=We.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=We.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jt.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new Dr(this),this.broadcastEndpointURL=Pu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==We.closed){const{config:{broadcast:u,presence:c,private:f}}=this.params,v=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(E=>E.filter))!==null&&o!==void 0?o:[],m=!!this.bindings[Ur.PRESENCE]&&this.bindings[Ur.PRESENCE].length>0,y={},A={broadcast:u,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:v,private:f};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(E=>e?.(tn.CHANNEL_ERROR,E)),this._onClose(()=>e?.(tn.CLOSED)),this.updateJoinPayload(Object.assign({config:A},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:E})=>{var g;if(this.socket.setAuth(),E===void 0){e?.(tn.SUBSCRIBED);return}else{const C=this.bindings.postgres_changes,j=(g=C?.length)!==null&&g!==void 0?g:0,F=[];for(let q=0;q<j;q++){const B=C[q],{filter:{event:D,schema:x,table:K,filter:M}}=B,L=E&&E[q];if(L&&L.event===D&&L.schema===x&&L.table===K&&L.filter===M)F.push(Object.assign(Object.assign({},B),{id:L.id}));else{this.unsubscribe(),this.state=We.errored,e?.(tn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=F,e&&e(tn.SUBSCRIBED);return}}).receive("error",E=>{this.state=We.errored,e?.(tn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{e?.(tn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===We.joined&&e===Ur.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:u,payload:c}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=m.body)===null||o===void 0?void 0:o.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var c,f,v;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||v===void 0)&&v.ack)&&u("ok"),m.receive("ok",()=>u("ok")),m.receive("error",()=>u("error")),m.receive("timeout",()=>u("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=We.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new os(this,jt.leave,{},e),r.receive("ok",()=>{t(),o("ok")}).receive("timeout",()=>{t(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=We.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const o=new AbortController,u=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(u),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new os(this,e,t,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bh){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,u;const c=e.toLocaleLowerCase(),{close:f,error:v,leave:m,join:y}=jt;if(r&&[f,v,m,y].indexOf(c)>=0&&r!==this._joinRef())return;let E=this._onMessage(c,t,r);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(g=>{var C,j,F;return((C=g.filter)===null||C===void 0?void 0:C.event)==="*"||((F=(j=g.filter)===null||j===void 0?void 0:j.event)===null||F===void 0?void 0:F.toLocaleLowerCase())===c}).map(g=>g.callback(E,r)):(u=this.bindings[c])===null||u===void 0||u.filter(g=>{var C,j,F,q,B,D;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in g){const x=g.id,K=(C=g.filter)===null||C===void 0?void 0:C.event;return x&&((j=t.ids)===null||j===void 0?void 0:j.includes(x))&&(K==="*"||K?.toLocaleLowerCase()===((F=t.data)===null||F===void 0?void 0:F.type.toLocaleLowerCase()))}else{const x=(B=(q=g?.filter)===null||q===void 0?void 0:q.event)===null||B===void 0?void 0:B.toLocaleLowerCase();return x==="*"||x===((D=t?.event)===null||D===void 0?void 0:D.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===c}).map(g=>{if(typeof E=="object"&&"ids"in E){const C=E.data,{schema:j,table:F,commit_timestamp:q,type:B,errors:D}=C;E=Object.assign(Object.assign({},{schema:j,table:F,commit_timestamp:q,eventType:B,new:{},old:{},errors:D}),this._getPayloadRecords(C))}g.callback(E,r)})}_isClosed(){return this.state===We.closed}_isJoined(){return this.state===We.joined}_isJoining(){return this.state===We.joining}_isLeaving(){return this.state===We.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),u={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(u):this.bindings[o]=[u],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var u;return!(((u=o.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===r&&to.isEqual(o.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(jt.close,{},e)}_onError(e){this._on(jt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=We.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Sa(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Sa(e.columns,e.old_record)),t}}const Pa=()=>{},yi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ih=[1e3,2e3,5e3,1e4],Rh=1e4,Oh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class jh{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ks,this.transport=null,this.heartbeatIntervalMs=yi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pa,this.ref=0,this.reconnectTimer=null,this.logger=Pa,this.conn=null,this.sendBuffer=[],this.serializer=new Ah,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let u;return o?u=o:typeof fetch>"u"?u=(...c)=>zr(async()=>{const{default:f}=await Promise.resolve().then(()=>wr);return{default:f}},void 0,import.meta.url).then(({default:f})=>f(...c)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):u=fetch,(...c)=>u(...c)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ss.websocket}`,this.httpEndpoint=Pu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:yh}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Fr.connecting:return Ln.Connecting;case Fr.open:return Ln.Open;case Fr.closing:return Ln.Closing;default:return Ln.Closed}}isConnected(){return this.connectionState()===Ln.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(u=>u.topic===r);if(o)return o;{const u=new to(`realtime:${e}`,t,this);return this.channels.push(u),u}}push(e){const{topic:t,event:r,payload:o,ref:u}=e,c=()=>{this.encode(e,f=>{var v;(v=this.conn)===null||v===void 0||v.send(f)})};this.log("push",`${t} ${r} (${u})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(wh,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},yi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:u,ref:c}=t,f=c?`(${c})`:"",v=u.status||"";this.log("receive",`${v} ${r} ${o} ${f}`.trim(),u),this.channels.filter(m=>m._isMember(r)).forEach(m=>m._trigger(o,u,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(jt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Oh],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const o={access_token:t,version:_h};t&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(jt.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Cu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,o,u,c,f,v,m;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:ks,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:yi.HEARTBEAT_INTERVAL,this.worker=(u=e?.worker)!==null&&u!==void 0?u:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(y=>Ih[y-1]||Rh),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((y,A)=>A(JSON.stringify(y))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class no extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ve(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Mh extends no{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ts extends no{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var xh=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const Iu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>zr(async()=>{const{default:r}=await Promise.resolve().then(()=>wr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Lh=()=>xh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield zr(()=>Promise.resolve().then(()=>wr),void 0,import.meta.url)).Response:Response}),Ps=n=>{if(Array.isArray(n))return n.map(t=>Ps(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));e[o]=Ps(r)}),e},Fh=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Wn=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const as=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Dh=(n,e,t)=>Wn(void 0,void 0,void 0,function*(){const r=yield Lh();n instanceof r&&!t?.noResolveJson?n.json().then(o=>{const u=n.status||500,c=o?.statusCode||u+"";e(new Mh(as(o),u,c))}).catch(o=>{e(new Ts(as(o),o))}):e(new Ts(as(n),n))}),Uh=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"||!r?o:(Fh(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(r)):o.body=r,e?.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),t))};function Gr(n,e,t,r,o,u){return Wn(this,void 0,void 0,function*(){return new Promise((c,f)=>{n(t,Uh(e,r,o,u)).then(v=>{if(!v.ok)throw v;return r?.noResolveJson?v:v.json()}).then(v=>c(v)).catch(v=>Dh(v,f,r))})})}function ji(n,e,t,r){return Wn(this,void 0,void 0,function*(){return Gr(n,"GET",e,t,r)})}function Wt(n,e,t,r,o){return Wn(this,void 0,void 0,function*(){return Gr(n,"POST",e,r,o,t)})}function Is(n,e,t,r,o){return Wn(this,void 0,void 0,function*(){return Gr(n,"PUT",e,r,o,t)})}function $h(n,e,t,r){return Wn(this,void 0,void 0,function*(){return Gr(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Ru(n,e,t,r,o){return Wn(this,void 0,void 0,function*(){return Gr(n,"DELETE",e,r,o,t)})}var it=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const Nh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ia={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Bh{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Iu(o)}uploadOrUpdate(e,t,r,o){return it(this,void 0,void 0,function*(){try{let u;const c=Object.assign(Object.assign({},Ia),o);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const v=c.metadata;typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),v&&u.append("metadata",this.encodeMetadata(v)),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl),v&&u.append("metadata",this.encodeMetadata(v))):(u=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,v&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),o?.headers&&(f=Object.assign(Object.assign({},f),o.headers));const m=this._removeEmptyFolders(t),y=this._getFinalPath(m),A=yield(e=="PUT"?Is:Wt)(this.fetch,`${this.url}/object/${y}`,u,Object.assign({headers:f},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:A.Id,fullPath:A.Key},error:null}}catch(u){if(Ve(u))return{data:null,error:u};throw u}})}upload(e,t,r){return it(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return it(this,void 0,void 0,function*(){const u=this._removeEmptyFolders(e),c=this._getFinalPath(u),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let v;const m=Object.assign({upsert:Ia.upsert},o),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",m.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",m.cacheControl)):(v=r,y["cache-control"]=`max-age=${m.cacheControl}`,y["content-type"]=m.contentType);const A=yield Is(this.fetch,f.toString(),v,{headers:y});return{data:{path:u,fullPath:A.Key},error:null}}catch(v){if(Ve(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return it(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t?.upsert&&(o["x-upsert"]="true");const u=yield Wt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+u.url),f=c.searchParams.get("token");if(!f)throw new no("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:f},error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}update(e,t,r){return it(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return it(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}copy(e,t,r){return it(this,void 0,void 0,function*(){try{return{data:{path:(yield Wt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return it(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),u=yield Wt(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return u={signedUrl:encodeURI(`${this.url}${u.signedURL}${c}`)},{data:u,error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return it(this,void 0,void 0,function*(){try{const o=yield Wt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),u=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${u}`):null})),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}download(e,t){return it(this,void 0,void 0,function*(){const o=typeof t?.transform<"u"?"render/image/authenticated":"object",u=this.transformOptsToQueryString(t?.transform||{}),c=u?`?${u}`:"";try{const f=this._getFinalPath(e);return{data:yield(yield ji(this.fetch,`${this.url}/${o}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(Ve(f))return{data:null,error:f};throw f}})}info(e){return it(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ji(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ps(r),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}exists(e){return it(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield $h(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Ve(r)&&r instanceof Ts){const o=r.originalError;if([400,404].includes(o?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],u=t?.download?`download=${t.download===!0?"":t.download}`:"";u!==""&&o.push(u);const f=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&o.push(v);let m=o.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${r}${m}`)}}}remove(e){return it(this,void 0,void 0,function*(){try{return{data:yield Ru(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}list(e,t,r){return it(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},Nh),t),{prefix:e||""});return{data:yield Wt(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}listV2(e,t){return it(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Wt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Wh="2.11.0",Vh={"X-Client-Info":`storage-js/${Wh}`};var Zn=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class qh{constructor(e,t={},r,o){const u=new URL(e);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(u.hostname)&&!u.hostname.includes("storage.supabase.")&&(u.hostname=u.hostname.replace("supabase.","storage.supabase.")),this.url=u.href,this.headers=Object.assign(Object.assign({},Vh),t),this.fetch=Iu(r)}listBuckets(){return Zn(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ve(e))return{data:null,error:e};throw e}})}getBucket(e){return Zn(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Zn(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Zn(this,void 0,void 0,function*(){try{return{data:yield Is(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Zn(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Zn(this,void 0,void 0,function*(){try{return{data:yield Ru(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}}class Hh extends qh{constructor(e,t={},r,o){super(e,t,r,o)}from(e){return new Bh(this.url,this.headers,e,this.fetch)}}const zh="2.56.0";let xr="";typeof Deno<"u"?xr="deno":typeof document<"u"?xr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xr="react-native":xr="node";const Gh={"X-Client-Info":`supabase-js-${xr}/${zh}`},Kh={headers:Gh},Yh={schema:"public"},Jh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xh={};var Qh=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const Zh=n=>{let e;return n?e=n:typeof fetch>"u"?e=wu:e=fetch,(...t)=>e(...t)},ed=()=>typeof Headers>"u"?bu:Headers,td=(n,e,t)=>{const r=Zh(t),o=ed();return(u,c)=>Qh(void 0,void 0,void 0,function*(){var f;const v=(f=yield e())!==null&&f!==void 0?f:n;let m=new o(c?.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${v}`),r(u,Object.assign(Object.assign({},c),{headers:m}))})};var nd=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};function rd(n){return n.endsWith("/")?n:n+"/"}function id(n,e){var t,r;const{db:o,auth:u,realtime:c,global:f}=n,{db:v,auth:m,realtime:y,global:A}=e,E={db:Object.assign(Object.assign({},v),o),auth:Object.assign(Object.assign({},m),u),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},A),f),{headers:Object.assign(Object.assign({},(t=A?.headers)!==null&&t!==void 0?t:{}),(r=f?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>nd(this,void 0,void 0,function*(){return""})};return n.accessToken?E.accessToken=n.accessToken:delete E.accessToken,E}const Ou="2.71.1",ir=30*1e3,Rs=3,us=Rs*ir,sd="http://localhost:9999",od="supabase.auth.token",ad={"X-Client-Info":`gotrue-js/${Ou}`},Os="X-Supabase-Api-Version",ju={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ud=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ld=600*1e3;class ro extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function le(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class cd extends ro{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function hd(n){return le(n)&&n.name==="AuthApiError"}class Mu extends ro{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class En extends ro{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class mn extends En{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function dd(n){return le(n)&&n.name==="AuthSessionMissingError"}class wi extends En{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bi extends En{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ai extends En{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fd(n){return le(n)&&n.name==="AuthImplicitGrantRedirectError"}class Ra extends En{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class js extends En{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ls(n){return le(n)&&n.name==="AuthRetryableFetchError"}class Oa extends En{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Ms extends En{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ja=` 	
\r=`.split(""),vd=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<ja.length;e+=1)n[ja[e].charCodeAt(0)]=-2;for(let e=0;e<Mi.length;e+=1)n[Mi[e].charCodeAt(0)]=e;return n})();function Ma(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Mi[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Mi[r]),e.queuedBits-=6}}function xu(n,e,t){const r=vd[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function xa(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},u=c=>{md(c,r,t)};for(let c=0;c<n.length;c+=1)xu(n.charCodeAt(c),o,u);return e.join("")}function pd(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function gd(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|o)+65536,t+=1}pd(r,e)}}function md(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function _d(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<n.length;o+=1)xu(n.charCodeAt(o),t,r);return new Uint8Array(e)}function yd(n){const e=[];return gd(n,t=>e.push(t)),new Uint8Array(e)}function wd(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};return n.forEach(o=>Ma(o,t,r)),Ma(null,t,r),e.join("")}function bd(n){return Math.round(Date.now()/1e3)+n}function Ad(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ot=()=>typeof window<"u"&&typeof document<"u",On={tested:!1,writable:!1},Lu=()=>{if(!Ot())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(On.tested)return On.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),On.tested=!0,On.writable=!0}catch{On.tested=!0,On.writable=!1}return On.writable};function Ed(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,u)=>{e[u]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const Fu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>zr(async()=>{const{default:r}=await Promise.resolve().then(()=>wr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},kd=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",sr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},jn=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},gn=async(n,e)=>{await n.removeItem(e)};class Ui{constructor(){this.promise=new Ui.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ui.promiseConstructor=Promise;function cs(n){const e=n.split(".");if(e.length!==3)throw new Ms("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!ud.test(e[r]))throw new Ms("JWT not in base64url format");return{header:JSON.parse(xa(e[0])),payload:JSON.parse(xa(e[1])),signature:_d(e[2]),raw:{header:e[0],payload:e[1]}}}async function Sd(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Cd(n,e){return new Promise((r,o)=>{(async()=>{for(let u=0;u<1/0;u++)try{const c=await n(u);if(!e(u,null,c)){r(c);return}}catch(c){if(!e(u,c)){o(c);return}}})()})}function Td(n){return("0"+n.toString(16)).substr(-2)}function Pd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let u=0;u<56;u++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Td).join("")}async function Id(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(u=>String.fromCharCode(u)).join("")}async function Rd(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Id(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function er(n,e,t=!1){const r=Pd();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await sr(n,`${e}-code-verifier`,o);const u=await Rd(r);return[u,r===u?"plain":"s256"]}const Od=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jd(n){const e=n.headers.get(Os);if(!e||!e.match(Od))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Md(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function xd(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ld=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tr(n){if(!Ld.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hs(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function La(n){return JSON.parse(JSON.stringify(n))}var Fd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const Mn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Dd=[502,503,504];async function Fa(n){var e;if(!kd(n))throw new js(Mn(n),0);if(Dd.includes(n.status))throw new js(Mn(n),n.status);let t;try{t=await n.json()}catch(u){throw new Mu(Mn(u),u)}let r;const o=jd(n);if(o&&o.getTime()>=ju["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Oa(Mn(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new mn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((u,c)=>u&&typeof c=="string",!0))throw new Oa(Mn(t),n.status,t.weak_password.reasons);throw new cd(Mn(t),n.status||500,r)}const Ud=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function pe(n,e,t,r){var o;const u=Object.assign({},r?.headers);u[Os]||(u[Os]=ju["2024-01-01"].name),r?.jwt&&(u.Authorization=`Bearer ${r.jwt}`);const c=(o=r?.query)!==null&&o!==void 0?o:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",v=await $d(n,e,t+f,{headers:u,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(v):{data:Object.assign({},v),error:null}}async function $d(n,e,t,r,o,u){const c=Ud(e,r,o,u);let f;try{f=await n(t,Object.assign({},c))}catch(v){throw console.error(v),new js(Mn(v),0)}if(f.ok||await Fa(f),r?.noResolveJson)return f;try{return await f.json()}catch(v){await Fa(v)}}function en(n){var e;let t=null;Vd(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=bd(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Da(n){const e=en(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function _n(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Nd(n){return{data:n,error:null}}function Bd(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:u}=n,c=Fd(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:u},v=Object.assign({},c);return{data:{properties:f,user:v},error:null}}function Wd(n){return n}function Vd(n){return n.access_token&&n.refresh_token&&n.expires_in}const ds=["global","local","others"];var qd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class Hd{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Fu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ds[0]){if(ds.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ds.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_n})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=qd(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r?.newEmail,delete o.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Bd,redirectTo:t?.redirectTo})}catch(t){if(le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_n})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,u,c,f,v;try{const m={nextPage:null,lastPage:0,total:0},y=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(u=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&u!==void 0?u:""},xform:Wd});if(y.error)throw y.error;const A=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,g=(v=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&v!==void 0?v:[];return g.length>0&&(g.forEach(C=>{const j=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),F=JSON.parse(C.split(";")[1].split("=")[1]);m[`${F}Page`]=j}),m.total=parseInt(E)),{data:Object.assign(Object.assign({},A),m),error:null}}catch(m){if(le(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){tr(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_n})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){tr(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:_n})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){tr(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:_n})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){tr(e.userId);try{const{data:t,error:r}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _deleteFactor(e){tr(e.userId),tr(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}}function Ua(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function zd(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const nr={debug:!!(globalThis&&Lu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Du extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Gd extends Du{}async function Kd(n,e,t){nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),nr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Gd(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(nr.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}zd();const Yd={url:sd,storageKey:od,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ad,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function $a(n,e,t){return await t()}const rr={};class Vr{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Vr.nextInstanceID,Vr.nextInstanceID+=1,this.instanceID>0&&Ot()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Yd),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Hd({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Fu(o.fetch),this.lock=o.lock||$a,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Ot()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Kd:this.lock=$a,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Lu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ua(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Ua(this.memoryStorage)),Ot()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u),await this._notifyAllSubscribers(u.data.event,u.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=rr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){rr[this.storageKey]=Object.assign(Object.assign({},rr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=rr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){rr[this.storageKey]=Object.assign(Object.assign({},rr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ou}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Ed(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Ot()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:u}=await this._getSessionFromURL(t,r);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),fd(u)){const v=(e=u.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:u}}return await this._removeSession(),{error:u}}const{session:c,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return le(t)?{error:t}:{error:new Mu("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const u=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:en}),{data:c,error:f}=u;if(f||!c)return{data:{user:null,session:null},error:f};const v=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(u){if(le(u))return{data:{user:null,session:null},error:u};throw u}}async signUp(e){var t,r,o;try{let u;if("email"in e){const{email:y,password:A,options:E}=e;let g=null,C=null;this.flowType==="pkce"&&([g,C]=await er(this.storage,this.storageKey)),u=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E?.emailRedirectTo,body:{email:y,password:A,data:(t=E?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E?.captchaToken},code_challenge:g,code_challenge_method:C},xform:en})}else if("phone"in e){const{phone:y,password:A,options:E}=e;u=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:A,data:(r=E?.data)!==null&&r!==void 0?r:{},channel:(o=E?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:E?.captchaToken}},xform:en})}else throw new bi("You must provide either an email or phone number and a password");const{data:c,error:f}=u;if(f||!c)return{data:{user:null,session:null},error:f};const v=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(u){if(le(u))return{data:{user:null,session:null},error:u};throw u}}async signInWithPassword(e){try{let t;if("email"in e){const{email:u,password:c,options:f}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Da})}else if("phone"in e){const{phone:u,password:c,options:f}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Da})}else throw new bi("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new wi}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,u;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(u=e.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,o,u,c,f,v,m,y,A,E,g;let C,j;if("message"in e)C=e.message,j=e.signature;else{const{chain:F,wallet:q,statement:B,options:D}=e;let x;if(Ot())if(typeof q=="object")x=q;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))x=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof q!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=q}const K=new URL((t=D?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in x&&x.signIn){const M=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},D?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),B?{statement:B}:null));let L;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")L=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)L=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)C=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),j=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${K.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...B?["",B,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(o=(r=D?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((u=D?.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${D.signInWithSolana.notBefore}`]:[],...!((c=D?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${D.signInWithSolana.expirationTime}`]:[],...!((f=D?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${D.signInWithSolana.chainId}`]:[],...!((v=D?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${D.signInWithSolana.nonce}`]:[],...!((m=D?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${D.signInWithSolana.requestId}`]:[],...!((A=(y=D?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||A===void 0)&&A.length?["Resources",...D.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const M=await x.signMessage(new TextEncoder().encode(C),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=M}}try{const{data:F,error:q}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:wd(j)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:en});if(q)throw q;return!F||!F.session||!F.user?{data:{user:null,session:null},error:new wi}:(F.session&&(await this._saveSession(F.session),await this._notifyAllSubscribers("SIGNED_IN",F.session)),{data:Object.assign({},F),error:q})}catch(F){if(le(F))return{data:{user:null,session:null},error:F};throw F}}async _exchangeCodeForSession(e){const t=await jn(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:u,error:c}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:en});if(await gn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!u||!u.session||!u.user?{data:{user:null,session:null,redirectType:null},error:new wi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:Object.assign(Object.assign({},u),{redirectType:o??null}),error:c})}catch(u){if(le(u))return{data:{user:null,session:null,redirectType:null},error:u};throw u}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:u,nonce:c}=e,f=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:u,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:en}),{data:v,error:m}=f;return m?{data:{user:null,session:null},error:m}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new wi}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:m})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,u,c;try{if("email"in e){const{email:f,options:v}=e;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await er(this.storage,this.storageKey));const{error:A}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(r=v?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:m,code_challenge_method:y},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:A}}if("phone"in e){const{phone:f,options:v}=e,{data:m,error:y}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=v?.data)!==null&&o!==void 0?o:{},create_user:(u=v?.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(c=v?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m?.message_id},error:y}}throw new bi("You must provide either an email or phone number.")}catch(f){if(le(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(e){var t,r;try{let o,u;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,u=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:f}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:u}}),redirectTo:o,xform:en});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const v=c.session,m=c.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(o){if(le(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let u=null,c=null;return this.flowType==="pkce"&&([u,c]=await er(this.storage,this.storageKey)),await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:c}),headers:this.headers,xform:Nd})}catch(u){if(le(u))return{data:null,error:u};throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new mn;const{error:o}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(le(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:u}=e,{error:c}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:o,options:u}=e,{data:c,error:f}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:f}}throw new bi("You must provide either an email or phone number and a type")}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await jn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<us:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await jn(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=hs()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,m,y)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,m,y))})}return{data:{session:e},error:null}}const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?{data:{session:null},error:u}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_n}):await this._useSession(async t=>{var r,o,u;const{data:c,error:f}=t;if(f)throw f;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new mn}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&u!==void 0?u:void 0,xform:_n})})}catch(t){if(le(t))return dd(t)&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:u}=r;if(u)throw u;if(!o.session)throw new mn;const c=o.session;let f=null,v=null;this.flowType==="pkce"&&e.email!=null&&([f,v]=await er(this.storage,this.storageKey));const{data:m,error:y}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:v}),jwt:c.access_token,xform:_n});if(y)throw y;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new mn;const t=Date.now()/1e3;let r=t,o=!0,u=null;const{payload:c}=cs(e.access_token);if(c.exp&&(r=c.exp,o=r<=t),o){const{session:f,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!f)return{data:{user:null,session:null},error:null};u=f}else{const{data:f,error:v}=await this._getUser(e.access_token);if(v)throw v;u={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return{data:{user:u.user,session:u},error:null}}catch(t){if(le(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:f}=t;if(f)throw f;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new mn;const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?{data:{user:null,session:null},error:u}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ot())throw new Ai("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ai(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ra("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ai("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ra("No code detected.");const{data:B,error:D}=await this._exchangeCodeForSession(e.code);if(D)throw D;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:B.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:u,refresh_token:c,expires_in:f,expires_at:v,token_type:m}=e;if(!u||!f||!c||!m)throw new Ai("No session defined in URL");const y=Math.round(Date.now()/1e3),A=parseInt(f);let E=y+A;v&&(E=parseInt(v));const g=E-y;g*1e3<=ir&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${A}s`);const C=E-A;y-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,E,y):y-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,E,y);const{data:j,error:F}=await this._getUser(u);if(F)throw F;const q={provider_token:r,provider_refresh_token:o,access_token:u,expires_in:A,expires_at:E,refresh_token:c,token_type:m,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:q,redirectType:e.type},error:null}}catch(r){if(le(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await jn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:u}=t;if(u)return{error:u};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:f}=await this.admin.signOut(c,e);if(f&&!(hd(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return e!=="others"&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Ad(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:u},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",e,"session",u)}catch(u){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",u),console.error(u)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await er(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(u){if(le(u))return{data:null,error:u};throw u}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async u=>{var c,f,v,m,y;const{data:A,error:E}=u;if(E)throw E;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",g,{headers:this.headers,jwt:(y=(m=A.session)===null||m===void 0?void 0:m.access_token)!==null&&y!==void 0?y:void 0})});if(o)throw o;return Ot()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(le(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:u,error:c}=t;if(c)throw c;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=u.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Cd(async o=>(o>0&&await Sd(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:en})),(o,u)=>{const c=200*Math.pow(2,o);return u&&ls(u)&&Date.now()+c-r<ir})}catch(r){if(this._debug(t,"error",r),le(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Ot()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await jn(this.storage,this.storageKey);if(o&&this.userStorage){let c=await jn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await sr(this.userStorage,this.storageKey+"-user",c)),o.user=(e=c?.user)!==null&&e!==void 0?e:hs()}else if(o&&!o.user&&!o.user){const c=await jn(this.storage,this.storageKey+"-user");c&&c?.user?(o.user=c.user,await gn(this.storage,this.storageKey+"-user"),await sr(this.storage,this.storageKey,o)):o.user=hs()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const u=((t=o.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<us;if(this._debug(r,`session has${u?"":" not"} expired with margin of ${us}s`),u){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),ls(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(o.access_token);!f&&c?.user?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new mn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Ui;const{data:u,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!u.session)throw new mn;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const f={session:u.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(u){if(this._debug(o,"error",u),le(u)){const c={session:null,error:u};return ls(u)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(u),u}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const u=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(v){u.push(v)}});if(await Promise.all(c),u.length>0){for(let f=0;f<u.length;f+=1)console.error(u[f]);throw u[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await sr(this.userStorage,this.storageKey+"-user",{user:t.user});const o=Object.assign({},t);delete o.user;const u=La(o);await sr(this.storage,this.storageKey,u)}else{const o=La(t);await sr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await gn(this.storage,this.storageKey),await gn(this.storage,this.storageKey+"-code-verifier"),await gn(this.storage,this.storageKey+"-user"),this.userStorage&&await gn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ot()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ir);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/ir);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${ir}ms, refresh threshold is ${Rs} ticks`),o<=Rs&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Du)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ot()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[u,c]=await er(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(f.toString())}if(r?.queryParams){const u=new URLSearchParams(r.queryParams);o.push(u.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;return u?{data:null,error:u}:await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:u,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:m}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(r=u?.session)===null||r===void 0?void 0:r.access_token});return m?{data:null,error:m}:(e.factorType==="totp"&&(!((o=v?.totp)===null||o===void 0)&&o.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;if(u)return{data:null,error:u};const{data:c,error:f}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(le(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;return u?{data:null,error:u}:await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(le(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),u=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:u},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:u}=e;if(u)return{data:null,error:u};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=cs(o.access_token);let f=null;c.aal&&(f=c.aal);let v=f;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(A=>A.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const y=c.amr||[];return{data:{currentLevel:f,nextLevel:v,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(f=>f.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(f=>f.kid===e),r&&this.jwks_cached_at+ld>o)return r;const{data:u,error:c}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=o,r=u.keys.find(f=>f.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:g,error:C}=await this.getSession();if(C||!g.session)return{data:null,error:C};r=g.session.access_token}const{header:o,payload:u,signature:c,raw:{header:f,payload:v}}=cs(r);t?.allowExpired||Md(u.exp);const m=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!m){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:u,header:o,signature:c},error:null}}const y=xd(o.alg),A=await crypto.subtle.importKey("jwk",m,y,!0,["verify"]);if(!await crypto.subtle.verify(y,A,c,yd(`${f}.${v}`)))throw new Ms("Invalid JWT signature");return{data:{claims:u,header:o,signature:c},error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}}Vr.nextInstanceID=0;const Jd=Vr;class Xd extends Jd{constructor(e){super(e)}}var Qd=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(A){c(A)}}function v(y){try{m(r.throw(y))}catch(A){c(A)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class Zd{constructor(e,t,r){var o,u,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=rd(e),v=new URL(f);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const m=`sb-${v.hostname.split(".")[0]}-auth-token`,y={db:Yh,realtime:Xh,auth:Object.assign(Object.assign({},Jh),{storageKey:m}),global:Kh},A=id(r??{},y);this.storageKey=(o=A.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(u=A.global.headers)!==null&&u!==void 0?u:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(E,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=A.auth)!==null&&c!==void 0?c:{},this.headers,A.global.fetch),this.fetch=td(t,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.rest=new ph(new URL("rest/v1",v).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new Hh(this.storageUrl.href,this.headers,this.fetch,r?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new sh(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Qd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:u,flowType:c,lock:f,debug:v},m,y){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Xd({url:this.authUrl.href,headers:Object.assign(Object.assign({},A),m),storageKey:u,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:c,lock:f,debug:v,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new jh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ef=(n,e,t)=>new Zd(n,e,t);function tf(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}tf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const nf="https://vycjpmuyscfygstjjied.supabase.co",rf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",lr=ef(nf,rf,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}});function sf(){if(window.Telegram?.WebApp){const n=window.Telegram.WebApp;return n.expand(),n.enableClosingConfirmation(),n.ready(),n}return null}function of(n){return n?.initDataUnsafe?.user||null}function Na(){return typeof window.Telegram<"u"&&typeof window.Telegram.WebApp<"u"&&window.Telegram.WebApp.initData!==""}async function af(n,e,t,r,o,u){try{ie(e,!0),ie(t,"");const c=te(r).initData;if(!c)throw new Error("Telegram init data not available");const{data:f,error:v}=await lr.functions.invoke("tma-auth",{body:{initData:c}});if(v)throw v;const{error:m}=await lr.auth.setSession({access_token:f.access_token,refresh_token:f.refresh_token});if(m)throw m;const{data:y}=await lr.auth.getUser();ie(o,y?.user,!0),ie(u,{access_token:f.access_token,refresh_token:f.refresh_token},!0),ie(e,!1)}catch(c){ie(t,"Ошибка авторизации: "+c.message),console.error("Auth error:",c)}finally{ie(e,!1)}}async function uf(n,e,t,r){try{await lr.auth.signOut(),ie(e,null),ie(t,null)}catch(o){ie(r,"Ошибка выхода: "+o.message)}}var lf=qe('<div class="loading"><p>Загрузка...</p></div>'),cf=qe('<div class="header row"><div class="user-avatar"><!></div> <div class="user-info"><h3 class="user-name"> </h3> <p class="user-meta"><!></p></div> <button class="button button-logout">Выйти</button></div> <!>',1),hf=qe('<div class="auth-section"><h1 class="welcome-title"><!></h1> <p class="welcome-text">Погрузитесь в атмосферную историю с интерактивными диалогами</p> <button class="button"><!></button></div>'),df=qe("<div><!></div>");function ff(n,e){gr(e,!0);let t=Fe(null),r=Fe(null),o=Fe(null),u=Fe(null),c=Fe(!0),f=Fe("");Wr(async()=>{try{ie(t,sf(),!0),ie(r,of(te(t)),!0);const{data:E}=await lr.auth.getSession();if(ie(u,E?.session,!0),te(u)){const{data:g}=await lr.auth.getUser();ie(o,g?.user,!0),ie(c,!1)}}catch(E){ie(f,"Ошибка инициализации: "+E.message)}finally{ie(c,!1)}}),Wr(()=>{});var v=df(),m=xe(v);{var y=E=>{var g=lf();be(E,g)},A=E=>{var g=$n(),C=rn(g);{var j=q=>{var B=cf(),D=rn(B),x=xe(D),K=xe(x);{var M=se=>{var tt=pn("🧛‍♂️");be(se,tt)},L=se=>{var tt=pn("💩");be(se,tt)};et(K,se=>{te(o).user_metadata?.first_name?se(M):se(L,!1)})}var ee=Mt(x,2),X=xe(ee),ae=xe(X),z=Mt(X,2),re=xe(z);{var Ne=se=>{var tt=pn();xt(()=>nn(tt,`@${te(o).user_metadata.username??""}`)),be(se,tt)},Be=se=>{var tt=pn();xt(()=>nn(tt,`ID: ${te(o).user_metadata?.telegram_id??""}`)),be(se,tt)};et(re,se=>{te(o).user_metadata?.username?se(Ne):se(Be,!1)})}var De=Mt(ee,2);De.__click=[uf,o,u,f];var At=Mt(D,2);As(At,{}),xt(()=>nn(ae,`${te(o).user_metadata?.first_name??""}
          ${(te(o).user_metadata?.last_name||"")??""}`)),be(q,B)},F=q=>{var B=hf(),D=xe(B),x=xe(D);{var K=z=>{var re=pn();xt(()=>nn(re,`Привет, ${te(r).first_name??""}!`)),be(z,re)},M=z=>{var re=pn("Дракула: История");be(z,re)};et(x,z=>{te(r)?z(K):z(M,!1)})}var L=Mt(D,4);L.__click=[af,c,f,t,o,u];var ee=xe(L);{var X=z=>{var re=pn();xt(()=>nn(re,`Начать историю как ${te(r).first_name??""}`)),be(z,re)},ae=z=>{var re=pn("Начать историю");be(z,re)};et(ee,z=>{te(r)?z(X):z(ae,!1)})}be(q,B)};et(C,q=>{te(o)&&te(u)?q(j):q(F,!1)},!0)}be(E,g)};et(m,E=>{te(c)?E(y):E(A,!1)})}be(n,v),mr()}Qs(["click"]);var vf=qe("<!> <p>Ты кто такой с*ка? Чтоб это сделать</p> <p>Мне бы очень не хотелось переходить на личности, вы уж извините, но хватает ли вашего уровня компетенции для работы в данном заведении?</p>",1);function pf(n,e){gr(e,!1),Na()?console.log("Запущено в Telegram Mini App"):console.log("Обычный браузер"),Cc();var t=$n(),r=rn(t);{var o=c=>{ff(c,{})},u=c=>{var f=$n(),v=rn(f);{var m=A=>{As(A,{})},y=A=>{var E=vf(),g=rn(E);As(g,{}),be(A,E)};et(v,A=>{Ic()?A(m):A(y,!1)},!0)}be(c,f)};et(r,c=>{Na()?c(o):c(u,!1)})}be(n,t),mr()}vc(pf,{target:document.getElementById("app")});
