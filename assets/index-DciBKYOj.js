(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();const xa=!1;var Is=Array.isArray,nl=Array.prototype.indexOf,Rs=Array.from,vs=Object.defineProperty,Or=Object.getOwnPropertyDescriptor,rl=Object.getOwnPropertyDescriptors,il=Object.prototype,sl=Array.prototype,Ma=Object.getPrototypeOf,Vo=Object.isExtensible;function ol(n){for(var e=0;e<n.length;e++)n[e]()}function al(){var n,e,t=new Promise((r,o)=>{n=r,e=o});return{promise:t,resolve:n,reject:e}}const pt=2,Os=4,js=8,dr=16,rn=32,$n=64,La=128,Et=256,ki=512,nt=1024,At=2048,bn=4096,Lt=8192,fr=16384,xs=32768,Ms=65536,qo=1<<17,ul=1<<18,Br=1<<19,ll=1<<20,ps=1<<21,Ls=1<<22,Fn=1<<23,Ei=Symbol("$state"),Fs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function cl(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function hl(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function dl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function fl(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function vl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function pl(n){throw new Error("https://svelte.dev/e/effect_orphan")}function gl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ml(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function _l(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function yl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const wl=1,bl=2,El=16,Al=1,kl=2,Je=Symbol(),Sl="http://www.w3.org/1999/xhtml";let Cl=!1;function Fa(n){return n===this.v}function Ua(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Tl(n,e){return n!==e}function Da(n){return!Ua(n,this.v)}let Wr=!1,Pl=!1;function Il(){Wr=!0}let qe=null;function Si(n){qe=n}function Vr(n,e=!1,t){qe={p:qe,c:null,e:null,s:n,x:null,l:Wr&&!e?{s:null,u:null,$:[]}:null}}function qr(n){var e=qe,t=e.e;if(t!==null){e.e=null;for(var r of t)Xa(r)}return qe=e.p,{}}function vr(){return!Wr||qe!==null&&qe.l===null}const Rl=new WeakMap;function Ol(n){var e=Se;if(e===null)return ke.f|=Fn,n;if((e.f&xs)===0){if((e.f&La)===0)throw!e.parent&&n instanceof Error&&$a(n),n;e.b.error(n)}else Us(n,e)}function Us(n,e){for(;e!==null;){if((e.f&La)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&$a(n),n}function $a(n){const e=Rl.get(n);e&&(vs(n,"message",{value:e.message}),vs(n,"stack",{value:e.stack}))}let Ci=[];function jl(){var n=Ci;Ci=[],ol(n)}function Na(n){Ci.length===0&&queueMicrotask(jl),Ci.push(n)}function xl(){for(var n=Se.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&cl(),n}function Ba(n){var e=pt|At,t=ke!==null&&(ke.f&pt)!==0?ke:null;return Se===null||t!==null&&(t.f&Et)!==0?e|=Et:Se.f|=Br,{ctx:qe,deps:null,effects:null,equals:Fa,f:e,fn:n,reactions:null,rv:0,v:Je,wv:0,parent:t??Se,ac:null}}function Ml(n,e){let t=Se;t===null&&dl();var r=t.b,o=void 0,u=Fr(Je),c=null,f=!ke;return Jl(()=>{try{var v=n();c&&Promise.resolve(v).catch(()=>{})}catch(g){v=Promise.reject(g)}var m=()=>v;o=c?.then(m,m)??Promise.resolve(v),c=o;var y=Xe,E=r.pending;f&&(r.update_pending_count(1),E||y.increment());const A=(g,S=void 0)=>{c=null,E||y.activate(),S?S!==Fs&&(u.f|=Fn,Pi(u,S)):((u.f&Fn)!==0&&(u.f^=Fn),Pi(u,g)),f&&(r.update_pending_count(-1),E||y.decrement()),Ha()};if(o.then(A,g=>A(null,g||"unknown")),y)return()=>{queueMicrotask(()=>y.neuter())}}),new Promise(v=>{function m(y){function E(){y===o?v(u):m(o)}y.then(E,E)}m(o)})}function Wa(n){const e=Ba(n);return e.equals=Da,e}function Va(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)nn(e[t])}}function Ll(n){for(var e=n.parent;e!==null;){if((e.f&pt)===0)return e;e=e.parent}return null}function Ds(n){var e,t=Se;wn(Ll(n));try{Va(n),e=ou(n)}finally{wn(t)}return e}function qa(n){var e=Ds(n);if(n.equals(e)||(n.v=e,n.wv=iu()),!pr){var t=(_n||(n.f&Et)!==0)&&n.deps!==null?bn:nt;ct(n,t)}}function Fl(n,e,t){const r=vr()?Ba:Wa;if(e.length===0){t(n.map(r));return}var o=Xe,u=Se,c=Ul(),f=xl();Promise.all(e.map(v=>Ml(v))).then(v=>{o?.activate(),c();try{t([...n.map(r),...v])}catch(m){(u.f&fr)===0&&Us(m,u)}o?.deactivate(),Ha()}).catch(v=>{f.error(v)})}function Ul(){var n=Se,e=ke,t=qe,r=Xe;return function(){wn(n),qt(e),Si(t),r?.activate()}}function Ha(){wn(null),qt(null),Si(null)}const is=new Set;let Xe=null,Ho=new Set,Ti=[];function za(){const n=Ti.shift();Ti.length>0&&queueMicrotask(za),n()}let Lr=[],$s=null,gs=!1;class ur{current=new Map;#u=new Map;#i=new Set;#e=0;#l=null;#c=!1;#n=[];#s=[];#r=[];#t=[];#o=[];#h=[];#d=[];skipped_effects=new Set;process(e){Lr=[];for(const o of e)this.#v(o);if(this.#n.length===0&&this.#e===0){this.#f();var t=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#o=[],Xe=null,zo(t),zo(r),Xe===null?Xe=this:is.delete(this),this.#l?.resolve()}else this.#a(this.#r),this.#a(this.#t),this.#a(this.#o);for(const o of this.#n)or(o);for(const o of this.#s)or(o);this.#n=[],this.#s=[]}#v(e){e.f^=nt;for(var t=e.first;t!==null;){var r=t.f,o=(r&(rn|$n))!==0,u=o&&(r&nt)!==0,c=u||(r&Lt)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(o)t.f^=nt;else if((r&Os)!==0)this.#t.push(t);else if((r&nt)===0)if((r&Ls)!==0){var f=t.b?.pending?this.#s:this.#n;f.push(t)}else Di(t)&&((t.f&dr)!==0&&this.#o.push(t),or(t));var v=t.first;if(v!==null){t=v;continue}}var m=t.parent;for(t=t.next;t===null&&m!==null;)t=m.next,m=m.parent}}#a(e){for(const t of e)((t.f&At)!==0?this.#h:this.#d).push(t),ct(t,nt);e.length=0}capture(e,t){this.#u.has(e)||this.#u.set(e,t),this.current.set(e,e.v)}activate(){Xe=this}deactivate(){Xe=null;for(const e of Ho)if(Ho.delete(e),e(),Xe!==null)break}neuter(){this.#c=!0}flush(){Lr.length>0?Dl():this.#f(),Xe===this&&(this.#e===0&&is.delete(this),this.deactivate())}#f(){if(!this.#c)for(const e of this.#i)e();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)ct(e,At),lr(e);for(const e of this.#d)ct(e,bn),lr(e);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#i.add(e)}settled(){return(this.#l??=al()).promise}static ensure(){if(Xe===null){const e=Xe=new ur;is.add(Xe),ur.enqueue(()=>{Xe===e&&e.flush()})}return Xe}static enqueue(e){Ti.length===0&&queueMicrotask(za),Ti.unshift(e)}}function Dl(){var n=sr;gs=!0;try{var e=0;for(Ko(!0);Lr.length>0;){var t=ur.ensure();if(e++>1e3){var r,o;$l()}t.process(Lr),yn.clear()}}finally{gs=!1,Ko(n),$s=null}}function $l(){try{gl()}catch(n){Us(n,$s)}}let xn=null;function zo(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(fr|Lt))===0&&Di(r)&&(xn=[],or(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?eu(r):r.fn=null),xn?.length>0)){yn.clear();for(const o of xn)or(o);xn=[]}}xn=null}}function lr(n){for(var e=$s=n;e.parent!==null;){e=e.parent;var t=e.f;if(gs&&e===Se&&(t&dr)!==0)return;if((t&($n|rn))!==0){if((t&nt)===0)return;e.f^=nt}}Lr.push(e)}const yn=new Map;function Fr(n,e){var t={f:0,v:n,reactions:null,equals:Fa,rv:0,wv:0};return t}function $e(n,e){const t=Fr(n);return ec(t),t}function Nl(n,e=!1,t=!0){const r=Fr(n);return e||(r.equals=Da),Wr&&t&&qe!==null&&qe.l!==null&&(qe.l.s??=[]).push(r),r}function re(n,e,t=!1){ke!==null&&(!Vt||(ke.f&qo)!==0)&&vr()&&(ke.f&(pt|dr|Ls|qo))!==0&&!tn?.includes(n)&&yl();let r=t?Ln(e):e;return Pi(n,r)}function Pi(n,e){if(!n.equals(e)){var t=n.v;pr?yn.set(n,e):yn.set(n,t),n.v=e;var r=ur.ensure();r.capture(n,t),(n.f&pt)!==0&&((n.f&At)!==0&&Ds(n),ct(n,(n.f&Et)===0?nt:bn)),n.wv=iu(),Ga(n,At),vr()&&Se!==null&&(Se.f&nt)!==0&&(Se.f&(rn|$n))===0&&(wt===null?tc([n]):wt.push(n))}return e}function Bl(n,e=1){var t=te(n),r=e===1?t++:t--;return re(n,t),r}function ss(n){re(n,n.v+1)}function Ga(n,e){var t=n.reactions;if(t!==null)for(var r=vr(),o=t.length,u=0;u<o;u++){var c=t[u],f=c.f;if(!(!r&&c===Se)){var v=(f&At)===0;v&&ct(c,e),(f&pt)!==0?Ga(c,bn):v&&((f&dr)!==0&&xn!==null&&xn.push(c),lr(c))}}}function Ln(n){if(typeof n!="object"||n===null||Ei in n)return n;const e=Ma(n);if(e!==il&&e!==sl)return n;var t=new Map,r=Is(n),o=$e(0),u=Dn,c=f=>{if(Dn===u)return f();var v=ke,m=Dn;qt(null),Jo(u);var y=f();return qt(v),Jo(m),y};return r&&t.set("length",$e(n.length)),new Proxy(n,{defineProperty(f,v,m){(!("value"in m)||m.configurable===!1||m.enumerable===!1||m.writable===!1)&&ml();var y=t.get(v);return y===void 0?y=c(()=>{var E=$e(m.value);return t.set(v,E),E}):re(y,m.value,!0),!0},deleteProperty(f,v){var m=t.get(v);if(m===void 0){if(v in f){const y=c(()=>$e(Je));t.set(v,y),ss(o)}}else re(m,Je),ss(o);return!0},get(f,v,m){if(v===Ei)return n;var y=t.get(v),E=v in f;if(y===void 0&&(!E||Or(f,v)?.writable)&&(y=c(()=>{var g=Ln(E?f[v]:Je),S=$e(g);return S}),t.set(v,y)),y!==void 0){var A=te(y);return A===Je?void 0:A}return Reflect.get(f,v,m)},getOwnPropertyDescriptor(f,v){var m=Reflect.getOwnPropertyDescriptor(f,v);if(m&&"value"in m){var y=t.get(v);y&&(m.value=te(y))}else if(m===void 0){var E=t.get(v),A=E?.v;if(E!==void 0&&A!==Je)return{enumerable:!0,configurable:!0,value:A,writable:!0}}return m},has(f,v){if(v===Ei)return!0;var m=t.get(v),y=m!==void 0&&m.v!==Je||Reflect.has(f,v);if(m!==void 0||Se!==null&&(!y||Or(f,v)?.writable)){m===void 0&&(m=c(()=>{var A=y?Ln(f[v]):Je,g=$e(A);return g}),t.set(v,m));var E=te(m);if(E===Je)return!1}return y},set(f,v,m,y){var E=t.get(v),A=v in f;if(r&&v==="length")for(var g=m;g<E.v;g+=1){var S=t.get(g+"");S!==void 0?re(S,Je):g in f&&(S=c(()=>$e(Je)),t.set(g+"",S))}if(E===void 0)(!A||Or(f,v)?.writable)&&(E=c(()=>$e(void 0)),re(E,Ln(m)),t.set(v,E));else{A=E.v!==Je;var O=c(()=>Ln(m));re(E,O)}var M=Reflect.getOwnPropertyDescriptor(f,v);if(M?.set&&M.set.call(y,m),!A){if(r&&typeof v=="string"){var H=t.get("length"),B=Number(v);Number.isInteger(B)&&B>=H.v&&re(H,B+1)}ss(o)}return!0},ownKeys(f){te(o);var v=Reflect.ownKeys(f).filter(E=>{var A=t.get(E);return A===void 0||A.v!==Je});for(var[m,y]of t)y.v!==Je&&!(m in f)&&v.push(m);return v},setPrototypeOf(){_l()}})}var Go,Ka,Ya,Ja;function Wl(){if(Go===void 0){Go=window,Ka=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Ya=Or(e,"firstChild").get,Ja=Or(e,"nextSibling").get,Vo(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Vo(t)&&(t.__t=void 0)}}function Nn(n=""){return document.createTextNode(n)}function Ii(n){return Ya.call(n)}function Fi(n){return Ja.call(n)}function Fe(n,e){return Ii(n)}function Un(n,e){{var t=Ii(n);return t instanceof Comment&&t.data===""?Fi(t):t}}function ut(n,e=1,t=!1){let r=n;for(;e--;)r=Fi(r);return r}function Vl(n){n.textContent=""}function Ns(){return!1}function Bs(n){var e=ke,t=Se;qt(null),wn(null);try{return n()}finally{qt(e),wn(t)}}function ql(n){Se===null&&ke===null&&pl(),ke!==null&&(ke.f&Et)!==0&&Se===null&&vl(),pr&&fl()}function Hl(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function sn(n,e,t,r=!0){var o=Se;o!==null&&(o.f&Lt)!==0&&(n|=Lt);var u={ctx:qe,deps:null,nodes_start:null,nodes_end:null,f:n|At,first:null,fn:e,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{or(u),u.f|=xs}catch(v){throw nn(u),v}else e!==null&&lr(u);if(r){var c=u;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&Br)===0&&(c=c.first),c!==null&&(c.parent=o,o!==null&&Hl(c,o),ke!==null&&(ke.f&pt)!==0&&(n&$n)===0)){var f=ke;(f.effects??=[]).push(c)}}return u}function zl(n){const e=sn(js,null,!1);return ct(e,nt),e.teardown=n,e}function Gl(n){ql();var e=Se.f,t=!ke&&(e&rn)!==0&&(e&xs)===0;if(t){var r=qe;(r.e??=[]).push(n)}else return Xa(n)}function Xa(n){return sn(Os|ll,n,!1)}function Kl(n){ur.ensure();const e=sn($n|Br,n,!0);return(t={})=>new Promise(r=>{t.outro?Ui(e,()=>{nn(e),r(void 0)}):(nn(e),r(void 0))})}function Yl(n){return sn(Os,n,!1)}function Jl(n){return sn(Ls|Br,n,!0)}function Xl(n,e=0){return sn(js|e,n,!0)}function lt(n,e=[],t=[]){Fl(e,t,r=>{sn(js,()=>n(...r.map(te)),!0)})}function Ws(n,e=0){var t=sn(dr|e,n,!0);return t}function cr(n,e=!0){return sn(rn|Br,n,!0,e)}function Qa(n){var e=n.teardown;if(e!==null){const t=pr,r=ke;Yo(!0),qt(null);try{e.call(null)}finally{Yo(t),qt(r)}}}function Za(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const o=t.ac;o!==null&&Bs(()=>{o.abort(Fs)});var r=t.next;(t.f&$n)!==0?t.parent=null:nn(t,e),t=r}}function Ql(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&rn)===0&&nn(e),e=t}}function nn(n,e=!0){var t=!1;(e||(n.f&ul)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Zl(n.nodes_start,n.nodes_end),t=!0),Za(n,e&&!t),Ri(n,0),ct(n,fr);var r=n.transitions;if(r!==null)for(const u of r)u.stop();Qa(n);var o=n.parent;o!==null&&o.first!==null&&eu(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Zl(n,e){for(;n!==null;){var t=n===e?null:Fi(n);n.remove(),n=t}}function eu(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Ui(n,e){var t=[];Vs(n,t,!0),tu(t,()=>{nn(n),e&&e()})}function tu(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function Vs(n,e,t){if((n.f&Lt)===0){if(n.f^=Lt,n.transitions!==null)for(const c of n.transitions)(c.is_global||t)&&e.push(c);for(var r=n.first;r!==null;){var o=r.next,u=(r.f&Ms)!==0||(r.f&rn)!==0;Vs(r,e,u?t:!1),r=o}}}function qs(n){nu(n,!0)}function nu(n,e){if((n.f&Lt)!==0){n.f^=Lt,(n.f&nt)===0&&(ct(n,At),lr(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&Ms)!==0||(t.f&rn)!==0;nu(t,o?e:!1),t=r}if(n.transitions!==null)for(const u of n.transitions)(u.is_global||e)&&u.in()}}let sr=!1;function Ko(n){sr=n}let pr=!1;function Yo(n){pr=n}let ke=null,Vt=!1;function qt(n){ke=n}let Se=null;function wn(n){Se=n}let tn=null;function ec(n){ke!==null&&(tn===null?tn=[n]:tn.push(n))}let it=null,vt=0,wt=null;function tc(n){wt=n}let ru=1,Ur=0,Dn=Ur;function Jo(n){Dn=n}let _n=!1;function iu(){return++ru}function Di(n){var e=n.f;if((e&At)!==0)return!0;if((e&bn)!==0){var t=n.deps,r=(e&Et)!==0;if(t!==null){var o,u,c=(e&ki)!==0,f=r&&Se!==null&&!_n,v=t.length;if((c||f)&&(Se===null||(Se.f&fr)===0)){var m=n,y=m.parent;for(o=0;o<v;o++)u=t[o],(c||!u?.reactions?.includes(m))&&(u.reactions??=[]).push(m);c&&(m.f^=ki),f&&y!==null&&(y.f&Et)===0&&(m.f^=Et)}for(o=0;o<v;o++)if(u=t[o],Di(u)&&qa(u),u.wv>n.wv)return!0}(!r||Se!==null&&!_n)&&ct(n,nt)}return!1}function su(n,e,t=!0){var r=n.reactions;if(r!==null&&!tn?.includes(n))for(var o=0;o<r.length;o++){var u=r[o];(u.f&pt)!==0?su(u,e,!1):e===u&&(t?ct(u,At):(u.f&nt)!==0&&ct(u,bn),lr(u))}}function ou(n){var e=it,t=vt,r=wt,o=ke,u=_n,c=tn,f=qe,v=Vt,m=Dn,y=n.f;it=null,vt=0,wt=null,_n=(y&Et)!==0&&(Vt||!sr||ke===null),ke=(y&(rn|$n))===0?n:null,tn=null,Si(n.ctx),Vt=!1,Dn=++Ur,n.ac!==null&&(Bs(()=>{n.ac.abort(Fs)}),n.ac=null);try{n.f|=ps;var E=n.fn,A=E(),g=n.deps;if(it!==null){var S;if(Ri(n,vt),g!==null&&vt>0)for(g.length=vt+it.length,S=0;S<it.length;S++)g[vt+S]=it[S];else n.deps=g=it;if(!_n||(y&pt)!==0&&n.reactions!==null)for(S=vt;S<g.length;S++)(g[S].reactions??=[]).push(n)}else g!==null&&vt<g.length&&(Ri(n,vt),g.length=vt);if(vr()&&wt!==null&&!Vt&&g!==null&&(n.f&(pt|bn|At))===0)for(S=0;S<wt.length;S++)su(wt[S],n);return o!==null&&o!==n&&(Ur++,wt!==null&&(r===null?r=wt:r.push(...wt))),(n.f&Fn)!==0&&(n.f^=Fn),A}catch(O){return Ol(O)}finally{n.f^=ps,it=e,vt=t,wt=r,ke=o,_n=u,tn=c,Si(f),Vt=v,Dn=m}}function nc(n,e){let t=e.reactions;if(t!==null){var r=nl.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&(e.f&pt)!==0&&(it===null||!it.includes(e))&&(ct(e,bn),(e.f&(Et|ki))===0&&(e.f^=ki),Va(e),Ri(e,0))}function Ri(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)nc(n,t[r])}function or(n){var e=n.f;if((e&fr)===0){ct(n,nt);var t=Se,r=sr;Se=n,sr=!0;try{(e&dr)!==0?Ql(n):Za(n),Qa(n);var o=ou(n);n.teardown=typeof o=="function"?o:null,n.wv=ru;var u;xa&&Pl&&(n.f&At)!==0&&n.deps}finally{sr=r,Se=t}}}function te(n){var e=n.f,t=(e&pt)!==0;if(ke!==null&&!Vt){var r=Se!==null&&(Se.f&fr)!==0;if(!r&&!tn?.includes(n)){var o=ke.deps;if((ke.f&ps)!==0)n.rv<Ur&&(n.rv=Ur,it===null&&o!==null&&o[vt]===n?vt++:it===null?it=[n]:(!_n||!it.includes(n))&&it.push(n));else{(ke.deps??=[]).push(n);var u=n.reactions;u===null?n.reactions=[ke]:u.includes(ke)||u.push(ke)}}}else if(t&&n.deps===null&&n.effects===null){var c=n,f=c.parent;f!==null&&(f.f&Et)===0&&(c.f^=Et)}if(pr){if(yn.has(n))return yn.get(n);if(t){c=n;var v=c.v;return((c.f&nt)===0&&c.reactions!==null||au(c))&&(v=Ds(c)),yn.set(c,v),v}}else t&&(c=n,Di(c)&&qa(c));if((n.f&Fn)!==0)throw n.v;return n.v}function au(n){if(n.v===Je)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(yn.has(e)||(e.f&pt)!==0&&au(e))return!0;return!1}function uu(n){var e=Vt;try{return Vt=!0,n()}finally{Vt=e}}const rc=-7169;function ct(n,e){n.f=n.f&rc|e}const ic=["touchstart","touchmove"];function sc(n){return ic.includes(n)}const lu=new Set,ms=new Set;function oc(n,e,t,r={}){function o(u){if(r.capture||Ir.call(e,u),!u.cancelBubble)return Bs(()=>t?.call(this,u))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Na(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function Xo(n,e,t,r,o){var u={capture:r,passive:o},c=oc(n,e,t,u);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&zl(()=>{e.removeEventListener(n,c,u)})}function Hs(n){for(var e=0;e<n.length;e++)lu.add(n[e]);for(var t of ms)t(n)}let Qo=null;function Ir(n){var e=this,t=e.ownerDocument,r=n.type,o=n.composedPath?.()||[],u=o[0]||n.target;Qo=n;var c=0,f=Qo===n&&n.__root;if(f){var v=o.indexOf(f);if(v!==-1&&(e===document||e===window)){n.__root=e;return}var m=o.indexOf(e);if(m===-1)return;v<=m&&(c=v)}if(u=o[c]||n.target,u!==e){vs(n,"currentTarget",{configurable:!0,get(){return u||t}});var y=ke,E=Se;qt(null),wn(null);try{for(var A,g=[];u!==null;){var S=u.assignedSlot||u.parentNode||u.host||null;try{var O=u["__"+r];if(O!=null&&(!u.disabled||n.target===u))if(Is(O)){var[M,...H]=O;M.apply(u,[n,...H])}else O.call(u,n)}catch(B){A?g.push(B):A=B}if(n.cancelBubble||S===e||S===null)break;u=S}if(A){for(let B of g)queueMicrotask(()=>{throw B});throw A}}finally{n.__root=e,delete n.currentTarget,qt(y),wn(E)}}}function ac(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Oi(n,e){var t=Se;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function He(n,e){var t=(e&Al)!==0,r=(e&kl)!==0,o,u=!n.startsWith("<!>");return()=>{o===void 0&&(o=ac(u?n:"<!>"+n),t||(o=Ii(o)));var c=r||Ka?document.importNode(o,!0):o.cloneNode(!0);if(t){var f=Ii(c),v=c.lastChild;Oi(f,v)}else Oi(c,c);return c}}function vn(n=""){{var e=Nn(n+"");return Oi(e,e),e}}function Dr(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Nn();return n.append(e,t),Oi(e,t),n}function Pe(n,e){n!==null&&n.before(e)}function bt(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function uc(n,e){return lc(n,e)}const zn=new Map;function lc(n,{target:e,anchor:t,props:r={},events:o,context:u,intro:c=!0}){Wl();var f=new Set,v=E=>{for(var A=0;A<E.length;A++){var g=E[A];if(!f.has(g)){f.add(g);var S=sc(g);e.addEventListener(g,Ir,{passive:S});var O=zn.get(g);O===void 0?(document.addEventListener(g,Ir,{passive:S}),zn.set(g,1)):zn.set(g,O+1)}}};v(Rs(lu)),ms.add(v);var m=void 0,y=Kl(()=>{var E=t??e.appendChild(Nn());return cr(()=>{if(u){Vr({});var A=qe;A.c=u}o&&(r.$$events=o),m=n(E,r)||{},u&&qr()}),()=>{for(var A of f){e.removeEventListener(A,Ir);var g=zn.get(A);--g===0?(document.removeEventListener(A,Ir),zn.delete(A)):zn.set(A,g)}ms.delete(v),E!==t&&E.parentNode?.removeChild(E)}});return cc.set(m,y),m}let cc=new WeakMap;function tt(n,e,t=!1){var r=n,o=null,u=null,c=Je,f=t?Ms:0,v=!1;const m=(g,S=!0)=>{v=!0,A(S,g)};var y=null;function E(){y!==null&&(y.lastChild.remove(),r.before(y),y=null);var g=c?o:u,S=c?u:o;g&&qs(g),S&&Ui(S,()=>{c?u=null:o=null})}const A=(g,S)=>{if(c!==(c=g)){var O=Ns(),M=r;if(O&&(y=document.createDocumentFragment(),y.append(M=Nn())),c?o??=S&&cr(()=>S(M)):u??=S&&cr(()=>S(M)),O){var H=Xe,B=c?o:u,U=c?u:o;B&&H.skipped_effects.delete(B),U&&H.skipped_effects.add(U),H.add_callback(E)}else E()}};Ws(()=>{v=!1,e(m),v||A(null,null)},f)}function Zo(n,e,t){var r=n,o=Je,u,c,f=null,v=vr()?Tl:Ua;function m(){u&&Ui(u),f!==null&&(f.lastChild.remove(),r.before(f),f=null),u=c}Ws(()=>{if(v(o,o=e())){var y=r,E=Ns();E&&(f=document.createDocumentFragment(),f.append(y=Nn())),c=cr(()=>t(y)),E?Xe.add_callback(m):m()}})}function hc(n,e,t){for(var r=n.items,o=[],u=e.length,c=0;c<u;c++)Vs(e[c].e,o,!0);var f=u>0&&o.length===0&&t!==null;if(f){var v=t.parentNode;Vl(v),v.append(t),r.clear(),Bt(n,e[0].prev,e[u-1].next)}tu(o,()=>{for(var m=0;m<u;m++){var y=e[m];f||(r.delete(y.k),Bt(n,y.prev,y.next)),nn(y.e,!f)}})}function dc(n,e,t,r,o,u=null){var c=n,f={flags:e,items:new Map,first:null};{var v=n;c=v.appendChild(Nn())}var m=null,y=!1,E=new Map,A=Wa(()=>{var M=t();return Is(M)?M:M==null?[]:Rs(M)}),g,S;function O(){fc(S,g,f,E,c,o,e,r,t),u!==null&&(g.length===0?m?qs(m):m=cr(()=>u(c)):m!==null&&Ui(m,()=>{m=null}))}Ws(()=>{S??=Se,g=te(A);var M=g.length;if(!(y&&M===0)){y=M===0;var H,B,U,L;if(Ns()){var z=new Set,x=Xe;for(B=0;B<M;B+=1){U=g[B],L=r(U,B);var F=f.items.get(L)??E.get(L);F?cu(F,U,B):(H=hu(null,f,null,null,U,L,B,o,e,t,!0),E.set(L,H)),z.add(L)}for(const[ee,X]of f.items)z.has(ee)||x.skipped_effects.add(X.e);x.add_callback(O)}else O();te(A)}})}function fc(n,e,t,r,o,u,c,f,v){var m=e.length,y=t.items,E=t.first,A=E,g,S=null,O=[],M=[],H,B,U,L;for(L=0;L<m;L+=1){if(H=e[L],B=f(H,L),U=y.get(B),U===void 0){var z=r.get(B);if(z!==void 0){r.delete(B),y.set(B,z);var x=S?S.next:A;Bt(t,S,z),Bt(t,z,x),os(z,x,o),S=z}else{var F=A?A.e.nodes_start:o;S=hu(F,t,S,S===null?t.first:S.next,H,B,L,u,c,v)}y.set(B,S),O=[],M=[],A=S.next;continue}if(cu(U,H,L),(U.e.f&Lt)!==0&&qs(U.e),U!==A){if(g!==void 0&&g.has(U)){if(O.length<M.length){var ee=M[0],X;S=ee.prev;var se=O[0],Y=O[O.length-1];for(X=0;X<O.length;X+=1)os(O[X],ee,o);for(X=0;X<M.length;X+=1)g.delete(M[X]);Bt(t,se.prev,Y.next),Bt(t,S,se),Bt(t,Y,ee),A=ee,S=Y,L-=1,O=[],M=[]}else g.delete(U),os(U,A,o),Bt(t,U.prev,U.next),Bt(t,U,S===null?t.first:S.next),Bt(t,S,U),S=U;continue}for(O=[],M=[];A!==null&&A.k!==B;)(A.e.f&Lt)===0&&(g??=new Set).add(A),M.push(A),A=A.next;if(A===null)continue;U=A}O.push(U),S=U,A=U.next}if(A!==null||g!==void 0){for(var ae=g===void 0?[]:Rs(g);A!==null;)(A.e.f&Lt)===0&&ae.push(A),A=A.next;var Ee=ae.length;if(Ee>0){var je=m===0?o:null;hc(t,ae,je)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var Ne of r.values())nn(Ne.e);r.clear()}function cu(n,e,t,r){Pi(n.v,e),n.i=t}function hu(n,e,t,r,o,u,c,f,v,m,y){var E=(v&wl)!==0,A=(v&El)===0,g=E?A?Nl(o,!1,!1):Fr(o):o,S=(v&bl)===0?c:Fr(c),O={i:S,v:g,k:u,a:null,e:null,prev:t,next:r};try{if(n===null){var M=document.createDocumentFragment();M.append(n=Nn())}return O.e=cr(()=>f(n,g,S,m),Cl),O.e.prev=t&&t.e,O.e.next=r&&r.e,t===null?y||(e.first=O):(t.next=O,t.e.next=O.e),r!==null&&(r.prev=O,r.e.prev=O.e),O}finally{}}function os(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,u=n.e.nodes_start;u!==null&&u!==r;){var c=Fi(u);o.before(u),u=c}}function Bt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const ea=[...` 	
\r\f \v\uFEFF`];function vc(n,e,t){var r=n==null?"":""+n;if(t){for(var o in t)if(t[o])r=r?r+" "+o:o;else if(r.length)for(var u=o.length,c=0;(c=r.indexOf(o,c))>=0;){var f=c+u;(c===0||ea.includes(r[c-1]))&&(f===r.length||ea.includes(r[f]))?r=(c===0?"":r.substring(0,c))+r.substring(f+1):c=f}}return r===""?null:r}function ta(n,e,t,r,o,u){var c=n.__className;if(c!==t||c===void 0){var f=vc(t,r,u);f==null?n.removeAttribute("class"):n.className=f,n.__className=t}else if(u&&o!==u)for(var v in u){var m=!!u[v];(o==null||m!==!!o[v])&&n.classList.toggle(v,m)}return u}const pc=Symbol("is custom element"),gc=Symbol("is html");function na(n,e,t,r){var o=mc(n);o[e]!==(o[e]=t)&&(t==null?n.removeAttribute(e):typeof t!="string"&&_c(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function mc(n){return n.__attributes??={[pc]:n.nodeName.includes("-"),[gc]:n.namespaceURI===Sl}}var ra=new Map;function _c(n){var e=n.getAttribute("is")||n.nodeName,t=ra.get(e);if(t)return t;ra.set(e,t=[]);for(var r,o=n,u=Element.prototype;u!==o;){r=rl(o);for(var c in r)r[c].set&&t.push(c);o=Ma(o)}return t}function ia(n,e){return n===e||n?.[Ei]===e}function yc(n={},e,t,r){return Yl(()=>{var o,u;return Xl(()=>{o=u,u=[],uu(()=>{n!==t(...u)&&(e(n,...u),o&&ia(t(...o),n)&&e(null,...o))})}),()=>{Na(()=>{u&&ia(t(...u),n)&&e(null,...u)})}}),n}function $r(n){qe===null&&hl(),Wr&&qe.l!==null?wc(qe).m.push(n):Gl(()=>{const e=uu(n);if(typeof e=="function")return e})}function wc(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const bc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(bc);Il();const Ec="modulepreload",Ac=function(n,e){return new URL(n,e).href},sa={},Hr=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let m=function(y){return Promise.all(y.map(E=>Promise.resolve(E).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};const c=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),v=f?.nonce||f?.getAttribute("nonce");o=m(t.map(y=>{if(y=Ac(y,r),y in sa)return;sa[y]=!0;const E=y.endsWith(".css"),A=E?'[rel="stylesheet"]':"";if(!!r)for(let O=c.length-1;O>=0;O--){const M=c[O];if(M.href===y&&(!E||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${A}`))return;const S=document.createElement("link");if(S.rel=E?"stylesheet":Ec,E||(S.as="script"),S.crossOrigin="",S.href=y,v&&S.setAttribute("nonce",v),document.head.appendChild(S),E)return new Promise((O,M)=>{S.addEventListener("load",O),S.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return o.then(c=>{for(const f of c||[])f.status==="rejected"&&u(f.reason);return e().catch(u)})},kc=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Hr(async()=>{const{default:r}=await Promise.resolve().then(()=>gr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class zs extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Sc extends zs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class oa extends zs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class aa extends zs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var _s;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(_s||(_s={}));var Cc=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class Tc{constructor(e,{headers:t={},customFetch:r,region:o=_s.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=kc(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Cc(this,void 0,void 0,function*(){try{const{headers:o,method:u,body:c}=t;let f={},{region:v}=t;v||(v=this.region);const m=new URL(`${this.url}/${e}`);v&&v!=="any"&&(f["x-region"]=v,m.searchParams.set("forceFunctionRegion",v));let y;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(f["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(f["Content-Type"]="application/json",y=JSON.stringify(c)));const E=yield this.fetch(m.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:y}).catch(O=>{throw new Sc(O)}),A=E.headers.get("x-relay-error");if(A&&A==="true")throw new oa(E);if(!E.ok)throw new aa(E);let g=((r=E.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),S;return g==="application/json"?S=yield E.json():g==="application/octet-stream"?S=yield E.blob():g==="text/event-stream"?S=E:g==="multipart/form-data"?S=yield E.formData():S=yield E.text(),{data:S,error:null,response:E}}catch(o){return{data:null,error:o,response:o instanceof aa||o instanceof oa?o.context:void 0}}})}}function Pc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ic(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var o=!1;try{o=this instanceof r}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var Ye={},Gn={},Kn={},Yn={},Jn={},Xn={},Rc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},hr=Rc();const Oc=hr.fetch,du=hr.fetch.bind(hr),fu=hr.Headers,jc=hr.Request,xc=hr.Response,gr=Object.freeze(Object.defineProperty({__proto__:null,Headers:fu,Request:jc,Response:xc,default:du,fetch:Oc},Symbol.toStringTag,{value:"Module"})),Mc=Ic(gr);var mi={},ua;function vu(){if(ua)return mi;ua=1,Object.defineProperty(mi,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return mi.default=n,mi}var la;function pu(){if(la)return Xn;la=1;var n=Xn&&Xn.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Xn,"__esModule",{value:!0});const e=n(Mc),t=n(vu());class r{constructor(u){var c,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(c=u.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,c){return this.headers=new Headers(this.headers),this.headers.set(u,c),this}then(u,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let v=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var y,E,A,g;let S=null,O=null,M=null,H=m.status,B=m.statusText;if(m.ok){if(this.method!=="HEAD"){const x=await m.text();x===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?O=x:O=JSON.parse(x))}const L=(E=this.headers.get("Prefer"))===null||E===void 0?void 0:E.match(/count=(exact|planned|estimated)/),z=(A=m.headers.get("content-range"))===null||A===void 0?void 0:A.split("/");L&&z&&z.length>1&&(M=parseInt(z[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(O)&&(O.length>1?(S={code:"PGRST116",details:`Results contain ${O.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},O=null,M=null,H=406,B="Not Acceptable"):O.length===1?O=O[0]:O=null)}else{const L=await m.text();try{S=JSON.parse(L),Array.isArray(S)&&m.status===404&&(O=[],S=null,H=200,B="OK")}catch{m.status===404&&L===""?(H=204,B="No Content"):S={message:L}}if(S&&this.isMaybeSingle&&(!((g=S?.details)===null||g===void 0)&&g.includes("0 rows"))&&(S=null,H=200,B="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:O,count:M,status:H,statusText:B}});return this.shouldThrowOnError||(v=v.catch(m=>{var y,E,A;return{error:{message:`${(y=m?.name)!==null&&y!==void 0?y:"FetchError"}: ${m?.message}`,details:`${(E=m?.stack)!==null&&E!==void 0?E:""}`,hint:"",code:`${(A=m?.code)!==null&&A!==void 0?A:""}`},data:null,count:null,status:0,statusText:""}})),v.then(u,c)}returns(){return this}overrideTypes(){return this}}return Xn.default=r,Xn}var ca;function gu(){if(ca)return Jn;ca=1;var n=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jn,"__esModule",{value:!0});const e=n(pu());class t extends e.default{select(o){let u=!1;const c=(o??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:u=!0,nullsFirst:c,foreignTable:f,referencedTable:v=f}={}){const m=v?`${v}.order`:"order",y=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${y?`${y},`:""}${o}.${u?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:u,referencedTable:c=u}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${o}`),this}range(o,u,{foreignTable:c,referencedTable:f=c}={}){const v=typeof f>"u"?"offset":`${f}.offset`,m=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(v,`${o}`),this.url.searchParams.set(m,`${u-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:u=!1,settings:c=!1,buffers:f=!1,wal:v=!1,format:m="text"}={}){var y;const E=[o?"analyze":null,u?"verbose":null,c?"settings":null,f?"buffers":null,v?"wal":null].filter(Boolean).join("|"),A=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${A}"; options=${E};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Jn.default=t,Jn}var ha;function Gs(){if(ha)return Yn;ha=1;var n=Yn&&Yn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Yn,"__esModule",{value:!0});const e=n(gu());class t extends e.default{eq(o,u){return this.url.searchParams.append(o,`eq.${u}`),this}neq(o,u){return this.url.searchParams.append(o,`neq.${u}`),this}gt(o,u){return this.url.searchParams.append(o,`gt.${u}`),this}gte(o,u){return this.url.searchParams.append(o,`gte.${u}`),this}lt(o,u){return this.url.searchParams.append(o,`lt.${u}`),this}lte(o,u){return this.url.searchParams.append(o,`lte.${u}`),this}like(o,u){return this.url.searchParams.append(o,`like.${u}`),this}likeAllOf(o,u){return this.url.searchParams.append(o,`like(all).{${u.join(",")}}`),this}likeAnyOf(o,u){return this.url.searchParams.append(o,`like(any).{${u.join(",")}}`),this}ilike(o,u){return this.url.searchParams.append(o,`ilike.${u}`),this}ilikeAllOf(o,u){return this.url.searchParams.append(o,`ilike(all).{${u.join(",")}}`),this}ilikeAnyOf(o,u){return this.url.searchParams.append(o,`ilike(any).{${u.join(",")}}`),this}is(o,u){return this.url.searchParams.append(o,`is.${u}`),this}in(o,u){const c=Array.from(new Set(u)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,u){return typeof u=="string"?this.url.searchParams.append(o,`cs.${u}`):Array.isArray(u)?this.url.searchParams.append(o,`cs.{${u.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(u)}`),this}containedBy(o,u){return typeof u=="string"?this.url.searchParams.append(o,`cd.${u}`):Array.isArray(u)?this.url.searchParams.append(o,`cd.{${u.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(u)}`),this}rangeGt(o,u){return this.url.searchParams.append(o,`sr.${u}`),this}rangeGte(o,u){return this.url.searchParams.append(o,`nxl.${u}`),this}rangeLt(o,u){return this.url.searchParams.append(o,`sl.${u}`),this}rangeLte(o,u){return this.url.searchParams.append(o,`nxr.${u}`),this}rangeAdjacent(o,u){return this.url.searchParams.append(o,`adj.${u}`),this}overlaps(o,u){return typeof u=="string"?this.url.searchParams.append(o,`ov.${u}`):this.url.searchParams.append(o,`ov.{${u.join(",")}}`),this}textSearch(o,u,{config:c,type:f}={}){let v="";f==="plain"?v="pl":f==="phrase"?v="ph":f==="websearch"&&(v="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${v}fts${m}.${u}`),this}match(o){return Object.entries(o).forEach(([u,c])=>{this.url.searchParams.append(u,`eq.${c}`)}),this}not(o,u,c){return this.url.searchParams.append(o,`not.${u}.${c}`),this}or(o,{foreignTable:u,referencedTable:c=u}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${o})`),this}filter(o,u,c){return this.url.searchParams.append(o,`${u}.${c}`),this}}return Yn.default=t,Yn}var da;function mu(){if(da)return Kn;da=1;var n=Kn&&Kn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Kn,"__esModule",{value:!0});const e=n(Gs());class t{constructor(o,{headers:u={},schema:c,fetch:f}){this.url=o,this.headers=new Headers(u),this.schema=c,this.fetch=f}select(o,{head:u=!1,count:c}={}){const f=u?"HEAD":"GET";let v=!1;const m=(o??"*").split("").map(y=>/\s/.test(y)&&!v?"":(y==='"'&&(v=!v),y)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:u,defaultToNull:c=!0}={}){var f;const v="POST";if(u&&this.headers.append("Prefer",`count=${u}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const m=o.reduce((y,E)=>y.concat(Object.keys(E)),[]);if(m.length>0){const y=[...new Set(m)].map(E=>`"${E}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(o,{onConflict:u,ignoreDuplicates:c=!1,count:f,defaultToNull:v=!0}={}){var m;const y="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),u!==void 0&&this.url.searchParams.set("on_conflict",u),f&&this.headers.append("Prefer",`count=${f}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const E=o.reduce((A,g)=>A.concat(Object.keys(g)),[]);if(E.length>0){const A=[...new Set(E)].map(g=>`"${g}"`);this.url.searchParams.set("columns",A.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(o,{count:u}={}){var c;const f="PATCH";return u&&this.headers.append("Prefer",`count=${u}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var u;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Kn.default=t,Kn}var fa;function Lc(){if(fa)return Gn;fa=1;var n=Gn&&Gn.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Gn,"__esModule",{value:!0});const e=n(mu()),t=n(Gs());class r{constructor(u,{headers:c={},schema:f,fetch:v}={}){this.url=u,this.headers=new Headers(c),this.schemaName=f,this.fetch=v}from(u){const c=new URL(`${this.url}/${u}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(u){return new r(this.url,{headers:this.headers,schema:u,fetch:this.fetch})}rpc(u,c={},{head:f=!1,get:v=!1,count:m}={}){var y;let E;const A=new URL(`${this.url}/rpc/${u}`);let g;f||v?(E=f?"HEAD":"GET",Object.entries(c).filter(([O,M])=>M!==void 0).map(([O,M])=>[O,Array.isArray(M)?`{${M.join(",")}}`:`${M}`]).forEach(([O,M])=>{A.searchParams.append(O,M)})):(E="POST",g=c);const S=new Headers(this.headers);return m&&S.set("Prefer",`count=${m}`),new t.default({method:E,url:A,headers:S,schema:this.schemaName,body:g,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Gn.default=r,Gn}var va;function Fc(){if(va)return Ye;va=1;var n=Ye&&Ye.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.PostgrestError=Ye.PostgrestBuilder=Ye.PostgrestTransformBuilder=Ye.PostgrestFilterBuilder=Ye.PostgrestQueryBuilder=Ye.PostgrestClient=void 0;const e=n(Lc());Ye.PostgrestClient=e.default;const t=n(mu());Ye.PostgrestQueryBuilder=t.default;const r=n(Gs());Ye.PostgrestFilterBuilder=r.default;const o=n(gu());Ye.PostgrestTransformBuilder=o.default;const u=n(pu());Ye.PostgrestBuilder=u.default;const c=n(vu());return Ye.PostgrestError=c.default,Ye.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:u.default,PostgrestError:c.default},Ye}var Uc=Fc();const Dc=Pc(Uc),{PostgrestClient:$c,PostgrestQueryBuilder:lf,PostgrestFilterBuilder:cf,PostgrestTransformBuilder:hf,PostgrestBuilder:df,PostgrestError:ff}=Dc;class Nc{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Bc="2.15.1",Wc=`realtime-js/${Bc}`,Vc="1.0.0",ys=1e4,qc=1e3,Hc=100;var jr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(jr||(jr={}));var We;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(We||(We={}));var Mt;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Mt||(Mt={}));var ws;(function(n){n.websocket="websocket"})(ws||(ws={}));var Mn;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Mn||(Mn={}));class zc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),u=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=r.decode(e.slice(c,c+o));c=c+o;const v=r.decode(e.slice(c,c+u));c=c+u;const m=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:f,event:v,payload:m}}}class _u{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Me;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Me||(Me={}));const pa=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((u,c)=>(u[c]=Gc(c,n,e,o),u),{})},Gc=(n,e,t,r)=>{const o=e.find(f=>f.name===n),u=o?.type,c=t[n];return u&&!r.includes(u)?yu(u,c):bs(c)},yu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Xc(e,t)}switch(n){case Me.bool:return Kc(e);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return Yc(e);case Me.json:case Me.jsonb:return Jc(e);case Me.timestamp:return Qc(e);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return bs(e);default:return bs(e)}},bs=n=>n,Kc=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Yc=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Jc=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Xc=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let u;const c=n.slice(1,t);try{u=JSON.parse("["+c+"]")}catch{u=c?c.split(","):[]}return u.map(f=>yu(e,f))}return n},Qc=n=>typeof n=="string"?n.replace(" ","T"):n,wu=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class as{constructor(e,t,r={},o=ys){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ga;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ga||(ga={}));class xr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:u,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xr.syncState(this.state,o,u,c),this.pendingDiffs.forEach(v=>{this.state=xr.syncDiff(this.state,v,u,c)}),this.pendingDiffs=[],f()}),this.channel._on(r.diff,{},o=>{const{onJoin:u,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=xr.syncDiff(this.state,o,u,c),f())}),this.onJoin((o,u,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:u,newPresences:c})}),this.onLeave((o,u,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:u,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const u=this.cloneDeep(e),c=this.transformState(t),f={},v={};return this.map(u,(m,y)=>{c[m]||(v[m]=y)}),this.map(c,(m,y)=>{const E=u[m];if(E){const A=y.map(M=>M.presence_ref),g=E.map(M=>M.presence_ref),S=y.filter(M=>g.indexOf(M.presence_ref)<0),O=E.filter(M=>A.indexOf(M.presence_ref)<0);S.length>0&&(f[m]=S),O.length>0&&(v[m]=O)}else f[m]=y}),this.syncDiff(u,{joins:f,leaves:v},r,o)}static syncDiff(e,t,r,o){const{joins:u,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(u,(f,v)=>{var m;const y=(m=e[f])!==null&&m!==void 0?m:[];if(e[f]=this.cloneDeep(v),y.length>0){const E=e[f].map(g=>g.presence_ref),A=y.filter(g=>E.indexOf(g.presence_ref)<0);e[f].unshift(...A)}r(f,y,v)}),this.map(c,(f,v)=>{let m=e[f];if(!m)return;const y=v.map(E=>E.presence_ref);m=m.filter(E=>y.indexOf(E.presence_ref)<0),e[f]=m,o(f,m,v),m.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ma;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ma||(ma={}));var Mr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Mr||(Mr={}));var en;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(en||(en={}));class Ks{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=We.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new as(this,Mt.join,this.params,this.timeout),this.rejoinTimer=new _u(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=We.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=We.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=We.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Mt.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new xr(this),this.broadcastEndpointURL=wu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==We.closed){const{config:{broadcast:u,presence:c,private:f}}=this.params,v=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(A=>A.filter))!==null&&o!==void 0?o:[],m=!!this.bindings[Mr.PRESENCE]&&this.bindings[Mr.PRESENCE].length>0,y={},E={broadcast:u,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:v,private:f};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(A=>e?.(en.CHANNEL_ERROR,A)),this._onClose(()=>e?.(en.CLOSED)),this.updateJoinPayload(Object.assign({config:E},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:A})=>{var g;if(this.socket.setAuth(),A===void 0){e?.(en.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,O=(g=S?.length)!==null&&g!==void 0?g:0,M=[];for(let H=0;H<O;H++){const B=S[H],{filter:{event:U,schema:L,table:z,filter:x}}=B,F=A&&A[H];if(F&&F.event===U&&F.schema===L&&F.table===z&&F.filter===x)M.push(Object.assign(Object.assign({},B),{id:F.id}));else{this.unsubscribe(),this.state=We.errored,e?.(en.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=M,e&&e(en.SUBSCRIBED);return}}).receive("error",A=>{this.state=We.errored,e?.(en.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(A).join(", ")||"error")))}).receive("timeout",()=>{e?.(en.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===We.joined&&e===Mr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:u,payload:c}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=m.body)===null||o===void 0?void 0:o.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var c,f,v;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||v===void 0)&&v.ack)&&u("ok"),m.receive("ok",()=>u("ok")),m.receive("error",()=>u("error")),m.receive("timeout",()=>u("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=We.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Mt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new as(this,Mt.leave,{},e),r.receive("ok",()=>{t(),o("ok")}).receive("timeout",()=>{t(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=We.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const o=new AbortController,u=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(u),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new as(this,e,t,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Hc){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,u;const c=e.toLocaleLowerCase(),{close:f,error:v,leave:m,join:y}=Mt;if(r&&[f,v,m,y].indexOf(c)>=0&&r!==this._joinRef())return;let A=this._onMessage(c,t,r);if(t&&!A)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(g=>{var S,O,M;return((S=g.filter)===null||S===void 0?void 0:S.event)==="*"||((M=(O=g.filter)===null||O===void 0?void 0:O.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===c}).map(g=>g.callback(A,r)):(u=this.bindings[c])===null||u===void 0||u.filter(g=>{var S,O,M,H,B,U;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in g){const L=g.id,z=(S=g.filter)===null||S===void 0?void 0:S.event;return L&&((O=t.ids)===null||O===void 0?void 0:O.includes(L))&&(z==="*"||z?.toLocaleLowerCase()===((M=t.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{const L=(B=(H=g?.filter)===null||H===void 0?void 0:H.event)===null||B===void 0?void 0:B.toLocaleLowerCase();return L==="*"||L===((U=t?.event)===null||U===void 0?void 0:U.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===c}).map(g=>{if(typeof A=="object"&&"ids"in A){const S=A.data,{schema:O,table:M,commit_timestamp:H,type:B,errors:U}=S;A=Object.assign(Object.assign({},{schema:O,table:M,commit_timestamp:H,eventType:B,new:{},old:{},errors:U}),this._getPayloadRecords(S))}g.callback(A,r)})}_isClosed(){return this.state===We.closed}_isJoined(){return this.state===We.joined}_isJoining(){return this.state===We.joining}_isLeaving(){return this.state===We.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),u={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(u):this.bindings[o]=[u],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var u;return!(((u=o.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===r&&Ks.isEqual(o.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Mt.close,{},e)}_onError(e){this._on(Mt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=We.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=pa(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=pa(e.columns,e.old_record)),t}}const _a=()=>{},_i={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Zc=[1e3,2e3,5e3,1e4],eh=1e4,th=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nh{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ys,this.transport=null,this.heartbeatIntervalMs=_i.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_a,this.ref=0,this.reconnectTimer=null,this.logger=_a,this.conn=null,this.sendBuffer=[],this.serializer=new zc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let u;return o?u=o:typeof fetch>"u"?u=(...c)=>Hr(async()=>{const{default:f}=await Promise.resolve().then(()=>gr);return{default:f}},void 0,import.meta.url).then(({default:f})=>f(...c)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):u=fetch,(...c)=>u(...c)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ws.websocket}`,this.httpEndpoint=wu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Nc.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Vc}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case jr.connecting:return Mn.Connecting;case jr.open:return Mn.Open;case jr.closing:return Mn.Closing;default:return Mn.Closed}}isConnected(){return this.connectionState()===Mn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(u=>u.topic===r);if(o)return o;{const u=new Ks(`realtime:${e}`,t,this);return this.channels.push(u),u}}push(e){const{topic:t,event:r,payload:o,ref:u}=e,c=()=>{this.encode(e,f=>{var v;(v=this.conn)===null||v===void 0||v.send(f)})};this.log("push",`${t} ${r} (${u})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(qc,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},_i.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:u,ref:c}=t,f=c?`(${c})`:"",v=u.status||"";this.log("receive",`${v} ${r} ${o} ${f}`.trim(),u),this.channels.filter(m=>m._isMember(r)).forEach(m=>m._trigger(o,u,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Mt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([th],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const o={access_token:t,version:Wc};t&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(Mt.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new _u(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_i.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,o,u,c,f,v,m;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:ys,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:_i.HEARTBEAT_INTERVAL,this.worker=(u=e?.worker)!==null&&u!==void 0?u:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(y=>Zc[y-1]||eh),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((y,E)=>E(JSON.stringify(y))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Ys extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ve(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class rh extends Ys{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Es extends Ys{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ih=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const bu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Hr(async()=>{const{default:r}=await Promise.resolve().then(()=>gr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},sh=()=>ih(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Hr(()=>Promise.resolve().then(()=>gr),void 0,import.meta.url)).Response:Response}),As=n=>{if(Array.isArray(n))return n.map(t=>As(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));e[o]=As(r)}),e},oh=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Bn=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const us=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ah=(n,e,t)=>Bn(void 0,void 0,void 0,function*(){const r=yield sh();n instanceof r&&!t?.noResolveJson?n.json().then(o=>{const u=n.status||500,c=o?.statusCode||u+"";e(new rh(us(o),u,c))}).catch(o=>{e(new Es(us(o),o))}):e(new Es(us(n),n))}),uh=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"||!r?o:(oh(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(r)):o.body=r,e?.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),t))};function zr(n,e,t,r,o,u){return Bn(this,void 0,void 0,function*(){return new Promise((c,f)=>{n(t,uh(e,r,o,u)).then(v=>{if(!v.ok)throw v;return r?.noResolveJson?v:v.json()}).then(v=>c(v)).catch(v=>ah(v,f,r))})})}function ji(n,e,t,r){return Bn(this,void 0,void 0,function*(){return zr(n,"GET",e,t,r)})}function Wt(n,e,t,r,o){return Bn(this,void 0,void 0,function*(){return zr(n,"POST",e,r,o,t)})}function ks(n,e,t,r,o){return Bn(this,void 0,void 0,function*(){return zr(n,"PUT",e,r,o,t)})}function lh(n,e,t,r){return Bn(this,void 0,void 0,function*(){return zr(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Eu(n,e,t,r,o){return Bn(this,void 0,void 0,function*(){return zr(n,"DELETE",e,r,o,t)})}var rt=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const ch={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ya={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hh{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=bu(o)}uploadOrUpdate(e,t,r,o){return rt(this,void 0,void 0,function*(){try{let u;const c=Object.assign(Object.assign({},ya),o);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const v=c.metadata;typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),v&&u.append("metadata",this.encodeMetadata(v)),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl),v&&u.append("metadata",this.encodeMetadata(v))):(u=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,v&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),o?.headers&&(f=Object.assign(Object.assign({},f),o.headers));const m=this._removeEmptyFolders(t),y=this._getFinalPath(m),E=yield(e=="PUT"?ks:Wt)(this.fetch,`${this.url}/object/${y}`,u,Object.assign({headers:f},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:E.Id,fullPath:E.Key},error:null}}catch(u){if(Ve(u))return{data:null,error:u};throw u}})}upload(e,t,r){return rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return rt(this,void 0,void 0,function*(){const u=this._removeEmptyFolders(e),c=this._getFinalPath(u),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let v;const m=Object.assign({upsert:ya.upsert},o),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",m.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",m.cacheControl)):(v=r,y["cache-control"]=`max-age=${m.cacheControl}`,y["content-type"]=m.contentType);const E=yield ks(this.fetch,f.toString(),v,{headers:y});return{data:{path:u,fullPath:E.Key},error:null}}catch(v){if(Ve(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return rt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t?.upsert&&(o["x-upsert"]="true");const u=yield Wt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+u.url),f=c.searchParams.get("token");if(!f)throw new Ys("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:f},error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}update(e,t,r){return rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return rt(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}copy(e,t,r){return rt(this,void 0,void 0,function*(){try{return{data:{path:(yield Wt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return rt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),u=yield Wt(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return u={signedUrl:encodeURI(`${this.url}${u.signedURL}${c}`)},{data:u,error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return rt(this,void 0,void 0,function*(){try{const o=yield Wt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),u=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${u}`):null})),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}download(e,t){return rt(this,void 0,void 0,function*(){const o=typeof t?.transform<"u"?"render/image/authenticated":"object",u=this.transformOptsToQueryString(t?.transform||{}),c=u?`?${u}`:"";try{const f=this._getFinalPath(e);return{data:yield(yield ji(this.fetch,`${this.url}/${o}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(Ve(f))return{data:null,error:f};throw f}})}info(e){return rt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ji(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:As(r),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}exists(e){return rt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield lh(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Ve(r)&&r instanceof Es){const o=r.originalError;if([400,404].includes(o?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],u=t?.download?`download=${t.download===!0?"":t.download}`:"";u!==""&&o.push(u);const f=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&o.push(v);let m=o.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${r}${m}`)}}}remove(e){return rt(this,void 0,void 0,function*(){try{return{data:yield Eu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}list(e,t,r){return rt(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},ch),t),{prefix:e||""});return{data:yield Wt(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(Ve(o))return{data:null,error:o};throw o}})}listV2(e,t){return rt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Wt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const dh="2.11.0",fh={"X-Client-Info":`storage-js/${dh}`};var Qn=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class vh{constructor(e,t={},r,o){const u=new URL(e);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(u.hostname)&&!u.hostname.includes("storage.supabase.")&&(u.hostname=u.hostname.replace("supabase.","storage.supabase.")),this.url=u.href,this.headers=Object.assign(Object.assign({},fh),t),this.fetch=bu(r)}listBuckets(){return Qn(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ve(e))return{data:null,error:e};throw e}})}getBucket(e){return Qn(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Qn(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Qn(this,void 0,void 0,function*(){try{return{data:yield ks(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Qn(this,void 0,void 0,function*(){try{return{data:yield Wt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Qn(this,void 0,void 0,function*(){try{return{data:yield Eu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}})}}class ph extends vh{constructor(e,t={},r,o){super(e,t,r,o)}from(e){return new hh(this.url,this.headers,e,this.fetch)}}const gh="2.56.0";let Rr="";typeof Deno<"u"?Rr="deno":typeof document<"u"?Rr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rr="react-native":Rr="node";const mh={"X-Client-Info":`supabase-js-${Rr}/${gh}`},_h={headers:mh},yh={schema:"public"},wh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bh={};var Eh=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};const Ah=n=>{let e;return n?e=n:typeof fetch>"u"?e=du:e=fetch,(...t)=>e(...t)},kh=()=>typeof Headers>"u"?fu:Headers,Sh=(n,e,t)=>{const r=Ah(t),o=kh();return(u,c)=>Eh(void 0,void 0,void 0,function*(){var f;const v=(f=yield e())!==null&&f!==void 0?f:n;let m=new o(c?.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${v}`),r(u,Object.assign(Object.assign({},c),{headers:m}))})};var Ch=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};function Th(n){return n.endsWith("/")?n:n+"/"}function Ph(n,e){var t,r;const{db:o,auth:u,realtime:c,global:f}=n,{db:v,auth:m,realtime:y,global:E}=e,A={db:Object.assign(Object.assign({},v),o),auth:Object.assign(Object.assign({},m),u),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},E),f),{headers:Object.assign(Object.assign({},(t=E?.headers)!==null&&t!==void 0?t:{}),(r=f?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Ch(this,void 0,void 0,function*(){return""})};return n.accessToken?A.accessToken=n.accessToken:delete A.accessToken,A}const Au="2.71.1",rr=30*1e3,Ss=3,ls=Ss*rr,Ih="http://localhost:9999",Rh="supabase.auth.token",Oh={"X-Client-Info":`gotrue-js/${Au}`},Cs="X-Supabase-Api-Version",ku={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xh=600*1e3;class Js extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ue(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Mh extends Js{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Lh(n){return ue(n)&&n.name==="AuthApiError"}class Su extends Js{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class En extends Js{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class gn extends En{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Fh(n){return ue(n)&&n.name==="AuthSessionMissingError"}class yi extends En{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wi extends En{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class bi extends En{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Uh(n){return ue(n)&&n.name==="AuthImplicitGrantRedirectError"}class wa extends En{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ts extends En{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function cs(n){return ue(n)&&n.name==="AuthRetryableFetchError"}class ba extends En{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Ps extends En{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ea=` 	
\r=`.split(""),Dh=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Ea.length;e+=1)n[Ea[e].charCodeAt(0)]=-2;for(let e=0;e<xi.length;e+=1)n[xi[e].charCodeAt(0)]=e;return n})();function Aa(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(xi[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(xi[r]),e.queuedBits-=6}}function Cu(n,e,t){const r=Dh[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function ka(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},u=c=>{Bh(c,r,t)};for(let c=0;c<n.length;c+=1)Cu(n.charCodeAt(c),o,u);return e.join("")}function $h(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Nh(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|o)+65536,t+=1}$h(r,e)}}function Bh(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Wh(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<n.length;o+=1)Cu(n.charCodeAt(o),t,r);return new Uint8Array(e)}function Vh(n){const e=[];return Nh(n,t=>e.push(t)),new Uint8Array(e)}function qh(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};return n.forEach(o=>Aa(o,t,r)),Aa(null,t,r),e.join("")}function Hh(n){return Math.round(Date.now()/1e3)+n}function zh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const xt=()=>typeof window<"u"&&typeof document<"u",Rn={tested:!1,writable:!1},Tu=()=>{if(!xt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rn.tested)return Rn.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Rn.tested=!0,Rn.writable=!0}catch{Rn.tested=!0,Rn.writable=!1}return Rn.writable};function Gh(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,u)=>{e[u]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const Pu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Hr(async()=>{const{default:r}=await Promise.resolve().then(()=>gr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Kh=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ir=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},On=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},pn=async(n,e)=>{await n.removeItem(e)};class $i{constructor(){this.promise=new $i.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}$i.promiseConstructor=Promise;function hs(n){const e=n.split(".");if(e.length!==3)throw new Ps("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!jh.test(e[r]))throw new Ps("JWT not in base64url format");return{header:JSON.parse(ka(e[0])),payload:JSON.parse(ka(e[1])),signature:Wh(e[2]),raw:{header:e[0],payload:e[1]}}}async function Yh(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Jh(n,e){return new Promise((r,o)=>{(async()=>{for(let u=0;u<1/0;u++)try{const c=await n(u);if(!e(u,null,c)){r(c);return}}catch(c){if(!e(u,c)){o(c);return}}})()})}function Xh(n){return("0"+n.toString(16)).substr(-2)}function Qh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let u=0;u<56;u++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Xh).join("")}async function Zh(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(u=>String.fromCharCode(u)).join("")}async function ed(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Zh(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zn(n,e,t=!1){const r=Qh();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await ir(n,`${e}-code-verifier`,o);const u=await ed(r);return[u,r===u?"plain":"s256"]}const td=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nd(n){const e=n.headers.get(Cs);if(!e||!e.match(td))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function rd(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function id(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function er(n){if(!sd.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ds(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Sa(n){return JSON.parse(JSON.stringify(n))}var od=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const jn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ad=[502,503,504];async function Ca(n){var e;if(!Kh(n))throw new Ts(jn(n),0);if(ad.includes(n.status))throw new Ts(jn(n),n.status);let t;try{t=await n.json()}catch(u){throw new Su(jn(u),u)}let r;const o=nd(n);if(o&&o.getTime()>=ku["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new ba(jn(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new gn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((u,c)=>u&&typeof c=="string",!0))throw new ba(jn(t),n.status,t.weak_password.reasons);throw new Mh(jn(t),n.status||500,r)}const ud=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function ve(n,e,t,r){var o;const u=Object.assign({},r?.headers);u[Cs]||(u[Cs]=ku["2024-01-01"].name),r?.jwt&&(u.Authorization=`Bearer ${r.jwt}`);const c=(o=r?.query)!==null&&o!==void 0?o:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",v=await ld(n,e,t+f,{headers:u,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(v):{data:Object.assign({},v),error:null}}async function ld(n,e,t,r,o,u){const c=ud(e,r,o,u);let f;try{f=await n(t,Object.assign({},c))}catch(v){throw console.error(v),new Ts(jn(v),0)}if(f.ok||await Ca(f),r?.noResolveJson)return f;try{return await f.json()}catch(v){await Ca(v)}}function Zt(n){var e;let t=null;fd(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Hh(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Ta(n){const e=Zt(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function mn(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function cd(n){return{data:n,error:null}}function hd(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:u}=n,c=od(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:u},v=Object.assign({},c);return{data:{properties:f,user:v},error:null}}function dd(n){return n}function fd(n){return n.access_token&&n.refresh_token&&n.expires_in}const fs=["global","local","others"];var vd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class pd{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Pu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=fs[0]){if(fs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fs.join(", ")}`);try{return await ve(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ue(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:mn})}catch(r){if(ue(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=vd(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r?.newEmail,delete o.newEmail),await ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:hd,redirectTo:t?.redirectTo})}catch(t){if(ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ve(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:mn})}catch(t){if(ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,u,c,f,v;try{const m={nextPage:null,lastPage:0,total:0},y=await ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(u=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&u!==void 0?u:""},xform:dd});if(y.error)throw y.error;const E=await y.json(),A=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,g=(v=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&v!==void 0?v:[];return g.length>0&&(g.forEach(S=>{const O=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(S.split(";")[1].split("=")[1]);m[`${M}Page`]=O}),m.total=parseInt(A)),{data:Object.assign(Object.assign({},E),m),error:null}}catch(m){if(ue(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){er(e);try{return await ve(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:mn})}catch(t){if(ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){er(e);try{return await ve(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:mn})}catch(r){if(ue(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){er(e);try{return await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:mn})}catch(r){if(ue(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){er(e.userId);try{const{data:t,error:r}=await ve(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){er(e.userId),er(e.id);try{return{data:await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}}}function Pa(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function gd(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const tr={debug:!!(globalThis&&Tu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Iu extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class md extends Iu{}async function _d(n,e,t){tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),tr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new md(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(tr.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}gd();const yd={url:Ih,storageKey:Rh,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Oh,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ia(n,e,t){return await t()}const nr={};class Nr{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Nr.nextInstanceID,Nr.nextInstanceID+=1,this.instanceID>0&&xt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},yd),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new pd({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Pu(o.fetch),this.lock=o.lock||Ia,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:xt()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=_d:this.lock=Ia,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Tu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Pa(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Pa(this.memoryStorage)),xt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u),await this._notifyAllSubscribers(u.data.event,u.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=nr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){nr[this.storageKey]=Object.assign(Object.assign({},nr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=nr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){nr[this.storageKey]=Object.assign(Object.assign({},nr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Au}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Gh(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),xt()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:u}=await this._getSessionFromURL(t,r);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),Uh(u)){const v=(e=u.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:u}}return await this._removeSession(),{error:u}}const{session:c,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ue(t)?{error:t}:{error:new Su("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const u=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Zt}),{data:c,error:f}=u;if(f||!c)return{data:{user:null,session:null},error:f};const v=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(u){if(ue(u))return{data:{user:null,session:null},error:u};throw u}}async signUp(e){var t,r,o;try{let u;if("email"in e){const{email:y,password:E,options:A}=e;let g=null,S=null;this.flowType==="pkce"&&([g,S]=await Zn(this.storage,this.storageKey)),u=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:A?.emailRedirectTo,body:{email:y,password:E,data:(t=A?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:A?.captchaToken},code_challenge:g,code_challenge_method:S},xform:Zt})}else if("phone"in e){const{phone:y,password:E,options:A}=e;u=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:E,data:(r=A?.data)!==null&&r!==void 0?r:{},channel:(o=A?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:A?.captchaToken}},xform:Zt})}else throw new wi("You must provide either an email or phone number and a password");const{data:c,error:f}=u;if(f||!c)return{data:{user:null,session:null},error:f};const v=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(u){if(ue(u))return{data:{user:null,session:null},error:u};throw u}}async signInWithPassword(e){try{let t;if("email"in e){const{email:u,password:c,options:f}=e;t=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Ta})}else if("phone"in e){const{phone:u,password:c,options:f}=e;t=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Ta})}else throw new wi("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new yi}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,u;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(u=e.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,o,u,c,f,v,m,y,E,A,g;let S,O;if("message"in e)S=e.message,O=e.signature;else{const{chain:M,wallet:H,statement:B,options:U}=e;let L;if(xt())if(typeof H=="object")L=H;else{const x=window;if("solana"in x&&typeof x.solana=="object"&&("signIn"in x.solana&&typeof x.solana.signIn=="function"||"signMessage"in x.solana&&typeof x.solana.signMessage=="function"))L=x.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof H!="object"||!U?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=H}const z=new URL((t=U?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in L&&L.signIn){const x=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},U?.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),B?{statement:B}:null));let F;if(Array.isArray(x)&&x[0]&&typeof x[0]=="object")F=x[0];else if(x&&typeof x=="object"&&"signedMessage"in x&&"signature"in x)F=x;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)S=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),O=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${z.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...B?["",B,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(o=(r=U?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((u=U?.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${U.signInWithSolana.notBefore}`]:[],...!((c=U?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${U.signInWithSolana.expirationTime}`]:[],...!((f=U?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${U.signInWithSolana.chainId}`]:[],...!((v=U?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${U.signInWithSolana.nonce}`]:[],...!((m=U?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${U.signInWithSolana.requestId}`]:[],...!((E=(y=U?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||E===void 0)&&E.length?["Resources",...U.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const x=await L.signMessage(new TextEncoder().encode(S),"utf8");if(!x||!(x instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");O=x}}try{const{data:M,error:H}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:qh(O)},!((A=e.options)===null||A===void 0)&&A.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Zt});if(H)throw H;return!M||!M.session||!M.user?{data:{user:null,session:null},error:new yi}:(M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),{data:Object.assign({},M),error:H})}catch(M){if(ue(M))return{data:{user:null,session:null},error:M};throw M}}async _exchangeCodeForSession(e){const t=await On(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:u,error:c}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Zt});if(await pn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!u||!u.session||!u.user?{data:{user:null,session:null,redirectType:null},error:new yi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:Object.assign(Object.assign({},u),{redirectType:o??null}),error:c})}catch(u){if(ue(u))return{data:{user:null,session:null,redirectType:null},error:u};throw u}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:u,nonce:c}=e,f=await ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:u,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Zt}),{data:v,error:m}=f;return m?{data:{user:null,session:null},error:m}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new yi}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:m})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,u,c;try{if("email"in e){const{email:f,options:v}=e;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await Zn(this.storage,this.storageKey));const{error:E}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(r=v?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:m,code_challenge_method:y},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in e){const{phone:f,options:v}=e,{data:m,error:y}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=v?.data)!==null&&o!==void 0?o:{},create_user:(u=v?.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(c=v?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:m?.message_id},error:y}}throw new wi("You must provide either an email or phone number.")}catch(f){if(ue(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(e){var t,r;try{let o,u;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,u=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:f}=await ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:u}}),redirectTo:o,xform:Zt});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const v=c.session,m=c.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:m,session:v},error:null}}catch(o){if(ue(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let u=null,c=null;return this.flowType==="pkce"&&([u,c]=await Zn(this.storage,this.storageKey)),await ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:c}),headers:this.headers,xform:cd})}catch(u){if(ue(u))return{data:null,error:u};throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new gn;const{error:o}=await ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(ue(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:u}=e,{error:c}=await ve(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:o,options:u}=e,{data:c,error:f}=await ve(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:f}}throw new wi("You must provide either an email or phone number and a type")}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await On(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ls:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await On(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=ds()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,m,y)=>(!c&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,m,y))})}return{data:{session:e},error:null}}const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?{data:{session:null},error:u}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:mn}):await this._useSession(async t=>{var r,o,u;const{data:c,error:f}=t;if(f)throw f;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gn}:await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&u!==void 0?u:void 0,xform:mn})})}catch(t){if(ue(t))return Fh(t)&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:u}=r;if(u)throw u;if(!o.session)throw new gn;const c=o.session;let f=null,v=null;this.flowType==="pkce"&&e.email!=null&&([f,v]=await Zn(this.storage,this.storageKey));const{data:m,error:y}=await ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:v}),jwt:c.access_token,xform:mn});if(y)throw y;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(ue(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gn;const t=Date.now()/1e3;let r=t,o=!0,u=null;const{payload:c}=hs(e.access_token);if(c.exp&&(r=c.exp,o=r<=t),o){const{session:f,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!f)return{data:{user:null,session:null},error:null};u=f}else{const{data:f,error:v}=await this._getUser(e.access_token);if(v)throw v;u={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return{data:{user:u.user,session:u},error:null}}catch(t){if(ue(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:f}=t;if(f)throw f;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new gn;const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?{data:{user:null,session:null},error:u}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ue(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!xt())throw new bi("No browser detected.");if(e.error||e.error_description||e.error_code)throw new bi(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new wa("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new bi("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wa("No code detected.");const{data:B,error:U}=await this._exchangeCodeForSession(e.code);if(U)throw U;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:B.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:u,refresh_token:c,expires_in:f,expires_at:v,token_type:m}=e;if(!u||!f||!c||!m)throw new bi("No session defined in URL");const y=Math.round(Date.now()/1e3),E=parseInt(f);let A=y+E;v&&(A=parseInt(v));const g=A-y;g*1e3<=rr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${E}s`);const S=A-E;y-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,A,y):y-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,A,y);const{data:O,error:M}=await this._getUser(u);if(M)throw M;const H={provider_token:r,provider_refresh_token:o,access_token:u,expires_in:E,expires_at:A,refresh_token:c,token_type:m,user:O.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:H,redirectType:e.type},error:null}}catch(r){if(ue(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await On(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:u}=t;if(u)return{error:u};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:f}=await this.admin.signOut(c,e);if(f&&!(Lh(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return e!=="others"&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=zh(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:u},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",e,"session",u)}catch(u){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",u),console.error(u)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Zn(this.storage,this.storageKey,!0));try{return await ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(u){if(ue(u))return{data:null,error:u};throw u}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async u=>{var c,f,v,m,y;const{data:E,error:A}=u;if(A)throw A;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await ve(this.fetch,"GET",g,{headers:this.headers,jwt:(y=(m=E.session)===null||m===void 0?void 0:m.access_token)!==null&&y!==void 0?y:void 0})});if(o)throw o;return xt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(ue(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:u,error:c}=t;if(c)throw c;return await ve(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=u.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Jh(async o=>(o>0&&await Yh(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zt})),(o,u)=>{const c=200*Math.pow(2,o);return u&&cs(u)&&Date.now()+c-r<rr})}catch(r){if(this._debug(t,"error",r),ue(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),xt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await On(this.storage,this.storageKey);if(o&&this.userStorage){let c=await On(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await ir(this.userStorage,this.storageKey+"-user",c)),o.user=(e=c?.user)!==null&&e!==void 0?e:ds()}else if(o&&!o.user&&!o.user){const c=await On(this.storage,this.storageKey+"-user");c&&c?.user?(o.user=c.user,await pn(this.storage,this.storageKey+"-user"),await ir(this.storage,this.storageKey,o)):o.user=ds()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const u=((t=o.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ls;if(this._debug(r,`session has${u?"":" not"} expired with margin of ${ls}s`),u){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),cs(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(o.access_token);!f&&c?.user?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new gn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new $i;const{data:u,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!u.session)throw new gn;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const f={session:u.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(u){if(this._debug(o,"error",u),ue(u)){const c={session:null,error:u};return cs(u)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(u),u}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const u=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(v){u.push(v)}});if(await Promise.all(c),u.length>0){for(let f=0;f<u.length;f+=1)console.error(u[f]);throw u[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await ir(this.userStorage,this.storageKey+"-user",{user:t.user});const o=Object.assign({},t);delete o.user;const u=Sa(o);await ir(this.storage,this.storageKey,u)}else{const o=Sa(t);await ir(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await pn(this.storage,this.storageKey),await pn(this.storage,this.storageKey+"-code-verifier"),await pn(this.storage,this.storageKey+"-user"),this.userStorage&&await pn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/rr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${rr}ms, refresh threshold is ${Ss} ticks`),o<=Ss&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Iu)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[u,c]=await Zn(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(f.toString())}if(r?.queryParams){const u=new URLSearchParams(r.queryParams);o.push(u.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;return u?{data:null,error:u}:await ve(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:u,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:m}=await ve(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(r=u?.session)===null||r===void 0?void 0:r.access_token});return m?{data:null,error:m}:(e.factorType==="totp"&&(!((o=v?.totp)===null||o===void 0)&&o.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(ue(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;if(u)return{data:null,error:u};const{data:c,error:f}=await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(ue(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:u}=t;return u?{data:null,error:u}:await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ue(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),u=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:u},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:u}=e;if(u)return{data:null,error:u};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=hs(o.access_token);let f=null;c.aal&&(f=c.aal);let v=f;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(E=>E.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const y=c.amr||[];return{data:{currentLevel:f,nextLevel:v,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(f=>f.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(f=>f.kid===e),r&&this.jwks_cached_at+xh>o)return r;const{data:u,error:c}=await ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=o,r=u.keys.find(f=>f.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:g,error:S}=await this.getSession();if(S||!g.session)return{data:null,error:S};r=g.session.access_token}const{header:o,payload:u,signature:c,raw:{header:f,payload:v}}=hs(r);t?.allowExpired||rd(u.exp);const m=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!m){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:u,header:o,signature:c},error:null}}const y=id(o.alg),E=await crypto.subtle.importKey("jwk",m,y,!0,["verify"]);if(!await crypto.subtle.verify(y,E,c,Vh(`${f}.${v}`)))throw new Ps("Invalid JWT signature");return{data:{claims:u,header:o,signature:c},error:null}}catch(r){if(ue(r))return{data:null,error:r};throw r}}}Nr.nextInstanceID=0;const wd=Nr;class bd extends wd{constructor(e){super(e)}}var Ed=function(n,e,t,r){function o(u){return u instanceof t?u:new t(function(c){c(u)})}return new(t||(t=Promise))(function(u,c){function f(y){try{m(r.next(y))}catch(E){c(E)}}function v(y){try{m(r.throw(y))}catch(E){c(E)}}function m(y){y.done?u(y.value):o(y.value).then(f,v)}m((r=r.apply(n,e||[])).next())})};class Ad{constructor(e,t,r){var o,u,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=Th(e),v=new URL(f);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const m=`sb-${v.hostname.split(".")[0]}-auth-token`,y={db:yh,realtime:bh,auth:Object.assign(Object.assign({},wh),{storageKey:m}),global:_h},E=Ph(r??{},y);this.storageKey=(o=E.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(u=E.global.headers)!==null&&u!==void 0?u:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(A,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=E.auth)!==null&&c!==void 0?c:{},this.headers,E.global.fetch),this.fetch=Sh(t,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new $c(new URL("rest/v1",v).href,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),this.storage=new ph(this.storageUrl.href,this.headers,this.fetch,r?.storage),E.accessToken||this._listenForAuthEvents()}get functions(){return new Tc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ed(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:u,flowType:c,lock:f,debug:v},m,y){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bd({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),m),storageKey:u,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:c,lock:f,debug:v,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new nh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const kd=(n,e,t)=>new Ad(n,e,t);function Sd(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Sd()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Cd="https://vycjpmuyscfygstjjied.supabase.co",Td="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",ar=kd(Cd,Td,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}});function Pd(){if(window.Telegram?.WebApp){const n=window.Telegram.WebApp;return n.expand(),n.enableClosingConfirmation(),n.ready(),n}return null}function Id(n){return n?.initDataUnsafe?.user||null}var Ai={exports:{}},Rd=Ai.exports,Ra;function Od(){return Ra||(Ra=1,(function(n,e){(function(r,o){n.exports=o()})(Rd,()=>(()=>{var t=[,((c,f,v)=>{v.r(f),v.d(f,{default:()=>y});var m=(()=>{var E=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(A={}){var g=A,S,O;g.ready=new Promise((i,s)=>{S=i,O=s});function M(){function i(k){const I=d;l=s=0,d=new Map,I.forEach(R=>{try{R(k)}catch(P){console.error(P)}}),this.pb(),_&&_.Tb()}let s=0,l=0,d=new Map,_=null,b=null;this.requestAnimationFrame=function(k){s||(s=requestAnimationFrame(i.bind(this)));const I=++l;return d.set(I,k),I},this.cancelAnimationFrame=function(k){d.delete(k),s&&d.size==0&&(cancelAnimationFrame(s),s=0)},this.Rb=function(k){b&&(document.body.remove(b),b=null),k||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",k=function(I){b.innerHTML="RIVE FPS "+I.toFixed(1)},document.body.appendChild(b)),_=new function(){let I=0,R=0;this.Tb=function(){var P=performance.now();R?(++I,P-=R,1e3<P&&(k(1e3*I/P),I=R=0)):(R=P,I=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),_=null},this.pb=function(){}}function H(i){console.assert(!0);const s=new Map;let l=-1/0;this.push=function(d){return d=d+((1<<i)-1)>>i,s.has(d)&&clearTimeout(s.get(d)),s.set(d,setTimeout(function(){s.delete(d),s.length==0?l=-1/0:d==l&&(l=Math.max(...s.keys()),console.assert(l<d))},1e3)),l=Math.max(d,l),l<<i}}const B=g.onRuntimeInitialized;g.onRuntimeInitialized=function(){B&&B();let i=g.decodeAudio;g.decodeAudio=function(_,b){_=i(_),b(_)};let s=g.decodeFont;g.decodeFont=function(_,b){_=s(_),b(_)};const l=g.FileAssetLoader;g.ptrToAsset=_=>{let b=g.ptrToFileAsset(_);return b.isImage?g.ptrToImageAsset(_):b.isFont?g.ptrToFontAsset(_):b.isAudio?g.ptrToAudioAsset(_):b},g.CustomFileAssetLoader=l.extend("CustomFileAssetLoader",{__construct:function({loadContents:_}){this.__parent.__construct.call(this),this.Gb=_},loadContents:function(_,b){return _=g.ptrToAsset(_),this.Gb(_,b)}}),g.CDNFileAssetLoader=l.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(_){let b=g.ptrToAsset(_);return _=b.cdnUuid,_===""?!1:((function(k,I){var R=new XMLHttpRequest;R.responseType="arraybuffer",R.onreadystatechange=function(){R.readyState==4&&R.status==200&&I(R)},R.open("GET",k,!0),R.send(null)})(b.cdnBaseUrl+"/"+_,k=>{b.decode(new Uint8Array(k.response))}),!0)}}),g.FallbackFileAssetLoader=l.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(_){this.lb.push(_)},loadContents:function(_,b){for(let k of this.lb)if(k.loadContents(_,b))return!0;return!1}});let d=g.computeAlignment;g.computeAlignment=function(_,b,k,I,R=1){return d.call(this,_,b,k,I,R)}};const U="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),L=new function(){function i(){if(!s){let ce=function(de,G,Le){if(G=N.createShader(G),N.shaderSource(G,Le),N.compileShader(G),Le=N.getShaderInfoLog(G),0<(Le||"").length)throw Le;N.attachShader(de,G)};var C=document.createElement("canvas"),W={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let N;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(N=C.getContext("webgl",W),l=1,!N)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(N=C.getContext("webgl2",W))l=2;else if(N=C.getContext("webgl",W))l=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(N=new Proxy(N,{get(de,G){if(de.isContextLost()){if(R||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",G),R=!0),typeof de[G]=="function")return function(){}}else return typeof de[G]=="function"?function(...Le){return de[G].apply(de,Le)}:de[G]},set(de,G,Le){if(de.isContextLost())R||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+G),R=!0);else return de[G]=Le,!0}}),d=Math.min(N.getParameter(N.MAX_RENDERBUFFER_SIZE),N.getParameter(N.MAX_TEXTURE_SIZE)),C=N.createProgram(),ce(C,N.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),ce(C,N.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),N.bindAttribLocation(C,0,"vertex"),N.bindAttribLocation(C,1,"uv"),N.linkProgram(C),W=N.getProgramInfoLog(C),0<(W||"").trim().length)throw W;_=N.getUniformLocation(C,"mat"),b=N.getUniformLocation(C,"translate"),N.useProgram(C),N.bindBuffer(N.ARRAY_BUFFER,N.createBuffer()),N.enableVertexAttribArray(0),N.enableVertexAttribArray(1),N.bindBuffer(N.ELEMENT_ARRAY_BUFFER,N.createBuffer()),N.uniform1i(N.getUniformLocation(C,"image"),0),N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s=N}return!0}let s=null,l=0,d=0,_=null,b=null,k=0,I=0,R=!1;i(),this.hc=function(){return i(),d},this.Mb=function(C){s.deleteTexture&&s.deleteTexture(C)},this.Lb=function(C){if(!i())return null;const W=s.createTexture();return W?(s.bindTexture(s.TEXTURE_2D,W),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,C),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),l==2?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.generateMipmap(s.TEXTURE_2D)):s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),W):null};const P=new H(8),V=new H(8),q=new H(10),J=new H(10);this.Qb=function(C,W,N,ce,de){if(i()){var G=P.push(C),Le=V.push(W);if(s.canvas){(s.canvas.width!=G||s.canvas.height!=Le)&&(s.canvas.width=G,s.canvas.height=Le),s.viewport(0,Le-W,C,W),s.disable(s.SCISSOR_TEST),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.SCISSOR_TEST),N.sort((we,Nt)=>Nt.xb-we.xb),G=q.push(ce),k!=G&&(s.bufferData(s.ARRAY_BUFFER,8*G,s.DYNAMIC_DRAW),k=G),G=0;for(var Ze of N)s.bufferSubData(s.ARRAY_BUFFER,G,Ze.Ua),G+=4*Ze.Ua.length;console.assert(G==4*ce);for(var $t of N)s.bufferSubData(s.ARRAY_BUFFER,G,$t.Db),G+=4*$t.Db.length;console.assert(G==8*ce),G=J.push(de),I!=G&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,2*G,s.DYNAMIC_DRAW),I=G),Ze=0;for(var Tn of N)s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,Ze,Tn.indices),Ze+=2*Tn.indices.length;console.assert(Ze==2*de),Tn=0,$t=!0,G=Ze=0;for(const we of N){we.image.Ka!=Tn&&(s.bindTexture(s.TEXTURE_2D,we.image.Ja||null),Tn=we.image.Ka),we.mc?(s.scissor(we.Za,Le-we.$a-we.kb,we.Ac,we.kb),$t=!0):$t&&(s.scissor(0,Le-W,C,W),$t=!1),N=2/C;const Nt=-2/W;s.uniform4f(_,we.ha[0]*N*we.Ba,we.ha[1]*Nt*we.Ca,we.ha[2]*N*we.Ba,we.ha[3]*Nt*we.Ca),s.uniform2f(b,we.ha[4]*N*we.Ba+N*(we.Za-we.ic*we.Ba)-1,we.ha[5]*Nt*we.Ca+Nt*(we.$a-we.jc*we.Ca)+1),s.vertexAttribPointer(0,2,s.FLOAT,!1,0,G),s.vertexAttribPointer(1,2,s.FLOAT,!1,0,G+4*ce),s.drawElements(s.TRIANGLES,we.indices.length,s.UNSIGNED_SHORT,Ze),G+=4*we.Ua.length,Ze+=2*we.indices.length}console.assert(G==4*ce),console.assert(Ze==2*de)}}},this.canvas=function(){return i()&&s.canvas}},z=g.onRuntimeInitialized;g.onRuntimeInitialized=function(){function i(D){switch(D){case P.srcOver:return"source-over";case P.screen:return"screen";case P.overlay:return"overlay";case P.darken:return"darken";case P.lighten:return"lighten";case P.colorDodge:return"color-dodge";case P.colorBurn:return"color-burn";case P.hardLight:return"hard-light";case P.softLight:return"soft-light";case P.difference:return"difference";case P.exclusion:return"exclusion";case P.multiply:return"multiply";case P.hue:return"hue";case P.saturation:return"saturation";case P.color:return"color";case P.luminosity:return"luminosity"}}function s(D){return"rgba("+((16711680&D)>>>16)+","+((65280&D)>>>8)+","+((255&D)>>>0)+","+((4278190080&D)>>>24)/255+")"}function l(){0<Le.length&&(L.Qb(G.drawWidth(),G.drawHeight(),Le,Ze,$t),Le=[],$t=Ze=0,G.reset(512,512));for(const D of de){for(const K of D.H)K();D.H=[]}de.clear()}z&&z();var d=g.RenderPaintStyle;const _=g.RenderPath,b=g.RenderPaint,k=g.Renderer,I=g.StrokeCap,R=g.StrokeJoin,P=g.BlendMode,V=d.fill,q=d.stroke,J=g.FillRule.evenOdd;let C=1;var W=g.RenderImage.extend("CanvasRenderImage",{__construct:function({la:D,xa:K}={}){this.__parent.__construct.call(this),this.Ka=C,C=C+1&2147483647||1,this.la=D,this.xa=K},__destruct:function(){this.Ja&&(L.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(D){var K=this;K.xa&&K.xa(K);var pe=new Image;K.Xa=URL.createObjectURL(new Blob([D],{type:"image/png"})),pe.onload=function(){K.Fb=pe,K.Ja=L.Lb(pe),K.size(pe.width,pe.height),K.la&&K.la(K)},pe.src=K.Xa}}),N=_.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(D,K,pe,be,he,_e,Re){var Oe=this.T,jt=Oe.addPath;D=D.T;const Ge=new DOMMatrix;Ge.a=K,Ge.b=pe,Ge.c=be,Ge.d=he,Ge.e=_e,Ge.f=Re,jt.call(Oe,D,Ge)},fillRule:function(D){this.Wa=D},moveTo:function(D,K){this.T.moveTo(D,K)},lineTo:function(D,K){this.T.lineTo(D,K)},cubicTo:function(D,K,pe,be,he,_e){this.T.bezierCurveTo(D,K,pe,be,he,_e)},close:function(){this.T.closePath()}}),ce=b.extend("CanvasRenderPaint",{color:function(D){this.Ya=s(D)},thickness:function(D){this.Ib=D},join:function(D){switch(D){case R.miter:this.Ia="miter";break;case R.round:this.Ia="round";break;case R.bevel:this.Ia="bevel"}},cap:function(D){switch(D){case I.butt:this.Ha="butt";break;case I.round:this.Ha="round";break;case I.square:this.Ha="square"}},style:function(D){this.Hb=D},blendMode:function(D){this.Eb=i(D)},clearGradient:function(){this.ja=null},linearGradient:function(D,K,pe,be){this.ja={zb:D,Ab:K,cb:pe,eb:be,Ra:[]}},radialGradient:function(D,K,pe,be){this.ja={zb:D,Ab:K,cb:pe,eb:be,Ra:[],ec:!0}},addStop:function(D,K){this.ja.Ra.push({color:D,stop:K})},completeGradient:function(){},draw:function(D,K,pe){let be=this.Hb;var he=this.Ya,_e=this.ja;if(D.globalCompositeOperation=this.Eb,_e!=null){he=_e.zb;var Re=_e.Ab;const jt=_e.cb;var Oe=_e.eb;const Ge=_e.Ra;_e.ec?(_e=jt-he,Oe-=Re,he=D.createRadialGradient(he,Re,0,he,Re,Math.sqrt(_e*_e+Oe*Oe))):he=D.createLinearGradient(he,Re,jt,Oe);for(let yt=0,Ke=Ge.length;yt<Ke;yt++)Re=Ge[yt],he.addColorStop(Re.stop,s(Re.color));this.Ya=he,this.ja=null}switch(be){case q:D.strokeStyle=he,D.lineWidth=this.Ib,D.lineCap=this.Ha,D.lineJoin=this.Ia,D.stroke(K);break;case V:D.fillStyle=he,D.fill(K,pe)}}});const de=new Set;let G=null,Le=[],Ze=0,$t=0;var Tn=g.CanvasRenderer=k.extend("Renderer",{__construct:function(D){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=D.getContext("2d"),this.Va=D,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const D=this.S.length-6;if(6>D)throw"restore() called without matching save().";this.S.splice(D),this.H.push(this.C.restore.bind(this.C))},transform:function(D,K,pe,be,he,_e){const Re=this.S,Oe=Re.length-6;Re.splice(Oe,6,Re[Oe]*D+Re[Oe+2]*K,Re[Oe+1]*D+Re[Oe+3]*K,Re[Oe]*pe+Re[Oe+2]*be,Re[Oe+1]*pe+Re[Oe+3]*be,Re[Oe]*he+Re[Oe+2]*_e+Re[Oe+4],Re[Oe+1]*he+Re[Oe+3]*_e+Re[Oe+5]),this.H.push(this.C.transform.bind(this.C,D,K,pe,be,he,_e))},rotate:function(D){const K=Math.sin(D);D=Math.cos(D),this.transform(D,K,-K,D,0,0)},_drawPath:function(D,K){this.H.push(K.draw.bind(K,this.C,D.T,D.Wa===J?"evenodd":"nonzero"))},_drawRiveImage:function(D,K,pe,be){var he=D.Fb;if(he){var _e=this.C,Re=i(pe);this.H.push(function(){_e.globalCompositeOperation=Re,_e.globalAlpha=be,_e.drawImage(he,0,0),_e.globalAlpha=1})}},_getMatrix:function(D){const K=this.S,pe=K.length-6;for(let be=0;6>be;++be)D[be]=K[pe+be]},_drawImageMesh:function(D,K,pe,be,he,_e,Re,Oe,jt,Ge,yt){K=this.C.canvas.width;var Ke=this.C.canvas.height;const Do=Ge-Oe,$o=yt-jt;Oe=Math.max(Oe,0),jt=Math.max(jt,0),Ge=Math.min(Ge,K),yt=Math.min(yt,Ke);const Tr=Ge-Oe,Pr=yt-jt;if(console.assert(Tr<=Math.min(Do,K)),console.assert(Pr<=Math.min($o,Ke)),!(0>=Tr||0>=Pr)){Ge=Tr<Do||Pr<$o,K=yt=1;var Pn=Math.ceil(Tr*yt),In=Math.ceil(Pr*K);Ke=L.hc(),Pn>Ke&&(yt*=Ke/Pn,Pn=Ke),In>Ke&&(K*=Ke/In,In=Ke),G||(G=new g.DynamicRectanizer(Ke),G.reset(512,512)),Ke=G.addRect(Pn,In),0>Ke&&(l(),de.add(this),Ke=G.addRect(Pn,In),console.assert(0<=Ke));var No=Ke&65535,Bo=Ke>>16;Le.push({ha:this.S.slice(this.S.length-6),image:D,Za:No,$a:Bo,ic:Oe,jc:jt,Ac:Pn,kb:In,Ba:yt,Ca:K,Ua:new Float32Array(he),Db:new Float32Array(_e),indices:new Uint16Array(Re),mc:Ge,xb:D.Ka<<1|(Ge?1:0)}),Ze+=he.length,$t+=Re.length;var Hn=this.C,tl=i(pe);this.H.push(function(){Hn.save(),Hn.resetTransform(),Hn.globalCompositeOperation=tl,Hn.globalAlpha=be;const Wo=L.canvas();Wo&&Hn.drawImage(Wo,No,Bo,Pn,In,Oe,jt,Tr,Pr),Hn.restore()})}},_clipPath:function(D){this.H.push(this.C.clip.bind(this.C,D.T,D.Wa===J?"evenodd":"nonzero"))},clear:function(){de.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(D,K){this.transform(1,0,0,1,D,K)}});g.makeRenderer=function(D){const K=new Tn(D),pe=K.C;return new Proxy(K,{get(be,he){if(typeof be[he]=="function")return function(..._e){return be[he].apply(be,_e)};if(typeof pe[he]=="function"){if(-1<U.indexOf(he))throw Error("RiveException: Method call to '"+he+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(..._e){K.H.push(pe[he].bind(pe,..._e))}}return be[he]},set(be,he,_e){if(he in pe)return K.H.push(()=>{pe[he]=_e}),!0}})},g.decodeImage=function(D,K){new W({la:K}).decode(D)},g.renderFactory={makeRenderPaint:function(){return new ce},makeRenderPath:function(){return new N},makeRenderImage:function(){let D=Nt;return new W({xa:()=>{D.total++},la:()=>{if(D.loaded++,D.loaded===D.total){const K=D.ready;K&&(K(),D.ready=null)}}})}};let we=g.load,Nt=null;g.load=function(D,K,pe=!0){const be=new g.FallbackFileAssetLoader;return K!==void 0&&be.addLoader(K),pe&&(K=new g.CDNFileAssetLoader,be.addLoader(K)),new Promise(function(he){let _e=null;Nt={total:0,loaded:0,ready:function(){he(_e)}},_e=we(D,be),Nt.total==0&&he(_e)})};let el=g.RendererWrapper.prototype.align;g.RendererWrapper.prototype.align=function(D,K,pe,be,he=1){el.call(this,D,K,pe,be,he)},d=new M,g.requestAnimationFrame=d.requestAnimationFrame.bind(d),g.cancelAnimationFrame=d.cancelAnimationFrame.bind(d),g.enableFPSCounter=d.Rb.bind(d),g.disableFPSCounter=d.Ob,d.pb=l,g.resolveAnimationFrame=l,g.cleanup=function(){G&&G.delete()}};var x=Object.assign({},g),F="./this.program",ee=typeof window=="object",X=typeof importScripts=="function",se="",Y,ae;(ee||X)&&(X?se=self.location.href:typeof document<"u"&&document.currentScript&&(se=document.currentScript.src),E&&(se=E),se.indexOf("blob:")!==0?se=se.substr(0,se.replace(/[?#].*/,"").lastIndexOf("/")+1):se="",X&&(ae=i=>{var s=new XMLHttpRequest;return s.open("GET",i,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),Y=(i,s,l)=>{var d=new XMLHttpRequest;d.open("GET",i,!0),d.responseType="arraybuffer",d.onload=()=>{d.status==200||d.status==0&&d.response?s(d.response):l()},d.onerror=l,d.send(null)});var Ee=g.print||console.log.bind(console),je=g.printErr||console.error.bind(console);Object.assign(g,x),x=null,g.thisProgram&&(F=g.thisProgram);var Ne;g.wasmBinary&&(Ne=g.wasmBinary),g.noExitRuntime,typeof WebAssembly!="object"&&un("no native wasm support detected");var kt,ge,on=!1,Ce,ye,Qe,St,me,Te,Ct,xe;function ht(){var i=kt.buffer;g.HEAP8=Ce=new Int8Array(i),g.HEAP16=Qe=new Int16Array(i),g.HEAP32=me=new Int32Array(i),g.HEAPU8=ye=new Uint8Array(i),g.HEAPU16=St=new Uint16Array(i),g.HEAPU32=Te=new Uint32Array(i),g.HEAPF32=Ct=new Float32Array(i),g.HEAPF64=xe=new Float64Array(i)}var Be,Ht=[],an=[],zt=[];function An(){var i=g.preRun.shift();Ht.unshift(i)}var st=0,Tt=null;function un(i){throw g.onAbort&&g.onAbort(i),i="Aborted("+i+")",je(i),on=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),O(i),i}function mr(i){return i.startsWith("data:application/octet-stream;base64,")}var Gt;if(Gt="canvas_advanced.wasm",!mr(Gt)){var Gr=Gt;Gt=g.locateFile?g.locateFile(Gr,se):se+Gr}function dt(i){if(i==Gt&&Ne)return new Uint8Array(Ne);if(ae)return ae(i);throw"both async and sync fetching of the wasm failed"}function Ni(i){if(!Ne&&(ee||X)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(s=>{if(!s.ok)throw"failed to load wasm binary file at '"+i+"'";return s.arrayBuffer()}).catch(()=>dt(i));if(Y)return new Promise((s,l)=>{Y(i,d=>s(new Uint8Array(d)),l)})}return Promise.resolve().then(()=>dt(i))}function Kr(i,s,l){return Ni(i).then(d=>WebAssembly.instantiate(d,s)).then(d=>d).then(l,d=>{je("failed to asynchronously prepare wasm: "+d),un(d)})}function Bi(i,s){var l=Gt;return Ne||typeof WebAssembly.instantiateStreaming!="function"||mr(l)||l.startsWith("file://")||typeof fetch!="function"?Kr(l,i,s):fetch(l,{credentials:"same-origin"}).then(d=>WebAssembly.instantiateStreaming(d,i).then(s,function(_){return je("wasm streaming compile failed: "+_),je("falling back to ArrayBuffer instantiation"),Kr(l,i,s)}))}var ln,p,a={460492:(i,s,l,d,_)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=s,window.h.I.La=l,window.h.ga={},window.h.ga.stopped=d,window.h.ga.yb=_;let b=window.h;b.D=[],b.yc=function(k){for(var I=0;I<b.D.length;++I)if(b.D[I]==null)return b.D[I]=k,I;return b.D.push(k),b.D.length-1},b.Cb=function(k){for(b.D[k]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(k){for(var I=0;I<b.D.length;++I)if(b.D[I]==k)return b.Cb(I)},b.ra=function(k){return b.D[k]},b.Ta=["touchend","click"],b.unlock=function(){for(var k=0;k<b.D.length;++k){var I=b.D[k];I!=null&&I.J!=null&&I.state===b.ga.yb&&I.J.resume().then(()=>{xo(I.qb)},R=>{console.error("Failed to resume audiocontext",R)})}b.Ta.map(function(R){document.removeEventListener(R,b.unlock,!0)})},b.Ta.map(function(k){document.addEventListener(k,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),s=i.sampleRate;return i.close(),s}catch{return 0}},463249:(i,s,l,d,_,b)=>{if(typeof window.h>"u")return-1;var k={},I={};return i==window.h.I.ya&&l!=0&&(I.sampleRate=l),k.J=new(window.AudioContext||window.webkitAudioContext)(I),k.J.suspend(),k.state=window.h.ga.stopped,l=0,i!=window.h.I.ya&&(l=s),k.Z=k.J.createScriptProcessor(d,l,s),k.Z.onaudioprocess=function(R){if((k.sa==null||k.sa.length==0)&&(k.sa=new Float32Array(Ct.buffer,_,d*s)),i==window.h.I.capture||i==window.h.I.La){for(var P=0;P<s;P+=1)for(var V=R.inputBuffer.getChannelData(P),q=k.sa,J=0;J<d;J+=1)q[J*s+P]=V[J];Mo(b,d,_)}if(i==window.h.I.ya||i==window.h.I.La)for(Lo(b,d,_),P=0;P<R.outputBuffer.numberOfChannels;++P)for(V=R.outputBuffer.getChannelData(P),q=k.sa,J=0;J<d;J+=1)V[J]=q[J*s+P];else for(P=0;P<R.outputBuffer.numberOfChannels;++P)R.outputBuffer.getChannelData(P).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(R){k.Da=k.J.createMediaStreamSource(R),k.Da.connect(k.Z),k.Z.connect(k.J.destination)}).catch(function(R){console.log("Failed to get user media: "+R)}),i==window.h.I.ya&&k.Z.connect(k.J.destination),k.qb=b,window.h.yc(k)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},h=i=>{for(;0<i.length;)i.shift()(g)},w=(i,s)=>{for(var l=0,d=i.length-1;0<=d;d--){var _=i[d];_==="."?i.splice(d,1):_===".."?(i.splice(d,1),l++):l&&(i.splice(d,1),l--)}if(s)for(;l;l--)i.unshift("..");return i},T=i=>{var s=i.charAt(0)==="/",l=i.substr(-1)==="/";return(i=w(i.split("/").filter(d=>!!d),!s).join("/"))||s||(i="."),i&&l&&(i+="/"),(s?"/":"")+i},j=i=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=s[0],s=s[1],!i&&!s?".":(s&&(s=s.substr(0,s.length-1)),i+s)},$=i=>{if(i==="/")return"/";i=T(i),i=i.replace(/\/$/,"");var s=i.lastIndexOf("/");return s===-1?i:i.substr(s+1)},ne=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);un("initRandomDevice")},oe=i=>(oe=ne())(i);function Z(){for(var i="",s=!1,l=arguments.length-1;-1<=l&&!s;l--){if(s=0<=l?arguments[l]:"/",typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";i=s+"/"+i,s=s.charAt(0)==="/"}return i=w(i.split("/").filter(d=>!!d),!s).join("/"),(s?"/":"")+i||"."}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ie=(i,s,l)=>{var d=s+l;for(l=s;i[l]&&!(l>=d);)++l;if(16<l-s&&i.buffer&&fe)return fe.decode(i.subarray(s,l));for(d="";s<l;){var _=i[s++];if(_&128){var b=i[s++]&63;if((_&224)==192)d+=String.fromCharCode((_&31)<<6|b);else{var k=i[s++]&63;_=(_&240)==224?(_&15)<<12|b<<6|k:(_&7)<<18|b<<12|k<<6|i[s++]&63,65536>_?d+=String.fromCharCode(_):(_-=65536,d+=String.fromCharCode(55296|_>>10,56320|_&1023))}}else d+=String.fromCharCode(_)}return d},ze=[],Ue=i=>{for(var s=0,l=0;l<i.length;++l){var d=i.charCodeAt(l);127>=d?s++:2047>=d?s+=2:55296<=d&&57343>=d?(s+=4,++l):s+=3}return s},Pt=(i,s,l,d)=>{if(!(0<d))return 0;var _=l;d=l+d-1;for(var b=0;b<i.length;++b){var k=i.charCodeAt(b);if(55296<=k&&57343>=k){var I=i.charCodeAt(++b);k=65536+((k&1023)<<10)|I&1023}if(127>=k){if(l>=d)break;s[l++]=k}else{if(2047>=k){if(l+1>=d)break;s[l++]=192|k>>6}else{if(65535>=k){if(l+2>=d)break;s[l++]=224|k>>12}else{if(l+3>=d)break;s[l++]=240|k>>18,s[l++]=128|k>>12&63}s[l++]=128|k>>6&63}s[l++]=128|k&63}}return s[l]=0,l-_};function gt(i,s){var l=Array(Ue(i)+1);return i=Pt(i,l,0,l.length),s&&(l.length=i),l}var ot=[];function at(i,s){ot[i]={input:[],F:[],V:s},Vi(i,mt)}var mt={open:function(i){var s=ot[i.node.za];if(!s)throw new Q(43);i.s=s,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,s,l,d){if(!i.s||!i.s.V.jb)throw new Q(60);for(var _=0,b=0;b<d;b++){try{var k=i.s.V.jb(i.s)}catch{throw new Q(29)}if(k===void 0&&_===0)throw new Q(6);if(k==null)break;_++,s[l+b]=k}return _&&(i.node.timestamp=Date.now()),_},write:function(i,s,l,d){if(!i.s||!i.s.V.Oa)throw new Q(60);try{for(var _=0;_<d;_++)i.s.V.Oa(i.s,s[l+_])}catch{throw new Q(29)}return d&&(i.node.timestamp=Date.now()),_}},cn={jb:function(){e:{if(!ze.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}ze=gt(i,!0)}i=ze.shift()}return i},Oa:function(i,s){s===null||s===10?(Ee(Ie(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Ee(Ie(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},hn={Oa:function(i,s){s===null||s===10?(je(Ie(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(je(Ie(i.F,0)),i.F=[])}};function Ft(i,s){var l=i.j?i.j.length:0;l>=s||(s=Math.max(s,l*(1048576>l?2:1.125)>>>0),l!=0&&(s=Math.max(s,256)),l=i.j,i.j=new Uint8Array(s),0<i.v&&i.j.set(l.subarray(0,i.v),0))}var ie={O:null,U(){return ie.createNode(null,"/",16895,0)},createNode(i,s,l,d){if((l&61440)===24576||(l&61440)===4096)throw new Q(63);return ie.O||(ie.O={dir:{node:{Y:ie.l.Y,P:ie.l.P,ka:ie.l.ka,va:ie.l.va,vb:ie.l.vb,Bb:ie.l.Bb,wb:ie.l.wb,tb:ie.l.tb,Ea:ie.l.Ea},stream:{ba:ie.m.ba}},file:{node:{Y:ie.l.Y,P:ie.l.P},stream:{ba:ie.m.ba,read:ie.m.read,write:ie.m.write,pa:ie.m.pa,mb:ie.m.mb,ob:ie.m.ob}},link:{node:{Y:ie.l.Y,P:ie.l.P,ma:ie.l.ma},stream:{}},ab:{node:{Y:ie.l.Y,P:ie.l.P},stream:ju}}),l=to(i,s,l,d),(l.mode&61440)===16384?(l.l=ie.O.dir.node,l.m=ie.O.dir.stream,l.j={}):(l.mode&61440)===32768?(l.l=ie.O.file.node,l.m=ie.O.file.stream,l.v=0,l.j=null):(l.mode&61440)===40960?(l.l=ie.O.link.node,l.m=ie.O.link.stream):(l.mode&61440)===8192&&(l.l=ie.O.ab.node,l.m=ie.O.ab.stream),l.timestamp=Date.now(),i&&(i.j[s]=l,i.timestamp=l.timestamp),l},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var s={};return s.Jc=(i.mode&61440)===8192?i.id:1,s.Mc=i.id,s.mode=i.mode,s.Oc=1,s.uid=0,s.Lc=0,s.za=i.za,(i.mode&61440)===16384?s.size=4096:(i.mode&61440)===32768?s.size=i.v:(i.mode&61440)===40960?s.size=i.link.length:s.size=0,s.Bc=new Date(i.timestamp),s.Nc=new Date(i.timestamp),s.Ic=new Date(i.timestamp),s.Jb=4096,s.Cc=Math.ceil(s.size/s.Jb),s},P(i,s){if(s.mode!==void 0&&(i.mode=s.mode),s.timestamp!==void 0&&(i.timestamp=s.timestamp),s.size!==void 0&&(s=s.size,i.v!=s))if(s==0)i.j=null,i.v=0;else{var l=i.j;i.j=new Uint8Array(s),l&&i.j.set(l.subarray(0,Math.min(s,i.v))),i.v=s}},ka(){throw Wi[44]},va(i,s,l,d){return ie.createNode(i,s,l,d)},vb(i,s,l){if((i.mode&61440)===16384){try{var d=Jr(s,l)}catch{}if(d)for(var _ in d.j)throw new Q(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=l,s.j[l]=i,s.timestamp=i.parent.timestamp,i.parent=s},Bb(i,s){delete i.j[s],i.timestamp=Date.now()},wb(i,s){var l=Jr(i,s),d;for(d in l.j)throw new Q(55);delete i.j[s],i.timestamp=Date.now()},tb(i){var s=[".",".."],l;for(l in i.j)i.j.hasOwnProperty(l)&&s.push(l);return s},Ea(i,s,l){return i=ie.createNode(i,s,41471,0),i.link=l,i},ma(i){if((i.mode&61440)!==40960)throw new Q(28);return i.link}},m:{read(i,s,l,d,_){var b=i.node.j;if(_>=i.node.v)return 0;if(i=Math.min(i.node.v-_,d),8<i&&b.subarray)s.set(b.subarray(_,_+i),l);else for(d=0;d<i;d++)s[l+d]=b[_+d];return i},write(i,s,l,d,_,b){if(s.buffer===Ce.buffer&&(b=!1),!d)return 0;if(i=i.node,i.timestamp=Date.now(),s.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=s.subarray(l,l+d),i.v=d;if(i.v===0&&_===0)return i.j=s.slice(l,l+d),i.v=d;if(_+d<=i.v)return i.j.set(s.subarray(l,l+d),_),d}if(Ft(i,_+d),i.j.subarray&&s.subarray)i.j.set(s.subarray(l,l+d),_);else for(b=0;b<d;b++)i.j[_+b]=s[l+b];return i.v=Math.max(i.v,_+d),d},ba(i,s,l){if(l===1?s+=i.position:l===2&&(i.node.mode&61440)===32768&&(s+=i.node.v),0>s)throw new Q(28);return s},pa(i,s,l){Ft(i.node,s+l),i.node.v=Math.max(i.node.v,s+l)},mb(i,s,l,d,_){if((i.node.mode&61440)!==32768)throw new Q(43);if(i=i.node.j,_&2||i.buffer!==Ce.buffer){if((0<l||l+s<i.length)&&(i.subarray?i=i.subarray(l,l+s):i=Array.prototype.slice.call(i,l,l+s)),l=!0,un(),s=void 0,!s)throw new Q(48);Ce.set(i,s)}else l=!1,s=i.byteOffset;return{o:s,M:l}},ob(i,s,l,d){return ie.m.write(i,s,0,d,l,!1),0}}};function Ae(i,s){var l=0;return i&&(l|=365),s&&(l|=146),l}var Ut=null,Xs={},Yr=[],Ru=1,_r=null,Qs=!0,Q=null,Wi={},kn=(i,s={})=>{if(i=Z(i),!i)return{path:"",node:null};if(s=Object.assign({hb:!0,Qa:0},s),8<s.Qa)throw new Q(32);i=i.split("/").filter(k=>!!k);for(var l=Ut,d="/",_=0;_<i.length;_++){var b=_===i.length-1;if(b&&s.parent)break;if(l=Jr(l,i[_]),d=T(d+"/"+i[_]),l.wa&&(!b||b&&s.hb)&&(l=l.wa.root),!b||s.gb){for(b=0;(l.mode&61440)===40960;)if(l=xu(d),d=Z(j(d),l),l=kn(d,{Qa:s.Qa+1}).node,40<b++)throw new Q(32)}}return{path:d,node:l}},Zs=i=>{for(var s;;){if(i===i.parent)return i=i.U.nb,s?i[i.length-1]!=="/"?`${i}/${s}`:i+s:i;s=s?`${i.name}/${s}`:i.name,i=i.parent}},eo=(i,s)=>{for(var l=0,d=0;d<s.length;d++)l=(l<<5)-l+s.charCodeAt(d)|0;return(i+l>>>0)%_r.length},Jr=(i,s)=>{var l;if(l=(l=Xr(i,"x"))?l:i.l.ka?0:2)throw new Q(l,i);for(l=_r[eo(i.id,s)];l;l=l.lc){var d=l.name;if(l.parent.id===i.id&&d===s)return l}return i.l.ka(i,s)},to=(i,s,l,d)=>(i=new Io(i,s,l,d),s=eo(i.parent.id,i.name),i.lc=_r[s],_r[s]=i),no=i=>{var s=["r","w","rw"][i&3];return i&512&&(s+="w"),s},Xr=(i,s)=>{if(Qs)return 0;if(!s.includes("r")||i.mode&292){if(s.includes("w")&&!(i.mode&146)||s.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},ro=(i,s)=>{try{return Jr(i,s),20}catch{}return Xr(i,"wx")},Ou=()=>{for(var i=0;4096>=i;i++)if(!Yr[i])return i;throw new Q(33)},dn=i=>{if(i=Yr[i],!i)throw new Q(8);return i},io=(i,s=-1)=>(wr||(wr=function(){this.h={}},wr.prototype={},Object.defineProperties(wr.prototype,{object:{get(){return this.node},set(l){this.node=l}},flags:{get(){return this.h.flags},set(l){this.h.flags=l}},position:{get(){return this.h.position},set(l){this.h.position=l}}})),i=Object.assign(new wr,i),s==-1&&(s=Ou()),i.X=s,Yr[s]=i),ju={open:i=>{i.m=Xs[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new Q(70)}},Vi=(i,s)=>{Xs[i]={m:s}},so=(i,s)=>{var l=s==="/",d=!s;if(l&&Ut)throw new Q(10);if(!l&&!d){var _=kn(s,{hb:!1});if(s=_.path,_=_.node,_.wa)throw new Q(10);if((_.mode&61440)!==16384)throw new Q(54)}s={type:i,Qc:{},nb:s,kc:[]},i=i.U(s),i.U=s,s.root=i,l?Ut=i:_&&(_.wa=s,_.U&&_.U.kc.push(s))},It=(i,s,l)=>{var d=kn(i,{parent:!0}).node;if(i=$(i),!i||i==="."||i==="..")throw new Q(28);var _=ro(d,i);if(_)throw new Q(_);if(!d.l.va)throw new Q(63);return d.l.va(d,i,s,l)},Qr=(i,s,l)=>{typeof l>"u"&&(l=s,s=438),It(i,s|8192,l)},qi=(i,s)=>{if(!Z(i))throw new Q(44);var l=kn(s,{parent:!0}).node;if(!l)throw new Q(44);s=$(s);var d=ro(l,s);if(d)throw new Q(d);if(!l.l.Ea)throw new Q(63);l.l.Ea(l,s,i)},xu=i=>{if(i=kn(i).node,!i)throw new Q(44);if(!i.l.ma)throw new Q(28);return Z(Zs(i.parent),i.l.ma(i))},Zr=(i,s,l)=>{if(i==="")throw new Q(44);if(typeof s=="string"){var d={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[s];if(typeof d>"u")throw Error(`Unknown file open mode: ${s}`);s=d}if(l=s&64?(typeof l>"u"?438:l)&4095|32768:0,typeof i=="object")var _=i;else{i=T(i);try{_=kn(i,{gb:!(s&131072)}).node}catch{}}if(d=!1,s&64)if(_){if(s&128)throw new Q(20)}else _=It(i,l,0),d=!0;if(!_)throw new Q(44);if((_.mode&61440)===8192&&(s&=-513),s&65536&&(_.mode&61440)!==16384)throw new Q(54);if(!d&&(l=_?(_.mode&61440)===40960?32:(_.mode&61440)===16384&&(no(s)!=="r"||s&512)?31:Xr(_,no(s)):44))throw new Q(l);if(s&512&&!d){if(l=_,l=typeof l=="string"?kn(l,{gb:!0}).node:l,!l.l.P)throw new Q(63);if((l.mode&61440)===16384)throw new Q(31);if((l.mode&61440)!==32768)throw new Q(28);if(d=Xr(l,"w"))throw new Q(d);l.l.P(l,{size:0,timestamp:Date.now()})}return s&=-131713,_=io({node:_,path:Zs(_),flags:s,seekable:!0,position:0,m:_.m,zc:[],error:!1}),_.m.open&&_.m.open(_),!g.logReadFiles||s&1||(ei||(ei={}),i in ei||(ei[i]=1)),_},oo=(i,s,l)=>{if(i.X===null)throw new Q(8);if(!i.seekable||!i.m.ba)throw new Q(70);if(l!=0&&l!=1&&l!=2)throw new Q(28);i.position=i.m.ba(i,s,l),i.zc=[]},ao=()=>{Q||(Q=function(i,s){this.name="ErrnoError",this.node=s,this.pc=function(l){this.aa=l},this.pc(i),this.message="FS error"},Q.prototype=Error(),Q.prototype.constructor=Q,[44].forEach(i=>{Wi[i]=new Q(i),Wi[i].stack="<generic error, no stack>"}))},uo,yr=(i,s,l)=>{i=T("/dev/"+i);var d=Ae(!!s,!!l);Hi||(Hi=64);var _=Hi++<<8|0;Vi(_,{open:b=>{b.seekable=!1},close:()=>{l&&l.buffer&&l.buffer.length&&l(10)},read:(b,k,I,R)=>{for(var P=0,V=0;V<R;V++){try{var q=s()}catch{throw new Q(29)}if(q===void 0&&P===0)throw new Q(6);if(q==null)break;P++,k[I+V]=q}return P&&(b.node.timestamp=Date.now()),P},write:(b,k,I,R)=>{for(var P=0;P<R;P++)try{l(k[I+P])}catch{throw new Q(29)}return R&&(b.node.timestamp=Date.now()),P}}),Qr(i,d,_)},Hi,Sn={},wr,ei,br=void 0;function Kt(){return br+=4,me[br-4>>2]}function lo(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var s=i.charCodeAt(0);return 48<=s&&57>=s?`_${i}`:i}function ti(i,s){return i=lo(i),{[i]:function(){return s.apply(this,arguments)}}[i]}function co(){this.M=[void 0],this.ib=[]}var _t=new co,Wn=void 0;function le(i){throw new Wn(i)}var Rt=i=>(i||le("Cannot use deleted val. handle = "+i),_t.get(i).value),Ot=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return _t.pa({ub:1,value:i})}};function ho(i){var s=Error,l=ti(i,function(d){this.name=i,this.message=d,d=Error(d).stack,d!==void 0&&(this.stack=this.toString()+`
`+d.replace(/^Error(:[^\n]*)?\n/,""))});return l.prototype=Object.create(s.prototype),l.prototype.constructor=l,l.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},l}var fo=void 0,vo=void 0;function De(i){for(var s="";ye[i];)s+=vo[ye[i++]];return s}var Er=[];function zi(){for(;Er.length;){var i=Er.pop();i.g.fa=!1,i.delete()}}var Ar=void 0,Yt={};function Gi(i,s){for(s===void 0&&le("ptr should not be undefined");i.A;)s=i.na(s),i=i.A;return s}var Cn={};function po(i){i=Fo(i);var s=De(i);return Qt(i),s}function kr(i,s){var l=Cn[i];return l===void 0&&le(s+" has unknown type "+po(i)),l}function ni(){}var Ki=!1;function go(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function mo(i,s,l){return s===l?i:l.A===void 0?null:(i=mo(i,s,l.A),i===null?null:l.Pb(i))}var _o={};function Mu(i,s){return s=Gi(i,s),Yt[s]}var yo=void 0;function ri(i){throw new yo(i)}function ii(i,s){return s.u&&s.o||ri("makeClassHandle requires ptr and ptrType"),!!s.L!=!!s.G&&ri("Both smartPtrType and smartPtr must be specified"),s.count={value:1},Vn(Object.create(i,{g:{value:s}}))}function Vn(i){return typeof FinalizationRegistry>"u"?(Vn=s=>s,i):(Ki=new FinalizationRegistry(s=>{go(s.g)}),Vn=s=>{var l=s.g;return l.G&&Ki.register(s,{g:l},s),s},ni=s=>{Ki.unregister(s)},Vn(i))}var si={};function Sr(i){for(;i.length;){var s=i.pop();i.pop()(s)}}function Cr(i){return this.fromWireType(me[i>>2])}var qn={},oi={};function ft(i,s,l){function d(I){I=l(I),I.length!==i.length&&ri("Mismatched type converter count");for(var R=0;R<i.length;++R)Dt(i[R],I[R])}i.forEach(function(I){oi[I]=s});var _=Array(s.length),b=[],k=0;s.forEach((I,R)=>{Cn.hasOwnProperty(I)?_[R]=Cn[I]:(b.push(I),qn.hasOwnProperty(I)||(qn[I]=[]),qn[I].push(()=>{_[R]=Cn[I],++k,k===b.length&&d(_)}))}),b.length===0&&d(_)}function ai(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function Lu(i,s,l={}){var d=s.name;if(i||le(`type "${d}" must have a positive integer typeid pointer`),Cn.hasOwnProperty(i)){if(l.$b)return;le(`Cannot register type '${d}' twice`)}Cn[i]=s,delete oi[i],qn.hasOwnProperty(i)&&(s=qn[i],delete qn[i],s.forEach(_=>_()))}function Dt(i,s,l={}){if(!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");Lu(i,s,l)}function Yi(i){le(i.g.u.i.name+" instance already deleted")}function fn(){}function Ji(i,s,l){if(i[s].B===void 0){var d=i[s];i[s]=function(){return i[s].B.hasOwnProperty(arguments.length)||le(`Function '${l}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[s].B})!`),i[s].B[arguments.length].apply(this,arguments)},i[s].B=[],i[s].B[d.ea]=d}}function Xi(i,s,l){g.hasOwnProperty(i)?((l===void 0||g[i].B!==void 0&&g[i].B[l]!==void 0)&&le(`Cannot register public name '${i}' twice`),Ji(g,i,i),g.hasOwnProperty(l)&&le(`Cannot register multiple overloads of a function with the same number of arguments (${l})!`),g[i].B[l]=s):(g[i]=s,l!==void 0&&(g[i].Pc=l))}function Fu(i,s,l,d,_,b,k,I){this.name=i,this.constructor=s,this.N=l,this.W=d,this.A=_,this.Ub=b,this.na=k,this.Pb=I,this.rb=[]}function ui(i,s,l){for(;s!==l;)s.na||le(`Expected null or instance of ${l.name}, got an instance of ${s.name}`),i=s.na(i),s=s.A;return i}function Uu(i,s){return s===null?(this.Na&&le(`null is not a valid ${this.name}`),0):(s.g||le(`Cannot pass "${Zi(s)}" as a ${this.name}`),s.g.o||le(`Cannot pass deleted object as a pointer of type ${this.name}`),ui(s.g.o,s.g.u.i,this.i))}function Du(i,s){if(s===null){if(this.Na&&le(`null is not a valid ${this.name}`),this.ua){var l=this.Pa();return i!==null&&i.push(this.W,l),l}return 0}if(s.g||le(`Cannot pass "${Zi(s)}" as a ${this.name}`),s.g.o||le(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&s.g.u.ta&&le(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`),l=ui(s.g.o,s.g.u.i,this.i),this.ua)switch(s.g.G===void 0&&le("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:s.g.L===this?l=s.g.G:le(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`);break;case 1:l=s.g.G;break;case 2:if(s.g.L===this)l=s.g.G;else{var d=s.clone();l=this.oc(l,Ot(function(){d.delete()})),i!==null&&i.push(this.W,l)}break;default:le("Unsupporting sharing policy")}return l}function $u(i,s){return s===null?(this.Na&&le(`null is not a valid ${this.name}`),0):(s.g||le(`Cannot pass "${Zi(s)}" as a ${this.name}`),s.g.o||le(`Cannot pass deleted object as a pointer of type ${this.name}`),s.g.u.ta&&le(`Cannot convert argument of type ${s.g.u.name} to parameter type ${this.name}`),ui(s.g.o,s.g.u.i,this.i))}function Jt(i,s,l,d){this.name=i,this.i=s,this.Na=l,this.ta=d,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,s.A!==void 0?this.toWireType=Du:(this.toWireType=d?Uu:$u,this.K=null)}function wo(i,s,l){g.hasOwnProperty(i)||ri("Replacing nonexistant public symbol"),g[i].B!==void 0&&l!==void 0?g[i].B[l]=s:(g[i]=s,g[i].ea=l)}var li=[],bo=i=>{var s=li[i];return s||(i>=li.length&&(li.length=i+1),li[i]=s=Be.get(i)),s},Nu=(i,s)=>{var l=[];return function(){if(l.length=0,Object.assign(l,arguments),i.includes("j")){var d=g["dynCall_"+i];d=l&&l.length?d.apply(null,[s].concat(l)):d.call(null,s)}else d=bo(s).apply(null,l);return d}};function et(i,s){i=De(i);var l=i.includes("j")?Nu(i,s):bo(s);return typeof l!="function"&&le(`unknown function pointer with signature ${i}: ${s}`),l}var Eo=void 0;function Xt(i,s){function l(b){_[b]||Cn[b]||(oi[b]?oi[b].forEach(l):(d.push(b),_[b]=!0))}var d=[],_={};throw s.forEach(l),new Eo(`${i}: `+d.map(po).join([", "]))}function ci(i,s,l,d,_){var b=s.length;2>b&&le("argTypes array size mismatch! Must at least get return value and 'this' types!");var k=s[1]!==null&&l!==null,I=!1;for(l=1;l<s.length;++l)if(s[l]!==null&&s[l].K===void 0){I=!0;break}var R=s[0].name!=="void",P=b-2,V=Array(P),q=[],J=[];return function(){if(arguments.length!==P&&le(`function ${i} called with ${arguments.length} arguments, expected ${P} args!`),J.length=0,q.length=k?2:1,q[0]=_,k){var C=s[1].toWireType(J,this);q[1]=C}for(var W=0;W<P;++W)V[W]=s[W+2].toWireType(J,arguments[W]),q.push(V[W]);if(W=d.apply(null,q),I)Sr(J);else for(var N=k?1:2;N<s.length;N++){var ce=N===1?C:V[N-2];s[N].K!==null&&s[N].K(ce)}return C=R?s[0].fromWireType(W):void 0,C}}function hi(i,s){for(var l=[],d=0;d<i;d++)l.push(Te[s+4*d>>2]);return l}function Ao(i,s,l){return i instanceof Object||le(`${l} with invalid "this": ${i}`),i instanceof s.i.constructor||le(`${l} incompatible with "this" of type ${i.constructor.name}`),i.g.o||le(`cannot call emscripten binding method ${l} on deleted object`),ui(i.g.o,i.g.u.i,s.i)}function Qi(i){i>=_t.h&&--_t.get(i).ub===0&&_t.Zb(i)}function Bu(i,s,l){switch(s){case 0:return function(d){return this.fromWireType((l?Ce:ye)[d])};case 1:return function(d){return this.fromWireType((l?Qe:St)[d>>1])};case 2:return function(d){return this.fromWireType((l?me:Te)[d>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Zi(i){if(i===null)return"null";var s=typeof i;return s==="object"||s==="array"||s==="function"?i.toString():""+i}function Wu(i,s){switch(s){case 2:return function(l){return this.fromWireType(Ct[l>>2])};case 3:return function(l){return this.fromWireType(xe[l>>3])};default:throw new TypeError("Unknown float type: "+i)}}function Vu(i,s,l){switch(s){case 0:return l?function(d){return Ce[d]}:function(d){return ye[d]};case 1:return l?function(d){return Qe[d>>1]}:function(d){return St[d>>1]};case 2:return l?function(d){return me[d>>2]}:function(d){return Te[d>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var ko=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,qu=(i,s)=>{for(var l=i>>1,d=l+s/2;!(l>=d)&&St[l];)++l;if(l<<=1,32<l-i&&ko)return ko.decode(ye.subarray(i,l));for(l="",d=0;!(d>=s/2);++d){var _=Qe[i+2*d>>1];if(_==0)break;l+=String.fromCharCode(_)}return l},Hu=(i,s,l)=>{if(l===void 0&&(l=2147483647),2>l)return 0;l-=2;var d=s;l=l<2*i.length?l/2:i.length;for(var _=0;_<l;++_)Qe[s>>1]=i.charCodeAt(_),s+=2;return Qe[s>>1]=0,s-d},zu=i=>2*i.length,Gu=(i,s)=>{for(var l=0,d="";!(l>=s/4);){var _=me[i+4*l>>2];if(_==0)break;++l,65536<=_?(_-=65536,d+=String.fromCharCode(55296|_>>10,56320|_&1023)):d+=String.fromCharCode(_)}return d},Ku=(i,s,l)=>{if(l===void 0&&(l=2147483647),4>l)return 0;var d=s;l=d+l-4;for(var _=0;_<i.length;++_){var b=i.charCodeAt(_);if(55296<=b&&57343>=b){var k=i.charCodeAt(++_);b=65536+((b&1023)<<10)|k&1023}if(me[s>>2]=b,s+=4,s+4>l)break}return me[s>>2]=0,s-d},Yu=i=>{for(var s=0,l=0;l<i.length;++l){var d=i.charCodeAt(l);55296<=d&&57343>=d&&++l,s+=4}return s},Ju={};function di(i){var s=Ju[i];return s===void 0?De(i):s}var fi=[];function Xu(i){var s=fi.length;return fi.push(i),s}function Qu(i,s){for(var l=Array(i),d=0;d<i;++d)l[d]=kr(Te[s+4*d>>2],"parameter "+d);return l}var So=[],es=[],ts={},Co=()=>{if(!ns){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:F||"./this.program"},s;for(s in ts)ts[s]===void 0?delete i[s]:i[s]=ts[s];var l=[];for(s in i)l.push(`${s}=${i[s]}`);ns=l}return ns},ns,vi=i=>i%4===0&&(i%100!==0||i%400===0),To=[31,29,31,30,31,30,31,31,30,31,30,31],Po=[31,28,31,30,31,30,31,31,30,31,30,31],Zu=(i,s,l,d)=>{function _(C,W,N){for(C=typeof C=="number"?C.toString():C||"";C.length<W;)C=N[0]+C;return C}function b(C,W){return _(C,W,"0")}function k(C,W){function N(de){return 0>de?-1:0<de?1:0}var ce;return(ce=N(C.getFullYear()-W.getFullYear()))===0&&(ce=N(C.getMonth()-W.getMonth()))===0&&(ce=N(C.getDate()-W.getDate())),ce}function I(C){switch(C.getDay()){case 0:return new Date(C.getFullYear()-1,11,29);case 1:return C;case 2:return new Date(C.getFullYear(),0,3);case 3:return new Date(C.getFullYear(),0,2);case 4:return new Date(C.getFullYear(),0,1);case 5:return new Date(C.getFullYear()-1,11,31);case 6:return new Date(C.getFullYear()-1,11,30)}}function R(C){var W=C.ca;for(C=new Date(new Date(C.da+1900,0,1).getTime());0<W;){var N=C.getMonth(),ce=(vi(C.getFullYear())?To:Po)[N];if(W>ce-C.getDate())W-=ce-C.getDate()+1,C.setDate(1),11>N?C.setMonth(N+1):(C.setMonth(0),C.setFullYear(C.getFullYear()+1));else{C.setDate(C.getDate()+W);break}}return N=new Date(C.getFullYear()+1,0,4),W=I(new Date(C.getFullYear(),0,4)),N=I(N),0>=k(W,C)?0>=k(N,C)?C.getFullYear()+1:C.getFullYear():C.getFullYear()-1}var P=me[d+40>>2];d={wc:me[d>>2],vc:me[d+4>>2],Fa:me[d+8>>2],Sa:me[d+12>>2],Ga:me[d+16>>2],da:me[d+20>>2],R:me[d+24>>2],ca:me[d+28>>2],Rc:me[d+32>>2],uc:me[d+36>>2],xc:P&&P?Ie(ye,P):""},l=l?Ie(ye,l):"",P={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var V in P)l=l.replace(new RegExp(V,"g"),P[V]);var q="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),J="January February March April May June July August September October November December".split(" ");P={"%a":C=>q[C.R].substring(0,3),"%A":C=>q[C.R],"%b":C=>J[C.Ga].substring(0,3),"%B":C=>J[C.Ga],"%C":C=>b((C.da+1900)/100|0,2),"%d":C=>b(C.Sa,2),"%e":C=>_(C.Sa,2," "),"%g":C=>R(C).toString().substring(2),"%G":C=>R(C),"%H":C=>b(C.Fa,2),"%I":C=>(C=C.Fa,C==0?C=12:12<C&&(C-=12),b(C,2)),"%j":C=>{for(var W=0,N=0;N<=C.Ga-1;W+=(vi(C.da+1900)?To:Po)[N++]);return b(C.Sa+W,3)},"%m":C=>b(C.Ga+1,2),"%M":C=>b(C.vc,2),"%n":()=>`
`,"%p":C=>0<=C.Fa&&12>C.Fa?"AM":"PM","%S":C=>b(C.wc,2),"%t":()=>"	","%u":C=>C.R||7,"%U":C=>b(Math.floor((C.ca+7-C.R)/7),2),"%V":C=>{var W=Math.floor((C.ca+7-(C.R+6)%7)/7);if(2>=(C.R+371-C.ca-2)%7&&W++,W)W==53&&(N=(C.R+371-C.ca)%7,N==4||N==3&&vi(C.da)||(W=1));else{W=52;var N=(C.R+7-C.ca-1)%7;(N==4||N==5&&vi(C.da%400-1))&&W++}return b(W,2)},"%w":C=>C.R,"%W":C=>b(Math.floor((C.ca+7-(C.R+6)%7)/7),2),"%y":C=>(C.da+1900).toString().substring(2),"%Y":C=>C.da+1900,"%z":C=>{C=C.uc;var W=0<=C;return C=Math.abs(C)/60,(W?"+":"-")+("0000"+(C/60*100+C%60)).slice(-4)},"%Z":C=>C.xc,"%%":()=>"%"},l=l.replace(/%%/g,"\0\0");for(V in P)l.includes(V)&&(l=l.replace(new RegExp(V,"g"),P[V](d)));return l=l.replace(/\0\0/g,"%"),V=gt(l,!1),V.length>s?0:(Ce.set(V,i),V.length-1)};function Io(i,s,l,d){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Ru++,this.name=s,this.mode=l,this.l={},this.m={},this.za=d}Object.defineProperties(Io.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),ao(),_r=Array(4096),so(ie,"/"),It("/tmp",16895,0),It("/home",16895,0),It("/home/web_user",16895,0),(()=>{It("/dev",16895,0),Vi(259,{read:()=>0,write:(d,_,b,k)=>k}),Qr("/dev/null",259),at(1280,cn),at(1536,hn),Qr("/dev/tty",1280),Qr("/dev/tty1",1536);var i=new Uint8Array(1024),s=0,l=()=>(s===0&&(s=oe(i).byteLength),i[--s]);yr("random",l),yr("urandom",l),It("/dev/shm",16895,0),It("/dev/shm/tmp",16895,0)})(),(()=>{It("/proc",16895,0);var i=It("/proc/self",16895,0);It("/proc/self/fd",16895,0),so({U:()=>{var s=to(i,"fd",16895,73);return s.l={ka:(l,d)=>{var _=dn(+d);return l={parent:null,U:{nb:"fake"},l:{ma:()=>_.path}},l.parent=l}},s}},"/proc/self/fd")})(),Object.assign(co.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var s=this.ib.pop()||this.M.length;return this.M[s]=i,s},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),Wn=g.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},_t.M.push({value:void 0},{value:null},{value:!0},{value:!1}),_t.h=_t.M.length,g.count_emval_handles=function(){for(var i=0,s=_t.h;s<_t.M.length;++s)_t.M[s]!==void 0&&++i;return i},fo=g.PureVirtualError=ho("PureVirtualError");for(var Ro=Array(256),pi=0;256>pi;++pi)Ro[pi]=String.fromCharCode(pi);vo=Ro,g.getInheritedInstanceCount=function(){return Object.keys(Yt).length},g.getLiveInheritedInstances=function(){var i=[],s;for(s in Yt)Yt.hasOwnProperty(s)&&i.push(Yt[s]);return i},g.flushPendingDeletes=zi,g.setDelayFunction=function(i){Ar=i,Er.length&&Ar&&Ar(zi)},yo=g.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},fn.prototype.isAliasOf=function(i){if(!(this instanceof fn&&i instanceof fn))return!1;var s=this.g.u.i,l=this.g.o,d=i.g.u.i;for(i=i.g.o;s.A;)l=s.na(l),s=s.A;for(;d.A;)i=d.na(i),d=d.A;return s===d&&l===i},fn.prototype.clone=function(){if(this.g.o||Yi(this),this.g.ia)return this.g.count.value+=1,this;var i=Vn,s=Object,l=s.create,d=Object.getPrototypeOf(this),_=this.g;return i=i(l.call(s,d,{g:{value:{count:_.count,fa:_.fa,ia:_.ia,o:_.o,u:_.u,G:_.G,L:_.L}}})),i.g.count.value+=1,i.g.fa=!1,i},fn.prototype.delete=function(){this.g.o||Yi(this),this.g.fa&&!this.g.ia&&le("Object already scheduled for deletion"),ni(this),go(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},fn.prototype.isDeleted=function(){return!this.g.o},fn.prototype.deleteLater=function(){return this.g.o||Yi(this),this.g.fa&&!this.g.ia&&le("Object already scheduled for deletion"),Er.push(this),Er.length===1&&Ar&&Ar(zi),this.g.fa=!0,this},Jt.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},Jt.prototype.bb=function(i){this.W&&this.W(i)},Jt.prototype.argPackAdvance=8,Jt.prototype.readValueFromPointer=Cr,Jt.prototype.deleteObject=function(i){i!==null&&i.delete()},Jt.prototype.fromWireType=function(i){function s(){return this.ua?ii(this.i.N,{u:this.nc,o:l,L:this,G:i}):ii(this.i.N,{u:this,o:i})}var l=this.Vb(i);if(!l)return this.bb(i),null;var d=Mu(this.i,l);if(d!==void 0)return d.g.count.value===0?(d.g.o=l,d.g.G=i,d.clone()):(d=d.clone(),this.bb(i),d);if(d=this.i.Ub(l),d=_o[d],!d)return s.call(this);d=this.ta?d.Kb:d.pointerType;var _=mo(l,this.i,d.i);return _===null?s.call(this):this.ua?ii(d.i.N,{u:d,o:_,L:this,G:i}):ii(d.i.N,{u:d,o:_})},Eo=g.UnboundTypeError=ho("UnboundTypeError");var Oo={__syscall_fcntl64:function(i,s,l){br=l;try{var d=dn(i);switch(s){case 0:var _=Kt();return 0>_?-28:io(d,_).X;case 1:case 2:return 0;case 3:return d.flags;case 4:return _=Kt(),d.flags|=_,0;case 5:return _=Kt(),Qe[_+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return me[jo()>>2]=28,-1;default:return-28}}catch(b){if(typeof Sn>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,s,l){br=l;try{var d=dn(i);switch(s){case 21509:return d.s?0:-59;case 21505:if(!d.s)return-59;if(d.s.V.bc){s=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var _=Kt();me[_>>2]=25856,me[_+4>>2]=5,me[_+8>>2]=191,me[_+12>>2]=35387;for(var b=0;32>b;b++)Ce[_+b+17>>0]=s[b]||0}return 0;case 21510:case 21511:case 21512:return d.s?0:-59;case 21506:case 21507:case 21508:if(!d.s)return-59;if(d.s.V.cc)for(_=Kt(),s=[],b=0;32>b;b++)s.push(Ce[_+b+17>>0]);return 0;case 21519:return d.s?(_=Kt(),me[_>>2]=0):-59;case 21520:return d.s?-28:-59;case 21531:if(_=Kt(),!d.m.ac)throw new Q(59);return d.m.ac(d,s,_);case 21523:return d.s?(d.s.V.dc&&(b=[24,80],_=Kt(),Qe[_>>1]=b[0],Qe[_+2>>1]=b[1]),0):-59;case 21524:return d.s?0:-59;case 21515:return d.s?0:-59;default:return-28}}catch(k){if(typeof Sn>"u"||k.name!=="ErrnoError")throw k;return-k.aa}},__syscall_openat:function(i,s,l,d){br=d;try{s=s?Ie(ye,s):"";var _=s;if(_.charAt(0)==="/")s=_;else{var b=i===-100?"/":dn(i).path;if(_.length==0)throw new Q(44);s=T(b+"/"+_)}var k=d?Kt():0;return Zr(s,l,k).X}catch(I){if(typeof Sn>"u"||I.name!=="ErrnoError")throw I;return-I.aa}},_embind_create_inheriting_constructor:function(i,s,l){i=De(i),s=kr(s,"wrapper"),l=Rt(l);var d=[].slice,_=s.i,b=_.N,k=_.A.N,I=_.A.constructor;i=ti(i,function(){_.A.rb.forEach((function(P){if(this[P]===k[P])throw new fo(`Pure virtual function ${P} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,d.call(arguments))}),b.__construct=function(){this===b&&le("Pass correct 'this' to __construct");var P=I.implement.apply(void 0,[this].concat(d.call(arguments)));ni(P);var V=P.g;P.notifyOnDestruction(),V.ia=!0,Object.defineProperties(this,{g:{value:V}}),Vn(this),P=V.o,P=Gi(_,P),Yt.hasOwnProperty(P)?le(`Tried to register registered instance: ${P}`):Yt[P]=this},b.__destruct=function(){this===b&&le("Pass correct 'this' to __destruct"),ni(this);var P=this.g.o;P=Gi(_,P),Yt.hasOwnProperty(P)?delete Yt[P]:le(`Tried to unregister unregistered instance: ${P}`)},i.prototype=Object.create(b);for(var R in l)i.prototype[R]=l[R];return Ot(i)},_embind_finalize_value_object:function(i){var s=si[i];delete si[i];var l=s.Pa,d=s.W,_=s.fb,b=_.map(k=>k.Yb).concat(_.map(k=>k.rc));ft([i],b,k=>{var I={};return _.forEach((R,P)=>{var V=k[P],q=R.Wb,J=R.Xb,C=k[P+_.length],W=R.qc,N=R.sc;I[R.Sb]={read:ce=>V.fromWireType(q(J,ce)),write:(ce,de)=>{var G=[];W(N,ce,C.toWireType(G,de)),Sr(G)}}}),[{name:s.name,fromWireType:function(R){var P={},V;for(V in I)P[V]=I[V].read(R);return d(R),P},toWireType:function(R,P){for(var V in I)if(!(V in P))throw new TypeError(`Missing field: "${V}"`);var q=l();for(V in I)I[V].write(q,P[V]);return R!==null&&R.push(d,q),q},argPackAdvance:8,readValueFromPointer:Cr,K:d}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,s,l,d,_){var b=ai(l);s=De(s),Dt(i,{name:s,fromWireType:function(k){return!!k},toWireType:function(k,I){return I?d:_},argPackAdvance:8,readValueFromPointer:function(k){if(l===1)var I=Ce;else if(l===2)I=Qe;else if(l===4)I=me;else throw new TypeError("Unknown boolean type size: "+s);return this.fromWireType(I[k>>b])},K:null})},_embind_register_class:function(i,s,l,d,_,b,k,I,R,P,V,q,J){V=De(V),b=et(_,b),I&&(I=et(k,I)),P&&(P=et(R,P)),J=et(q,J);var C=lo(V);Xi(C,function(){Xt(`Cannot construct ${V} due to unbound types`,[d])}),ft([i,s,l],d?[d]:[],function(W){if(W=W[0],d)var N=W.i,ce=N.N;else ce=fn.prototype;W=ti(C,function(){if(Object.getPrototypeOf(this)!==de)throw new Wn("Use 'new' to construct "+V);if(G.$===void 0)throw new Wn(V+" has no accessible constructor");var Ze=G.$[arguments.length];if(Ze===void 0)throw new Wn(`Tried to invoke ctor of ${V} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(G.$).toString()}) parameters instead!`);return Ze.apply(this,arguments)});var de=Object.create(ce,{constructor:{value:W}});W.prototype=de;var G=new Fu(V,W,de,J,N,b,I,P);G.A&&(G.A.oa===void 0&&(G.A.oa=[]),G.A.oa.push(G)),N=new Jt(V,G,!0,!1),ce=new Jt(V+"*",G,!1,!1);var Le=new Jt(V+" const*",G,!1,!0);return _o[i]={pointerType:ce,Kb:Le},wo(C,W),[N,ce,Le]})},_embind_register_class_class_function:function(i,s,l,d,_,b,k){var I=hi(l,d);s=De(s),b=et(_,b),ft([],[i],function(R){function P(){Xt(`Cannot call ${V} due to unbound types`,I)}R=R[0];var V=`${R.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var q=R.i.constructor;return q[s]===void 0?(P.ea=l-1,q[s]=P):(Ji(q,s,V),q[s].B[l-1]=P),ft([],I,function(J){if(J=ci(V,[J[0],null].concat(J.slice(1)),null,b,k),q[s].B===void 0?(J.ea=l-1,q[s]=J):q[s].B[l-1]=J,R.i.oa)for(const C of R.i.oa)C.constructor.hasOwnProperty(s)||(C.constructor[s]=J);return[]}),[]})},_embind_register_class_class_property:function(i,s,l,d,_,b,k,I){s=De(s),b=et(_,b),ft([],[i],function(R){R=R[0];var P=`${R.name}.${s}`,V={get(){Xt(`Cannot access ${P} due to unbound types`,[l])},enumerable:!0,configurable:!0};return V.set=I?()=>{Xt(`Cannot access ${P} due to unbound types`,[l])}:()=>{le(`${P} is a read-only property`)},Object.defineProperty(R.i.constructor,s,V),ft([],[l],function(q){q=q[0];var J={get(){return q.fromWireType(b(d))},enumerable:!0};return I&&(I=et(k,I),J.set=C=>{var W=[];I(d,q.toWireType(W,C)),Sr(W)}),Object.defineProperty(R.i.constructor,s,J),[]}),[]})},_embind_register_class_constructor:function(i,s,l,d,_,b){var k=hi(s,l);_=et(d,_),ft([],[i],function(I){I=I[0];var R=`constructor ${I.name}`;if(I.i.$===void 0&&(I.i.$=[]),I.i.$[s-1]!==void 0)throw new Wn(`Cannot register multiple constructors with identical number of parameters (${s-1}) for class '${I.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return I.i.$[s-1]=()=>{Xt(`Cannot construct ${I.name} due to unbound types`,k)},ft([],k,function(P){return P.splice(1,0,null),I.i.$[s-1]=ci(R,P,null,_,b),[]}),[]})},_embind_register_class_function:function(i,s,l,d,_,b,k,I){var R=hi(l,d);s=De(s),b=et(_,b),ft([],[i],function(P){function V(){Xt(`Cannot call ${q} due to unbound types`,R)}P=P[0];var q=`${P.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),I&&P.i.rb.push(s);var J=P.i.N,C=J[s];return C===void 0||C.B===void 0&&C.className!==P.name&&C.ea===l-2?(V.ea=l-2,V.className=P.name,J[s]=V):(Ji(J,s,q),J[s].B[l-2]=V),ft([],R,function(W){return W=ci(q,W,P,b,k),J[s].B===void 0?(W.ea=l-2,J[s]=W):J[s].B[l-2]=W,[]}),[]})},_embind_register_class_property:function(i,s,l,d,_,b,k,I,R,P){s=De(s),_=et(d,_),ft([],[i],function(V){V=V[0];var q=`${V.name}.${s}`,J={get(){Xt(`Cannot access ${q} due to unbound types`,[l,k])},enumerable:!0,configurable:!0};return J.set=R?()=>{Xt(`Cannot access ${q} due to unbound types`,[l,k])}:()=>{le(q+" is a read-only property")},Object.defineProperty(V.i.N,s,J),ft([],R?[l,k]:[l],function(C){var W=C[0],N={get(){var de=Ao(this,V,q+" getter");return W.fromWireType(_(b,de))},enumerable:!0};if(R){R=et(I,R);var ce=C[1];N.set=function(de){var G=Ao(this,V,q+" setter"),Le=[];R(P,G,ce.toWireType(Le,de)),Sr(Le)}}return Object.defineProperty(V.i.N,s,N),[]}),[]})},_embind_register_emval:function(i,s){s=De(s),Dt(i,{name:s,fromWireType:function(l){var d=Rt(l);return Qi(l),d},toWireType:function(l,d){return Ot(d)},argPackAdvance:8,readValueFromPointer:Cr,K:null})},_embind_register_enum:function(i,s,l,d){function _(){}l=ai(l),s=De(s),_.values={},Dt(i,{name:s,constructor:_,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,k){return k.value},argPackAdvance:8,readValueFromPointer:Bu(s,l,d),K:null}),Xi(s,_)},_embind_register_enum_value:function(i,s,l){var d=kr(i,"enum");s=De(s),i=d.constructor,d=Object.create(d.constructor.prototype,{value:{value:l},constructor:{value:ti(`${d.name}_${s}`,function(){})}}),i.values[l]=d,i[s]=d},_embind_register_float:function(i,s,l){l=ai(l),s=De(s),Dt(i,{name:s,fromWireType:function(d){return d},toWireType:function(d,_){return _},argPackAdvance:8,readValueFromPointer:Wu(s,l),K:null})},_embind_register_function:function(i,s,l,d,_,b){var k=hi(s,l);i=De(i),_=et(d,_),Xi(i,function(){Xt(`Cannot call ${i} due to unbound types`,k)},s-1),ft([],k,function(I){return wo(i,ci(i,[I[0],null].concat(I.slice(1)),null,_,b),s-1),[]})},_embind_register_integer:function(i,s,l,d,_){s=De(s),_===-1&&(_=4294967295),_=ai(l);var b=I=>I;if(d===0){var k=32-8*l;b=I=>I<<k>>>k}l=s.includes("unsigned")?function(I,R){return R>>>0}:function(I,R){return R},Dt(i,{name:s,fromWireType:b,toWireType:l,argPackAdvance:8,readValueFromPointer:Vu(s,_,d!==0),K:null})},_embind_register_memory_view:function(i,s,l){function d(b){b>>=2;var k=Te;return new _(k.buffer,k[b+1],k[b])}var _=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];l=De(l),Dt(i,{name:l,fromWireType:d,argPackAdvance:8,readValueFromPointer:d},{$b:!0})},_embind_register_std_string:function(i,s){s=De(s);var l=s==="std::string";Dt(i,{name:s,fromWireType:function(d){var _=Te[d>>2],b=d+4;if(l)for(var k=b,I=0;I<=_;++I){var R=b+I;if(I==_||ye[R]==0){if(k=k?Ie(ye,k,R-k):"",P===void 0)var P=k;else P+="\0",P+=k;k=R+1}}else{for(P=Array(_),I=0;I<_;++I)P[I]=String.fromCharCode(ye[b+I]);P=P.join("")}return Qt(d),P},toWireType:function(d,_){_ instanceof ArrayBuffer&&(_=new Uint8Array(_));var b=typeof _=="string";b||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int8Array||le("Cannot pass non-string to std::string");var k=l&&b?Ue(_):_.length,I=rs(4+k+1),R=I+4;if(Te[I>>2]=k,l&&b)Pt(_,ye,R,k+1);else if(b)for(b=0;b<k;++b){var P=_.charCodeAt(b);255<P&&(Qt(R),le("String has UTF-16 code units that do not fit in 8 bits")),ye[R+b]=P}else for(b=0;b<k;++b)ye[R+b]=_[b];return d!==null&&d.push(Qt,I),I},argPackAdvance:8,readValueFromPointer:Cr,K:function(d){Qt(d)}})},_embind_register_std_wstring:function(i,s,l){if(l=De(l),s===2)var d=qu,_=Hu,b=zu,k=()=>St,I=1;else s===4&&(d=Gu,_=Ku,b=Yu,k=()=>Te,I=2);Dt(i,{name:l,fromWireType:function(R){for(var P=Te[R>>2],V=k(),q,J=R+4,C=0;C<=P;++C){var W=R+4+C*s;(C==P||V[W>>I]==0)&&(J=d(J,W-J),q===void 0?q=J:(q+="\0",q+=J),J=W+s)}return Qt(R),q},toWireType:function(R,P){typeof P!="string"&&le(`Cannot pass non-string to C++ string type ${l}`);var V=b(P),q=rs(4+V+s);return Te[q>>2]=V>>I,_(P,q+4,V+s),R!==null&&R.push(Qt,q),q},argPackAdvance:8,readValueFromPointer:Cr,K:function(R){Qt(R)}})},_embind_register_value_object:function(i,s,l,d,_,b){si[i]={name:De(s),Pa:et(l,d),W:et(_,b),fb:[]}},_embind_register_value_object_field:function(i,s,l,d,_,b,k,I,R,P){si[i].fb.push({Sb:De(s),Yb:l,Wb:et(d,_),Xb:b,rc:k,qc:et(I,R),sc:P})},_embind_register_void:function(i,s){s=De(s),Dt(i,{fc:!0,name:s,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,s,l){i=Rt(i),s=kr(s,"emval::as");var d=[],_=Ot(d);return Te[l>>2]=_,s.toWireType(d,i)},_emval_call_method:function(i,s,l,d,_){i=fi[i],s=Rt(s),l=di(l);var b=[];return Te[d>>2]=Ot(b),i(s,l,b,_)},_emval_call_void_method:function(i,s,l,d){i=fi[i],s=Rt(s),l=di(l),i(s,l,null,d)},_emval_decref:Qi,_emval_get_method_caller:function(i,s){var l=Qu(i,s),d=l[0];s=d.name+"_$"+l.slice(1).map(function(k){return k.name}).join("_")+"$";var _=So[s];if(_!==void 0)return _;var b=Array(i-1);return _=Xu((k,I,R,P)=>{for(var V=0,q=0;q<i-1;++q)b[q]=l[q+1].readValueFromPointer(P+V),V+=l[q+1].argPackAdvance;for(k=k[I].apply(k,b),q=0;q<i-1;++q)l[q+1].Nb&&l[q+1].Nb(b[q]);if(!d.fc)return d.toWireType(R,k)}),So[s]=_},_emval_get_module_property:function(i){return i=di(i),Ot(g[i])},_emval_get_property:function(i,s){return i=Rt(i),s=Rt(s),Ot(i[s])},_emval_incref:function(i){4<i&&(_t.get(i).ub+=1)},_emval_new_array:function(){return Ot([])},_emval_new_cstring:function(i){return Ot(di(i))},_emval_new_object:function(){return Ot({})},_emval_run_destructors:function(i){var s=Rt(i);Sr(s),Qi(i)},_emval_set_property:function(i,s,l){i=Rt(i),s=Rt(s),l=Rt(l),i[s]=l},_emval_take_value:function(i,s){return i=kr(i,"_emval_take_value"),i=i.readValueFromPointer(s),Ot(i)},abort:()=>{un("")},emscripten_asm_const_int:(i,s,l)=>{es.length=0;var d;for(l>>=2;d=ye[s++];)l+=d!=105&l,es.push(d==105?me[l]:xe[l++>>1]),++l;return a[i].apply(null,es)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,s,l)=>ye.copyWithin(i,s,s+l),emscripten_resize_heap:i=>{var s=ye.length;if(i>>>=0,2147483648<i)return!1;for(var l=1;4>=l;l*=2){var d=s*(1+.2/l);d=Math.min(d,i+100663296);var _=Math;d=Math.max(i,d);e:{_=_.min.call(_,2147483648,d+(65536-d%65536)%65536)-kt.buffer.byteLength+65535>>>16;try{kt.grow(_),ht();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,s)=>{var l=0;return Co().forEach(function(d,_){var b=s+l;for(_=Te[i+4*_>>2]=b,b=0;b<d.length;++b)Ce[_++>>0]=d.charCodeAt(b);Ce[_>>0]=0,l+=d.length+1}),0},environ_sizes_get:(i,s)=>{var l=Co();Te[i>>2]=l.length;var d=0;return l.forEach(function(_){d+=_.length+1}),Te[s>>2]=d,0},fd_close:function(i){try{var s=dn(i);if(s.X===null)throw new Q(8);s.Ma&&(s.Ma=null);try{s.m.close&&s.m.close(s)}catch(l){throw l}finally{Yr[s.X]=null}return s.X=null,0}catch(l){if(typeof Sn>"u"||l.name!=="ErrnoError")throw l;return l.aa}},fd_read:function(i,s,l,d){try{e:{var _=dn(i);i=s;for(var b,k=s=0;k<l;k++){var I=Te[i>>2],R=Te[i+4>>2];i+=8;var P=_,V=I,q=R,J=b,C=Ce;if(0>q||0>J)throw new Q(28);if(P.X===null)throw new Q(8);if((P.flags&2097155)===1)throw new Q(8);if((P.node.mode&61440)===16384)throw new Q(31);if(!P.m.read)throw new Q(28);var W=typeof J<"u";if(!W)J=P.position;else if(!P.seekable)throw new Q(70);var N=P.m.read(P,C,V,q,J);W||(P.position+=N);var ce=N;if(0>ce){var de=-1;break e}if(s+=ce,ce<R)break;typeof b<"u"&&(b+=ce)}de=s}return Te[d>>2]=de,0}catch(G){if(typeof Sn>"u"||G.name!=="ErrnoError")throw G;return G.aa}},fd_seek:function(i,s,l,d,_){s=l+2097152>>>0<4194305-!!s?(s>>>0)+4294967296*l:NaN;try{if(isNaN(s))return 61;var b=dn(i);return oo(b,s,d),p=[b.position>>>0,(ln=b.position,1<=+Math.abs(ln)?0<ln?+Math.floor(ln/4294967296)>>>0:~~+Math.ceil((ln-+(~~ln>>>0))/4294967296)>>>0:0)],me[_>>2]=p[0],me[_+4>>2]=p[1],b.Ma&&s===0&&d===0&&(b.Ma=null),0}catch(k){if(typeof Sn>"u"||k.name!=="ErrnoError")throw k;return k.aa}},fd_write:function(i,s,l,d){try{e:{var _=dn(i);i=s;for(var b,k=s=0;k<l;k++){var I=Te[i>>2],R=Te[i+4>>2];i+=8;var P=_,V=I,q=R,J=b,C=Ce;if(0>q||0>J)throw new Q(28);if(P.X===null)throw new Q(8);if((P.flags&2097155)===0)throw new Q(8);if((P.node.mode&61440)===16384)throw new Q(31);if(!P.m.write)throw new Q(28);P.seekable&&P.flags&1024&&oo(P,0,2);var W=typeof J<"u";if(!W)J=P.position;else if(!P.seekable)throw new Q(70);var N=P.m.write(P,C,V,q,J,void 0);W||(P.position+=N);var ce=N;if(0>ce){var de=-1;break e}s+=ce,typeof b<"u"&&(b+=ce)}de=s}return Te[d>>2]=de,0}catch(G){if(typeof Sn>"u"||G.name!=="ErrnoError")throw G;return G.aa}},strftime_l:(i,s,l,d)=>Zu(i,s,l,d)};(function(){function i(l){if(ge=l=l.exports,kt=ge.memory,ht(),Be=ge.__indirect_function_table,an.unshift(ge.__wasm_call_ctors),st--,g.monitorRunDependencies&&g.monitorRunDependencies(st),st==0&&Tt){var d=Tt;Tt=null,d()}return l}var s={env:Oo,wasi_snapshot_preview1:Oo};if(st++,g.monitorRunDependencies&&g.monitorRunDependencies(st),g.instantiateWasm)try{return g.instantiateWasm(s,i)}catch(l){je("Module.instantiateWasm callback failed with error: "+l),O(l)}return Bi(s,function(l){i(l.instance)}).catch(O),{}})();var Qt=i=>(Qt=ge.free)(i),rs=i=>(rs=ge.malloc)(i),jo=()=>(jo=ge.__errno_location)(),xo=g._ma_device__on_notification_unlocked=i=>(xo=g._ma_device__on_notification_unlocked=ge.ma_device__on_notification_unlocked)(i);g._ma_malloc_emscripten=(i,s)=>(g._ma_malloc_emscripten=ge.ma_malloc_emscripten)(i,s),g._ma_free_emscripten=(i,s)=>(g._ma_free_emscripten=ge.ma_free_emscripten)(i,s);var Mo=g._ma_device_process_pcm_frames_capture__webaudio=(i,s,l)=>(Mo=g._ma_device_process_pcm_frames_capture__webaudio=ge.ma_device_process_pcm_frames_capture__webaudio)(i,s,l),Lo=g._ma_device_process_pcm_frames_playback__webaudio=(i,s,l)=>(Lo=g._ma_device_process_pcm_frames_playback__webaudio=ge.ma_device_process_pcm_frames_playback__webaudio)(i,s,l),Fo=i=>(Fo=ge.__getTypeName)(i);g.__embind_initialize_bindings=()=>(g.__embind_initialize_bindings=ge._embind_initialize_bindings)(),g.dynCall_iiji=(i,s,l,d,_)=>(g.dynCall_iiji=ge.dynCall_iiji)(i,s,l,d,_),g.dynCall_jiji=(i,s,l,d,_)=>(g.dynCall_jiji=ge.dynCall_jiji)(i,s,l,d,_),g.dynCall_iiiji=(i,s,l,d,_,b)=>(g.dynCall_iiiji=ge.dynCall_iiiji)(i,s,l,d,_,b),g.dynCall_iij=(i,s,l,d)=>(g.dynCall_iij=ge.dynCall_iij)(i,s,l,d),g.dynCall_jii=(i,s,l)=>(g.dynCall_jii=ge.dynCall_jii)(i,s,l),g.dynCall_viijii=(i,s,l,d,_,b,k)=>(g.dynCall_viijii=ge.dynCall_viijii)(i,s,l,d,_,b,k),g.dynCall_iiiiij=(i,s,l,d,_,b,k)=>(g.dynCall_iiiiij=ge.dynCall_iiiiij)(i,s,l,d,_,b,k),g.dynCall_iiiiijj=(i,s,l,d,_,b,k,I,R)=>(g.dynCall_iiiiijj=ge.dynCall_iiiiijj)(i,s,l,d,_,b,k,I,R),g.dynCall_iiiiiijj=(i,s,l,d,_,b,k,I,R,P)=>(g.dynCall_iiiiiijj=ge.dynCall_iiiiiijj)(i,s,l,d,_,b,k,I,R,P);var gi;Tt=function i(){gi||Uo(),gi||(Tt=i)};function Uo(){function i(){if(!gi&&(gi=!0,g.calledRun=!0,!on)){if(g.noFSInit||uo||(uo=!0,ao(),g.stdin=g.stdin,g.stdout=g.stdout,g.stderr=g.stderr,g.stdin?yr("stdin",g.stdin):qi("/dev/tty","/dev/stdin"),g.stdout?yr("stdout",null,g.stdout):qi("/dev/tty","/dev/stdout"),g.stderr?yr("stderr",null,g.stderr):qi("/dev/tty1","/dev/stderr"),Zr("/dev/stdin",0),Zr("/dev/stdout",1),Zr("/dev/stderr",1)),Qs=!1,h(an),S(g),g.onRuntimeInitialized&&g.onRuntimeInitialized(),g.postRun)for(typeof g.postRun=="function"&&(g.postRun=[g.postRun]);g.postRun.length;){var s=g.postRun.shift();zt.unshift(s)}h(zt)}}if(!(0<st)){if(g.preRun)for(typeof g.preRun=="function"&&(g.preRun=[g.preRun]);g.preRun.length;)An();h(Ht),0<st||(g.setStatus?(g.setStatus("Running..."),setTimeout(function(){setTimeout(function(){g.setStatus("")},1),i()},1)):i())}}if(g.preInit)for(typeof g.preInit=="function"&&(g.preInit=[g.preInit]);0<g.preInit.length;)g.preInit.pop()();return Uo(),A.ready})})();const y=m}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,f,v)=>{v.r(f),v.d(f,{Animation:()=>m.Animation});var m=v(4)}),((c,f,v)=>{v.r(f),v.d(f,{Animation:()=>m});var m=(function(){function y(E,A,g,S){this.animation=E,this.artboard=A,this.playing=S,this.loopCount=0,this.scrubTo=null,this.instance=new g.LinearAnimationInstance(E,A)}return Object.defineProperty(y.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"time",{get:function(){return this.instance.time},set:function(E){this.instance.time=E},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),y.prototype.advance=function(E){this.scrubTo===null?this.instance.advance(E):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},y.prototype.apply=function(E){this.instance.apply(E)},y.prototype.cleanup=function(){this.instance.delete()},y})()}),((c,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>E.AudioAssetWrapper,AudioWrapper:()=>E.AudioWrapper,BLANK_URL:()=>y.BLANK_URL,CustomFileAssetLoaderWrapper:()=>E.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>E.FileAssetWrapper,Finalizable:()=>E.Finalizable,FontAssetWrapper:()=>E.FontAssetWrapper,FontWrapper:()=>E.FontWrapper,ImageAssetWrapper:()=>E.ImageAssetWrapper,ImageWrapper:()=>E.ImageWrapper,finalizationRegistry:()=>E.finalizationRegistry,registerTouchInteractions:()=>m.registerTouchInteractions,sanitizeUrl:()=>y.sanitizeUrl});var m=v(6),y=v(7),E=v(8)}),((c,f,v)=>{v.r(f),v.d(f,{registerTouchInteractions:()=>E});var m=void 0,y=function(A,g){var S,O;return["touchstart","touchmove"].indexOf(A.type)>-1&&(!((S=A.touches)===null||S===void 0)&&S.length)?(g||A.preventDefault(),{clientX:A.touches[0].clientX,clientY:A.touches[0].clientY}):A.type==="touchend"&&(!((O=A.changedTouches)===null||O===void 0)&&O.length)?{clientX:A.changedTouches[0].clientX,clientY:A.changedTouches[0].clientY}:{clientX:A.clientX,clientY:A.clientY}},E=function(A){var g=A.canvas,S=A.artboard,O=A.stateMachines,M=O===void 0?[]:O,H=A.renderer,B=A.rive,U=A.fit,L=A.alignment,z=A.isTouchScrollEnabled,x=z===void 0?!1:z,F=A.layoutScaleFactor,ee=F===void 0?1:F;if(!g||!M.length||!H||!B||!S||typeof window>"u")return null;var X=null,se=!1,Y=function(Ee){if(se&&Ee instanceof MouseEvent){Ee.type=="mouseup"&&(se=!1);return}se=x&&Ee.type==="touchend"&&X==="touchstart",X=Ee.type;var je=Ee.currentTarget.getBoundingClientRect(),Ne=y(Ee,x),kt=Ne.clientX,ge=Ne.clientY;if(!(!kt&&!ge)){var on=kt-je.left,Ce=ge-je.top,ye=B.computeAlignment(U,L,{minX:0,minY:0,maxX:je.width,maxY:je.height},S.bounds,ee),Qe=new B.Mat2D;ye.invert(Qe);var St=new B.Vec2D(on,Ce),me=B.mapXY(Qe,St),Te=me.x(),Ct=me.y();switch(me.delete(),Qe.delete(),St.delete(),ye.delete(),Ee.type){case"mouseout":for(var xe=0,ht=M;xe<ht.length;xe++){var Be=ht[xe];Be.pointerMove(Te,Ct)}break;case"touchmove":case"mouseover":case"mousemove":{for(var Ht=0,an=M;Ht<an.length;Ht++){var Be=an[Ht];Be.pointerMove(Te,Ct)}break}case"touchstart":case"mousedown":{for(var zt=0,An=M;zt<An.length;zt++){var Be=An[zt];Be.pointerDown(Te,Ct)}break}case"touchend":case"mouseup":{for(var st=0,Tt=M;st<Tt.length;st++){var Be=Tt[st];Be.pointerUp(Te,Ct)}break}}}},ae=Y.bind(m);return g.addEventListener("mouseover",ae),g.addEventListener("mouseout",ae),g.addEventListener("mousemove",ae),g.addEventListener("mousedown",ae),g.addEventListener("mouseup",ae),g.addEventListener("touchmove",ae,{passive:x}),g.addEventListener("touchstart",ae,{passive:x}),g.addEventListener("touchend",ae),function(){g.removeEventListener("mouseover",ae),g.removeEventListener("mouseout",ae),g.removeEventListener("mousemove",ae),g.removeEventListener("mousedown",ae),g.removeEventListener("mouseup",ae),g.removeEventListener("touchmove",ae),g.removeEventListener("touchstart",ae),g.removeEventListener("touchend",ae)}}}),((c,f,v)=>{v.r(f),v.d(f,{BLANK_URL:()=>O,sanitizeUrl:()=>B});var m=/^([^\w]*)(javascript|data|vbscript)/im,y=/&#(\w+)(^\w|;)?/g,E=/&(newline|tab);/gi,A=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,g=/^.+(:|&colon;)/gim,S=[".","/"],O="about:blank";function M(U){return S.indexOf(U[0])>-1}function H(U){var L=U.replace(A,"");return L.replace(y,function(z,x){return String.fromCharCode(x)})}function B(U){if(!U)return O;var L=H(U).replace(E,"").replace(A,"").trim();if(!L)return O;if(M(L))return L;var z=L.match(g);if(!z)return L;var x=z[0];return m.test(x)?O:L}}),((c,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>H,AudioWrapper:()=>A,CustomFileAssetLoaderWrapper:()=>S,FileAssetWrapper:()=>O,Finalizable:()=>y,FontAssetWrapper:()=>B,FontWrapper:()=>g,ImageAssetWrapper:()=>M,ImageWrapper:()=>E,finalizationRegistry:()=>z});var m=(function(){var x=function(F,ee){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,se){X.__proto__=se}||function(X,se){for(var Y in se)Object.prototype.hasOwnProperty.call(se,Y)&&(X[Y]=se[Y])},x(F,ee)};return function(F,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");x(F,ee);function X(){this.constructor=F}F.prototype=ee===null?Object.create(ee):(X.prototype=ee.prototype,new X)}})(),y=(function(){function x(){this.selfUnref=!1}return x})(),E=(function(x){m(F,x);function F(ee){var X=x.call(this)||this;return X._nativeImage=ee,X}return Object.defineProperty(F.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),F.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},F})(y),A=(function(x){m(F,x);function F(ee){var X=x.call(this)||this;return X._nativeAudio=ee,X}return Object.defineProperty(F.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),F.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},F})(y),g=(function(x){m(F,x);function F(ee){var X=x.call(this)||this;return X._nativeFont=ee,X}return Object.defineProperty(F.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),F.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},F})(y),S=(function(){function x(F,ee){this._assetLoaderCallback=ee,this.assetLoader=new F.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return x.prototype.loadContents=function(F,ee){var X;return F.isImage?X=new M(F):F.isAudio?X=new H(F):F.isFont&&(X=new B(F)),this._assetLoaderCallback(X,ee)},x})(),O=(function(){function x(F){this._nativeFileAsset=F}return x.prototype.decode=function(F){this._nativeFileAsset.decode(F)},Object.defineProperty(x.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),x})(),M=(function(x){m(F,x);function F(){return x!==null&&x.apply(this,arguments)||this}return F.prototype.setRenderImage=function(ee){this._nativeFileAsset.setRenderImage(ee.nativeImage)},F})(O),H=(function(x){m(F,x);function F(){return x!==null&&x.apply(this,arguments)||this}return F.prototype.setAudioSource=function(ee){this._nativeFileAsset.setAudioSource(ee.nativeAudio)},F})(O),B=(function(x){m(F,x);function F(){return x!==null&&x.apply(this,arguments)||this}return F.prototype.setFont=function(ee){this._nativeFileAsset.setFont(ee.nativeFont)},F})(O),U=(function(){function x(F){}return x.prototype.register=function(F){F.selfUnref=!0},x.prototype.unregister=function(F){},x})(),L=typeof FinalizationRegistry<"u"?FinalizationRegistry:U,z=new L(function(x){x.unref()})})],r={};function o(c){var f=r[c];if(f!==void 0)return f.exports;var v=r[c]={exports:{}};return t[c](v,v.exports,o),v.exports}o.d=(c,f)=>{for(var v in f)o.o(f,v)&&!o.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:f[v]})},o.o=(c,f)=>Object.prototype.hasOwnProperty.call(c,f),o.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var u={};return(()=>{o.r(u),o.d(u,{Alignment:()=>B,DataEnum:()=>Ct,EventType:()=>Y,Fit:()=>H,Layout:()=>U,LoopType:()=>ae,Rive:()=>me,RiveEventType:()=>F,RiveFile:()=>St,RuntimeLoader:()=>L,StateMachineInput:()=>x,StateMachineInputType:()=>z,Testing:()=>Ni,ViewModel:()=>Te,ViewModelInstance:()=>ht,ViewModelInstanceArtboard:()=>Gt,ViewModelInstanceAssetImage:()=>mr,ViewModelInstanceBoolean:()=>zt,ViewModelInstanceColor:()=>un,ViewModelInstanceEnum:()=>st,ViewModelInstanceList:()=>Tt,ViewModelInstanceNumber:()=>an,ViewModelInstanceString:()=>Ht,ViewModelInstanceTrigger:()=>An,ViewModelInstanceValue:()=>Be,decodeAudio:()=>Kr,decodeFont:()=>ln,decodeImage:()=>Bi});var c=o(1),f=o(2),v=o(3),m=o(5),y=(function(){var p=function(a,h){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,T){w.__proto__=T}||function(w,T){for(var j in T)Object.prototype.hasOwnProperty.call(T,j)&&(w[j]=T[j])},p(a,h)};return function(a,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");p(a,h);function w(){this.constructor=a}a.prototype=h===null?Object.create(h):(w.prototype=h.prototype,new w)}})(),E=function(){return E=Object.assign||function(p){for(var a,h=1,w=arguments.length;h<w;h++){a=arguments[h];for(var T in a)Object.prototype.hasOwnProperty.call(a,T)&&(p[T]=a[T])}return p},E.apply(this,arguments)},A=function(p,a,h,w){function T(j){return j instanceof h?j:new h(function($){$(j)})}return new(h||(h=Promise))(function(j,$){function ne(fe){try{Z(w.next(fe))}catch(Ie){$(Ie)}}function oe(fe){try{Z(w.throw(fe))}catch(Ie){$(Ie)}}function Z(fe){fe.done?j(fe.value):T(fe.value).then(ne,oe)}Z((w=w.apply(p,a||[])).next())})},g=function(p,a){var h={label:0,sent:function(){if(j[0]&1)throw j[1];return j[1]},trys:[],ops:[]},w,T,j,$=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return $.next=ne(0),$.throw=ne(1),$.return=ne(2),typeof Symbol=="function"&&($[Symbol.iterator]=function(){return this}),$;function ne(Z){return function(fe){return oe([Z,fe])}}function oe(Z){if(w)throw new TypeError("Generator is already executing.");for(;$&&($=0,Z[0]&&(h=0)),h;)try{if(w=1,T&&(j=Z[0]&2?T.return:Z[0]?T.throw||((j=T.return)&&j.call(T),0):T.next)&&!(j=j.call(T,Z[1])).done)return j;switch(T=0,j&&(Z=[Z[0]&2,j.value]),Z[0]){case 0:case 1:j=Z;break;case 4:return h.label++,{value:Z[1],done:!1};case 5:h.label++,T=Z[1],Z=[0];continue;case 7:Z=h.ops.pop(),h.trys.pop();continue;default:if(j=h.trys,!(j=j.length>0&&j[j.length-1])&&(Z[0]===6||Z[0]===2)){h=0;continue}if(Z[0]===3&&(!j||Z[1]>j[0]&&Z[1]<j[3])){h.label=Z[1];break}if(Z[0]===6&&h.label<j[1]){h.label=j[1],j=Z;break}if(j&&h.label<j[2]){h.label=j[2],h.ops.push(Z);break}j[2]&&h.ops.pop(),h.trys.pop();continue}Z=a.call(p,h)}catch(fe){Z=[6,fe],T=0}finally{w=j=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}},S=function(p,a,h){if(h||arguments.length===2)for(var w=0,T=a.length,j;w<T;w++)(j||!(w in a))&&(j||(j=Array.prototype.slice.call(a,0,w)),j[w]=a[w]);return p.concat(j||Array.prototype.slice.call(a))},O=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h.isHandledError=!0,h}return a})(Error),M=function(p){return p&&p.isHandledError?p.message:"Problem loading file; may be corrupt!"},H;(function(p){p.Cover="cover",p.Contain="contain",p.Fill="fill",p.FitWidth="fitWidth",p.FitHeight="fitHeight",p.None="none",p.ScaleDown="scaleDown",p.Layout="layout"})(H||(H={}));var B;(function(p){p.Center="center",p.TopLeft="topLeft",p.TopCenter="topCenter",p.TopRight="topRight",p.CenterLeft="centerLeft",p.CenterRight="centerRight",p.BottomLeft="bottomLeft",p.BottomCenter="bottomCenter",p.BottomRight="bottomRight"})(B||(B={}));var U=(function(){function p(a){var h,w,T,j,$,ne,oe;this.fit=(h=a?.fit)!==null&&h!==void 0?h:H.Contain,this.alignment=(w=a?.alignment)!==null&&w!==void 0?w:B.Center,this.layoutScaleFactor=(T=a?.layoutScaleFactor)!==null&&T!==void 0?T:1,this.minX=(j=a?.minX)!==null&&j!==void 0?j:0,this.minY=($=a?.minY)!==null&&$!==void 0?$:0,this.maxX=(ne=a?.maxX)!==null&&ne!==void 0?ne:0,this.maxY=(oe=a?.maxY)!==null&&oe!==void 0?oe:0}return p.new=function(a){var h=a.fit,w=a.alignment,T=a.minX,j=a.minY,$=a.maxX,ne=a.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new p({fit:h,alignment:w,minX:T,minY:j,maxX:$,maxY:ne})},p.prototype.copyWith=function(a){var h=a.fit,w=a.alignment,T=a.layoutScaleFactor,j=a.minX,$=a.minY,ne=a.maxX,oe=a.maxY;return new p({fit:h??this.fit,alignment:w??this.alignment,layoutScaleFactor:T??this.layoutScaleFactor,minX:j??this.minX,minY:$??this.minY,maxX:ne??this.maxX,maxY:oe??this.maxY})},p.prototype.runtimeFit=function(a){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var h;return this.fit===H.Cover?h=a.Fit.cover:this.fit===H.Contain?h=a.Fit.contain:this.fit===H.Fill?h=a.Fit.fill:this.fit===H.FitWidth?h=a.Fit.fitWidth:this.fit===H.FitHeight?h=a.Fit.fitHeight:this.fit===H.ScaleDown?h=a.Fit.scaleDown:this.fit===H.Layout?h=a.Fit.layout:h=a.Fit.none,this.cachedRuntimeFit=h,h},p.prototype.runtimeAlignment=function(a){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var h;return this.alignment===B.TopLeft?h=a.Alignment.topLeft:this.alignment===B.TopCenter?h=a.Alignment.topCenter:this.alignment===B.TopRight?h=a.Alignment.topRight:this.alignment===B.CenterLeft?h=a.Alignment.centerLeft:this.alignment===B.CenterRight?h=a.Alignment.centerRight:this.alignment===B.BottomLeft?h=a.Alignment.bottomLeft:this.alignment===B.BottomCenter?h=a.Alignment.bottomCenter:this.alignment===B.BottomRight?h=a.Alignment.bottomRight:h=a.Alignment.center,this.cachedRuntimeAlignment=h,h},p})(),L=(function(){function p(){}return p.loadRuntime=function(){c.default({locateFile:function(){return p.wasmURL}}).then(function(a){var h;for(p.runtime=a;p.callBackQueue.length>0;)(h=p.callBackQueue.shift())===null||h===void 0||h(p.runtime)}).catch(function(a){var h={message:a?.message||"Unknown error",type:a?.name||"Error",wasmError:a instanceof WebAssembly.CompileError||a instanceof WebAssembly.RuntimeError,originalError:a};console.debug("Rive WASM load error details:",h);var w="https://cdn.jsdelivr.net/npm/".concat(f.name,"@").concat(f.version,"/rive_fallback.wasm");if(p.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(p.wasmURL," (").concat(h.message,"), trying jsdelivr as a backup")),p.setWasmUrl(w),p.loadRuntime();else{var T=["Could not load Rive WASM file from ".concat(p.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(h.type),"- Message: ".concat(h.message),"- WebAssembly-specific error: ".concat(h.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(T)}})},p.getInstance=function(a){p.isLoading||(p.isLoading=!0,p.loadRuntime()),p.runtime?a(p.runtime):p.callBackQueue.push(a)},p.awaitInstance=function(){return new Promise(function(a){return p.getInstance(function(h){return a(h)})})},p.setWasmUrl=function(a){p.wasmURL=a},p.getWasmUrl=function(){return p.wasmURL},p.isLoading=!1,p.callBackQueue=[],p.wasmURL="https://unpkg.com/".concat(f.name,"@").concat(f.version,"/rive.wasm"),p})(),z;(function(p){p[p.Number=56]="Number",p[p.Trigger=58]="Trigger",p[p.Boolean=59]="Boolean"})(z||(z={}));var x=(function(){function p(a,h){this.type=a,this.runtimeInput=h}return Object.defineProperty(p.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(a){this.runtimeInput.value=a},enumerable:!1,configurable:!0}),p.prototype.fire=function(){this.type===z.Trigger&&this.runtimeInput.fire()},p.prototype.delete=function(){this.runtimeInput=null},p})(),F;(function(p){p[p.General=128]="General",p[p.OpenUrl=131]="OpenUrl"})(F||(F={}));var ee=(function(){function p(a){this.nativeArtboard=a}return p})(),X=(function(){function p(a,h,w,T){this.stateMachine=a,this.playing=w,this.artboard=T,this.inputs=[],this.instance=new h.StateMachineInstance(a,T),this.initInputs(h)}return Object.defineProperty(p.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statesChanged",{get:function(){for(var a=[],h=0;h<this.instance.stateChangedCount();h++)a.push(this.instance.stateChangedNameByIndex(h));return a},enumerable:!1,configurable:!0}),p.prototype.advance=function(a){this.instance.advance(a)},p.prototype.advanceAndApply=function(a){this.instance.advanceAndApply(a)},p.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},p.prototype.reportedEventAt=function(a){return this.instance.reportedEventAt(a)},p.prototype.initInputs=function(a){for(var h=0;h<this.instance.inputCount();h++){var w=this.instance.input(h);this.inputs.push(this.mapRuntimeInput(w,a))}},p.prototype.mapRuntimeInput=function(a,h){if(a.type===h.SMIInput.bool)return new x(z.Boolean,a.asBool());if(a.type===h.SMIInput.number)return new x(z.Number,a.asNumber());if(a.type===h.SMIInput.trigger)return new x(z.Trigger,a.asTrigger())},p.prototype.cleanup=function(){this.inputs.forEach(function(a){a.delete()}),this.inputs.length=0,this.instance.delete()},p.prototype.bindViewModelInstance=function(a){a.runtimeInstance!=null&&this.instance.bindViewModelInstance(a.runtimeInstance)},p})(),se=(function(){function p(a,h,w,T,j){T===void 0&&(T=[]),j===void 0&&(j=[]),this.runtime=a,this.artboard=h,this.eventManager=w,this.animations=T,this.stateMachines=j}return p.prototype.add=function(a,h,w){if(w===void 0&&(w=!0),a=dt(a),a.length===0)this.animations.forEach(function(Ue){return Ue.playing=h}),this.stateMachines.forEach(function(Ue){return Ue.playing=h});else for(var T=this.animations.map(function(Ue){return Ue.name}),j=this.stateMachines.map(function(Ue){return Ue.name}),$=0;$<a.length;$++){var ne=T.indexOf(a[$]),oe=j.indexOf(a[$]);if(ne>=0||oe>=0)ne>=0?this.animations[ne].playing=h:this.stateMachines[oe].playing=h;else{var Z=this.artboard.animationByName(a[$]);if(Z){var fe=new v.Animation(Z,this.artboard,this.runtime,h);fe.advance(0),fe.apply(1),this.animations.push(fe)}else{var Ie=this.artboard.stateMachineByName(a[$]);if(Ie){var ze=new X(Ie,this.runtime,h,this.artboard);this.stateMachines.push(ze)}}}}return w&&(h?this.eventManager.fire({type:Y.Play,data:this.playing}):this.eventManager.fire({type:Y.Pause,data:this.paused})),h?this.playing:this.paused},p.prototype.initLinearAnimations=function(a,h){for(var w=this.animations.map(function(oe){return oe.name}),T=0;T<a.length;T++){var j=w.indexOf(a[T]);if(j>=0)this.animations[j].playing=h;else{var $=this.artboard.animationByName(a[T]);if($){var ne=new v.Animation($,this.artboard,this.runtime,h);ne.advance(0),ne.apply(1),this.animations.push(ne)}else console.error("Animation with name ".concat(a[T]," not found."))}}},p.prototype.initStateMachines=function(a,h){for(var w=this.stateMachines.map(function(oe){return oe.name}),T=0;T<a.length;T++){var j=w.indexOf(a[T]);if(j>=0)this.stateMachines[j].playing=h;else{var $=this.artboard.stateMachineByName(a[T]);if($){var ne=new X($,this.runtime,h,this.artboard);this.stateMachines.push(ne),h||ne.advanceAndApply(0)}else console.warn("State Machine with name ".concat(a[T]," not found.")),this.initLinearAnimations([a[T]],h)}}},p.prototype.play=function(a){return this.add(a,!0)},p.prototype.pause=function(a){return this.add(a,!1)},p.prototype.scrub=function(a,h){var w=this.animations.filter(function(T){return a.includes(T.name)});return w.forEach(function(T){return T.scrubTo=h}),w.map(function(T){return T.name})},Object.defineProperty(p.prototype,"playing",{get:function(){return this.animations.filter(function(a){return a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"paused",{get:function(){return this.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),p.prototype.stop=function(a){var h=this;a=dt(a);var w=[];if(a.length===0)w=this.animations.map(function($){return $.name}).concat(this.stateMachines.map(function($){return $.name})),this.animations.forEach(function($){return $.cleanup()}),this.stateMachines.forEach(function($){return $.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var T=this.animations.filter(function($){return a.includes($.name)});T.forEach(function($){$.cleanup(),h.animations.splice(h.animations.indexOf($),1)});var j=this.stateMachines.filter(function($){return a.includes($.name)});j.forEach(function($){$.cleanup(),h.stateMachines.splice(h.stateMachines.indexOf($),1)}),w=T.map(function($){return $.name}).concat(j.map(function($){return $.name}))}return this.eventManager.fire({type:Y.Stop,data:w}),w},Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(a,h){return a||h.playing},!1)||this.stateMachines.reduce(function(a,h){return a||h.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),p.prototype.atLeastOne=function(a,h){h===void 0&&(h=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],a,h):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],a,h)),w},p.prototype.handleLooping=function(){for(var a=0,h=this.animations.filter(function(T){return T.playing});a<h.length;a++){var w=h[a];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:Y.Loop,data:{animation:w.name,type:ae.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:Y.Loop,data:{animation:w.name,type:ae.PingPong}}),w.loopCount=0)}},p.prototype.handleStateChanges=function(){for(var a=[],h=0,w=this.stateMachines.filter(function(j){return j.playing});h<w.length;h++){var T=w[h];a.push.apply(a,T.statesChanged)}a.length>0&&this.eventManager.fire({type:Y.StateChange,data:a})},p.prototype.handleAdvancing=function(a){this.eventManager.fire({type:Y.Advance,data:a})},p})(),Y;(function(p){p.Load="load",p.LoadError="loaderror",p.Play="play",p.Pause="pause",p.Stop="stop",p.Loop="loop",p.Draw="draw",p.Advance="advance",p.StateChange="statechange",p.RiveEvent="riveevent",p.AudioStatusChange="audiostatuschange"})(Y||(Y={}));var ae;(function(p){p.OneShot="oneshot",p.Loop="loop",p.PingPong="pingpong"})(ae||(ae={}));var Ee=(function(){function p(a){a===void 0&&(a=[]),this.listeners=a}return p.prototype.getListeners=function(a){return this.listeners.filter(function(h){return h.type===a})},p.prototype.add=function(a){this.listeners.includes(a)||this.listeners.push(a)},p.prototype.remove=function(a){for(var h=0;h<this.listeners.length;h++){var w=this.listeners[h];if(w.type===a.type&&w.callback===a.callback){this.listeners.splice(h,1);break}}},p.prototype.removeAll=function(a){var h=this;a?this.listeners.filter(function(w){return w.type===a}).forEach(function(w){return h.remove(w)}):this.listeners.splice(0,this.listeners.length)},p.prototype.fire=function(a){var h=this.getListeners(a.type);h.forEach(function(w){return w.callback(a)})},p})(),je=(function(){function p(a){this.eventManager=a,this.queue=[]}return p.prototype.add=function(a){this.queue.push(a)},p.prototype.process=function(){for(;this.queue.length>0;){var a=this.queue.shift();a?.action&&a.action(),a?.event&&this.eventManager.fire(a.event)}},p})(),Ne;(function(p){p[p.AVAILABLE=0]="AVAILABLE",p[p.UNAVAILABLE=1]="UNAVAILABLE"})(Ne||(Ne={}));var kt=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h._started=!1,h._enabled=!1,h._status=Ne.UNAVAILABLE,h}return a.prototype.delay=function(h){return A(this,void 0,void 0,function(){return g(this,function(w){return[2,new Promise(function(T){return setTimeout(T,h)})]})})},a.prototype.timeout=function(){return A(this,void 0,void 0,function(){return g(this,function(h){return[2,new Promise(function(w,T){return setTimeout(T,50)})]})})},a.prototype.reportToListeners=function(){this.fire({type:Y.AudioStatusChange}),this.removeAll()},a.prototype.enableAudio=function(){return A(this,void 0,void 0,function(){return g(this,function(h){return this._enabled||(this._enabled=!0,this._status=Ne.AVAILABLE,this.reportToListeners()),[2]})})},a.prototype.testAudio=function(){return A(this,void 0,void 0,function(){return g(this,function(h){switch(h.label){case 0:if(!(this._status===Ne.UNAVAILABLE&&this._audioContext!==null))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return h.sent(),this.enableAudio(),[3,4];case 3:return h.sent(),[3,4];case 4:return[2]}})})},a.prototype._establishAudio=function(){return A(this,void 0,void 0,function(){return g(this,function(h){switch(h.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),h.label=2;case 2:return this._status!==Ne.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return h.sent(),[4,this.delay(1e3)];case 4:return h.sent(),[3,2];case 5:return[2]}})})},a.prototype.listenForUserAction=function(){var h=this,w=function(){return A(h,void 0,void 0,function(){return g(this,function(T){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},a.prototype.establishAudio=function(){return A(this,void 0,void 0,function(){return g(this,function(h){return this._establishAudio(),[2]})})},Object.defineProperty(a.prototype,"systemVolume",{get:function(){return this._status===Ne.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),a})(Ee),ge=new kt,on=(function(){function p(){}return p.prototype.observe=function(){},p.prototype.unobserve=function(){},p.prototype.disconnect=function(){},p})(),Ce=globalThis.ResizeObserver||on,ye=(function(){function p(){var a=this;this._elementsMap=new Map,this._onObservedEntry=function(h){var w=a._elementsMap.get(h.target);w!==null?w.onResize(h.target.clientWidth==0||h.target.clientHeight==0):a._resizeObserver.unobserve(h.target)},this._onObserved=function(h){h.forEach(a._onObservedEntry)},this._resizeObserver=new Ce(this._onObserved)}return p.prototype.add=function(a,h){var w={onResize:h,element:a};return this._elementsMap.set(a,w),this._resizeObserver.observe(a),w},p.prototype.remove=function(a){this._resizeObserver.unobserve(a.element),this._elementsMap.delete(a.element)},p})(),Qe=new ye,St=(function(){function p(a){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=a.src,this.buffer=a.buffer,a.assetLoader&&(this.assetLoader=a.assetLoader),this.enableRiveAssetCDN=typeof a.enableRiveAssetCDN=="boolean"?a.enableRiveAssetCDN:!0,this.eventManager=new Ee,a.onLoad&&this.on(Y.Load,a.onLoad),a.onLoadError&&this.on(Y.LoadError,a.onLoadError)}return p.prototype.initData=function(){return A(this,void 0,void 0,function(){var a,h,w,T,j;return g(this,function($){switch($.label){case 0:return this.src?(a=this,[4,Gr(this.src)]):[3,2];case 1:a.buffer=$.sent(),$.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new m.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),h=w.assetLoader),T=this,[4,this.runtime.load(new Uint8Array(this.buffer),h,this.enableRiveAssetCDN)]);case 3:return T.file=$.sent(),this.destroyed?((j=this.file)===null||j===void 0||j.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:Y.Load,data:this}):this.fireLoadError(p.fileLoadErrorMessage),[2])}})})},p.prototype.init=function(){return A(this,void 0,void 0,function(){var a,h;return g(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(p.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),a=this,[4,L.awaitInstance()];case 2:return a.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return h=w.sent(),this.fireLoadError(h instanceof Error?h.message:p.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},p.prototype.fireLoadError=function(a){throw this.eventManager.fire({type:Y.LoadError,data:a}),new Error(a)},p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.cleanup=function(){var a;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(a=this.file)===null||a===void 0||a.delete(),this.file=null,this.destroyed=!0)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},p.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},p.prototype.getArtboard=function(a){var h=this.file.artboardByName(a);return h!=null?new ee(h):null},p.missingErrorMessage="Rive source file or data buffer required",p.fileLoadErrorMessage="The file failed to load",p})(),me=(function(){function p(a){var h=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(T){var j=h._hasZeroSize!==T;h._hasZeroSize=T,T?(!h._layout.maxX||!h._layout.maxY)&&h.resizeToCanvas():j&&h.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=a.canvas,a.canvas.constructor===HTMLCanvasElement&&(this._observed=Qe.add(this.canvas,this.onCanvasResize)),this.src=a.src,this.buffer=a.buffer,this.riveFile=a.riveFile,this.layout=(w=a.layout)!==null&&w!==void 0?w:new U,this.shouldDisableRiveListeners=!!a.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!a.isTouchScrollEnabled,this.automaticallyHandleEvents=!!a.automaticallyHandleEvents,this.enableRiveAssetCDN=a.enableRiveAssetCDN===void 0?!0:a.enableRiveAssetCDN,this.eventManager=new Ee,a.onLoad&&this.on(Y.Load,a.onLoad),a.onLoadError&&this.on(Y.LoadError,a.onLoadError),a.onPlay&&this.on(Y.Play,a.onPlay),a.onPause&&this.on(Y.Pause,a.onPause),a.onStop&&this.on(Y.Stop,a.onStop),a.onLoop&&this.on(Y.Loop,a.onLoop),a.onStateChange&&this.on(Y.StateChange,a.onStateChange),a.onAdvance&&this.on(Y.Advance,a.onAdvance),a.onload&&!a.onLoad&&this.on(Y.Load,a.onload),a.onloaderror&&!a.onLoadError&&this.on(Y.LoadError,a.onloaderror),a.onplay&&!a.onPlay&&this.on(Y.Play,a.onplay),a.onpause&&!a.onPause&&this.on(Y.Pause,a.onpause),a.onstop&&!a.onStop&&this.on(Y.Stop,a.onstop),a.onloop&&!a.onLoop&&this.on(Y.Loop,a.onloop),a.onstatechange&&!a.onStateChange&&this.on(Y.StateChange,a.onstatechange),a.assetLoader&&(this.assetLoader=a.assetLoader),this.taskQueue=new je(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:a.autoplay,autoBind:a.autoBind,animations:a.animations,stateMachines:a.stateMachines,artboard:a.artboard,useOffscreenRenderer:a.useOffscreenRenderer})}return Object.defineProperty(p.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),p.new=function(a){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new p(a)},p.prototype.onSystemAudioChanged=function(){this.volume=this._volume},p.prototype.init=function(a){var h=this,w=a.src,T=a.buffer,j=a.riveFile,$=a.animations,ne=a.stateMachines,oe=a.artboard,Z=a.autoplay,fe=Z===void 0?!1:Z,Ie=a.useOffscreenRenderer,ze=Ie===void 0?!1:Ie,Ue=a.autoBind,Pt=Ue===void 0?!1:Ue;if(!this.destroyed){if(this.src=w,this.buffer=T,this.riveFile=j,!this.src&&!this.buffer&&!this.riveFile)throw new O(p.missingErrorMessage);var gt=dt($),ot=dt(ne);this.loaded=!1,this.readyForPlaying=!1,L.awaitInstance().then(function(at){h.destroyed||(h.runtime=at,h.removeRiveListeners(),h.deleteRiveRenderer(),h.renderer=h.runtime.makeRenderer(h.canvas,ze),h.canvas.width||h.canvas.height||h.resizeDrawingSurfaceToCanvas(),h.initData(oe,gt,ot,fe,Pt).then(function(mt){if(mt)return h.setupRiveListeners()}).catch(function(mt){console.error(mt)}))}).catch(function(at){console.error(at)})}},p.prototype.setupRiveListeners=function(a){var h=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(j){return j.playing&&h.runtime.hasListeners(j.instance)}).map(function(j){return j.instance}),T=this.isTouchScrollEnabled;a&&"isTouchScrollEnabled"in a&&(T=a.isTouchScrollEnabled),this.eventCleanup=(0,m.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:T,layoutScaleFactor:this._layout.layoutScaleFactor})}},p.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},p.prototype.initializeAudio=function(){var a=this,h;ge.status==Ne.UNAVAILABLE&&!((h=this.artboard)===null||h===void 0)&&h.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:Y.AudioStatusChange,callback:function(){return a.onSystemAudioChanged()}},ge.add(this._audioEventListener),ge.establishAudio())},p.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},p.prototype.initData=function(a,h,w,T,j){return A(this,void 0,void 0,function(){var $,ne,oe,Z;return g(this,function(fe){switch(fe.label){case 0:return fe.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:($=new St({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=$,[4,$.init()]);case 1:if(fe.sent(),this.destroyed)return $.destroyIfUnused(),[2,!1];fe.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(a,h,w,T,j),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:Y.Load,data:(Z=this.src)!==null&&Z!==void 0?Z:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return ne=fe.sent(),oe=M(ne),console.warn(oe),this.eventManager.fire({type:Y.LoadError,data:oe}),[2,Promise.reject(oe)];case 4:return[2]}})})},p.prototype.initArtboard=function(a,h,w,T,j){if(this.file){var $=a?this.file.artboardByName(a):this.file.defaultArtboard();if(!$){var ne="Invalid artboard name or no default artboard";console.warn(ne),this.eventManager.fire({type:Y.LoadError,data:ne});return}if(this.artboard=$,$.volume=this._volume*ge.systemVolume,this.artboard.animationCount()<1){var ne="Artboard has no animations";throw this.eventManager.fire({type:Y.LoadError,data:ne}),ne}this.animator=new se(this.runtime,this.artboard,this.eventManager);var oe;if(h.length>0||w.length>0?(oe=h.concat(w),this.animator.initLinearAnimations(h,T),this.animator.initStateMachines(w,T)):oe=[this.animator.atLeastOne(T,!1)],this.taskQueue.add({event:{type:T?Y.Play:Y.Pause,data:oe}}),j){var Z=this.file.defaultArtboardViewModel($);if(Z!==null){var fe=Z.defaultInstance();if(fe!==null){var Ie=new ht(fe,null);this.bindViewModelInstance(Ie)}}}}},p.prototype.drawFrame=function(){var a,h;!((a=document?.timeline)===null||a===void 0)&&a.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(h=this.runtime)===null||h===void 0||h.resolveAnimationFrame()):this.startRendering()},p.prototype.draw=function(a,h){var w;this.frameRequestId=null;var T=performance.now();this.lastRenderTime||(this.lastRenderTime=a),this.renderSecondTimer+=a-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,h?.());var j=(a-this.lastRenderTime)/1e3;this.lastRenderTime=a;for(var $=this.animator.animations.filter(function(Ut){return Ut.playing||Ut.needsScrub}).sort(function(Ut){return Ut.needsScrub?-1:1}),ne=0,oe=$;ne<oe.length;ne++){var Z=oe[ne];Z.advance(j),Z.instance.didLoop&&(Z.loopCount+=1),Z.apply(1)}for(var fe=this.animator.stateMachines.filter(function(Ut){return Ut.playing}),Ie=0,ze=fe;Ie<ze.length;Ie++){var Ue=ze[Ie],Pt=Ue.reportedEventCount();if(Pt)for(var gt=0;gt<Pt;gt++){var ot=Ue.reportedEventAt(gt);if(ot)if(ot.type===F.OpenUrl){if(this.eventManager.fire({type:Y.RiveEvent,data:ot}),this.automaticallyHandleEvents){var at=document.createElement("a"),mt=ot,cn=mt.url,hn=mt.target,Ft=(0,m.sanitizeUrl)(cn);cn&&at.setAttribute("href",Ft),hn&&at.setAttribute("target",hn),Ft&&Ft!==m.BLANK_URL&&at.click()}}else this.eventManager.fire({type:Y.RiveEvent,data:ot})}Ue.advanceAndApply(j)}this.animator.stateMachines.length==0&&this.artboard.advance(j);var ie=this.renderer;ie.clear(),ie.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(ie),ie.restore(),ie.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(j),this.frameCount++;var Ae=performance.now();for(this.frameTimes.push(Ae),this.durations.push(Ae-T);this.frameTimes[0]<=Ae-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},p.prototype.alignRenderer=function(){var a=this,h=a.renderer,w=a.runtime,T=a._layout,j=a.artboard;h.align(T.runtimeFit(w),T.runtimeAlignment(w),{minX:T.minX,minY:T.minY,maxX:T.maxX,maxY:T.maxY},j.bounds,this._devicePixelRatioUsed*T.layoutScaleFactor)},Object.defineProperty(p.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(a,h){return a+h},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),p.prototype.cleanup=function(){var a,h;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&Qe.remove(this._observed),this.removeRiveListeners(),this.file&&((a=this.riveFile)===null||a===void 0||a.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(ge.remove(this._audioEventListener),this._audioEventListener=null),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=null,this._dataEnums=null},p.prototype.deleteRiveRenderer=function(){var a;(a=this.renderer)===null||a===void 0||a.delete(),this.renderer=null},p.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},p.prototype.retrieveTextRun=function(a){var h;if(!a){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(a);if(!w){console.warn("Could not access a text run with name '".concat(a,"' in the '").concat((h=this.artboard)===null||h===void 0?void 0:h.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},p.prototype.getTextRunValue=function(a){var h=this.retrieveTextRun(a);return h?h.text:void 0},p.prototype.setTextRunValue=function(a,h){var w=this.retrieveTextRun(a);w&&(w.text=h)},p.prototype.play=function(a,h){var w=this;if(a=dt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(a,h)}});return}this.animator.play(a),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},p.prototype.pause=function(a){var h=this;if(a=dt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.pause(a)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(a)},p.prototype.scrub=function(a,h){var w=this;if(a=dt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(a,h)}});return}this.animator.scrub(a,h||0),this.drawFrame()},p.prototype.stop=function(a){var h=this;if(a=dt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.stop(a)}});return}this.animator&&this.animator.stop(a),this.eventCleanup&&this.eventCleanup()},p.prototype.reset=function(a){var h,w,T=a?.artboard,j=dt(a?.animations),$=dt(a?.stateMachines),ne=(h=a?.autoplay)!==null&&h!==void 0?h:!1,oe=(w=a?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(T,j,$,ne,oe),this.taskQueue.process()},p.prototype.load=function(a){this.file=null,this.stop(),this.init(a)},Object.defineProperty(p.prototype,"layout",{get:function(){return this._layout},set:function(a){this._layout=a,(!a.maxX||!a.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),p.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},p.prototype.resizeDrawingSurfaceToCanvas=function(a){if(this.canvas instanceof HTMLCanvasElement&&window){var h=this.canvas.getBoundingClientRect(),w=h.width,T=h.height,j=a||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=j,this.canvas.width=j*w,this.canvas.height=j*T,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===H.Layout){var $=this._layout.layoutScaleFactor;this.artboard.width=w/$,this.artboard.height=T/$}}},Object.defineProperty(p.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.animationCount();h++)a.push(this.artboard.animationByIndex(h).name);return a},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.stateMachineCount();h++)a.push(this.artboard.stateMachineByIndex(h).name);return a},enumerable:!1,configurable:!0}),p.prototype.stateMachineInputs=function(a){if(this.loaded){var h=this.animator.stateMachines.find(function(w){return w.name===a});return h?.inputs}},p.prototype.retrieveInputAtPath=function(a,h){if(!a){console.warn("No input name provided for path '".concat(h,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(a,h);if(!w){console.warn("Could not access an input with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.setBooleanStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===z.Boolean?T.asBool().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a boolean")))},p.prototype.setNumberStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===z.Number?T.asNumber().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a number")))},p.prototype.fireStateAtPath=function(a,h){var w=this.retrieveInputAtPath(a,h);w&&(w.type===z.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(a,"', at path:'").concat(h,"' is not a trigger")))},p.prototype.retrieveTextAtPath=function(a,h){if(!a){console.warn("No text name provided for path '".concat(h,"'"));return}if(!h){console.warn("No path provided for text '".concat(a,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.textByPath(a,h);if(!w){console.warn("Could not access text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.getTextRunValueAtPath=function(a,h){var w=this.retrieveTextAtPath(a,h);if(!w){console.warn("Could not get text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w.text},p.prototype.setTextRunValueAtPath=function(a,h,w){var T=this.retrieveTextAtPath(a,w);if(!T){console.warn("Could not set text with name: '".concat(a,"', at path:'").concat(w,"'"));return}T.text=h},Object.defineProperty(p.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.unsubscribe=function(a,h){console.warn("This function is deprecated: please use `off()` instead."),this.off(a,h)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.unsubscribeAll=function(a){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(a)},p.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},p.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},p.prototype.enableFPSCounter=function(a){this.runtime.enableFPSCounter(a)},p.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(p.prototype,"contents",{get:function(){if(this.loaded){for(var a={artboards:[]},h=0;h<this.file.artboardCount();h++){for(var w=this.file.artboardByIndex(h),T={name:w.name,animations:[],stateMachines:[]},j=0;j<w.animationCount();j++){var $=w.animationByIndex(j);T.animations.push($.name)}for(var ne=0;ne<w.stateMachineCount();ne++){for(var oe=w.stateMachineByIndex(ne),Z=oe.name,fe=new this.runtime.StateMachineInstance(oe,w),Ie=[],ze=0;ze<fe.inputCount();ze++){var Ue=fe.input(ze);Ie.push({name:Ue.name,type:Ue.type})}T.stateMachines.push({name:Z,inputs:Ie})}a.artboards.push(T)}return a}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(a){this._volume=a,this.artboard&&(this.artboard.volume=a*ge.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardWidth",{get:function(){var a;return this.artboard?this.artboard.width:(a=this._artboardWidth)!==null&&a!==void 0?a:0},set:function(a){this._artboardWidth=a,this.artboard&&(this.artboard.width=a)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardHeight",{get:function(){var a;return this.artboard?this.artboard.height:(a=this._artboardHeight)!==null&&a!==void 0?a:0},set:function(a){this._artboardHeight=a,this.artboard&&(this.artboard.height=a)},enumerable:!1,configurable:!0}),p.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(p.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(a){this._devicePixelRatioUsed=a},enumerable:!1,configurable:!0}),p.prototype.bindViewModelInstance=function(a){var h;this.artboard&&!this.destroyed&&a&&a.runtimeInstance&&(a.internalIncrementReferenceCount(),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=a,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(a)}):this.artboard.bindViewModelInstance(a.runtimeInstance))},Object.defineProperty(p.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),p.prototype.viewModelByIndex=function(a){var h=this.file.viewModelByIndex(a);return h!==null?new Te(h):null},p.prototype.viewModelByName=function(a){var h=this.file.viewModelByName(a);return h!==null?new Te(h):null},p.prototype.enums=function(){if(this._dataEnums===null){var a=this.file.enums();this._dataEnums=a.map(function(h){return new Ct(h)})}return this._dataEnums},p.prototype.defaultViewModel=function(){if(this.artboard){var a=this.file.defaultArtboardViewModel(this.artboard);if(a)return new Te(a)}return null},p.prototype.getArtboard=function(a){var h,w;return(w=(h=this.riveFile)===null||h===void 0?void 0:h.getArtboard(a))!==null&&w!==void 0?w:null},p.missingErrorMessage="Rive source file or data buffer required",p.cleanupErrorMessage="Attempt to use file after calling cleanup.",p})(),Te=(function(){function p(a){this._viewModel=a}return Object.defineProperty(p.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),p.prototype.instanceByIndex=function(a){var h=this._viewModel.instanceByIndex(a);return h!==null?new ht(h,null):null},p.prototype.instanceByName=function(a){var h=this._viewModel.instanceByName(a);return h!==null?new ht(h,null):null},p.prototype.defaultInstance=function(){var a=this._viewModel.defaultInstance();return a!==null?new ht(a,null):null},p.prototype.instance=function(){var a=this._viewModel.instance();return a!==null?new ht(a,null):null},Object.defineProperty(p.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),p})(),Ct=(function(){function p(a){this._dataEnum=a}return Object.defineProperty(p.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),p})(),xe;(function(p){p.Number="number",p.String="string",p.Boolean="boolean",p.Color="color",p.Trigger="trigger",p.Enum="enum",p.List="list",p.Image="image",p.Artboard="artboard"})(xe||(xe={}));var ht=(function(){function p(a,h){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=a,h!==null&&this._parents.push(h)}return Object.defineProperty(p.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),p.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(a){a.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(a){a.clearChanges()})),this._children.forEach(function(a){return a.handleCallbacks()})},p.prototype.addParent=function(a){this._parents.includes(a)||(this._parents.push(a),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&a.addToViewModelCallbacks(this))},p.prototype.removeParent=function(a){var h=this._parents.indexOf(a);if(h!==-1){var w=this._parents[h];w.removeFromViewModelCallbacks(this),this._parents.splice(h,1)}},p.prototype.addToPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)||(this._propertiesWithCallbacks.push(a),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.addToViewModelCallbacks=function(a){var h=this;this._children.includes(a)||(this._children.push(a),this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromViewModelCallbacks=function(a){var h=this;this._children.includes(a)&&(this._children=this._children.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(a){a.clearCallbacks()})},p.prototype.propertyFromPath=function(a,h){var w=a.split("/");return this.propertyFromPathSegments(w,0,h)},p.prototype.viewModelFromPathSegments=function(a,h){var w=this.internalViewModelInstance(a[h]);return w!==null?h==a.length-1?w:w.viewModelFromPathSegments(a,h++):null},p.prototype.propertyFromPathSegments=function(a,h,w){var T,j,$,ne,oe,Z,fe,Ie,ze,Ue,Pt,gt,ot,at,mt,cn,hn,Ft;if(h<a.length-1){var ie=this.internalViewModelInstance(a[h]);return ie!==null?ie.propertyFromPathSegments(a,h+1,w):null}var Ae=null;switch(w){case xe.Number:if(Ae=(j=(T=this._runtimeInstance)===null||T===void 0?void 0:T.number(a[h]))!==null&&j!==void 0?j:null,Ae!==null)return new an(Ae,this);break;case xe.String:if(Ae=(ne=($=this._runtimeInstance)===null||$===void 0?void 0:$.string(a[h]))!==null&&ne!==void 0?ne:null,Ae!==null)return new Ht(Ae,this);break;case xe.Boolean:if(Ae=(Z=(oe=this._runtimeInstance)===null||oe===void 0?void 0:oe.boolean(a[h]))!==null&&Z!==void 0?Z:null,Ae!==null)return new zt(Ae,this);break;case xe.Color:if(Ae=(Ie=(fe=this._runtimeInstance)===null||fe===void 0?void 0:fe.color(a[h]))!==null&&Ie!==void 0?Ie:null,Ae!==null)return new un(Ae,this);break;case xe.Trigger:if(Ae=(Ue=(ze=this._runtimeInstance)===null||ze===void 0?void 0:ze.trigger(a[h]))!==null&&Ue!==void 0?Ue:null,Ae!==null)return new An(Ae,this);break;case xe.Enum:if(Ae=(gt=(Pt=this._runtimeInstance)===null||Pt===void 0?void 0:Pt.enum(a[h]))!==null&&gt!==void 0?gt:null,Ae!==null)return new st(Ae,this);break;case xe.List:if(Ae=(at=(ot=this._runtimeInstance)===null||ot===void 0?void 0:ot.list(a[h]))!==null&&at!==void 0?at:null,Ae!==null)return new Tt(Ae,this);break;case xe.Image:if(Ae=(cn=(mt=this._runtimeInstance)===null||mt===void 0?void 0:mt.image(a[h]))!==null&&cn!==void 0?cn:null,Ae!==null)return new mr(Ae,this);break;case xe.Artboard:if(Ae=(Ft=(hn=this._runtimeInstance)===null||hn===void 0?void 0:hn.artboard(a[h]))!==null&&Ft!==void 0?Ft:null,Ae!==null)return new Gt(Ae,this);break}return null},p.prototype.internalViewModelInstance=function(a){var h;if(this._viewModelInstances.has(a))return this._viewModelInstances.get(a);var w=(h=this._runtimeInstance)===null||h===void 0?void 0:h.viewModel(a);if(w!==null){var T=new p(w,this);return T.internalIncrementReferenceCount(),this._viewModelInstances.set(a,T),T}return null},p.prototype.number=function(a){var h=this.propertyFromPath(a,xe.Number);return h},p.prototype.string=function(a){var h=this.propertyFromPath(a,xe.String);return h},p.prototype.boolean=function(a){var h=this.propertyFromPath(a,xe.Boolean);return h},p.prototype.color=function(a){var h=this.propertyFromPath(a,xe.Color);return h},p.prototype.trigger=function(a){var h=this.propertyFromPath(a,xe.Trigger);return h},p.prototype.enum=function(a){var h=this.propertyFromPath(a,xe.Enum);return h},p.prototype.list=function(a){var h=this.propertyFromPath(a,xe.List);return h},p.prototype.image=function(a){var h=this.propertyFromPath(a,xe.Image);return h},p.prototype.artboard=function(a){var h=this.propertyFromPath(a,xe.Artboard);return h},p.prototype.viewModel=function(a){var h=a.split("/"),w=h.length>1?this.viewModelFromPathSegments(h.slice(0,h.length-1),0):this;return w!=null?w.internalViewModelInstance(h[h.length-1]):null},p.prototype.internalReplaceViewModel=function(a,h){var w;if(h.runtimeInstance!==null){var T=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(a,h.runtimeInstance))||!1;if(T){h.internalIncrementReferenceCount();var j=this.internalViewModelInstance(a);j!==null&&(j.removeParent(this),this._children.includes(j)&&(this._children=this._children.filter(function($){return $!==j})),j.cleanup()),this._viewModelInstances.set(a,h),h.addParent(this)}return T}return!1},p.prototype.replaceViewModel=function(a,h){var w,T=a.split("/"),j=T.length>1?this.viewModelFromPathSegments(T.slice(0,T.length-1),0):this;return(w=j?.internalReplaceViewModel(T[T.length-1],h))!==null&&w!==void 0?w:!1},p.prototype.incrementReferenceCount=function(){var a;this._referenceCount++,(a=this._runtimeInstance)===null||a===void 0||a.incrementReferenceCount()},p.prototype.decrementReferenceCount=function(){var a;this._referenceCount--,(a=this._runtimeInstance)===null||a===void 0||a.decrementReferenceCount()},Object.defineProperty(p.prototype,"properties",{get:function(){var a;return((a=this._runtimeInstance)===null||a===void 0?void 0:a.getProperties().map(function(h){return E({},h)}))||[]},enumerable:!1,configurable:!0}),p.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},p.prototype.cleanup=function(){var a=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(T){T.cleanup()}),this._viewModelInstances.clear();var h=S([],this._children,!0);this._children.length=0;var w=S([],this._parents,!0);this._parents.length=0,h.forEach(function(T){T.removeParent(a)}),w.forEach(function(T){T.removeFromViewModelCallbacks(a)})}},p})(),Be=(function(){function p(a,h){this.callbacks=[],this._viewModelInstanceValue=a,this._parentViewModel=h}return p.prototype.on=function(a){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(a)||(this.callbacks.push(a),this._parentViewModel.addToPropertyCallbacks(this))},p.prototype.off=function(a){a?this.callbacks=this.callbacks.filter(function(h){return h!==a}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},p.prototype.internalHandleCallback=function(a){},p.prototype.handleCallbacks=function(){var a=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(h){a.internalHandleCallback(h)})},p.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},p.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),p})(),Ht=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Be),an=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Be),zt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Be),An=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return a.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},a.prototype.internalHandleCallback=function(h){h()},a})(Be),st=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(h){this._viewModelInstanceValue.valueIndex=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Be),Tt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),a.prototype.addInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(h.runtimeInstance),h.addParent(this._parentViewModel))},a.prototype.addInstanceAt=function(h,w){return h.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(h.runtimeInstance,w)?(h.addParent(this._parentViewModel),!0):!1},a.prototype.removeInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(h.runtimeInstance),h.removeParent(this._parentViewModel))},a.prototype.removeInstanceAt=function(h){this._viewModelInstanceValue.removeInstanceAt(h)},a.prototype.instanceAt=function(h){var w=this._viewModelInstanceValue.instanceAt(h);if(w!=null){var T=new ht(w,this._parentViewModel);return T}return null},a.prototype.swap=function(h,w){this._viewModelInstanceValue.swap(h,w)},a.prototype.internalHandleCallback=function(h){h()},a})(Be),un=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.rgb=function(h,w,T){this._viewModelInstanceValue.rgb(h,w,T)},a.prototype.rgba=function(h,w,T,j){this._viewModelInstanceValue.argb(j,h,w,T)},a.prototype.argb=function(h,w,T,j){this._viewModelInstanceValue.argb(h,w,T,j)},a.prototype.alpha=function(h){this._viewModelInstanceValue.alpha(h)},a.prototype.opacity=function(h){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,h))*255))},a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Be),mr=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Be),Gt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Be),Gr=function(p){return A(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Request(p),[4,fetch(a)];case 1:return h=T.sent(),[4,h.arrayBuffer()];case 2:return w=T.sent(),[2,w]}})})},dt=function(p){return typeof p=="string"?[p]:p instanceof Array?p:[]},Ni={EventManager:Ee,TaskQueueManager:je},Kr=function(p){return A(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(j){return L.getInstance(function($){$.decodeAudio(p,j)})}),[4,a];case 1:return h=T.sent(),w=new m.AudioWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})},Bi=function(p){return A(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(j){return L.getInstance(function($){$.decodeImage(p,j)})}),[4,a];case 1:return h=T.sent(),w=new m.ImageWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})},ln=function(p){return A(void 0,void 0,void 0,function(){var a,h,w;return g(this,function(T){switch(T.label){case 0:return a=new Promise(function(j){return L.getInstance(function($){$.decodeFont(p,j)})}),[4,a];case 1:return h=T.sent(),w=new m.FontWrapper(h),m.finalizationRegistry.register(w,h),[2,w]}})})}})(),u})())})(Ai)),Ai.exports}var jd=Od();const Mi="dracula",Li="https://vycjpmuyscfygstjjied.supabase.co";var xd=He('<div class="main-container"><canvas width="400" height="500"></canvas></div>');function Oa(n,e){Vr(e,!0);let t=$e(void 0);$r(()=>{if(!te(t))return;const u=new jd.Rive({src:`${Li}/storage/v1/object/public/${Mi}/${e.fileName}`,canvas:te(t),autoplay:!0,stateMachines:"SM1"});return()=>{u.cleanup()}});var r=xd(),o=Fe(r);yc(o,u=>re(t,u),()=>te(t)),Pe(n,r),qr()}var Md=He('<img alt="Background"/>'),Ld=He('<div class="background-media svelte-6amr7n"><!></div>'),Fd=He('<img alt="Character"/>'),Ud=He('<div class="character-media svelte-6amr7n"><!></div>'),Dd=(n,e,t)=>e(te(t).nextDialogueId),$d=He('<button class="option-button svelte-6amr7n"> </button>'),Nd=He('<div class="options-container svelte-6amr7n"></div>'),Bd=He('<div class="error-overlay svelte-6amr7n"><p class="error-text svelte-6amr7n"> </p></div>'),Wd=He('<div class="dialogue-container svelte-6amr7n"><!> <!> <div class="dialogue-content svelte-6amr7n"><div class="dialogue-text svelte-6amr7n"> </div> <!></div> <!></div>');function Vd(n,e){Vr(e,!0);let t=$e(null),r=$e(null),o=$e(null);async function u(){try{if(re(o,null),e.dialogue.backgroundImage)try{e.dialogue.backgroundImage.endsWith(".riv")||(re(t,`${Li}/storage/v1/object/public/${Mi}/${e.dialogue.backgroundImage}`),await c(te(t)))}catch{console.warn("Background not found:",e.dialogue.backgroundImage),re(t,null)}if(e.dialogue.characterImage)try{e.dialogue.characterImage.endsWith(".riv")||(re(r,`${Li}/storage/v1/object/public/${Mi}/${e.dialogue.characterImage}`),await c(te(r)))}catch{console.warn("Character not found:",e.dialogue.characterImage),re(r,null)}}catch(L){re(o,"Ошибка загрузки медиа: "+L.message),console.error("Media loading error:",L),e.dialogue.backgroundImage?.endsWith(".riv")&&re(t,null),e.dialogue.characterImage?.endsWith(".riv")&&re(r,null)}finally{}}function c(L){return new Promise((z,x)=>{const F=new Image;F.onload=()=>z(L),F.onerror=()=>x(new Error(`Image not found: ${L}`)),F.src=L})}u();function f(L){const z=new CustomEvent("dialogueChange",{detail:{nextDialogueId:L}});window.dispatchEvent(z)}var v=Wd(),m=Fe(v);{var y=L=>{var z=Ld(),x=Fe(z);{var F=X=>{var se=Dr(),Y=Un(se);Zo(Y,()=>e.dialogue.backgroundImage,ae=>{Oa(ae,{get fileName(){return e.dialogue.backgroundImage}})}),Pe(X,se)},ee=X=>{var se=Md();let Y;lt(ae=>{na(se,"src",te(t)?te(t):""),Y=ta(se,1,"background-image svelte-6amr7n",null,Y,ae)},[()=>({hidden:!te(t)||!e.dialogue.backgroundImage.endsWith(".riv")})]),Xo("error",se,()=>{re(o,"Ошибка загрузки фона: "+e.dialogue.backgroundImage),re(t,null)}),Pe(X,se)};tt(x,X=>{e.dialogue.backgroundImage.endsWith(".riv")?X(F):X(ee,!1)})}Pe(L,z)};tt(m,L=>{e.dialogue.backgroundImage&&L(y)})}var E=ut(m,2);{var A=L=>{var z=Ud(),x=Fe(z);{var F=X=>{var se=Dr(),Y=Un(se);Zo(Y,()=>e.dialogue.characterImage,ae=>{Oa(ae,{get fileName(){return e.dialogue.characterImage}})}),Pe(X,se)},ee=X=>{var se=Fd();let Y;lt(ae=>{na(se,"src",te(r)?te(r):""),Y=ta(se,1,"character-image svelte-6amr7n",null,Y,ae)},[()=>({hidden:!te(r)||!e.dialogue.characterImageUrl.endsWith(".riv")})]),Xo("error",se,()=>{re(o,"Ошибка загрузки персонажа: "+e.dialogue.characterImage),re(r,null)}),Pe(X,se)};tt(x,X=>{e.dialogue.characterImage.endsWith(".riv")?X(F):X(ee,!1)})}Pe(L,z)};tt(E,L=>{e.dialogue.characterImage&&L(A)})}var g=ut(E,2),S=Fe(g),O=Fe(S),M=ut(S,2);{var H=L=>{var z=Nd();dc(z,21,()=>e.dialogue.options,x=>x.text,(x,F)=>{var ee=$d();ee.__click=[Dd,f,F];var X=Fe(ee);lt(()=>bt(X,te(F).text)),Pe(x,ee)}),Pe(L,z)};tt(M,L=>{e.dialogue.options&&e.dialogue.options.length>0&&L(H)})}var B=ut(g,2);{var U=L=>{var z=Bd(),x=Fe(z),F=Fe(x);lt(()=>bt(F,te(o))),Pe(L,z)};tt(B,L=>{te(o)&&L(U)})}lt(()=>bt(O,`"${e.dialogue.text??""}"`)),Pe(n,v),qr()}Hs(["click"]);function qd(n,e){re(e,0)}async function Hd(n,e,t,r,o){re(e,!0),re(t,"");try{await r(),re(o,0)}catch(u){re(t,"Ошибка перезагрузки: "+u.message)}finally{re(e,!1)}}var zd=He('<div class="loading"><p>🔄 Загрузка истории Дракулы...</p></div>'),Gd=He('<div class="error"> <div style="margin-top: 15px;"><button class="nav-button">🔄 Попробовать снова</button></div></div>'),Kd=(n,e)=>e(),Yd=He('<div class="dialogues-container"><!></div>'),Jd=He('<div class="welcome-section"><h1 class="welcome-title">🧛‍♂️ Дракула: Интерактивная история</h1> <p class="welcome-text">Погрузитесь в атмосферную готическую историю с интерактивными диалогами.<br/> Принимайте решения, которые влияют на развитие сюжета.</p> <button class="start-button">🎭 Начать историю</button></div>'),Xd=He('<div class="app"><!></div>');function ja(n,e){Vr(e,!0),Ln({name:"Игрок"});let t=$e(!0),r=$e(""),o=$e(Ln([])),u=$e(0);$r(async()=>{try{await c()}catch(g){re(r,"Ошибка загрузки истории: "+g.message),console.error("Load error:",g)}finally{re(t,!1)}});async function c(){try{const g=await fetch(`${Li}/storage/v1/object/public/${Mi}/dracula_story.json`);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const S=await g.json();if(!S.dialogues||!Array.isArray(S.dialogues))throw new Error("Неверный формат файла истории: отсутствует dialogues array");re(o,S.dialogues,!0),console.log("Диалоги загружены:",te(o).length)}catch(g){throw re(r,"Ошибка загрузки истории: "+g.message),console.error("Load dialogues error:",g),g}}function f(g){const S=g.detail.nextDialogueId,O=te(o).findIndex(M=>M.id===S);if(O!==-1)re(u,O,!0);else{const M=te(o)[te(u)];if(M.nextDialogueId){const H=te(o).findIndex(B=>B.id===M.nextDialogueId);H!==-1&&re(u,H,!0)}}}function v(){te(u)<te(o).length-1&&Bl(u)}$r(()=>(window.addEventListener("dialogueChange",f),()=>window.removeEventListener("dialogueChange",f)));var m=Xd(),y=Fe(m);{var E=g=>{var S=zd();Pe(g,S)},A=g=>{var S=Dr(),O=Un(S);{var M=B=>{var U=Gd(),L=Fe(U),z=ut(L),x=Fe(z);x.__click=[Hd,t,r,c,u],lt(()=>bt(L,`⚠️ ${te(r)??""} `)),Pe(B,U)},H=B=>{var U=Dr(),L=Un(U);{var z=F=>{var ee=Yd();ee.__click=[Kd,v];var X=Fe(ee);Vd(X,{get index(){return te(u)},get dialogue(){return te(o)[te(u)]}}),Pe(F,ee)},x=F=>{var ee=Jd(),X=ut(Fe(ee),4);X.__click=[qd,u],Pe(F,ee)};tt(L,F=>{te(o).length>0?F(z):F(x,!1)},!0)}Pe(B,U)};tt(O,B=>{te(r)?B(M):B(H,!1)},!0)}Pe(g,S)};tt(y,g=>{te(t)?g(E):g(A,!1)})}Pe(n,m),qr()}Hs(["click"]);async function Qd(n,e,t,r,o,u){try{re(e,!0),re(t,"");const c=te(r).initData;if(!c)throw new Error("Telegram init data not available");const{data:f,error:v}=await ar.functions.invoke("tma-auth",{body:{initData:c}});if(v)throw v;const{error:m}=await ar.auth.setSession({access_token:f.access_token,refresh_token:f.refresh_token});if(m)throw m;const{data:y}=await ar.auth.getUser();re(o,y?.user,!0),re(u,{access_token:f.access_token,refresh_token:f.refresh_token},!0),re(e,!1)}catch(c){re(t,"Ошибка авторизации: "+c.message),console.error("Auth error:",c)}finally{re(e,!1)}}async function Zd(n,e,t,r){try{await ar.auth.signOut(),re(e,null),re(t,null)}catch(o){re(r,"Ошибка выхода: "+o.message)}}var ef=He('<div class="loading"><p>Загрузка...</p></div> <p> </p> <!>',1),tf=He('<div class="header"><div class="user-avatar"><!></div> <div class="user-info"><h3 class="user-name"> </h3> <p class="user-meta"><!></p></div> <button class="button button-logout">Выйти</button></div> <!>',1),nf=He('<div class="auth-section"><h1 class="welcome-title"><!></h1> <p class="welcome-text">Погрузитесь в атмосферную историю с интерактивными диалогами</p> <button class="button"><!></button></div>'),rf=He('<div class="error"> </div>'),sf=He("<div><!> <!></div>");function of(n,e){Vr(e,!0);let t=$e(null),r=$e(null),o=$e(null),u=$e(null),c=$e(!0),f=$e("");$r(async()=>{try{re(t,Pd(),!0),re(r,Id(te(t)),!0);const{data:S}=await ar.auth.getSession();if(re(u,S?.session,!0),re(f,"sessionData?.session"),te(u)){const{data:O}=await ar.auth.getUser();re(o,O?.user,!0),re(c,!1),re(f,"userData?.user")}}catch(S){re(f,"Ошибка инициализации: "+S.message)}finally{re(c,!1)}}),$r(()=>{});var v=sf(),m=Fe(v);{var y=S=>{var O=ef(),M=ut(Un(O),2),H=Fe(M),B=ut(M,2);ja(B,{}),lt(U=>bt(H,U),[()=>JSON.stringify(te(o))]),Pe(S,O)},E=S=>{var O=Dr(),M=Un(O);{var H=U=>{var L=tf(),z=Un(L),x=Fe(z),F=Fe(x);{var ee=Ce=>{var ye=vn();lt(()=>bt(ye,te(o).user_metadata.first_name[0])),Pe(Ce,ye)},X=Ce=>{var ye=vn("U");Pe(Ce,ye)};tt(F,Ce=>{te(o).user_metadata?.first_name?Ce(ee):Ce(X,!1)})}var se=ut(x,2),Y=Fe(se),ae=Fe(Y),Ee=ut(Y,2),je=Fe(Ee);{var Ne=Ce=>{var ye=vn();lt(()=>bt(ye,`@${te(o).user_metadata.username??""}`)),Pe(Ce,ye)},kt=Ce=>{var ye=vn();lt(()=>bt(ye,`ID: ${te(o).user_metadata?.telegram_id??""}`)),Pe(Ce,ye)};tt(je,Ce=>{te(o).user_metadata?.username?Ce(Ne):Ce(kt,!1)})}var ge=ut(se,2);ge.__click=[Zd,o,u,f];var on=ut(z,2);ja(on,{}),lt(()=>bt(ae,`${te(o).user_metadata?.first_name??""}
          ${(te(o).user_metadata?.last_name||"")??""}`)),Pe(U,L)},B=U=>{var L=nf(),z=Fe(L),x=Fe(z);{var F=Ee=>{var je=vn();lt(()=>bt(je,`Привет, ${te(r).first_name??""}!`)),Pe(Ee,je)},ee=Ee=>{var je=vn("Дракула: История");Pe(Ee,je)};tt(x,Ee=>{te(r)?Ee(F):Ee(ee,!1)})}var X=ut(z,4);X.__click=[Qd,c,f,t,o,u];var se=Fe(X);{var Y=Ee=>{var je=vn();lt(()=>bt(je,`Начать историю как ${te(r).first_name??""}`)),Pe(Ee,je)},ae=Ee=>{var je=vn("Начать историю");Pe(Ee,je)};tt(se,Ee=>{te(r)?Ee(Y):Ee(ae,!1)})}Pe(U,L)};tt(M,U=>{te(o)&&te(u)?U(H):U(B,!1)},!0)}Pe(S,O)};tt(m,S=>{te(c)?S(y):S(E,!1)})}var A=ut(m,2);{var g=S=>{var O=rf(),M=Fe(O);lt(()=>bt(M,te(f))),Pe(S,O)};tt(A,S=>{te(f)&&S(g)})}Pe(n,v),qr()}Hs(["click"]);function af(n){of(n,{})}uc(af,{target:document.getElementById("app")});
