(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const Xn=!1;var el=Array.isArray,tl=Array.prototype.indexOf,rl=Array.from,_s=Object.defineProperty,Zn=Object.getOwnPropertyDescriptor,sl=Object.getOwnPropertyDescriptors,nl=Object.getPrototypeOf,ei=Object.isExtensible;function il(t){return t()}function ti(t){for(var e=0;e<t.length;e++)t[e]()}function ol(){var t,e,r=new Promise((s,n)=>{t=s,e=n});return{promise:r,resolve:t,reject:e}}const oe=2,vo=4,yo=8,Ws=16,Te=32,_t=64,wo=128,Z=256,lr=512,V=1024,ie=2048,Fe=4096,ut=8192,gt=16384,Vs=32768,al=65536,ul=1<<18,zs=1<<19,Ks=1<<20,gs=1<<21,bo=1<<22,Le=1<<23,ri=Symbol("$state"),Hs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ll(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function mo(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function cl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function hl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function dl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function fl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function pl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}const _l=1,gl=2,Gs=Symbol();function ko(t){return t===this.v}function vl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function yl(t){return!vl(t,this.v)}let Er=!1,wl=!1;function bl(){Er=!0}let q=null;function cr(t){q=t}function Js(t,e=!1,r){q={p:q,c:null,e:null,s:t,x:null,l:Er&&!e?{s:null,u:null,$:[]}:null}}function Qs(t){var e=q,r=e.e;if(r!==null){e.e=null;for(var s of r)Io(s)}return q=e.p,{}}function Sr(){return!Er||q!==null&&q.l===null}const ml=new WeakMap;function kl(t){var e=$;if(e===null)return T.f|=Le,t;if((e.f&Vs)===0){if((e.f&wo)===0)throw!e.parent&&t instanceof Error&&Eo(t),t;e.b.error(t)}else Ys(t,e)}function Ys(t,e){for(;e!==null;){if((e.f&wo)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t instanceof Error&&Eo(t),t}function Eo(t){const e=ml.get(t);e&&(_s(t,"message",{value:e.message}),_s(t,"stack",{value:e.stack}))}function El(){for(var t=$.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&ll(),t}function $r(t){var e=oe|ie,r=T!==null&&(T.f&oe)!==0?T:null;return $===null||r!==null&&(r.f&Z)!==0?e|=Z:$.f|=zs,{ctx:q,deps:null,effects:null,equals:ko,f:e,fn:t,reactions:null,rv:0,v:Gs,wv:0,parent:r??$,ac:null}}function Sl(t,e){let r=$;r===null&&cl();var s=r.b,n=void 0,i=Ol(Gs),o=null,a=!T;return Ul(()=>{try{var u=t()}catch(f){u=Promise.reject(f)}var l=()=>u;n=o?.then(l,l)??Promise.resolve(u),o=n;var c=ce,h=s.pending;a&&(s.update_pending_count(1),h||c.increment());const d=(f,p=void 0)=>{o=null,h||c.activate(),p?p!==Hs&&(i.f|=Le,ii(i,p)):((i.f&Le)!==0&&(i.f^=Le),ii(i,f)),a&&(s.update_pending_count(-1),h||c.decrement()),To()};if(n.then(d,f=>d(null,f||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(u=>{function l(c){function h(){c===n?u(i):l(n)}c.then(h,h)}l(n)})}function si(t){const e=$r(t);return Fl(e),e}function $l(t){const e=$r(t);return e.equals=yl,e}function So(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Ne(e[r])}}function Tl(t){for(var e=t.parent;e!==null;){if((e.f&oe)===0)return e;e=e.parent}return null}function Xs(t){var e,r=$;ht(Tl(t));try{So(t),e=Fo(t)}finally{ht(r)}return e}function $o(t){var e=Xs(t);if(t.equals(e)||(t.v=e,t.wv=Bo()),!yt)if(lt!==null)lt.set(t,t.v);else{var r=(ke||(t.f&Z)!==0)&&t.deps!==null?Fe:V;K(t,r)}}function jl(t,e,r){const s=Sr()?$r:$l;if(e.length===0){r(t.map(s));return}var n=ce,i=$,o=Al(),a=El();Promise.all(e.map(u=>Sl(u))).then(u=>{n?.activate(),o();try{r([...t.map(s),...u])}catch(l){(i.f&gt)===0&&Ys(l,i)}n?.deactivate(),To()}).catch(u=>{a.error(u)})}function Al(){var t=$,e=T,r=q;return function(){ht(t),ct(e),cr(r)}}function To(){ht(null),ct(null),cr(null)}const rr=new Set;let ce=null,lt=null;let Pt=[],hr=null,vs=!1;class Tr{#u=new Map;#i=new Map;#o=new Set;#t=0;#l=null;#c=!1;#s=[];#a=[];#r=[];#e=[];#n=[];skipped_effects=new Set;#d(e){Pt=[];var r=null;if(rr.size>1){r=new Map,lt=new Map;for(const[i,o]of this.#u)r.set(i,{v:i.v,wv:i.wv}),i.v=o;for(const i of rr)if(i!==this)for(const[o,a]of i.#i)r.has(o)||(r.set(o,{v:o.v,wv:o.wv}),o.v=a)}for(const i of e)this.#f(i);if(this.#s.length===0&&this.#t===0){var s=this.#r,n=this.#e;this.#r=[],this.#e=[],this.#n=[],this.#h(),ni(s),ni(n),this.#l?.resolve()}else{for(const i of this.#r)K(i,V);for(const i of this.#e)K(i,V);for(const i of this.#n)K(i,V)}if(r){for(const[i,{v:o,wv:a}]of r)i.wv<=a&&(i.v=o);lt=null}for(const i of this.#s)Rt(i);for(const i of this.#a)Rt(i);this.#s=[],this.#a=[]}#f(e){e.f^=V;for(var r=e.first;r!==null;){var s=r.f,n=(s&(Te|_t))!==0,i=n&&(s&V)!==0,o=i||(s&ut)!==0||this.skipped_effects.has(r);if(!o&&r.fn!==null){if(n)r.f^=V;else if((s&vo)!==0)this.#e.push(r);else if(jr(r))if((s&bo)!==0){var a=r.b?.pending?this.#a:this.#s;a.push(r)}else(r.f&Ws)!==0&&this.#n.push(r),Rt(r);var u=r.first;if(u!==null){r=u;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}}capture(e,r){this.#i.has(e)||this.#i.set(e,r),this.#u.set(e,e.v)}activate(){ce=this}deactivate(){ce=null}neuter(){this.#c=!0}flush(){Pt.length>0?this.flush_effects():this.#h(),ce===this&&(this.#t===0&&rr.delete(this),ce=null)}flush_effects(){var e=at;vs=!0;try{var r=0;for(ai(!0);Pt.length>0;)r++>1e3&&Pl(),this.#d(Pt),De.clear()}finally{vs=!1,ai(e),hr=null}}#h(){if(!this.#c)for(const e of this.#o)e();this.#o.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const e of this.#r)K(e,ie),Ue(e);for(const e of this.#e)K(e,ie),Ue(e);for(const e of this.#n)K(e,ie),Ue(e);this.#r=[],this.#e=[],this.flush()}}add_callback(e){this.#o.add(e)}settled(){return(this.#l??=ol()).promise}static ensure(){if(ce===null){const e=ce=new Tr;rr.add(ce),queueMicrotask(()=>{ce===e&&e.flush()})}return ce}}function Pl(){try{pl()}catch(t){if(hr!==null)Ys(t,hr);else throw t}}function ni(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var s=t[r];if((s.f&(gt|ut))===0&&jr(s)){var n=fr;if(Rt(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null?qo(s):s.fn=null),fr>n&&(s.f&Ks)!==0)break}}for(;r<e;r+=1)Ue(t[r])}}function Ue(t){for(var e=hr=t;e.parent!==null;){e=e.parent;var r=e.f;if(vs&&e===$&&(r&Ws)!==0)return;if((r&(_t|Te))!==0){if((r&V)===0)return;e.f^=V}}Pt.push(e)}const De=new Map;function Ol(t,e){var r={f:0,v:t,reactions:null,equals:ko,rv:0,wv:0};return r}function ii(t,e){if(!t.equals(e)){var r=t.v;yt?De.set(t,e):De.set(t,r),t.v=e,Tr.ensure().capture(t,r),(t.f&oe)!==0&&((t.f&ie)!==0&&Xs(t),K(t,(t.f&Z)===0?V:Fe)),t.wv=Bo(),jo(t,ie),Sr()&&$!==null&&($.f&V)!==0&&($.f&(Te|_t))===0&&(ne===null?Wl([t]):ne.push(t))}return e}function jo(t,e){var r=t.reactions;if(r!==null)for(var s=Sr(),n=r.length,i=0;i<n;i++){var o=r[i],a=o.f;(a&ie)===0&&(!s&&o===$||(K(o,e),(a&(V|Z))!==0&&((a&oe)!==0?jo(o,Fe):Ue(o))))}}var oi,Ao,Po,Oo;function xl(){if(oi===void 0){oi=window,Ao=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Po=Zn(e,"firstChild").get,Oo=Zn(e,"nextSibling").get,ei(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ei(r)&&(r.__t=void 0)}}function Cl(t=""){return document.createTextNode(t)}function dr(t){return Po.call(t)}function Zs(t){return Oo.call(t)}function ys(t,e){return dr(t)}function xo(t,e){{var r=dr(t);return r instanceof Comment&&r.data===""?Zs(r):r}}function Co(t,e=1,r=!1){let s=t;for(;e--;)s=Zs(s);return s}function Ro(t){$===null&&T===null&&fl(),T!==null&&(T.f&Z)!==0&&$===null&&dl(),yt&&hl()}function Rl(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function vt(t,e,r,s=!0){var n=$;n!==null&&(n.f&ut)!==0&&(t|=ut);var i={ctx:q,deps:null,nodes_start:null,nodes_end:null,f:t|ie,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Rt(i),i.f|=Vs}catch(u){throw Ne(i),u}else e!==null&&Ue(i);var o=r&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&zs)===0;if(!o&&s&&(n!==null&&Rl(i,n),T!==null&&(T.f&oe)!==0)){var a=T;(a.effects??=[]).push(i)}return i}function ws(t){Ro();var e=$.f,r=!T&&(e&Te)!==0&&(e&Vs)===0;if(r){var s=q;(s.e??=[]).push(t)}else return Io(t)}function Io(t){return vt(vo|Ks,t,!1)}function Il(t){return Ro(),vt(yo|Ks,t,!0)}function Ll(t){Tr.ensure();const e=vt(_t,t,!0);return(r={})=>new Promise(s=>{r.outro?Bl(e,()=>{Ne(e),s(void 0)}):(Ne(e),s(void 0))})}function Ul(t){return vt(bo|zs,t,!0)}function Lo(t,e=[],r=[]){jl(e,r,s=>{vt(yo,()=>t(...s.map(Bt)),!0)})}function Dl(t,e=!0){return vt(Te,t,!0,e)}function Uo(t){var e=t.teardown;if(e!==null){const r=yt,s=T;ui(!0),ct(null);try{e.call(null)}finally{ui(r),ct(s)}}}function Do(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){r.ac?.abort(Hs);var s=r.next;(r.f&_t)!==0?r.parent=null:Ne(r,e),r=s}}function ql(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Te)===0&&Ne(e),e=r}}function Ne(t,e=!0){var r=!1;(e||(t.f&ul)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Nl(t.nodes_start,t.nodes_end),r=!0),Do(t,e&&!r),_r(t,0),K(t,gt);var s=t.transitions;if(s!==null)for(const i of s)i.stop();Uo(t);var n=t.parent;n!==null&&n.first!==null&&qo(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function Nl(t,e){for(;t!==null;){var r=t===e?null:Zs(t);t.remove(),t=r}}function qo(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function Bl(t,e){var r=[];No(t,r,!0),Ml(r,()=>{Ne(t),e&&e()})}function Ml(t,e){var r=t.length;if(r>0){var s=()=>--r||e();for(var n of t)n.out(s)}else e()}function No(t,e,r){if((t.f&ut)===0){if(t.f^=ut,t.transitions!==null)for(const o of t.transitions)(o.is_global||r)&&e.push(o);for(var s=t.first;s!==null;){var n=s.next,i=(s.f&al)!==0||(s.f&Te)!==0;No(s,e,i?r:!1),s=n}}}let at=!1;function ai(t){at=t}let yt=!1;function ui(t){yt=t}let T=null,_e=!1;function ct(t){T=t}let $=null;function ht(t){$=t}let Ee=null;function Fl(t){T!==null&&(Ee===null?Ee=[t]:Ee.push(t))}let z=null,Y=0,ne=null;function Wl(t){ne=t}let fr=1,pr=0,ke=!1;function Bo(){return++fr}function jr(t){var e=t.f;if((e&ie)!==0)return!0;if((e&Fe)!==0){var r=t.deps,s=(e&Z)!==0;if(r!==null){var n,i,o=(e&lr)!==0,a=s&&$!==null&&!ke,u=r.length;if((o||a)&&($===null||($.f&gt)===0)){var l=t,c=l.parent;for(n=0;n<u;n++)i=r[n],(o||!i?.reactions?.includes(l))&&(i.reactions??=[]).push(l);o&&(l.f^=lr),a&&c!==null&&(c.f&Z)===0&&(l.f^=Z)}for(n=0;n<u;n++)if(i=r[n],jr(i)&&$o(i),i.wv>t.wv)return!0}(!s||$!==null&&!ke)&&K(t,V)}return!1}function Mo(t,e,r=!0){var s=t.reactions;if(s!==null&&!Ee?.includes(t))for(var n=0;n<s.length;n++){var i=s[n];(i.f&oe)!==0?Mo(i,e,!1):e===i&&(r?K(i,ie):(i.f&V)!==0&&K(i,Fe),Ue(i))}}function Fo(t){var e=z,r=Y,s=ne,n=T,i=ke,o=Ee,a=q,u=_e,l=t.f;z=null,Y=0,ne=null,ke=(l&Z)!==0&&(_e||!at||T===null),T=(l&(Te|_t))===0?t:null,Ee=null,cr(t.ctx),_e=!1,++pr,t.ac!==null&&(t.ac.abort(Hs),t.ac=null);try{t.f|=gs;var c=(0,t.fn)(),h=t.deps;if(z!==null){var d;if(_r(t,Y),h!==null&&Y>0)for(h.length=Y+z.length,d=0;d<z.length;d++)h[Y+d]=z[d];else t.deps=h=z;if(!ke||(l&oe)!==0&&t.reactions!==null)for(d=Y;d<h.length;d++)(h[d].reactions??=[]).push(t)}else h!==null&&Y<h.length&&(_r(t,Y),h.length=Y);if(Sr()&&ne!==null&&!_e&&h!==null&&(t.f&(oe|Fe|ie))===0)for(d=0;d<ne.length;d++)Mo(ne[d],t);return n!==null&&n!==t&&(pr++,ne!==null&&(s===null?s=ne:s.push(...ne))),(t.f&Le)!==0&&(t.f^=Le),c}catch(f){return kl(f)}finally{t.f^=gs,z=e,Y=r,ne=s,T=n,ke=i,Ee=o,cr(a),_e=u}}function Vl(t,e){let r=e.reactions;if(r!==null){var s=tl.call(r,t);if(s!==-1){var n=r.length-1;n===0?r=e.reactions=null:(r[s]=r[n],r.pop())}}r===null&&(e.f&oe)!==0&&(z===null||!z.includes(e))&&(K(e,Fe),(e.f&(Z|lr))===0&&(e.f^=lr),So(e),_r(e,0))}function _r(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)Vl(t,r[s])}function Rt(t){var e=t.f;if((e&gt)===0){K(t,V);var r=$,s=at;$=t,at=!0;try{(e&Ws)!==0?ql(t):Do(t),Uo(t);var n=Fo(t);t.teardown=typeof n=="function"?n:null,t.wv=fr;var i;Xn&&wl&&(t.f&ie)!==0&&t.deps}finally{at=s,$=r}}}function Bt(t){var e=t.f,r=(e&oe)!==0;if(T!==null&&!_e){var s=$!==null&&($.f&gt)!==0;if(!s&&!Ee?.includes(t)){var n=T.deps;if((T.f&gs)!==0)t.rv<pr&&(t.rv=pr,z===null&&n!==null&&n[Y]===t?Y++:z===null?z=[t]:(!ke||!z.includes(t))&&z.push(t));else{(T.deps??=[]).push(t);var i=t.reactions;i===null?t.reactions=[T]:i.includes(T)||i.push(T)}}}else if(r&&t.deps===null&&t.effects===null){var o=t,a=o.parent;a!==null&&(a.f&Z)===0&&(o.f^=Z)}if(yt){if(De.has(t))return De.get(t);if(r){o=t;var u=o.v;return((o.f&V)!==0||Wo(o))&&(u=Xs(o)),De.set(o,u),u}}else if(r){if(o=t,lt?.has(o))return lt.get(o);jr(o)&&$o(o)}if((t.f&Le)!==0)throw t.v;return t.v}function Wo(t){if(t.v===Gs)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(De.has(e)||(e.f&oe)!==0&&Wo(e))return!0;return!1}function en(t){var e=_e;try{return _e=!0,t()}finally{_e=e}}const zl=-7169;function K(t,e){t.f=t.f&zl|e}function Kl(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ri in t)bs(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&ri in r&&bs(r)}}}function bs(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let s in t)try{bs(t[s],e)}catch{}const r=nl(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const s=sl(r);for(let n in s){const i=s[n].get;if(i)try{i.call(t)}catch{}}}}}const Hl=["touchstart","touchmove"];function Gl(t){return Hl.includes(t)}const Vo=new Set,ms=new Set;function Jl(t){for(var e=0;e<t.length;e++)Vo.add(t[e]);for(var r of ms)r(t)}function sr(t){var e=this,r=e.ownerDocument,s=t.type,n=t.composedPath?.()||[],i=n[0]||t.target,o=0,a=t.__root;if(a){var u=n.indexOf(a);if(u!==-1&&(e===document||e===window)){t.__root=e;return}var l=n.indexOf(e);if(l===-1)return;u<=l&&(o=u)}if(i=n[o]||t.target,i!==e){_s(t,"currentTarget",{configurable:!0,get(){return i||r}});var c=T,h=$;ct(null),ht(null);try{for(var d,f=[];i!==null;){var p=i.assignedSlot||i.parentNode||i.host||null;try{var v=i["__"+s];if(v!=null&&(!i.disabled||t.target===i))if(el(v)){var[g,...E]=v;g.apply(i,[t,...E])}else v.call(i,t)}catch(m){d?f.push(m):d=m}if(t.cancelBubble||p===e||p===null)break;i=p}if(d){for(let m of f)queueMicrotask(()=>{throw m});throw d}}finally{t.__root=e,delete t.currentTarget,ct(c),ht(h)}}}function Ql(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function li(t,e){var r=$;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function tn(t,e){var r=(e&_l)!==0,s=(e&gl)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=Ql(i?t:"<!>"+t),r||(n=dr(n)));var o=s||Ao?document.importNode(n,!0):n.cloneNode(!0);if(r){var a=dr(o),u=o.lastChild;li(a,u)}else li(o,o);return o}}function rn(t,e){t!==null&&t.before(e)}function zo(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function Yl(t,e){return Xl(t,e)}const Ke=new Map;function Xl(t,{target:e,anchor:r,props:s={},events:n,context:i,intro:o=!0}){xl();var a=new Set,u=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!a.has(f)){a.add(f);var p=Gl(f);e.addEventListener(f,sr,{passive:p});var v=Ke.get(f);v===void 0?(document.addEventListener(f,sr,{passive:p}),Ke.set(f,1)):Ke.set(f,v+1)}}};u(rl(Vo)),ms.add(u);var l=void 0,c=Ll(()=>{var h=r??e.appendChild(Cl());return Dl(()=>{if(i){Js({});var d=q;d.c=i}n&&(s.$$events=n),l=t(h,s)||{},i&&Qs()}),()=>{for(var d of a){e.removeEventListener(d,sr);var f=Ke.get(d);--f===0?(document.removeEventListener(d,sr),Ke.delete(d)):Ke.set(d,f)}ms.delete(u),h!==r&&h.parentNode?.removeChild(h)}});return Zl.set(l,c),l}let Zl=new WeakMap;function ec(t=!1){const e=q,r=e.l.u;if(!r)return;let s=()=>Kl(e.s);if(t){let n=0,i={};const o=$r(()=>{let a=!1;const u=e.s;for(const l in u)u[l]!==i[l]&&(i[l]=u[l],a=!0);return a&&n++,n});s=()=>Bt(o)}r.b.length&&Il(()=>{ci(e,s),ti(r.b)}),ws(()=>{const n=en(()=>r.m.map(il));return()=>{for(const i of n)typeof i=="function"&&i()}}),r.a.length&&ws(()=>{ci(e,s),ti(r.a)})}function ci(t,e){if(t.l.s)for(const r of t.l.s)Bt(r);e()}function Ko(t){q===null&&mo(),Er&&q.l!==null?tc(q).m.push(t):ws(()=>{const e=en(t);if(typeof e=="function")return e})}function Ho(t){q===null&&mo(),Ko(()=>()=>en(t))}function tc(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const rc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(rc);bl();var sc=tn("<div><h1> </h1></div>");function nc(t,e){var r=sc(),s=ys(r),n=ys(s);Lo(()=>zo(n,`${(e.name?e.name:"Novella")??""} Form`)),rn(t,r)}const ic="modulepreload",oc=function(t,e){return new URL(t,e).href},hi={},Gt=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=a?.nonce||a?.getAttribute("nonce");n=l(r.map(c=>{if(c=oc(c,s),c in hi)return;hi[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(!!s)for(let v=o.length-1;v>=0;v--){const g=o[v];if(g.href===c&&(!h||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":ic,h||(p.as="script"),p.crossOrigin="",p.href=c,u&&p.setAttribute("nonce",u),document.head.appendChild(p),h)return new Promise((v,g)=>{p.addEventListener("load",v),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},ac=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gt(async()=>{const{default:s}=await Promise.resolve().then(()=>wt);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class sn extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class uc extends sn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class di extends sn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class fi extends sn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ks;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ks||(ks={}));var lc=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class cc{constructor(e,{headers:r={},customFetch:s,region:n=ks.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=ac(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return lc(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:u}=r;u||(u=this.region);const l=new URL(`${this.url}/${e}`);u&&u!=="any"&&(a["x-region"]=u,l.searchParams.set("forceFunctionRegion",u));let c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const h=yield this.fetch(l.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(v=>{throw new uc(v)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new di(h);if(!h.ok)throw new fi(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof fi||n instanceof di?n.context:void 0}}})}}function hc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function dc(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function s(){var n=!1;try{n=this instanceof s}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}var I={},He={},Ge={},Je={},Qe={},Ye={},fc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},dt=fc();const pc=dt.fetch,Go=dt.fetch.bind(dt),Jo=dt.Headers,_c=dt.Request,gc=dt.Response,wt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Jo,Request:_c,Response:gc,default:Go,fetch:pc},Symbol.toStringTag,{value:"Module"})),vc=dc(wt);var nr={},pi;function Qo(){if(pi)return nr;pi=1,Object.defineProperty(nr,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return nr.default=t,nr}var _i;function Yo(){if(_i)return Ye;_i=1;var t=Ye&&Ye.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ye,"__esModule",{value:!0});const e=t(vc),r=t(Qo());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let u=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,h,d;let f=null,p=null,v=null,g=l.status,E=l.statusText;if(l.ok){if(this.method!=="HEAD"){const S=await l.text();S===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=S:p=JSON.parse(S))}const _=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(h=l.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");_&&w&&w.length>1&&(v=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,g=406,E="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const _=await l.text();try{f=JSON.parse(_),Array.isArray(f)&&l.status===404&&(p=[],f=null,g=200,E="OK")}catch{l.status===404&&_===""?(g=204,E="No Content"):f={message:_}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,E="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:p,count:v,status:g,statusText:E}});return this.shouldThrowOnError||(u=u.catch(l=>{var c,h,d;return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:`${(h=l?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=l?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),u.then(i,o)}returns(){return this}overrideTypes(){return this}}return Ye.default=s,Ye}var gi;function Xo(){if(gi)return Qe;gi=1;var t=Qe&&Qe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Qe,"__esModule",{value:!0});const e=t(Yo());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:u=a}={}){const l=u?`${u}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const u=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(u,`${n}`),this.url.searchParams.set(l,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:u=!1,format:l="text"}={}){var c;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,u?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${l}; for="${d}"; options=${h};`,l==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Qe.default=r,Qe}var vi;function nn(){if(vi)return Je;vi=1;var t=Je&&Je.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Je,"__esModule",{value:!0});const e=t(Xo());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let u="";a==="plain"?u="pl":a==="phrase"?u="ph":a==="websearch"&&(u="w");const l=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${u}fts${l}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return Je.default=r,Je}var yi;function Zo(){if(yi)return Ge;yi=1;var t=Ge&&Ge.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ge,"__esModule",{value:!0});const e=t(nn());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let u=!1;const l=(n??"*").split("").map(c=>/\s/.test(c)&&!u?"":(c==='"'&&(u=!u),c)).join("");return this.url.searchParams.set("select",l),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",u=[];if(this.headers.Prefer&&u.push(this.headers.Prefer),i&&u.push(`count=${i}`),o||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const l=n.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:u=!0}={}){const l="POST",c=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),u||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Ge.default=r,Ge}var Tt={},jt={},wi;function yc(){return wi||(wi=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.version=void 0,jt.version="0.0.0-automated"),jt}var bi;function wc(){if(bi)return Tt;bi=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.DEFAULT_HEADERS=void 0;const t=yc();return Tt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Tt}var mi;function bc(){if(mi)return He;mi=1;var t=He&&He.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(He,"__esModule",{value:!0});const e=t(Zo()),r=t(nn()),s=wc();class n{constructor(o,{headers:a={},schema:u,fetch:l}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=u,this.fetch=l}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:u=!1,get:l=!1,count:c}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;u||l?(h=u?"HEAD":"GET",Object.entries(a).filter(([v,g])=>g!==void 0).map(([v,g])=>[v,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([v,g])=>{d.searchParams.append(v,g)})):(h="POST",f=a);const p=Object.assign({},this.headers);return c&&(p.Prefer=`count=${c}`),new r.default({method:h,url:d,headers:p,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return He.default=n,He}var ki;function mc(){if(ki)return I;ki=1;var t=I&&I.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(I,"__esModule",{value:!0}),I.PostgrestError=I.PostgrestBuilder=I.PostgrestTransformBuilder=I.PostgrestFilterBuilder=I.PostgrestQueryBuilder=I.PostgrestClient=void 0;const e=t(bc());I.PostgrestClient=e.default;const r=t(Zo());I.PostgrestQueryBuilder=r.default;const s=t(nn());I.PostgrestFilterBuilder=s.default;const n=t(Xo());I.PostgrestTransformBuilder=n.default;const i=t(Yo());I.PostgrestBuilder=i.default;const o=t(Qo());return I.PostgrestError=o.default,I.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},I}var kc=mc();const Ec=hc(kc),{PostgrestClient:Sc,PostgrestQueryBuilder:Eg,PostgrestFilterBuilder:Sg,PostgrestTransformBuilder:$g,PostgrestBuilder:Tg,PostgrestError:jg}=Ec;function $c(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Tc=$c(),jc="2.11.15",Ac=`realtime-js/${jc}`,Pc="1.0.0",ea=1e4,Oc=1e3;var It;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(It||(It={}));var W;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(W||(W={}));var he;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(he||(he={}));var Es;(function(t){t.websocket="websocket"})(Es||(Es={}));var Re;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Re||(Re={}));class xc{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const u=s.decode(e.slice(o,o+i));o=o+i;const l=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:u,payload:l}}}class ta{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var O;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(O||(O={}));const Ei=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Cc(o,t,e,n),i),{})},Cc=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n?.type,o=r[t];return i&&!s.includes(i)?ra(i,o):Ss(o)},ra=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Uc(e,r)}switch(t){case O.bool:return Rc(e);case O.float4:case O.float8:case O.int2:case O.int4:case O.int8:case O.numeric:case O.oid:return Ic(e);case O.json:case O.jsonb:return Lc(e);case O.timestamp:return Dc(e);case O.abstime:case O.date:case O.daterange:case O.int4range:case O.int8range:case O.money:case O.reltime:case O.text:case O.time:case O.timestamptz:case O.timetz:case O.tsrange:case O.tstzrange:return Ss(e);default:return Ss(e)}},Ss=t=>t,Rc=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Ic=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Lc=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Uc=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ra(e,a))}return t},Dc=t=>typeof t=="string"?t.replace(" ","T"):t,sa=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Jr{constructor(e,r,s={},n=ea){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Si;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Si||(Si={}));class Lt{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lt.syncState(this.state,n,i,o),this.pendingDiffs.forEach(u=>{this.state=Lt.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Lt.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},u={};return this.map(i,(l,c)=>{o[l]||(u[l]=c)}),this.map(o,(l,c)=>{const h=i[l];if(h){const d=c.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),p=c.filter(g=>f.indexOf(g.presence_ref)<0),v=h.filter(g=>d.indexOf(g.presence_ref)<0);p.length>0&&(a[l]=p),v.length>0&&(u[l]=v)}else a[l]=c}),this.syncDiff(i,{joins:a,leaves:u},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,u)=>{var l;const c=(l=e[a])!==null&&l!==void 0?l:[];if(e[a]=this.cloneDeep(u),c.length>0){const h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,c,u)}),this.map(o,(a,u)=>{let l=e[a];if(!l)return;const c=u.map(h=>h.presence_ref);l=l.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=l,n(a,l,u),l.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $i;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})($i||($i={}));var Ti;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ti||(Ti={}));var pe;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(pe||(pe={}));class on{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Jr(this,he.join,this.params,this.timeout),this.rejoinTimer=new ta(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(he.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Lt(this),this.broadcastEndpointURL=sa(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==W.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(c=>e?.(pe.CHANNEL_ERROR,c)),this._onClose(()=>e?.(pe.CLOSED));const u={},l={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(c=>c.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e?.(pe.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,p=[];for(let v=0;v<f;v++){const g=d[v],{filter:{event:E,schema:m,table:_,filter:w}}=g,S=c&&c[v];if(S&&S.event===E&&S.schema===m&&S.table===_&&S.filter===w)p.push(Object.assign(Object.assign({},g),{id:S.id}));else{this.unsubscribe(),this.state=W.errored,e?.(pe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(pe.SUBSCRIBED);return}}).receive("error",c=>{this.state=W.errored,e?.(pe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e?.(pe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,u;const l=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=W.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(he.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Jr(this,he.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Jr(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:u,leave:l,join:c}=he;if(s&&[a,u,l,c].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,v,g;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(v=f.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,v,g,E,m,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,S=(p=f.filter)===null||p===void 0?void 0:p.event;return w&&((v=r.ids)===null||v===void 0?void 0:v.includes(w))&&(S==="*"||S?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const w=(m=(E=f?.filter)===null||E===void 0?void 0:E.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return w==="*"||w===((_=r?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:v,table:g,commit_timestamp:E,type:m,errors:_}=p;d=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:E,eventType:m,new:{},old:{},errors:_}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&on.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(he.close,{},e)}_onError(e){this._on(he.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Ei(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Ei(e.columns,e.old_record)),r}}const ji=()=>{},qc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Nc{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ea,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ji,this.ref=0,this.logger=ji,this.conn=null,this.sendBuffer=[],this.serializer=new xc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Gt(async()=>{const{default:u}=await Promise.resolve().then(()=>wt);return{default:u}},void 0,import.meta.url).then(({default:u})=>u(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Es.websocket}`,this.httpEndpoint=sa(e),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r?.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ta(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Tc),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Pc}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case It.connecting:return Re.Connecting;case It.open:return Re.Open;case It.closing:return Re.Closing;default:return Re.Closed}}isConnected(){return this.connectionState()===Re.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new on(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var u;(u=this.conn)===null||u===void 0||u.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:Ac};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(he.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Oc,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(he.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([qc],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class an extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function L(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Bc extends an{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $s extends an{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Mc=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const na=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gt(async()=>{const{default:s}=await Promise.resolve().then(()=>wt);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Fc=()=>Mc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gt(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url)).Response:Response}),Ts=t=>{if(Array.isArray(t))return t.map(r=>Ts(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Ts(s)}),e};var We=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const Qr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Wc=(t,e,r)=>We(void 0,void 0,void 0,function*(){const s=yield Fc();t instanceof s&&!r?.noResolveJson?t.json().then(n=>{e(new Bc(Qr(n),t.status||500))}).catch(n=>{e(new $s(Qr(n),n))}):e(new $s(Qr(t),t))}),Vc=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),r))};function Jt(t,e,r,s,n,i){return We(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,Vc(e,s,n,i)).then(u=>{if(!u.ok)throw u;return s?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>Wc(u,a,s))})})}function gr(t,e,r,s){return We(this,void 0,void 0,function*(){return Jt(t,"GET",e,r,s)})}function we(t,e,r,s,n){return We(this,void 0,void 0,function*(){return Jt(t,"POST",e,s,n,r)})}function zc(t,e,r,s,n){return We(this,void 0,void 0,function*(){return Jt(t,"PUT",e,s,n,r)})}function Kc(t,e,r,s){return We(this,void 0,void 0,function*(){return Jt(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function ia(t,e,r,s,n){return We(this,void 0,void 0,function*(){return Jt(t,"DELETE",e,s,n,r)})}var G=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const Hc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ai={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Gc{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=na(n)}uploadOrUpdate(e,r,s,n){return G(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ai),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,u&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:a},o?.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:l,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(L(i))return{data:null,error:i};throw i}})}upload(e,r,s){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return G(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let u;const l=Object.assign({upsert:Ai.upsert},n),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&s instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",s)):typeof FormData<"u"&&s instanceof FormData?(u=s,u.append("cacheControl",l.cacheControl)):(u=s,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:u,headers:c}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(u){if(L(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,r){return G(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield we(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new an("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}update(e,r,s){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return G(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}copy(e,r,s){return G(this,void 0,void 0,function*(){try{return{data:{path:(yield we(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return G(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield we(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return G(this,void 0,void 0,function*(){try{const n=yield we(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}download(e,r){return G(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield gr(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(L(a))return{data:null,error:a};throw a}})}info(e){return G(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield gr(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ts(s),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}exists(e){return G(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Kc(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(L(s)&&s instanceof $s){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof r?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(r?.transform||{});u!==""&&n.push(u);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${l}`)}}}remove(e){return G(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}list(e,r,s){return G(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Hc),r),{prefix:e||""});return{data:yield we(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Jc="2.7.1",Qc={"X-Client-Info":`storage-js/${Jc}`};var Xe=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class Yc{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},Qc),r),this.fetch=na(s)}listBuckets(){return Xe(this,void 0,void 0,function*(){try{return{data:yield gr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(L(e))return{data:null,error:e};throw e}})}getBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield gr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Xe(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Xe(this,void 0,void 0,function*(){try{return{data:yield zc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}}class Xc extends Yc{constructor(e,r={},s){super(e,r,s)}from(e){return new Gc(this.url,this.headers,e,this.fetch)}}const Zc="2.51.0";let Ot="";typeof Deno<"u"?Ot="deno":typeof document<"u"?Ot="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ot="react-native":Ot="node";const eh={"X-Client-Info":`supabase-js-${Ot}/${Zc}`},th={headers:eh},rh={schema:"public"},sh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nh={};var ih=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};const oh=t=>{let e;return t?e=t:typeof fetch>"u"?e=Go:e=fetch,(...r)=>e(...r)},ah=()=>typeof Headers>"u"?Jo:Headers,uh=(t,e,r)=>{const s=oh(r),n=ah();return(i,o)=>ih(void 0,void 0,void 0,function*(){var a;const u=(a=yield e())!==null&&a!==void 0?a:t;let l=new n(o?.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),s(i,Object.assign(Object.assign({},o),{headers:l}))})};var lh=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};function ch(t){return t.endsWith("/")?t:t+"/"}function hh(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:u,auth:l,realtime:c,global:h}=e,d={db:Object.assign(Object.assign({},u),n),auth:Object.assign(Object.assign({},l),i),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h?.headers)!==null&&r!==void 0?r:{}),(s=a?.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>lh(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const oa="2.71.0",nt=30*1e3,js=3,Yr=js*nt,dh="http://localhost:9999",fh="supabase.auth.token",ph={"X-Client-Info":`gotrue-js/${oa}`},As="X-Supabase-Api-Version",aa={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_h=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gh=10*60*1e3;class un extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function b(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class vh extends un{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function yh(t){return b(t)&&t.name==="AuthApiError"}class ua extends un{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class je extends un{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class ye extends je{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function wh(t){return b(t)&&t.name==="AuthSessionMissingError"}class ir extends je{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class or extends je{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ar extends je{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bh(t){return b(t)&&t.name==="AuthImplicitGrantRedirectError"}class Pi extends je{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ps extends je{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Xr(t){return b(t)&&t.name==="AuthRetryableFetchError"}class Oi extends je{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Os extends je{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),xi=` 	
\r=`.split(""),mh=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<xi.length;e+=1)t[xi[e].charCodeAt(0)]=-2;for(let e=0;e<vr.length;e+=1)t[vr[e].charCodeAt(0)]=e;return t})();function Ci(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(vr[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(vr[s]),e.queuedBits-=6}}function la(t,e,r){const s=mh[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Ri(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{Sh(o,s,r)};for(let o=0;o<t.length;o+=1)la(t.charCodeAt(o),n,i);return e.join("")}function kh(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Eh(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}kh(s,e)}}function Sh(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function $h(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)la(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Th(t){const e=[];return Eh(t,r=>e.push(r)),new Uint8Array(e)}function jh(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>Ci(n,r,s)),Ci(null,r,s),e.join("")}function Ah(t){return Math.round(Date.now()/1e3)+t}function Ph(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const le=()=>typeof window<"u"&&typeof document<"u",Oe={tested:!1,writable:!1},ca=()=>{if(!le())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oe.tested)return Oe.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Oe.tested=!0,Oe.writable=!0}catch{Oe.tested=!0,Oe.writable=!1}return Oe.writable};function Oh(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const ha=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gt(async()=>{const{default:s}=await Promise.resolve().then(()=>wt);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},xh=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",it=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},xe=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ve=async(t,e)=>{await t.removeItem(e)};class Ar{constructor(){this.promise=new Ar.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Ar.promiseConstructor=Promise;function Zr(t){const e=t.split(".");if(e.length!==3)throw new Os("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!_h.test(e[s]))throw new Os("JWT not in base64url format");return{header:JSON.parse(Ri(e[0])),payload:JSON.parse(Ri(e[1])),signature:$h(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ch(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Rh(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function Ih(t){return("0"+t.toString(16)).substr(-2)}function Lh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Ih).join("")}async function Uh(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Dh(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Uh(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ze(t,e,r=!1){const s=Lh();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await it(t,`${e}-code-verifier`,n);const i=await Dh(s);return[i,s===i?"plain":"s256"]}const qh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Nh(t){const e=t.headers.get(As);if(!e||!e.match(qh))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Bh(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Mh(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Fh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function et(t){if(!Fh.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function es(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var Wh=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Ce=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Vh=[502,503,504];async function Ii(t){var e;if(!xh(t))throw new Ps(Ce(t),0);if(Vh.includes(t.status))throw new Ps(Ce(t),t.status);let r;try{r=await t.json()}catch(i){throw new ua(Ce(i),i)}let s;const n=Nh(t);if(n&&n.getTime()>=aa["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Oi(Ce(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ye}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Oi(Ce(r),t.status,r.weak_password.reasons);throw new vh(Ce(r),t.status||500,s)}const zh=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function k(t,e,r,s){var n;const i=Object.assign({},s?.headers);i[As]||(i[As]=aa["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await Kh(t,e,r+a,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(u):{data:Object.assign({},u),error:null}}async function Kh(t,e,r,s,n,i){const o=zh(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(u){throw console.error(u),new Ps(Ce(u),0)}if(a.ok||await Ii(a),s?.noResolveJson)return a;try{return await a.json()}catch(u){await Ii(u)}}function fe(t){var e;let r=null;Qh(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Ah(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function Li(t){const e=fe(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function be(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Hh(t){return{data:t,error:null}}function Gh(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Wh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},u=Object.assign({},o);return{data:{properties:a,user:u},error:null}}function Jh(t){return t}function Qh(t){return t.access_token&&t.refresh_token&&t.expires_in}const ts=["global","local","others"];var Yh=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class Xh{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=ha(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=ts[0]){if(ts.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ts.join(", ")}`);try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(b(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:be})}catch(s){if(b(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Yh(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Gh,redirectTo:r?.redirectTo})}catch(r){if(b(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:be})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,u;try{const l={nextPage:null,lastPage:0,total:0},c=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Jh});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(u=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(p=>{const v=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);l[`${g}Page`]=v}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(b(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){et(e);try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:be})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){et(e);try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:be})}catch(s){if(b(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){et(e);try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:be})}catch(s){if(b(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){et(e.userId);try{const{data:r,error:s}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(b(r))return{data:null,error:r};throw r}}async _deleteFactor(e){et(e.userId),et(e.id);try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}}function Ui(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Zh(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const tt={debug:!!(globalThis&&ca()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class da extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ed extends da{}async function td(t,e,r){tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),tt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ed(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(tt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Zh();const rd={url:dh,storageKey:fh,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ph,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Di(t,e,r){return await r()}const rt={};class Mt{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mt.nextInstanceID,Mt.nextInstanceID+=1,this.instanceID>0&&le()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},rd),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Xh({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=ha(n.fetch),this.lock=n.lock||Di,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:le()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=td:this.lock=Di,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:ca()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ui(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ui(this.memoryStorage)),le()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=rt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){rt[this.storageKey]=Object.assign(Object.assign({},rt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=rt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){rt[this.storageKey]=Object.assign(Object.assign({},rt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${oa}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=Oh(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),le()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),bh(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return b(r)?{error:r}:{error:new ua("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:fe}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Ze(this.storage,this.storageKey)),i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:c,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:p},xform:fe})}else if("phone"in e){const{phone:c,password:h,options:d}=e;i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:fe})}else throw new or("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Li})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Li})}else throw new or("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new ir}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,u,l,c,h,d,f;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:g,wallet:E,statement:m,options:_}=e;let w;if(le())if(typeof E=="object")w=E;else{const y=window;if("solana"in y&&typeof y.solana=="object"&&("signIn"in y.solana&&typeof y.solana.signIn=="function"||"signMessage"in y.solana&&typeof y.solana.signMessage=="function"))w=y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=E}const S=new URL((r=_?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const y=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),m?{statement:m}:null));let R;if(Array.isArray(y)&&y[0]&&typeof y[0]=="object")R=y[0];else if(y&&typeof y=="object"&&"signedMessage"in y&&"signature"in y)R=y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)p=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),v=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${S.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(n=(s=_?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=_?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((u=_?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(c=_?.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const y=await w.signMessage(new TextEncoder().encode(p),"utf8");if(!y||!(y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=y}}try{const{data:g,error:E}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:jh(v)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:fe});if(E)throw E;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new ir}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:E})}catch(g){if(b(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await xe(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:fe});if(await ve(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ir}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(b(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:fe}),{data:u,error:l}=a;return l?{data:{user:null,session:null},error:l}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new ir}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:l})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:u}=e;let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Ze(this.storage,this.storageKey));const{error:h}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(s=u?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:l,code_challenge_method:c},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:u}=e,{data:l,error:c}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=u?.data)!==null&&n!==void 0?n:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new or("You must provide either an email or phone number.")}catch(a){if(b(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:fe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,l=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(n){if(b(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ze(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Hh})}catch(i){if(b(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new ye;const{error:n}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(b(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await k(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await k(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new or("You must provide either an email or phone number and a type")}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await xe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Yr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await xe(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=es()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,l,c)=>(!o&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,l,c))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:be}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ye}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:be})})}catch(r){if(b(r))return wh(r)&&(await this._removeSession(),await ve(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new ye;const o=n.session;let a=null,u=null;this.flowType==="pkce"&&e.email!=null&&([a,u]=await Ze(this.storage,this.storageKey));const{data:l,error:c}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:u}),jwt:o.access_token,xform:be});if(c)throw c;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(b(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ye;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=Zr(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(b(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new ye;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!le())throw new ar("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ar(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Pi("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ar("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Pi("No code detected.");const{data:m,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:u,token_type:l}=e;if(!i||!a||!o||!l)throw new ar("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;u&&(d=parseInt(u));const f=d-c;f*1e3<=nt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,c);const{data:v,error:g}=await this._getUser(i);if(g)throw g;const E={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:l,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:e.type},error:null}}catch(s){if(b(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await xe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(yh(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ve(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Ph(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ze(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(b(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,u,l,c;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(l=h.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0})});if(n)throw n;return le()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(b(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Rh(async n=>(n>0&&await Ch(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fe})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Xr(i)&&Date.now()+o-s<nt})}catch(s){if(this._debug(r,"error",s),b(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),le()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await xe(this.storage,this.storageKey);if(n&&this.userStorage){let o=await xe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await it(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:es()}else if(n&&!n.user&&!n.user){const o=await xe(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await ve(this.storage,this.storageKey+"-user"),await it(this.storage,this.storageKey,n)):n.user=es()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Yr;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Yr}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Xr(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new ye;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ar;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ye;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),b(i)){const o={session:null,error:i};return Xr(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await it(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=structuredClone(n);await it(this.storage,this.storageKey,i)}else{const n=structuredClone(r);await it(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await ve(this.storage,this.storageKey),await ve(this.storage,this.storageKey+"-code-verifier"),await ve(this.storage,this.storageKey+"-user"),this.userStorage&&await ve(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&le()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),nt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/nt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${nt}ms, refresh threshold is ${js} ticks`),n<=js&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof da)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!le()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ze(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:l}=await k(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(e.factorType==="totp"&&(!((n=u?.totp)===null||n===void 0)&&n.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(b(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(b(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=e?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Zr(n.access_token);let a=null;o.aal&&(a=o.aal);let u=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(u="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+gh>n)return s;const{data:i,error:o}=await k(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};s=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:u}}=Zr(s);r?.allowExpired||Bh(i.exp);const l=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!l){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const c=Mh(n.alg),h=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,Th(`${a}.${u}`)))throw new Os("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(b(s))return{data:null,error:s};throw s}}}Mt.nextInstanceID=0;const sd=Mt;class nd extends sd{constructor(e){super(e)}}var id=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(s.next(c))}catch(h){o(h)}}function u(c){try{l(s.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):n(c.value).then(a,u)}l((s=s.apply(t,e||[])).next())})};class od{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=ch(e),u=new URL(a);this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const l=`sb-${u.hostname.split(".")[0]}-auth-token`,c={db:rh,realtime:nh,auth:Object.assign(Object.assign({},sh),{storageKey:l}),global:th},h=hh(s??{},c);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=uh(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Sc(new URL("rest/v1",u).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new cc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Xc(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return id(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:u},l,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),l),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:u,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Nc(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s?.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ad=(t,e,r)=>new od(t,e,r),ud="https://vycjpmuyscfygstjjied.supabase.co",ld="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ";ad(ud,ld);var rs;function fa(t){return{lang:t?.lang??rs?.lang,message:t?.message,abortEarly:t?.abortEarly??rs?.abortEarly,abortPipeEarly:t?.abortPipeEarly??rs?.abortPipeEarly}}var cd;function hd(t){return cd?.get(t)}var dd;function fd(t){return dd?.get(t)}var pd;function _d(t,e){return pd?.get(t)?.get(e)}function gd(t){const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&Object.getPrototypeOf(t)?.constructor?.name)??"null":e}function ee(t,e,r,s,n){const i=n&&"input"in n?n.input:r.value,o=n?.expected??t.expects??null,a=n?.received??gd(i),u={kind:t.kind,type:t.type,input:i,expected:o,received:a,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${a}`,requirement:t.requirement,path:n?.path,issues:n?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},l=t.kind==="schema",c=n?.message??t.message??_d(t.reference,u.lang)??(l?fd(u.lang):null)??s.message??hd(u.lang);c!==void 0&&(u.message=typeof c=="function"?c(u):c),l&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function H(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},fa())}}}function pa(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function vd(t,e){const r=[...new Set(t)];return r.length>1?`(${r.join(` ${e} `)})`:r[0]??"never"}var xs=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function _a(t){return{kind:"transformation",type:"transform",reference:_a,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function yd(t,e,r){return typeof t.fallback=="function"?t.fallback(e,r):t.fallback}function ln(t,e,r){return typeof t.default=="function"?t.default(e,r):t.default}function cn(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function ga(){return{kind:"schema",type:"any",reference:ga,expects:"any",async:!1,get"~standard"(){return H(this)},"~run"(t){return t.typed=!0,t}}}function va(t,e){return{kind:"schema",type:"array",reference:va,expects:"Array",async:!1,item:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){const n=r.value;if(Array.isArray(n)){r.typed=!0,r.value=[];for(let i=0;i<n.length;i++){const o=n[i],a=this.item["~run"]({value:o},s);if(a.issues){const u={type:"array",origin:"value",input:n,key:i,value:o};for(const l of a.issues)l.path?l.path.unshift(u):l.path=[u],r.issues?.push(l);if(r.issues||(r.issues=a.issues),s.abortEarly){r.typed=!1;break}}a.typed||(r.typed=!1),r.value.push(a.value)}}else ee(this,"type",r,s);return r}}}function Cs(t){return{kind:"schema",type:"boolean",reference:Cs,expects:"boolean",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="boolean"?e.typed=!0:ee(this,"type",e,r),e}}}function ya(t){return{kind:"schema",type:"date",reference:ya,expects:"Date",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return e.value instanceof Date?isNaN(e.value)?ee(this,"type",e,r,{received:'"Invalid Date"'}):e.typed=!0:ee(this,"type",e,r),e}}}function hn(t){return{kind:"schema",type:"function",reference:hn,expects:"Function",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="function"?e.typed=!0:ee(this,"type",e,r),e}}}function wa(t,e){return{kind:"schema",type:"instance",reference:wa,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){return r.value instanceof this.class?r.typed=!0:ee(this,"type",r,s),r}}}function X(t,e){return{kind:"schema",type:"loose_object",reference:X,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){const n=r.value;if(n&&typeof n=="object"){r.typed=!0,r.value={};for(const i in this.entries){const o=this.entries[i];if(i in n||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const a=i in n?n[i]:ln(o),u=o["~run"]({value:a},s);if(u.issues){const l={type:"object",origin:"value",input:n,key:i,value:a};for(const c of u.issues)c.path?c.path.unshift(l):c.path=[l],r.issues?.push(c);if(r.issues||(r.issues=u.issues),s.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value[i]=u.value}else if(o.fallback!==void 0)r.value[i]=yd(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(ee(this,"key",r,s,{input:void 0,expected:`"${i}"`,path:[{type:"object",origin:"key",input:n,key:i,value:n[i]}]}),s.abortEarly))break}if(!r.issues||!s.abortEarly)for(const i in n)pa(n,i)&&!(i in this.entries)&&(r.value[i]=n[i])}else ee(this,"type",r,s);return r}}}function xt(t,e){return{kind:"schema",type:"nullish",reference:xt,expects:`(${t.expects} | null | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return H(this)},"~run"(r,s){return(r.value===null||r.value===void 0)&&(this.default!==void 0&&(r.value=ln(this,r,s)),r.value===null||r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function yr(t){return{kind:"schema",type:"number",reference:yr,expects:"number",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:ee(this,"type",e,r),e}}}function wr(t,e){return{kind:"schema",type:"optional",reference:wr,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return H(this)},"~run"(r,s){return r.value===void 0&&(this.default!==void 0&&(r.value=ln(this,r,s)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function ba(t,e,r){return{kind:"schema",type:"record",reference:ba,expects:"Object",async:!1,key:t,value:e,message:r,get"~standard"(){return H(this)},"~run"(s,n){const i=s.value;if(i&&typeof i=="object"){s.typed=!0,s.value={};for(const o in i)if(pa(i,o)){const a=i[o],u=this.key["~run"]({value:o},n);if(u.issues){const c={type:"object",origin:"key",input:i,key:o,value:a};for(const h of u.issues)h.path=[c],s.issues?.push(h);if(s.issues||(s.issues=u.issues),n.abortEarly){s.typed=!1;break}}const l=this.value["~run"]({value:a},n);if(l.issues){const c={type:"object",origin:"value",input:i,key:o,value:a};for(const h of l.issues)h.path?h.path.unshift(c):h.path=[c],s.issues?.push(h);if(s.issues||(s.issues=l.issues),n.abortEarly){s.typed=!1;break}}(!u.typed||!l.typed)&&(s.typed=!1),u.typed&&(s.value[u.value]=l.value)}}else ee(this,"type",s,n);return s}}}function U(t){return{kind:"schema",type:"string",reference:U,expects:"string",async:!1,message:t,get"~standard"(){return H(this)},"~run"(e,r){return typeof e.value=="string"?e.typed=!0:ee(this,"type",e,r),e}}}function qi(t){let e;if(t)for(const r of t)e?e.push(...r.issues):e=r.issues;return e}function ma(t,e){return{kind:"schema",type:"union",reference:ma,expects:vd(t.map(r=>r.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return H(this)},"~run"(r,s){let n,i,o;for(const a of this.options){const u=a["~run"]({value:r.value},s);if(u.typed)if(u.issues)i?i.push(u):i=[u];else{n=u;break}else o?o.push(u):o=[u]}if(n)return n;if(i){if(i.length===1)return i[0];ee(this,"type",r,s,{issues:qi(i)}),r.typed=!0}else{if(o?.length===1)return o[0];ee(this,"type",r,s,{issues:qi(o)})}return r}}}function ka(){return{kind:"schema",type:"unknown",reference:ka,expects:"unknown",async:!1,get"~standard"(){return H(this)},"~run"(t){return t.typed=!0,t}}}function ft(t,e,r){const s=t["~run"]({value:e},fa(r));if(s.issues)throw new xs(s.issues);return s.value}function ur(...t){return{...t[0],pipe:t,get"~standard"(){return H(this)},"~run"(e,r){for(const s of t)if(s.kind!=="metadata"){if(e.issues&&(s.kind==="schema"||s.kind==="transformation")){e.typed=!1;break}(!e.issues||!r.abortEarly&&!r.abortPipeEarly)&&(e=s["~run"](e,r))}return e}}}var wd=Object.defineProperty,bd=(t,e,r)=>e in t?wd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rs=(t,e,r)=>bd(t,typeof e!="symbol"?e+"":e,r),md=Object.defineProperty,kd=(t,e,r)=>e in t?md(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ed=(t,e,r)=>kd(t,e+"",r);function Sd(t,e){return r=>r instanceof t&&r.type===e}function Ea(t,e){e||(e=[]);const r=Symbol(t);class s extends Error{constructor(...i){const o=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...o),Ed(this,"type",r),this.name=t}}return Object.defineProperty(s,"name",{value:t}),[s,Sd(s,r)]}const[$d,Td]=Ea("CancelledError","Promise was canceled"),[jd,Ag]=Ea("TimeoutError",(t,e)=>[`Timeout reached: ${t}ms`,{cause:e}]),Sa=Symbol("Resolved");function Ni(t){return Array.isArray(t)&&t[0]===Sa}function Ad(t){return[Sa,t]}function Bi(t,e){return t.reject=e.reject,t.abort=e.abort,t}let N=class Is extends Promise{constructor(e,r){let s,n;super((i,o)=>{let a,u;typeof e=="function"?(a=e,u=r):u=e;const l=[],c=y=>(...R)=>{const tr=y(...R);return l.forEach(Zu=>Zu()),tr},h=new AbortController,{signal:d}=h;n=y=>{!d.aborted&&h.abort(y)};const f=()=>d.reason,p=y=>{const R=()=>{y(f())};d.addEventListener("abort",R,!0);const tr=()=>{d.removeEventListener("abort",R,!0)};return l.push(tr),tr},v=c(y=>{i(y),n(Ad(y))});s=c(y=>{o(y),n(y)}),u||(u={});const{abortSignal:g,rejectOnAbort:E=!0}=u;if(g)if(g.aborted){const{reason:y}=g;if(E)return s(y);n(y)}else{const y=()=>{n(g.reason)};g.addEventListener("abort",y),l.push(()=>{g.removeEventListener("abort",y)})}E&&p(o);const{timeout:m}=u;if(m){const y=setTimeout(()=>{n(new jd(m))},m);l.push(()=>{clearTimeout(y)})}const _=()=>d.aborted,w=()=>Ni(f()),S=()=>{const y=f();return Ni(y)?y[1]:void 0};try{const y=a&&a(v,s,{abortReason:f,abortSignal:d,isAborted:_,isResolved:w,onAborted:p,onResolved:R=>p(()=>{w()&&R(S())}),resolved:S,throwIfAborted(){if(_())throw f()}});y instanceof Promise&&y.catch(s)}catch(y){s(y)}}),Rs(this,"abort"),Rs(this,"reject"),this.abort=n,this.reject=s}static fn(e,r){return new Is(async(s,n,i)=>{try{s(await e(i))}catch(o){n(o)}},r)}static resolve(e){return this.fn(()=>e)}static reject(e){return new Is((r,s)=>{s(e)})}cancel(){this.abort(new $d)}catch(e){return this.then(void 0,e)}finally(e){return Bi(super.finally(e),this)}then(e,r){return Bi(super.then(e,r),this)}};function Mi(t,e){return t.resolve=e.resolve,t}let Pd=class Ls extends N{constructor(e,r){let s,n;typeof e=="function"?(s=e,n=r):n=e;let i;super((o,a,u)=>{i=o,s&&s(o,a,u)},n),Rs(this,"resolve"),this.resolve=i}static fn(e,r){return new Ls((s,n,i)=>{try{Promise.resolve(e(i)).then(s,n)}catch(o){n(o)}},r)}static resolve(e){return this.fn(()=>e)}static reject(e){return new Ls((r,s)=>{s(e)})}catch(e){return this.then(void 0,e)}finally(e){return Mi(super.finally(e),this)}then(e,r){return Mi(super.then(e,r),this)}};function $a(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function Od(t){return t.replace(/_([a-z])/g,(e,r)=>`-${r.toLowerCase()}`)}function Ta(t){return`tapps/${t}`}function ae(t,e){sessionStorage.setItem(Ta(t),JSON.stringify(e))}function J(t){const e=sessionStorage.getItem(Ta(t));try{return e?JSON.parse(e):void 0}catch{}}function Pr(...t){const e=t.flat(1);return[e.push.bind(e),()=>{e.forEach(r=>{r()})}]}function ja(t,e){e||(e={});const{textColor:r,bgColor:s,shouldLog:n}=e,i=n===void 0?!0:n,o=typeof i=="boolean"?()=>i:i,a=(u,l,...c)=>{if(l||o()){const h="font-weight:bold;padding:0 5px;border-radius:100px",[d,f,p]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[u];console[u](`%c${p} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${t}`,`${h};background-color:${d};color:${f}`,"",`${h};${r?`color:${r};`:""}${s?`background-color:${s}`:""}`,...c)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((u,[l,c])=>(u[l]=a.bind(void 0,l,!1),u[c]=a.bind(void 0,l,!0),u),{})}function Aa(t){return{lang:t?.lang??void 0,message:t?.message,abortEarly:t?.abortEarly??void 0,abortPipeEarly:t?.abortPipeEarly??void 0}}function xd(t,e){var r;return(r=void 0)==null?void 0:r.get(e)}function Cd(t){var e,r;const s=typeof t;return s==="string"?`"${t}"`:s==="number"||s==="bigint"||s==="boolean"?`${t}`:s==="object"||s==="function"?(t&&((r=(e=Object.getPrototypeOf(t))==null?void 0:e.constructor)==null?void 0:r.name))??"null":s}function te(t,e,r,s,n){const i=n&&"input"in n?n.input:r.value,o=n?.expected??t.expects??null,a=n?.received??Cd(i),u={kind:t.kind,type:t.type,input:i,expected:o,received:a,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${a}`,requirement:t.requirement,path:n?.path,issues:n?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},l=t.kind==="schema",c=n?.message??t.message??xd(t.reference,u.lang)??(l?(u.lang,void 0):null)??s.message??(u.lang,void 0);c&&(u.message=typeof c=="function"?c(u):c),l&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function ue(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},Aa())}}}function Pa(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Rd(t,e){const r=[...new Set(t)];return r.length>1?`(${r.join(` ${e} `)})`:r[0]??"never"}var Id=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function Oa(t,e){return{kind:"validation",type:"check",reference:Oa,async:!1,expects:null,requirement:t,message:e,"~run"(r,s){return r.typed&&!this.requirement(r.value)&&te(this,"input",r,s),r}}}function xa(t){return{kind:"validation",type:"integer",reference:xa,async:!1,expects:null,requirement:Number.isInteger,message:t,"~run"(e,r){return e.typed&&!this.requirement(e.value)&&te(this,"integer",e,r),e}}}function Se(t){return{kind:"transformation",type:"transform",reference:Se,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function Ca(t,e,r){return typeof t.default=="function"?t.default(e,r):t.default}function Ld(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function Ct(t){return{kind:"schema",type:"boolean",reference:Ct,expects:"boolean",async:!1,message:t,get"~standard"(){return ue(this)},"~run"(e,r){return typeof e.value=="boolean"?e.typed=!0:te(this,"type",e,r),e}}}function Ra(t){return{kind:"schema",type:"date",reference:Ra,expects:"Date",async:!1,message:t,get"~standard"(){return ue(this)},"~run"(e,r){return e.value instanceof Date?isNaN(e.value)?te(this,"type",e,r,{received:'"Invalid Date"'}):e.typed=!0:te(this,"type",e,r),e}}}function Ia(t,e){return{kind:"schema",type:"instance",reference:Ia,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return ue(this)},"~run"(r,s){return r.value instanceof this.class?r.typed=!0:te(this,"type",r,s),r}}}function dn(t){return{kind:"schema",type:"lazy",reference:dn,expects:"unknown",async:!1,getter:t,get"~standard"(){return ue(this)},"~run"(e,r){return this.getter(e.value)["~run"](e,r)}}}function bt(t,e){return{kind:"schema",type:"loose_object",reference:bt,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return ue(this)},"~run"(r,s){var n;const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const o in this.entries){const a=this.entries[o];if(o in i||(a.type==="exact_optional"||a.type==="optional"||a.type==="nullish")&&a.default!==void 0){const u=o in i?i[o]:Ca(a),l=a["~run"]({value:u},s);if(l.issues){const c={type:"object",origin:"value",input:i,key:o,value:u};for(const h of l.issues)h.path?h.path.unshift(c):h.path=[c],(n=r.issues)==null||n.push(h);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}l.typed||(r.typed=!1),r.value[o]=l.value}else if(a.type!=="exact_optional"&&a.type!=="optional"&&a.type!=="nullish"&&(te(this,"key",r,s,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:i,key:o,value:i[o]}]}),s.abortEarly))break}if(!r.issues||!s.abortEarly)for(const o in i)Pa(i,o)&&!(o in this.entries)&&(r.value[o]=i[o])}else te(this,"type",r,s);return r}}}function Or(t){return{kind:"schema",type:"number",reference:Or,expects:"number",async:!1,message:t,get"~standard"(){return ue(this)},"~run"(e,r){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:te(this,"type",e,r),e}}}function C(t,e){return{kind:"schema",type:"optional",reference:C,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return ue(this)},"~run"(r,s){return r.value===void 0&&(this.default!==void 0&&(r.value=Ca(this,r,s)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,s)}}}function La(t,e,r){return{kind:"schema",type:"record",reference:La,expects:"Object",async:!1,key:t,value:e,message:r,get"~standard"(){return ue(this)},"~run"(s,n){var i,o;const a=s.value;if(a&&typeof a=="object"){s.typed=!0,s.value={};for(const u in a)if(Pa(a,u)){const l=a[u],c=this.key["~run"]({value:u},n);if(c.issues){const d={type:"object",origin:"key",input:a,key:u,value:l};for(const f of c.issues)f.path=[d],(i=s.issues)==null||i.push(f);if(s.issues||(s.issues=c.issues),n.abortEarly){s.typed=!1;break}}const h=this.value["~run"]({value:l},n);if(h.issues){const d={type:"object",origin:"value",input:a,key:u,value:l};for(const f of h.issues)f.path?f.path.unshift(d):f.path=[d],(o=s.issues)==null||o.push(f);if(s.issues||(s.issues=h.issues),n.abortEarly){s.typed=!1;break}}(!c.typed||!h.typed)&&(s.typed=!1),c.typed&&(s.value[c.value]=h.value)}}else te(this,"type",s,n);return s}}}function P(t){return{kind:"schema",type:"string",reference:P,expects:"string",async:!1,message:t,get"~standard"(){return ue(this)},"~run"(e,r){return typeof e.value=="string"?e.typed=!0:te(this,"type",e,r),e}}}function Fi(t){let e;if(t)for(const r of t)e?e.push(...r.issues):e=r.issues;return e}function fn(t,e){return{kind:"schema",type:"union",reference:fn,expects:Rd(t.map(r=>r.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return ue(this)},"~run"(r,s){let n,i,o;for(const a of this.options){const u=a["~run"]({value:r.value},s);if(u.typed)if(u.issues)i?i.push(u):i=[u];else{n=u;break}else o?o.push(u):o=[u]}if(n)return n;if(i){if(i.length===1)return i[0];te(this,"type",r,s,{issues:Fi(i)}),r.typed=!0}else{if(o?.length===1)return o[0];te(this,"type",r,s,{issues:Fi(o)})}return r}}}function Ua(){return{kind:"schema",type:"unknown",reference:Ua,expects:"unknown",async:!1,get"~standard"(){return ue(this)},"~run"(t){return t.typed=!0,t}}}function Da(t,e,r){const s=t["~run"]({value:e},Aa(r));if(s.issues)throw new Id(s.issues);return s.value}function $e(...t){return{...t[0],pipe:t,get"~standard"(){return ue(this)},"~run"(e,r){for(const s of t)if(s.kind!=="metadata"){if(e.issues&&(s.kind==="schema"||s.kind==="transformation")){e.typed=!1;break}(!e.issues||!r.abortEarly&&!r.abortPipeEarly)&&(e=s["~run"](e,r))}return e}}}function Ud(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function Dd(t){return Object.entries(t).reduce((e,[r,s])=>(e[Ud(r)]=s,e),{})}function Us(t){const e=Dd(t);for(const r in e){const s=e[r];s&&typeof s=="object"&&!(s instanceof Date)&&(e[r]=Array.isArray(s)?s.map(Us):Us(s))}return e}function pn(t){return Se(e=>t?Us(e):e)}function qa(t){return e=>$e(t,pn(e))}function qd(t){return(e,r)=>Da($e(t,pn(r)),e)}function _n(){return Se(JSON.parse)}function gn(t){const e=qa(t);return r=>$e(P(),_n(),e(r))}function Na(t){return Se(e=>{const r={};return new URLSearchParams(e).forEach((s,n)=>{const i=r[n];Array.isArray(i)?i.push(s):i===void 0?r[n]=s:r[n]=[i,s]}),Da(t,r)})}function Ba(t){return e=>$e(fn([P(),Ia(URLSearchParams)]),Na(t),pn(e))}const Wi=C(dn(()=>Wd())),Nd=bt({id:Or(),photo_url:C(P()),type:P(),title:P(),username:C(P())}),Bd=bt({added_to_attachment_menu:C(Ct()),allows_write_to_pm:C(Ct()),first_name:P(),id:Or(),is_bot:C(Ct()),is_premium:C(Ct()),last_name:C(P()),language_code:C(P()),photo_url:C(P()),username:C(P())}),Md=bt({auth_date:$e(P(),Se(t=>new Date(Number(t)*1e3)),Ra()),can_send_after:C($e(P(),Se(Number),xa())),chat:C(dn(()=>Fd())),chat_type:C(P()),chat_instance:C(P()),hash:P(),query_id:C(P()),receiver:Wi,start_param:C(P()),signature:P(),user:Wi}),Fd=gn(Nd),Wd=gn(Bd),Vd=Ba(Md);function mt(t){return/^#[\da-f]{6}$/i.test(t)}function zd(t){return/^#[\da-f]{3}$/i.test(t)}function Kd(t){const e=t.replace(/\s/g,"").toLowerCase();if(mt(e))return e;if(zd(e)){let s="#";for(let n=0;n<3;n+=1)s+=e[1+n].repeat(2);return s}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((s,n)=>s+parseInt(n,10).toString(16).padStart(2,"0"),"#")}const Ma=qa(La(P(),$e(fn([P(),Or()]),Se(t=>typeof t=="number"?`#${(t&16777215).toString(16).padStart(6,"0")}`:t),Oa(mt)))),ss=C($e(P(),Se(t=>t==="1"))),Vi=gn(Ma()),Hd=bt({tgWebAppBotInline:ss,tgWebAppData:C(Vd()),tgWebAppDefaultColors:C(Vi()),tgWebAppFullscreen:ss,tgWebAppPlatform:P(),tgWebAppShowSettings:ss,tgWebAppStartParam:C(P()),tgWebAppThemeParams:Vi(),tgWebAppVersion:P()}),Fa=Ba(Hd),Wa=qd(Fa()),Gd=bt({eventType:P(),eventData:C(Ua())});function Jd(t){try{return Ld(Fa(),t)}catch{return!1}}function Qd(t){return{all:t=t||new Map,on:function(e,r){var s=t.get(e);s?s.push(r):t.set(e,[r])},off:function(e,r){var s=t.get(e);s&&(r?s.splice(s.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var s=t.get(e);s&&s.slice().map(function(n){n(r)}),(s=t.get("*"))&&s.slice().map(function(n){n(e,r)})}}}let ot;function Yd(t,e){ot&&ot.set(t,e)||e()}function Ft(t){if(ot)return t();ot=new Map;try{t()}finally{ot.forEach(e=>e()),ot=void 0}}function kt(t,e){e||(e={});const r=e.equals||Object.is;let s=[],n=t;const i=l=>{if(!r(n,l)){const c=n;n=l,Yd(u,()=>{[...s].forEach(([h,d])=>{h(l,c),d&&a(h,!0)})})}};function o(l){const c=typeof l!="object"?{once:l}:l;return{once:c.once||!1,signal:c.signal||!1}}const a=(l,c)=>{const h=o(c),d=s.findIndex(([f,p])=>f===l&&p.once===h.once&&p.signal===h.signal);d>=0&&s.splice(d,1)},u=Object.assign(function(){return Xd(u),n},{destroy(){s=[]},set:i,reset(){i(t)},sub(l,c){return s.push([l,o(c)]),()=>a(l,c)},unsub:a,unsubAll(){s=s.filter(l=>l[1].signal)}});return u}const Ut=[];function Xd(t){Ut.length&&Ut[Ut.length-1].add(t)}function Zd(t,e){let r=new Set,s;function n(){return s||(s=kt(o(),e))}function i(){n().set(o())}function o(){r.forEach(l=>{l.unsub(i,{signal:!0})});const a=new Set;let u;Ut.push(a);try{u=t()}finally{Ut.pop()}return a.forEach(l=>{l.sub(i,{signal:!0})}),r=a,u}return Object.assign(function(){return n()()},{destroy(){n().destroy()},sub(...a){return n().sub(...a)},unsub(...a){n().unsub(...a)},unsubAll(...a){n().unsubAll(...a)}})}var ef=Object.defineProperty,tf=(t,e,r)=>e in t?ef(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ds=(t,e,r)=>tf(t,typeof e!="symbol"?e+"":e,r);function Va(t,e){return r=>r instanceof t&&r.type===e}function B(t,e){e||(e=[]);const r=Symbol(t);class s extends Error{constructor(...i){const o=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...o),Ds(this,"type",r),this.name=t}}return Object.defineProperty(s,"name",{value:t}),[s,Va(s,r)]}function rf(t,e,r){const s=Symbol(t);class n extends B(t,r)[0]{constructor(...o){super(...o),Ds(this,"data"),Ds(this,"type",s),this.data=e(...o)}}return Object.defineProperty(n,"name",{value:t}),[n,Va(n,s)]}function za(t){return cn(X({TelegramWebviewProxy:X({postEvent:hn()})}),t)}function sf(){try{return window.self!==window.top}catch{return!0}}function nf(t,e){const r=new Map,s=Qd(),n=(i,o,a)=>{a||(a=!1);const u=r.get(i)||new Map;r.set(i,u);const l=u.get(o)||[];u.set(o,l);const c=l.findIndex(h=>h[1]===a);if(c>=0&&(s.off(i,l[c][0]),l.splice(c,1),!l.length&&(u.delete(o),!u.size))){const h=r.size;r.delete(i),h&&!r.size&&e()}};return[function(i,o,a){!r.size&&t();const u=()=>{n(i,o,a)},l=(...d)=>{a&&u(),i==="*"?o(d):o(...d)};s.on(i,l);const c=r.get(i)||new Map;r.set(i,c);const h=c.get(o)||[];return c.set(o,h),h.push([l,a||!1]),u},n,s.emit,function(){const i=r.size;s.all.clear(),r.clear(),i&&e()}]}function ns(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}let of=!1;const Wt=kt(ja("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return of}}));function Ka(t,e,r,s){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:r,set:s})}function zi(t,e){const r=t[e];Ka(t,e,()=>r,s=>{Object.entries(s).forEach(([n,i])=>{r[n]=i})})}function Ki(t,e,r){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}function is(t,e,r){const s=t[e],n=[r];typeof s=="function"&&n.push(s);const i=(...a)=>{n.forEach(u=>{u(...a)})},o=Object.assign((...a)=>{i(...a)},{unwrap(){const{length:a}=n;if(a===1){delete t[e];return}if(a===2){Ki(t,e,n[1]);return}n.unshift(1),Ki(t,e,i)}});Ka(t,e,()=>o,a=>{n.push(a)})}const af={clipboard_text_received:X({req_id:U(),data:xt(U())}),custom_method_invoked:X({req_id:U(),result:wr(ka()),error:wr(U())}),popup_closed:xt(X({button_id:xt(U(),()=>{})}),{}),viewport_changed:X({height:yr(),width:xt(yr(),()=>window.innerWidth),is_state_stable:Cs(),is_expanded:Cs()}),theme_changed:X({theme_params:Ma()})};function Hi(t){if(t.source!==window.parent)return;let e;try{e=ft(ur(U(),_n(),Gd),t.data)}catch{return}const{eventType:r,eventData:s}=e,n=af[r];let i;try{i=n?ft(n,s):s}catch(o){return Wt().forceError([`An error occurred processing the "${r}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),e,o)}uf(r,i)}const[D,Qt,uf,Pg]=nf(()=>{const t=window;!t.TelegramGameProxy&&(t.TelegramGameProxy={}),is(t.TelegramGameProxy,"receiveEvent",ns),zi(t,"TelegramGameProxy"),!t.Telegram&&(t.Telegram={}),!t.Telegram.WebView&&(t.Telegram.WebView={}),is(t.Telegram.WebView,"receiveEvent",ns),zi(t.Telegram,"WebView"),is(t,"TelegramGameProxy_receiveEvent",ns),window.addEventListener("message",Hi)},()=>{[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(t=>{const e=window;let r=[void 0,e];for(const i of t)if(r=[r[1],r[1][i]],!r[1])return;const[s,n]=r;"unwrap"in n&&(n.unwrap(),s&&s!==e&&!Object.keys(s).length&&delete e[t[0]])}),window.removeEventListener("message",Hi)}),[lf,Og]=B("MethodUnsupportedError",(t,e)=>[`Method "${t}" is unsupported in Mini Apps version ${e}`]),[cf,xg]=B("MethodParameterUnsupportedError",(t,e,r)=>[`Parameter "${e}" of "${t}" method is unsupported in Mini Apps version ${r}`]),[hf,Cg]=rf("LaunchParamsRetrieveError",t=>({errors:t}),t=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","📖 Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","","Collected errors:",...t.map(([e,r])=>`Source: ${e} / ${r instanceof Error?r.message:String(r)}`)].join(`
`)]);B("InvalidLaunchParamsError",(t,e)=>[`Invalid value for launch params: ${t}`,{cause:e}]);const[df,Rg]=B("UnknownEnvError"),[ff,Ig]=B("InvokeCustomMethodError",t=>[`Server returned error: ${t}`]),pf=kt((...t)=>{try{window.parent.postMessage(...t)}catch(e){e instanceof SyntaxError?Wt().forceError("Unable to call window.parent.postMessage due to incorrectly configured target origin. Use the setTargetOrigin method to allow this origin to receive events",e):Wt().forceError(e)}}),_f=(...t)=>pf()(...t),gf=kt("https://web.telegram.org");function vn(t,e){Wt().log("Posting event:",e?{eventType:t,eventData:e}:{eventType:t});const r=window,s=JSON.stringify({eventType:t,eventData:e});if(sf())return _f(s,gf());if(za(r)){r.TelegramWebviewProxy.postEvent(t,JSON.stringify(e));return}if(cn(X({external:X({notify:hn()})}),r)){r.external.notify(s);return}throw new df}function yn(t,e,r){r||(r={});const{capture:s}=r,[n,i]=Pr();return new N(o=>{(Array.isArray(e)?e:[e]).forEach(a=>{n(D(a,u=>{(!s||(Array.isArray(e)?s({event:a,payload:u}):s(u)))&&o(u)}))}),(r.postEvent||vn)(t,r.params)},r).finally(i)}const Gi="launchParams";function Ji(t){return t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function Ha(){const t=[];for(const[e,r]of[[()=>Ji(window.location.href),"window.location.href"],[()=>{const s=performance.getEntriesByType("navigation")[0];return s&&Ji(s.name)},"performance navigation entries"],[()=>J(Gi),"local storage"]]){const s=e();if(!s){t.push([r,new Error("Source is empty")]);continue}if(Jd(s))return ae(Gi,s),s;try{Wa(s)}catch(n){t.push([r,n])}}throw new hf(t)}function wn(t){return Wa(Ha())}function Qi(t,e){try{return wn(),!0}catch{return!1}return N.fn(async r=>{if(za(window))return!0;try{return await yn("web_app_request_theme","theme_changed",r),!0}catch{return!1}},{timeout:100})}function vf(){return new URLSearchParams(Ha()).get("tgWebAppData")||void 0}function yf(t){return({req_id:e})=>e===t}function Yi(t){return t.split(".").map(Number)}function wf(t,e){const r=Yi(t),s=Yi(e),n=Math.max(r.length,s.length);for(let i=0;i<n;i+=1){const o=r[i]||0,a=s[i]||0;if(o!==a)return o>a?1:-1}return 0}function F(t,e){return wf(t,e)<=0}function Be(t,e,r){if(typeof r=="string"){if(t==="web_app_open_link"){if(e==="try_instant_view")return F("6.4",r);if(e==="try_browser")return F("7.6",r)}if(t==="web_app_set_header_color"&&e==="color")return F("6.9",r);if(t==="web_app_close"&&e==="return_back")return F("7.6",r);if(t==="web_app_setup_main_button"&&e==="has_shine_effect")return F("7.10",r)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return F("6.1",e);case"web_app_open_popup":return F("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return F("6.4",e);case"web_app_switch_inline_query":return F("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return F("6.9",e);case"web_app_setup_settings_button":return F("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return F("7.2",e);case"web_app_setup_swipe_behavior":return F("7.7",e);case"web_app_share_to_story":return F("7.8",e);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return F("7.10",e);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return F("8.0",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function bf(t,e){e||(e="strict");const r=typeof e=="function"?e:s=>{const{method:n,version:i}=s,o="param"in s?new cf(n,s.param,i):new lf(n,i);if(e==="strict")throw o;return Wt().forceWarn(o.message)};return(s,n)=>Be(s,t)?s==="web_app_set_header_color"&&cn(X({color:ga()}),n)&&!Be(s,"color",t)?r({version:t,method:s,param:"color"}):vn(s,n):r({version:t,method:s})}function mf(t,e,r,s){return yn("web_app_invoke_custom_method","custom_method_invoked",{...s||{},params:{method:t,params:e,req_id:r},capture:yf(r)}).then(({result:n,error:i})=>{if(i)throw new ff(i);return n})}function kf(){return performance.getEntriesByType("navigation")[0]}function re(){const t=kf();return!!t&&t.type==="reload"}function Et(t,e){return kt(t,e)}function x(t,e){return Zd(t,e)}function j(t,e){const r=Et(t,e);return[r,x(r)]}let Ef=!1;const qs=kt(ja("Bridge",{bgColor:"forestgreen",textColor:"white",shouldLog(){return Ef}})),os=Et(0),Ga=Et(vn),[Xi,xr]=j({tgWebAppPlatform:"unknown",tgWebAppVersion:"0.0"}),me=x(()=>xr().tgWebAppVersion);function Sf(t){t||(t={});const{postEvent:e}=t,r=t.launchParams||wn();Xi.set(r),Ga.set(typeof e=="function"?e:bf(r.tgWebAppVersion)),qs().log("The package was configured. Launch params:",Xi())}function $f(){return os.set(os()+1),os().toString()}function Yt(t,e,r){return mf(t,e,$f(),{...r||{},postEvent:A})}const M=(t,e,r)=>(r||(r={}),r.postEvent||(r.postEvent=A),yn(t,e,r)),A=(t,e)=>Ga()(t,e);function Tf(t){return x(()=>Be(t,me()))}function Ve(t){return[t]}const[bn,Lg]=B("CSSVarsBoundError","CSS variables are already bound"),[Ja,Ug]=B("NotAvailableError",Ve);B("InvalidEnvError",Ve);const[At,Dg]=B("FunctionNotAvailableError",Ve),[ge,qg]=B("InvalidArgumentsError",(t,e)=>[t,{cause:e}]),[jf,Ng]=B("ConcurrentCallError",Ve),[Af,Bg]=B("SetEmojiStatusError",t=>[`Failed to set emoji status: ${t}`]),[Pf,Mg]=B("AccessDeniedError",Ve),[Of,Fg]=B("FullscreenFailedError",Ve);B("ShareMessageError",Ve);const[mn,Wg]=B("UnknownThemeParamsKeyError",t=>[`Unknown theme params key passed: ${t}`]);function Zi(){return typeof window>"u"}function kn(t,e,r){r||(r={});const{isSupported:s,isMounted:n,isMounting:i,component:o,supports:a}=r||{},u=`${o?`${o}.`:""}${t}()`,l=s?Array.isArray(s)||typeof s=="object"&&"any"in s?s:[s]:void 0;function c(m){if(a){const _=a[m];return Be(_[0],_[1],me())}return!0}function h(){if(!l)return;function m(S){return typeof S=="function"?S():Be(S,me())?void 0:`it is unsupported in Mini Apps version ${me()}`}const _=Array.isArray(l)?l:l.any,w=_.map(m).filter(Boolean);return Array.isArray(l)?w[0]:w.length===_.length?w[w.length-1]:void 0}function d(...m){for(const _ in a)if(a[_][2](...m)&&!c(_))return`option ${_} is not supported in Mini Apps version ${me()}`}let f;if(a){f={};for(const m in a)f[m]=x(()=>c(m))}const p=x(()=>!h()),v=x(()=>me()!=="0.0"),g=x(()=>!n||n()),E=x(()=>Qi()&&!Zi()&&v()&&p()&&g());return Object.assign((...m)=>{const _=`Unable to call the ${u} ${o?"method":"function"}:`;if(Zi()||!Qi())throw new At(`${_} it can't be called outside Mini Apps`);if(!v())throw new At(`${_} the SDK was not initialized. Use the SDK init() function`);const w=h();if(w)throw new At(`${_} ${w}`);const S=d(...m);if(S)throw new At(`${_} ${S}`);if(!g()){const y=i&&i()?"mounting. Wait for the mount completion":`unmounted. Use the ${o}.mount() method`;throw new At(`${_} the component is ${y}`)}return e(...m)},e,{isAvailable:E,ifAvailable(...m){return E()?[!0,e(...m)]:[!1]}},l?{isSupported:p}:{},f?{supports:f}:{})}function Cr(t,e){return e||(e={}),(r,s,n,i)=>kn(r,s,{...e,isSupported:n||e.isSupported,supports:i,component:t})}function Ae(t,e,r){return Cr(t,{isSupported:r,isMounted:e})}function se(t,e){return Cr(t,{isSupported:e})}const Rr="web_app_setup_back_button",Qa="back_button_pressed",Ir="backButton",[eo,Ya]=j(!1),[br,xf]=j(!1),Cf=Tf(Rr),Xa=Ae(Ir,br,Rr),En=se(Ir,Rr),Rf=Xa("hide",()=>{Sn(!1)}),If=En("mount",()=>{br()||(Sn(re()&&J(Ir)||!1),br.set(!0))});function Sn(t){t!==eo()&&(A(Rr,{is_visible:t}),ae(Ir,t),eo.set(t))}const Lf=En("onClick",t=>D(Qa,t)),Uf=En("offClick",t=>{Qt(Qa,t)}),Df=Xa("show",()=>{Sn(!0)});function qf(){br.set(!1)}const as=Object.freeze(Object.defineProperty({__proto__:null,hide:Rf,isMounted:xf,isSupported:Cf,isVisible:Ya,mount:If,offClick:Uf,onClick:Lf,show:Df,unmount:qf},Symbol.toStringTag,{value:"Module"}));function Q(t,e,r){r||(r={});const{promise:s,error:n}=r,[i,o]=s?[s,x(s)]:j(),[a,u]=n?[n,x(n)]:j();return[Object.assign((...l)=>{if(i()){const h=new jf(e);return a.set(h),N.reject(h)}Ft(()=>{i.set(t(...l)),a.set(void 0)});let c;return i().catch(h=>{throw c=h,h}).finally(()=>{Ft(()=>{i.set(void 0),a.set(c)})})},t),[i,o,x(()=>!!i())],[a,u]]}function Xt(t,e,r){const[s,...n]=Q(e,`The ${t} component is already mounting`),[i,o]=j(!1);return[(...a)=>i()?N.resolve():s(...a).then(u=>{Ft(()=>{i.set(!0),r(u)})}),...n,[i,o]]}const[Za,Vg]=j({available:!1,type:"",accessGranted:!1,accessRequested:!1,deviceId:"",tokenSaved:!1}),to="web_app_biometry_get_info",Nf=kn("requestBiometry",t=>M(to,"biometry_info_received",t),{isSupported:to});function eu(t){if(!Td(t))throw t}function tu(t){const e=t();e&&e.catch(eu).cancel()}const Vt="biometry",$n="web_app_biometry_request_auth",ru="biometry_info_received",Bf=t=>{Lr(Tn(t))};function su(){throw new Ja("Biometry is not available")}function Tn(t){let e=!1,r=!1,s="",n=!1,i="",o=!1;return t.available&&(e=!0,r=t.token_saved,s=t.device_id,n=t.access_requested,i=t.type,o=t.access_granted),{available:e,tokenSaved:r,deviceId:s,type:i,accessGranted:o,accessRequested:n}}const[Mf,Ff,Wf,nu]=Xt(Vt,t=>{const e=re()&&J(Vt);return e?N.resolve(e):Nf({abortSignal:t}).then(Tn)},t=>{D(ru,Bf),Lr(t)}),iu=se(Vt,$n),jn=Ae(Vt,nu[0],$n);iu("mount",Mf);const[,zg,Kg]=Ff,[,Hg]=Wf,[Gg,Jg]=nu,[Vf,zf,Kf]=Q(t=>N.fn(async e=>{const r=Za();r.available||su();const s=await M($n,"biometry_auth_requested",{...t,...e,params:{reason:((t||{}).reason||"").trim()}}),{token:n}=s;return typeof n=="string"&&Lr({...r,token:n}),s},t),"Biometry authentication is already in progress");jn("authenticate",Vf);const[,Qg,Yg]=zf,[,Xg]=Kf;iu("openSettings",()=>{A("web_app_biometry_open_settings")});const[Hf,Gf,Jf]=Q(t=>N.fn(async e=>{const r=await M("web_app_biometry_request_access",ru,{...t,...e,params:{reason:(t||{}).reason||""}}).then(Tn);return r.available||su(),Lr(r),r.accessGranted},t),"Biometry access request is already in progress");jn("requestAccess",Hf);const[,Zg,ev]=Gf,[,tv]=Jf;function Lr(t){Za.set(t),ae(Vt,t)}jn("updateToken",t=>(t||(t={}),M("web_app_biometry_update_token","biometry_token_updated",{...t,params:{token:t.token||"",reason:t.reason}}).then(e=>e.status)));function Ur(t,e){return Cr(t,{isMounted:e})}const Pe=Cr,Dr="closingBehavior",[ro,rv]=j(!1),[so,Qf]=j(!1),ou=Ur(Dr,Qf),Yf=Pe(Dr);ou("disableConfirmation",()=>{An(!1)});ou("enableConfirmation",()=>{An(!0)});Yf("mount",()=>{so()||(An(re()&&J(Dr)||!1),so.set(!0))});function An(t){t!==ro()&&(A("web_app_setup_closing_behavior",{need_confirmation:t}),ae(Dr,t),ro.set(t))}const Xf="web_app_invoke_custom_method",Zt=se("cloudStorage",Xf),Zf=Zt("deleteItem",(t,e)=>{const r=Array.isArray(t)?t:[t];return r.length?Yt("deleteStorageValues",{keys:r},e).then():N.resolve()});function ep(t,e){const r=Array.isArray(t)?t:[t];return r.length?Yt("getStorageValues",{keys:r},e).then(s=>{const n={...r.reduce((i,o)=>(i[o]="",i),{}),...ft(ba(U(),U()),s)};return typeof t=="string"?n[t]:n}):N.resolve(Array.isArray(t)?{}:"")}Zt("getItem",ep);const tp=Zt("getKeys",t=>Yt("getStorageKeys",{},t).then(e=>ft(va(U()),e)));Zt("setItem",(t,e,r)=>Yt("saveStorageValue",{key:t,value:e},r).then());Zt("clear",t=>tp(t).then(Zf));const qr="web_app_trigger_haptic_feedback",Pn=se("hapticFeedback",qr);Pn("impactOccurred",t=>{A(qr,{type:"impact",impact_style:t})});Pn("notificationOccurred",t=>{A(qr,{type:"notification",notification_type:t})});Pn("selectionChanged",()=>{A(qr,{type:"selection_change"})});const[au,rp]=j(void 0);function de(t){return x(()=>{const e=au();return e?e[t]:void 0})}const uu=de("auth_date"),lu=de("can_send_after"),sp=x(()=>{const t=uu(),e=lu();return e&&t?new Date(t.getTime()+e*1e3):void 0}),np=de("chat"),ip=de("chat_type"),op=de("chat_instance"),ap=de("hash"),up=de("query_id"),[lp,cp]=j(),hp=de("receiver");function dp(){const t=wn();au.set(t.tgWebAppData),lp.set(vf())}const fp=de("start_param"),pp=de("user"),no=Object.freeze(Object.defineProperty({__proto__:null,authDate:uu,canSendAfter:lu,canSendAfterDate:sp,chat:np,chatInstance:op,chatType:ip,hash:ap,queryId:up,raw:cp,receiver:hp,restore:dp,startParam:fp,state:rp,user:pp},Symbol.toStringTag,{value:"Module"})),cu="web_app_open_invoice",_p=se("invoice",cu);function gp(t,e,r){let s;if(e==="url"){const{hostname:n,pathname:i}=new URL(t,window.location.href);if(n!=="t.me")throw new ge(`Link has unexpected hostname: ${n}`);const o=i.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!o)throw new ge('Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,s]=o}else s=t,r=e;return M(cu,"invoice_closed",{...r,params:{slug:s},capture:n=>s===n.slug}).then(n=>n.status)}const[vp,yp,wp]=Q(gp,"Invoice is already opened");_p("open",vp);const[,sv,nv]=yp,[,iv]=wp,Dt="locationManager",hu="web_app_check_location",io="web_app_open_location_settings",Ns=Et({available:!1,accessGranted:!1,accessRequested:!1});function bp(t){let e=!1,r,s;return t.available&&(e=!0,r=t.access_requested,s=t.access_granted),{available:e,accessGranted:s||!1,accessRequested:r||!1}}const[mp,kp,Ep,du]=Xt(Dt,t=>{const e=re()&&J(Dt);return e?N.resolve(e):M("web_app_check_location","location_checked",t).then(bp)},t=>{Ns.set(t),ae(Dt,t)}),fu=se(Dt,hu),Sp=Ae(Dt,du[0],hu);fu("mount",mp);const[,ov,av]=kp,[,uv]=Ep,[lv,cv]=du,[$p,Tp,jp]=Q(t=>M("web_app_request_location","location_requested",t).then(e=>{if(!e.available)throw Ns.set({...Ns(),available:!1}),new Ja("Location data tracking is not available");const{available:r,...s}=e;return s}),"Location request is currently in progress");Sp("requestLocation",$p);const[,hv,dv]=Tp,[,fv]=jp;fu("openSettings",()=>{A(io)},io);function On(t){const e={};for(const r in t){const s=t[r];s!==void 0&&(e[r]=s)}return e}function Ap(t){const e=Kd(t);return Math.sqrt([.299,.587,.114].reduce((r,s,n)=>{const i=parseInt(e.slice(1+n*2,1+(n+1)*2),16);return r+i*i*s},0))<120}const[us,pv]=j(!1),[qe,er]=j({});function xn(t){return x(()=>qe()[t])}const pu=xn("button_color"),Pp=xn("button_text_color"),Op=xn("secondary_bg_color"),qt=Et({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),xp=x(()=>{const t=qt();return{...t,backgroundColor:t.backgroundColor||pu()||"#2481cc",textColor:t.textColor||Pp()||"#ffffff"}}),[oo,Cp]=j(!1),Rp="web_app_setup_main_button",_u="main_button_pressed",Nr="mainButton",Cn=Pe(Nr),Ip=Ur(Nr,Cp);Cn("mount",()=>{if(!oo()){const t=re()&&J(Nr);t&&qt.set(t),oo.set(!0)}});Cn("onClick",t=>D(_u,t));Cn("offClick",t=>{Qt(_u,t)});Ip("setParams",t=>{qt.set({...qt(),...On(t)}),ae(Nr,qt());const e=xp();e.text&&A(Rp,{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,text:e.text,text_color:e.textColor})});function Rn(t,e){document.documentElement.style.setProperty(t,e)}function In(t){document.documentElement.style.removeProperty(t)}const pt="themeParams",gu="theme_changed",vu=Pe(pt),yu=({theme_params:t})=>{qe.set(t),ae(pt,t)},[Lp,wu,Up,bu]=Xt(pt,t=>N.resolve(re()&&J(pt)||xr().tgWebAppThemeParams||{}),t=>{D(gu,yu),qe.set(t)}),Dp=Ur(pt,bu[0]);Dp("bindCssVars",t=>{if(us())throw new bn;t||(t=s=>`--tg-theme-${Od(s)}`);function e(s){Object.entries(qe()).forEach(([n,i])=>{i&&s(n,i)})}function r(){e((s,n)=>{Rn(t(s),n)})}return r(),qe.sub(r),us.set(!0),()=>{e(In),qe.unsub(r),us.set(!1)}});const qp=vu("mount",Lp);wu[2];wu[1];Up[1];const[ao,_v]=bu,Np=vu("mountSync",()=>{if(!ao()){const t=re()&&J(pt)||xr().tgWebAppThemeParams||{};D(gu,yu),Ft(()=>{qe.set(t),ao.set(!0)})}});function mu(t){return x(()=>Br(t()))}function Br(t){return mt(t)?t:er()[t]}const[zt,Bp]=j("bg_color"),Ln=mu(zt),[Kt,Mp]=j("bottom_bar_bg_color"),Un=x(()=>{const t=Kt();return mt(t)?t:er()[t]||Op()}),[Ht,Fp]=j("bg_color"),ku=mu(Ht),[ls,Wp]=j(!1),Vp=x(()=>{const t=Ln();return t?Ap(t):!1}),[Mr,zp]=j(!0),Eu=x(()=>({backgroundColor:zt(),bottomBarColor:Kt(),headerColor:Ht(),isActive:Mr()})),mr="web_app_set_background_color",kr="web_app_set_bottom_bar_color",Ie="web_app_set_header_color",Dn="visibility_changed",Me="miniApp",qn={any:[mr,kr,Ie]},Kp=x(()=>qn.any.some(t=>Be(t,me()))),Nn=t=>{Mr.set(t.is_visible),Wr()},Bn=t=>{[[Ht,Ie],[zt,mr],[Kt,kr]].forEach(([e,r])=>{const s=e();if(!mt(s)&&(r!==Ie||s!=="bg_color"&&s!=="secondary_bg_color")){const n=t[s];n&&A(r,{color:n})}})},[Hp,Su,Gp,$u]=Xt(Me,t=>qp(t).then(()=>re()&&J(Me)||void 0),t=>{Mn.ifAvailable(t?t.backgroundColor:"bg_color"),Fn.ifAvailable(t?t.bottomBarColor:"bottom_bar_bg_color"),Wn.ifAvailable(t?t.headerColor:"bg_color"),Mr.set(t?t.isActive:!0),D(Dn,Nn),er.sub(Bn)}),Tu=Pe(Me),ju=se(Me,qn),Fr=Ae(Me,$u[0],qn),Jp=Fr("bindCssVars",t=>{if(ls())throw new bn;const[e,r]=Pr();function s(n,i){function o(){Rn(n,i()||null)}o(),e(i.sub(o),In.bind(null,n))}return t||(t=n=>`--tg-${$a(n)}`),s(t("bgColor"),Ln),s(t("bottomBarColor"),Un),s(t("headerColor"),ku),e(()=>{ls.set(!1)}),ls.set(!0),r}),Qp=Tu("close",t=>{A("web_app_close",{return_back:t})}),Yp=ju("mount",Hp),Xp=Su[2],Au=Su[1],Zp=Gp[1],[Bs,e_]=$u,t_=ju("mountSync",()=>{if(!Bs()){Np();const t=re()&&J(Me)||void 0;Mn.ifAvailable(t?t.backgroundColor:"bg_color"),Fn.ifAvailable(t?t.bottomBarColor:"bottom_bar_bg_color"),Wn.ifAvailable(t?t.headerColor:"bg_color"),D(Dn,Nn),er.sub(Bn),Ft(()=>{Mr.set(t?t.isActive:!0),Bs.set(!0)})}}),r_=Tu("ready",()=>{A("web_app_ready")});function Wr(){ae(Me,Eu())}const Mn=Fr("setBackgroundColor",t=>{if(t===zt())return;const e=Br(t);if(!e)throw new mn(t);A(mr,{color:e}),zt.set(t),Wr()},mr),Fn=Fr("setBottomBarColor",t=>{if(t===Kt())return;const e=Br(t);if(!e)throw new mn(t);A(kr,{color:e}),Kt.set(t),Wr()},kr),Wn=Fr("setHeaderColor",t=>{if(t!==Ht()){if(t==="bg_color"||t==="secondary_bg_color")A(Ie,{color_key:t});else{const e=Br(t);if(!e)throw new mn(t);A(Ie,{color:e})}Ht.set(t),Wr()}},Ie,{rgb:[Ie,"color",mt]});function s_(){tu(Au),Qt(Dn,Nn),er.unsub(Bn),Bs.set(!1)}const cs=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:Bp,backgroundColorRGB:Ln,bindCssVars:Jp,bottomBarColor:Mp,bottomBarColorRGB:Un,close:Qp,headerColor:Fp,headerColorRGB:ku,isActive:zp,isCssVarsBound:Wp,isDark:Vp,isMounted:e_,isMounting:Xp,isSupported:Kp,mount:Yp,mountError:Zp,mountPromise:Au,mountSync:t_,ready:r_,setBackgroundColor:Mn,setBottomBarColor:Fn,setHeaderColor:Wn,state:Eu,unmount:s_},Symbol.toStringTag,{value:"Module"}));function n_(t){const e=t.message.trim(),r=(t.title||"").trim(),s=t.buttons||[];if(r.length>64)throw new ge(`Invalid title: ${r}`);if(!e||e.length>256)throw new ge(`Invalid message: ${e}`);if(s.length>3)throw new ge(`Invalid buttons count: ${s.length}`);return{title:r,message:e,buttons:s.length?s.map((n,i)=>{const o=n.id||"";if(o.length>64)throw new ge(`Button with index ${i} has invalid id: ${o}`);if(!n.type||n.type==="default"||n.type==="destructive"){const a=n.text.trim();if(!a||a.length>64)throw new ge(`Button with index ${i} has invalid text: ${a}`);return{type:n.type,text:a,id:o}}return{type:n.type,id:o}}):[{type:"close",id:""}]}}const Pu="web_app_open_popup",Ou=se("popup",Pu),[xu,Vn,Cu]=Q(t=>M(Pu,"popup_closed",{...t,params:n_(t)}).then(({button_id:e})=>e===void 0?null:e),"A popup is already opened");Ou("open",xu);Vn[1];Vn[2];Cu[1];Ou("show",xu);const[,gv,vv]=Vn,[,yv]=Cu,Ru="web_app_close_scan_qr_popup",Iu="web_app_open_scan_qr_popup",i_="scan_qr_popup_closed",o_="qr_text_received",Lu=se("qrScanner",Iu);Lu("close",()=>{A(Ru),tu(h_)});function a_(t){t||(t={});const{onCaptured:e,text:r,capture:s}=t,[,n]=Pr(D(i_,()=>{i.resolve()}),D(o_,o=>{e?e(o.data):(!s||s(o.data))&&(i.resolve(o.data),A(Ru))})),i=new Pd(t);return(t.postEvent||A)(Iu,{text:r}),N.resolve(i).catch(eu).finally(n)}const[u_,l_,c_]=Q(a_,"The QR Scanner is already opened");Lu("open",u_);const[,h_,wv]=l_,[,bv]=c_,Nt=Et({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),d_=x(()=>{const t=Nt();return{...t,backgroundColor:t.backgroundColor||Un()||"#000000",textColor:t.textColor||pu()||"#2481cc"}}),[uo,f_]=j(!1),zn="web_app_setup_secondary_button",Uu="secondary_button_pressed",Vr="secondaryButton",Kn=se(Vr,zn),p_=Ae(Vr,f_,zn);Kn("mount",()=>{if(!uo()){const t=re()&&J(Vr);t&&Nt.set(t),uo.set(!0)}});Kn("onClick",t=>D(Uu,t));Kn("offClick",t=>{Qt(Uu,t)});p_("setParams",t=>{Nt.set({...Nt(),...On(t)}),ae(Vr,Nt());const e=d_();e.text&&A(zn,{color:e.backgroundColor,has_shine_effect:e.hasShineEffect,is_active:e.isEnabled,is_progress_visible:e.isLoaderVisible,is_visible:e.isVisible,position:e.position,text:e.text,text_color:e.textColor})});const Hn="web_app_setup_settings_button",Du="settings_button_pressed",zr="settingsButton",[lo,mv]=j(!1),[Ms,kv]=j(!1),Gn=se(zr,Hn),qu=Ae(zr,Ms,Hn);qu("hide",()=>{Jn(!1)});Gn("mount",()=>{Ms()||(Jn(re()&&J(zr)||!1),Ms.set(!0))});function Jn(t){t!==lo()&&(A(Hn,{is_visible:t}),ae(zr,t),lo.set(t))}Gn("onClick",t=>D(Du,t));Gn("offClick",t=>{Qt(Du,t)});qu("show",()=>{Jn(!0)});const Qn="web_app_setup_swipe_behavior",Kr="swipeBehavior",[Fs,Ev]=j(!1),[co,Sv]=j(!0),__=se(Kr,Qn),Nu=Ae(Kr,Fs,Qn);Nu("disableVertical",()=>{Yn(!1)});Nu("enableVertical",()=>{Yn(!0)});__("mount",()=>{Fs()||(Yn(re()&&J(Kr)||!1,!0),Fs.set(!0))});function Yn(t,e){(t!==co()||e)&&(A(Qn,{allow_vertical_swipe:t}),ae(Kr,t),co.set(t))}const ze="viewport",Bu="fullscreen_changed",Mu="safe_area_changed",Fu="content_safe_area_changed",Wu="viewport_changed",Vu=Pe(ze),ho={left:0,top:0,bottom:0,right:0};function hs(t){return Math.max(t,0)}const[ds,g_]=j({contentSafeAreaInsets:ho,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:ho,stableHeight:0,width:0});function St(t){return x(()=>g_()[t])}const v_=St("height"),y_=St("stableHeight"),w_=St("width");function $t(t){const{height:e,stableHeight:r,width:s}=t;ds.set({...ds(),...On({...t,height:e?hs(e):void 0,width:s?hs(s):void 0,stableHeight:r?hs(r):void 0})}),ae(ze,ds())}function b_(){return J(ze)}function Hr(t){return x(()=>zu()[t])}const zu=St("contentSafeAreaInsets"),m_=Hr("bottom"),k_=Hr("left"),E_=Hr("right"),S_=Hr("top");function Gr(t){return x(()=>Ku()[t])}const Ku=St("safeAreaInsets"),$_=Gr("bottom"),T_=Gr("left"),j_=Gr("right"),A_=Gr("top"),Hu="web_app_request_safe_area",Gu=se(ze,Hu),fo=Gu("requestContentSafeAreaInsets",t=>M("web_app_request_content_safe_area",Fu,t));function P_(t){return M("web_app_request_viewport",Wu,t)}const po=Gu("requestSafeAreaInsets",t=>M(Hu,Mu,t)),O_=t=>{const{height:e}=t;$t({isExpanded:t.is_expanded,height:e,width:t.width,stableHeight:t.is_state_stable?e:void 0})},x_=t=>{$t({isFullscreen:t.is_fullscreen})},C_=t=>{$t({safeAreaInsets:t})},R_=t=>{$t({contentSafeAreaInsets:t})},[I_,L_,U_,D_]=Xt(ze,t=>{const e=re()&&b_();return e?N.resolve(e):N.fn(async r=>{const s=await N.all([po.isAvailable()?po(r):Ku(),fo.isAvailable()?fo(r):zu()]),n=xr(),i={contentSafeAreaInsets:s[1],isFullscreen:!!n.tgWebAppFullscreen,safeAreaInsets:s[0]};if(["macos","tdesktop","unigram","webk","weba","web"].includes(n.tgWebAppPlatform)){const o=window;return{...i,height:o.innerHeight,isExpanded:!0,stableHeight:o.innerHeight,width:o.innerWidth}}return P_(r).then(o=>({...i,height:o.height,isExpanded:o.is_expanded,stableHeight:o.is_state_stable?o.height:0,width:o.width}))},t)},t=>{D(Wu,O_),D(Bu,x_),D(Mu,C_),D(Fu,R_),$t(t)});Vu("mount",I_);const[,$v,Tv]=L_,[,jv]=U_,[Ju,Av]=D_,q_=Ur(ze,Ju),[fs,Pv]=j(!1);q_("bindCssVars",t=>{if(fs())throw new bn;t||(t=r=>`--tg-viewport-${$a(r)}`);const e=[["height",v_],["stableHeight",y_],["width",w_],["safeAreaInsetTop",A_],["safeAreaInsetBottom",$_],["safeAreaInsetLeft",T_],["safeAreaInsetRight",j_],["contentSafeAreaInsetTop",S_],["contentSafeAreaInsetBottom",m_],["contentSafeAreaInsetLeft",k_],["contentSafeAreaInsetRight",E_]].reduce((r,[s,n])=>{const i=t(s);if(i){const o=()=>{Rn(i,`${n()}px`)};r.push([o,n.sub(o),i])}return r},[]);return e.forEach(r=>{r[0]()}),fs.set(!0),()=>{e.forEach(r=>{r[1](),In(r[2])}),fs.set(!1)}});Vu("expand",()=>{A("web_app_expand")});const Qu="web_app_request_fullscreen",N_=Ae(ze,Ju,Qu),B_=St("isFullscreen"),[M_,Ov]=j(),[F_,xv]=j();function Yu(t,e){return N_(t,Q(r=>M(e?Qu:"web_app_exit_fullscreen",[Bu,"fullscreen_failed"],r).then(s=>{if("error"in s&&s.error!=="ALREADY_FULLSCREEN")throw new Of(s.error);const n="is_fullscreen"in s?s.is_fullscreen:!0;n!==B_()&&$t({isFullscreen:n})}),"Fullscreen mode change is already being requested",{promise:M_,error:F_})[0])}Yu("requestFullscreen",!0);Yu("exitFullscreen");const W_="web_app_request_emoji_status_access",[Cv,V_,z_]=Q(t=>M(W_,"emoji_status_access_requested",t).then(e=>e.status),"Emoji status access request is already in progress"),[,Rv,Iv]=V_,[,Lv]=z_,K_="web_app_set_emoji_status",[Uv,H_,G_]=Q((t,e)=>M(K_,["emoji_status_set","emoji_status_failed"],{params:{custom_emoji_id:t,duration:(e||{}).duration},...e}).then(r=>{if(r&&"error"in r)throw new Af(r.error)}),"Emoji status set request is currently in progress"),[,Dv,qv]=H_,[,Nv]=G_,J_="web_app_check_home_screen",[Bv,Q_,Y_]=Q(t=>M(J_,"home_screen_checked",t).then(e=>e.status||"unknown"),"Check home screen status request is currently in progress"),[,Mv,Fv]=Q_,[,Wv]=Y_,X_=Pe();X_("openLink",(t,e)=>{if(typeof t=="string")try{t=new URL(t)}catch(r){throw new ge(`"${t.toString()}" is invalid URL`,r)}e||(e={}),A("web_app_open_link",{url:t.toString(),try_browser:e.tryBrowser,try_instant_view:e.tryInstantView})});const _o="web_app_open_tg_link",Z_=Pe(),eg=Z_("openTelegramLink",t=>{const e=t.toString();if(!e.match(/^https:\/\/t.me\/.+/))throw new ge(`"${e}" is invalid URL`);if(!Be(_o,me())){window.location.href=e;return}t=new URL(t),A(_o,{path_full:t.pathname+t.search})}),tg=Pe();tg("shareURL",(t,e)=>{eg("https://t.me/share/url?"+new URLSearchParams({url:t,text:e||""}).toString().replace(/\+/g,"%20"))});function rg(t,e){return new N({abortSignal:e,timeout:t}).catch(()=>{})}const Xu="web_app_request_phone",[sg,ng,ig]=Q(t=>M(Xu,"phone_requested",t).then(e=>e.status),"Phone access request is currently in progress"),og=kn("requestPhoneAccess",sg,{isSupported:Xu}),[,Vv,zv]=ng,[,Kv]=ig;async function go(t){const e=ft(U(),await Yt("getRequestedContact",{},{...t,timeout:(t||{}).timeout||5e3}));return{raw:e,parsed:ft(ur(ma([U(),wa(URLSearchParams)]),Na(X({contact:ur(U(),_n(),X({user_id:yr(),phone_number:U(),first_name:U(),last_name:wr(U())})),auth_date:ur(U(),_a(r=>new Date(Number(r)*1e3)),ya()),hash:U()}))),e)}}const[Hv,ag,ug]=Q(t=>new N(async(e,r,s)=>{try{return e(await go(s))}catch(i){if(i instanceof xs)throw i}if(await og(s)!=="sent")throw new Pf("User denied access");let n=50;for(;!s.isAborted();){try{return e(await go(s))}catch(i){if(i instanceof xs)throw i}await rg(n),n+=50}},t),"Contact is already being requested"),[,Gv,Jv]=ag,[,Qv]=ug,lg="web_app_request_write_access",[Yv,cg,hg]=Q(t=>M(lg,"write_access_requested",t).then(e=>e.status),"Write access request is currently in progress"),[,Xv,Zv]=cg,[,ey]=hg;function dg(t){Sf(t);const[e,r]=Pr(D("reload_iframe",()=>{qs().log("Received a request to reload the page"),A("iframe_will_reload"),window.location.reload()})),{acceptCustomStyles:s=!0}={};if(s){const n=document.createElement("style");n.id="telegram-custom-styles",document.head.appendChild(n),e(D("set_custom_style",i=>{n.innerHTML=i}),()=>{document.head.removeChild(n)})}return A("iframe_ready",{reload_supported:!0}),qs().log("The package was initialized"),r}const ps=()=>{};function fg(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}const st=[];function pg(t,e=ps){let r=null;const s=new Set;function n(a){if(fg(t,a)&&(t=a,r)){const u=!st.length;for(const l of s)l[1](),st.push(l,t);if(u){for(let l=0;l<st.length;l+=2)st[l][0](st[l+1]);st.length=0}}}function i(a){n(a(t))}function o(a,u=ps){const l=[a,u];return s.add(l),s.size===1&&(r=e(n,i)||ps),a(t),()=>{s.delete(l),s.size===0&&r&&(r(),r=null)}}return{set:n,update:i,subscribe:o}}function _g(t){const e=pg(t()),r=t.sub(s=>{e.update(()=>s)});return Ho(r),e}function gg(){}var vg=tn("<p> </p> <button>PRESS</button>",1);function yg(t,e){Js(e,!0),_g(as.isVisible);let r=si(()=>`The button is, ${Ya()?"visible":"invisible"}`);no.restore();let s=si(()=>no.user);Ko(()=>{as.show()}),Ho(()=>{as.hide()});var n=vg(),i=xo(n),o=ys(i),a=Co(i,2);a.__click=[gg],Lo(u=>zo(o,`\`${Bt(r)??""}  ${u??""}\``),[()=>JSON.stringify(Bt(s))]),rn(t,n),Qs()}Jl(["click"]);function wg(t,e){Js(e,!1),(async()=>{try{await dg(),cs.ready.isAvailable()&&(await cs.ready(),cs.setHeaderColor("#fcb69f"),console.log("Mini App готово"))}catch(s){console.error("Ошибка инициализации:",s)}})(),ec(),yg(t,{}),Qs()}var bg=tn("<!> <!>",1);function mg(t){let e="User Name";var r=bg(),s=xo(r);nc(s,{name:e});var n=Co(s,2);wg(n,{}),rn(t,r)}Yl(mg,{target:document.getElementById("app")});
